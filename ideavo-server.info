$ next dev
  ‚ñ≤ Next.js 14.2.31
  - Local:        http://localhost:4000
  - Environments: .env

 ‚úì Starting...
 ‚úì Ready in 1955ms
 ‚úì Compiled /middleware in 168ms
 ‚úì Compiled (73 modules)
 ‚óã Compiling / ...
 ‚®Ø ./app/page.tsx
Error: 
  [31mx[0m the name `calculatePEK` is defined multiple times
      ,-[[36;1;4m/home/user/project/app/page.tsx[0m:897:1]
 [2m 897[0m |   };
 [2m 898[0m | 
 [2m 899[0m |   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API
 [2m 900[0m |   const calculatePEK = async (): Promise<CalculationResult> => {
      : [31;1m        ^^^^^^|^^^^^[0m
      :               [31;1m`-- [31;1mprevious definition of `calculatePEK` here[0m[0m
 [2m 901[0m |     const apiUrl = 'https://kabinet.pecom.ru/api/v1/calculateprice/';
 [2m 902[0m |     
 [2m 903[0m |     try {
 [2m 904[0m |       // –ü–æ–ª—É—á–∞–µ–º ID —Å–∫–ª–∞–¥–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º
 [2m 905[0m |       const senderWarehouseId = getPekWarehouseId(form.fromCity);
 [2m 906[0m |       const receiverWarehouseId = getPekWarehouseId(form.toCity);
 [2m 907[0m |       
 [2m 908[0m |       if (!senderWarehouseId || !receiverWarehouseId) {
 [2m 909[0m |         return {
 [2m 910[0m |           company: '–ü–≠–ö',
 [2m 911[0m |           price: 0,
 [2m 912[0m |           days: 0,
 [2m 913[0m |           error: `–°–∫–ª–∞–¥ –ü–≠–ö –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–æ—Ä–æ–¥–∞: ${!senderWarehouseId ? form.fromCity : ''} ${!receiverWarehouseId ? form.toCity : ''}`.trim(),
 [2m 914[0m |           apiUrl,
 [2m 915[0m |           requestData: { fromCity: form.fromCity, toCity: form.toCity },
 [2m 916[0m |           responseData: null
 [2m 917[0m |         };
 [2m 918[0m |       }
 [2m 919[0m | 
 [2m 920[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç—É –∑–∞–≤—Ç—Ä–∞ –¥–ª—è –∑–∞–±–æ—Ä–∞
 [2m 921[0m |       const tomorrow = new Date();
 [2m 922[0m |       tomorrow.setDate(tomorrow.getDate() + 1);
 [2m 923[0m |       const plannedDateTime = tomorrow.toISOString().slice(0, 19); // 2023-02-28T14:00:00
 [2m 924[0m | 
 [2m 925[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ –≥—Ä—É–∑–æ–≤
 [2m 926[0m |       const cargos = form.cargos.map(cargo => ({
 [2m 927[0m |         length: cargo.length / 100, // –ø–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–µ—Ç—Ä—ã
 [2m 928[0m |         width: cargo.width / 100,
 [2m 929[0m |         height: cargo.height / 100,
 [2m 930[0m |         volume: (cargo.length * cargo.width * cargo.height) / 1000000, // –º3
 [2m 931[0m |         weight: cargo.weight,
 [2m 932[0m |         isHP: form.needPackaging, // –∑–∞—â–∏—Ç–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞
 [2m 933[0m |         sealingPositionsCount: 0
 [2m 934[0m |       }));
 [2m 935[0m | 
 [2m 936[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –ü–≠–ö
 [2m 937[0m |       const requestData = {
 [2m 938[0m |         currencyCode: "643", // —Ä—É–±–ª–∏
 [2m 939[0m |         types: [3], // —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ –ø–µ—Ä–µ–≤–æ–∑–∫–∞
 [2m 940[0m |         senderWarehouseId,
 [2m 941[0m |         receiverWarehouseId,
 [2m 942[0m |         isOpenCarSender: false,
 [2m 943[0m |         isOpenCarReceiver: false,
 [2m 944[0m |         isHyperMarket: false,
 [2m 945[0m |         plannedDateTime,
 [2m 946[0m |         isInsurance: form.needInsurance && form.declaredValue > 0,
 [2m 947[0m |         isInsurancePrice: form.needInsurance ? form.declaredValue : 0,
 [2m 948[0m |         isPickUp: form.fromAddressDelivery,
 [2m 949[0m |         isDelivery: form.toAddressDelivery,
 [2m 950[0m |         needReturnDocuments: false,
 [2m 951[0m |         needArrangeTransportationDocuments: false,
 [2m 952[0m |         senderDistanceType: 0,
 [2m 953[0m |         receiverDistanceType: 0,
 [2m 954[0m |         cargos
 [2m 955[0m |       };
 [2m 956[0m | 
 [2m 957[0m |       // –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏ –ü–†–† –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
 [2m 958[0m |       if (form.needCarry) {
 [2m 959[0m |         requestData.pickupServices = {
 [2m 960[0m |           isLoading: true,
 [2m 961[0m |           floor: 0,
 [2m 962[0m |           carryingDistance: 0,
 [2m 963[0m |           isElevator: false
 [2m 964[0m |         };
 [2m 965[0m |         requestData.deliveryServices = {
 [2m 966[0m |           isLoading: true,
 [2m 967[0m |           floor: 0,
 [2m 968[0m |           carryingDistance: 0,
 [2m 969[0m |           isElevator: false
 [2m 970[0m |         };
 [2m 971[0m |       }
 [2m 972[0m | 
 [2m 973[0m |       // –î–æ–±–∞–≤–ª—è–µ–º –∞–¥—Ä–µ—Å–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞
 [2m 974[0m |       if (form.fromAddressDelivery) {
 [2m 975[0m |         requestData.pickup = {
 [2m 976[0m |           address: form.fromAddress || `–†–æ—Å—Å–∏—è, ${form.fromCity}`
 [2m 977[0m |         };
 [2m 978[0m |       }
 [2m 979[0m |       
 [2m 980[0m |       if (form.toAddressDelivery) {
 [2m 981[0m |         requestData.delivery = {
 [2m 982[0m |           address: form.toAddress || `–†–æ—Å—Å–∏—è, ${form.toCity}`
 [2m 983[0m |         };
 [2m 984[0m |       }
 [2m 985[0m | 
 [2m 986[0m |       console.log('üöÄ –ü–≠–ö API –∑–∞–ø—Ä–æ—Å:', requestData);
 [2m 987[0m | 
 [2m 988[0m |       const response = await fetch(apiUrl, {
 [2m 989[0m |         method: 'POST',
 [2m 990[0m |         headers: {
 [2m 991[0m |           'Content-Type': 'application/json;charset=utf-8',
 [2m 992[0m |           'Accept': 'application/json',
 [2m 993[0m |           'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`
 [2m 994[0m |         },
 [2m 995[0m |         body: JSON.stringify(requestData)
 [2m 996[0m |       });
 [2m 997[0m | 
 [2m 998[0m |       const data = await response.json();
 [2m 999[0m |       console.log('üöÄ –ü–≠–ö API –æ—Ç–≤–µ—Ç:', data);
 [2m1000[0m | 
 [2m1001[0m |       if (response.ok && !data.hasError && data.transfers && data.transfers.length > 0) {
 [2m1002[0m |         const transfer = data.transfers[0]; // –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —Ç–∞—Ä–∏—Ñ (–∞–≤—Ç–æ)
 [2m1003[0m |         
 [2m1004[0m |         if (!transfer.hasError) {
 [2m1005[0m |           // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —É—Å–ª—É–≥
 [2m1006[0m |           const services = [];
 [2m1007[0m |           let totalCalculated = 0;
 [2m1008[0m | 
 [2m1009[0m |           const processServices = (servicesList: any[], parentName = '') => {
 [2m1010[0m |             servicesList.forEach(service => {
 [2m1011[0m |               const serviceName = parentName ? `${parentName} - ${service.info}` : service.info;
 [2m1012[0m |               const serviceCost = parseFloat(service.cost) || 0;
 [2m1013[0m |               
 [2m1014[0m |               if (serviceCost > 0) {
 [2m1015[0m |                 services.push({
 [2m1016[0m |                   name: serviceName,
 [2m1017[0m |                   description: service.serviceType,
 [2m1018[0m |                   price: serviceCost
 [2m1019[0m |                 });
 [2m1020[0m |                 totalCalculated += serviceCost;
 [2m1021[0m |               }
 [2m1022[0m | 
 [2m1023[0m |               // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏
 [2m1024[0m |               if (service.services && Array.isArray(service.services)) {
 [2m1025[0m |                 processServices(service.services, serviceName);
 [2m1026[0m |               }
 [2m1027[0m |             });
 [2m1028[0m |           };
 [2m1029[0m | 
 [2m1030[0m |           if (transfer.services) {
 [2m1031[0m |             processServices(transfer.services);
 [2m1032[0m |           }
 [2m1033[0m | 
 [2m1034[0m |           return {
 [2m1035[0m |             company: '–ü–≠–ö',
 [2m1036[0m |             price: Math.round(transfer.costTotal),
 [2m1037[0m |             days: transfer.estDeliveryTime || 3,
 [2m1038[0m |             details: {
 [2m1039[0m |               note: `–î–æ—Å—Ç–∞–≤–∫–∞ ${form.fromCity} - ${form.toCity} (—Ç–∞—Ä–∏—Ñ ${transfer.type})`,
 [2m1040[0m |               services: services.length > 0 ? services : [
 [2m1041[0m |                 {
 [2m1042[0m |                   name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',
 [2m1043[0m |                   description: `${form.fromCity} - ${form.toCity}`,
 [2m1044[0m |                   price: Math.round(transfer.costTotal)
 [2m1045[0m |                 }
 [2m1046[0m |               ]
 [2m1047[0m |             },
 [2m1048[0m |             requestData,
 [2m1049[0m |             responseData: data,
 [2m1050[0m |             apiUrl
 [2m1051[0m |           };
 [2m1052[0m |         } else {
 [2m1053[0m |           throw new Error(transfer.errorMessage || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ç–∞—Ä–∏—Ñ–∞ –ü–≠–ö');
 [2m1054[0m |         }
 [2m1055[0m |       } else {
 [2m1056[0m |         throw new Error(data.errorMessage || '–û—à–∏–±–∫–∞ API –ü–≠–ö');
 [2m1057[0m |       }
 [2m1058[0m |       
 [2m1059[0m |     } catch (error: any) {
 [2m1060[0m |       console.error('üö® –û—à–∏–±–∫–∞ –ü–≠–ö API:', error);
 [2m1061[0m |       
 [2m1062[0m |       // –§–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
 [2m1063[0m |       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);
 [2m1064[0m |       let basePrice = totalWeight * 18; // 18 —Ä—É–± –∑–∞ –∫–≥ –¥–ª—è –ü–≠–ö
 [2m1065[0m |       
 [2m1066[0m |       if (form.fromAddressDelivery) basePrice += 600;
 [2m1067[0m |       if (form.toAddressDelivery) basePrice += 600;
 [2m1068[0m |       if (form.needInsurance && form.declaredValue > 0) basePrice += form.declaredValue * 0.012;
 [2m1069[0m |       if (form.needPackaging) basePrice += totalWeight * 25;
 [2m1070[0m |       if (form.needCarry) basePrice += 500;
 [2m1071[0m |       
 [2m1072[0m |       return {
 [2m1073[0m |         company: '–ü–≠–ö',
 [2m1074[0m |         price: Math.round(basePrice),
 [2m1075[0m |         days: 3,
 [2m1076[0m |         details: {
 [2m1077[0m |           note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ü–≠–ö (–æ—à–∏–±–∫–∞ API)',
 [2m1078[0m |           services: [
 [2m1079[0m |             {
 [2m1080[0m |               name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',
 [2m1081[0m |               description: `${form.fromCity} - ${form.toCity}`,
 [2m1082[0m |               price: Math.round(basePrice)
 [2m1083[0m |             }
 [2m1084[0m |           ]
 [2m1085[0m |         },
 [2m1086[0m |         requestData: null,
 [2m1087[0m |         responseData: null,
 [2m1088[0m |         apiUrl,
 [2m1089[0m |         error: `–û—à–∏–±–∫–∞ API –ü–≠–ö: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç.`
 [2m1090[0m |       };
 [2m1091[0m |     }
 [2m1092[0m |   };
 [2m1093[0m | 
 [2m1094[0m |   // –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Å–∫–ª–∞–¥–∞ –ü–≠–ö –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ API
 [2m1095[0m |   const findPekWarehouseId = async (address: string): Promise<string | null> => {
 [2m1096[0m |     try {
 [2m1097[0m |       // –ò—Å–ø–æ–ª—å–∑—É–µ–º API –ü–≠–ö –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ø–æ –∞–¥—Ä–µ—Å—É
 [2m1098[0m |       const response = await fetch('https://api.pecom.ru/v1/branches/findzonebyaddress', {
 [2m1099[0m |         method: 'POST',
 [2m1100[0m |         headers: {
 [2m1101[0m |           'Content-Type': 'application/json',
 [2m1102[0m |           'Authorization': 'Basic ' + btoa('C04C5BF2AE367BDCBDC71E7DA520A69B167D1984:')
 [2m1103[0m |         },
 [2m1104[0m |         body: JSON.stringify({
 [2m1105[0m |           address: address
 [2m1106[0m |         })
 [2m1107[0m |       });
 [2m1108[0m | 
 [2m1109[0m |       if (response.ok) {
 [2m1110[0m |         const data = await response.json();
 [2m1111[0m |         return data.mainWarehouseId || null;
 [2m1112[0m |       }
 [2m1113[0m |       
 [2m1114[0m |       // –§–æ–ª–ª–±—ç–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
 [2m1115[0m |       const fallbackWarehouses: { [key: string]: string } = {
 [2m1116[0m |         '–º–æ—Å–∫–≤–∞': 'dc6c746d-812d-11e4-bbfc-001999d8b3c5',
 [2m1117[0m |         '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': 'b436c978-086d-11e6-b6ca-00155d668909',
 [2m1118[0m |         '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '550e8400-e29b-41d4-a716-446655440000'
 [2m1119[0m |       };
 [2m1120[0m |       
 [2m1121[0m |       const normalizedCity = address.toLowerCase().trim()
 [2m1122[0m |         .replace(/—ë/g, '–µ')
 [2m1123[0m |         .replace(/[\s\-\.]+/g, '');
 [2m1124[0m |       
 [2m1125[0m |       for (const [city, warehouseId] of Object.entries(fallbackWarehouses)) {
 [2m1126[0m |         const normalizedCityKey = city.replace(/[\s\-\.]+/g, '');
 [2m1127[0m |         if (normalizedCity.includes(normalizedCityKey) || normalizedCityKey.includes(normalizedCity)) {
 [2m1128[0m |           return warehouseId;
 [2m1129[0m |         }
 [2m1130[0m |       }
 [2m1131[0m |       
 [2m1132[0m |       return null;
 [2m1133[0m |     } catch (error) {
 [2m1134[0m |       console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ü–≠–ö:', error);
 [2m1135[0m |       return null;
 [2m1136[0m |     }
 [2m1137[0m |   };
 [2m1138[0m | 
 [2m1139[0m |   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API
 [2m1140[0m |   const calculatePEK = async (): Promise<CalculationResult> => {
      : [33;1m        ^^^^^^|^^^^^[0m
      :               [33;1m`-- [33;1m`calculatePEK` redefined here[0m[0m
 [2m1141[0m |     const apiUrl = 'http://calc.pecom.ru/bitrix/components/pecom/calc/ajax.php';
 [2m1142[0m |     
 [2m1143[0m |     try {
      `----

Import trace for requested module:
./app/page.tsx
 ‚®Ø ./app/page.tsx
Error: 
  [31mx[0m the name `calculatePEK` is defined multiple times
      ,-[[36;1;4m/home/user/project/app/page.tsx[0m:897:1]
 [2m 897[0m |   };
 [2m 898[0m | 
 [2m 899[0m |   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API
 [2m 900[0m |   const calculatePEK = async (): Promise<CalculationResult> => {
      : [31;1m        ^^^^^^|^^^^^[0m
      :               [31;1m`-- [31;1mprevious definition of `calculatePEK` here[0m[0m
 [2m 901[0m |     const apiUrl = 'https://kabinet.pecom.ru/api/v1/calculateprice/';
 [2m 902[0m |     
 [2m 903[0m |     try {
 [2m 904[0m |       // –ü–æ–ª—É—á–∞–µ–º ID —Å–∫–ª–∞–¥–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º
 [2m 905[0m |       const senderWarehouseId = getPekWarehouseId(form.fromCity);
 [2m 906[0m |       const receiverWarehouseId = getPekWarehouseId(form.toCity);
 [2m 907[0m |       
 [2m 908[0m |       if (!senderWarehouseId || !receiverWarehouseId) {
 [2m 909[0m |         return {
 [2m 910[0m |           company: '–ü–≠–ö',
 [2m 911[0m |           price: 0,
 [2m 912[0m |           days: 0,
 [2m 913[0m |           error: `–°–∫–ª–∞–¥ –ü–≠–ö –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–æ—Ä–æ–¥–∞: ${!senderWarehouseId ? form.fromCity : ''} ${!receiverWarehouseId ? form.toCity : ''}`.trim(),
 [2m 914[0m |           apiUrl,
 [2m 915[0m |           requestData: { fromCity: form.fromCity, toCity: form.toCity },
 [2m 916[0m |           responseData: null
 [2m 917[0m |         };
 [2m 918[0m |       }
 [2m 919[0m | 
 [2m 920[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç—É –∑–∞–≤—Ç—Ä–∞ –¥–ª—è –∑–∞–±–æ—Ä–∞
 [2m 921[0m |       const tomorrow = new Date();
 [2m 922[0m |       tomorrow.setDate(tomorrow.getDate() + 1);
 [2m 923[0m |       const plannedDateTime = tomorrow.toISOString().slice(0, 19); // 2023-02-28T14:00:00
 [2m 924[0m | 
 [2m 925[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ –≥—Ä—É–∑–æ–≤
 [2m 926[0m |       const cargos = form.cargos.map(cargo => ({
 [2m 927[0m |         length: cargo.length / 100, // –ø–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–µ—Ç—Ä—ã
 [2m 928[0m |         width: cargo.width / 100,
 [2m 929[0m |         height: cargo.height / 100,
 [2m 930[0m |         volume: (cargo.length * cargo.width * cargo.height) / 1000000, // –º3
 [2m 931[0m |         weight: cargo.weight,
 [2m 932[0m |         isHP: form.needPackaging, // –∑–∞—â–∏—Ç–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞
 [2m 933[0m |         sealingPositionsCount: 0
 [2m 934[0m |       }));
 [2m 935[0m | 
 [2m 936[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –ü–≠–ö
 [2m 937[0m |       const requestData = {
 [2m 938[0m |         currencyCode: "643", // —Ä—É–±–ª–∏
 [2m 939[0m |         types: [3], // —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ –ø–µ—Ä–µ–≤–æ–∑–∫–∞
 [2m 940[0m |         senderWarehouseId,
 [2m 941[0m |         receiverWarehouseId,
 [2m 942[0m |         isOpenCarSender: false,
 [2m 943[0m |         isOpenCarReceiver: false,
 [2m 944[0m |         isHyperMarket: false,
 [2m 945[0m |         plannedDateTime,
 [2m 946[0m |         isInsurance: form.needInsurance && form.declaredValue > 0,
 [2m 947[0m |         isInsurancePrice: form.needInsurance ? form.declaredValue : 0,
 [2m 948[0m |         isPickUp: form.fromAddressDelivery,
 [2m 949[0m |         isDelivery: form.toAddressDelivery,
 [2m 950[0m |         needReturnDocuments: false,
 [2m 951[0m |         needArrangeTransportationDocuments: false,
 [2m 952[0m |         senderDistanceType: 0,
 [2m 953[0m |         receiverDistanceType: 0,
 [2m 954[0m |         cargos
 [2m 955[0m |       };
 [2m 956[0m | 
 [2m 957[0m |       // –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏ –ü–†–† –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
 [2m 958[0m |       if (form.needCarry) {
 [2m 959[0m |         requestData.pickupServices = {
 [2m 960[0m |           isLoading: true,
 [2m 961[0m |           floor: 0,
 [2m 962[0m |           carryingDistance: 0,
 [2m 963[0m |           isElevator: false
 [2m 964[0m |         };
 [2m 965[0m |         requestData.deliveryServices = {
 [2m 966[0m |           isLoading: true,
 [2m 967[0m |           floor: 0,
 [2m 968[0m |           carryingDistance: 0,
 [2m 969[0m |           isElevator: false
 [2m 970[0m |         };
 [2m 971[0m |       }
 [2m 972[0m | 
 [2m 973[0m |       // –î–æ–±–∞–≤–ª—è–µ–º –∞–¥—Ä–µ—Å–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞
 [2m 974[0m |       if (form.fromAddressDelivery) {
 [2m 975[0m |         requestData.pickup = {
 [2m 976[0m |           address: form.fromAddress || `–†–æ—Å—Å–∏—è, ${form.fromCity}`
 [2m 977[0m |         };
 [2m 978[0m |       }
 [2m 979[0m |       
 [2m 980[0m |       if (form.toAddressDelivery) {
 [2m 981[0m |         requestData.delivery = {
 [2m 982[0m |           address: form.toAddress || `–†–æ—Å—Å–∏—è, ${form.toCity}`
 [2m 983[0m |         };
 [2m 984[0m |       }
 [2m 985[0m | 
 [2m 986[0m |       console.log('üöÄ –ü–≠–ö API –∑–∞–ø—Ä–æ—Å:', requestData);
 [2m 987[0m | 
 [2m 988[0m |       const response = await fetch(apiUrl, {
 [2m 989[0m |         method: 'POST',
 [2m 990[0m |         headers: {
 [2m 991[0m |           'Content-Type': 'application/json;charset=utf-8',
 [2m 992[0m |           'Accept': 'application/json',
 [2m 993[0m |           'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`
 [2m 994[0m |         },
 [2m 995[0m |         body: JSON.stringify(requestData)
 [2m 996[0m |       });
 [2m 997[0m | 
 [2m 998[0m |       const data = await response.json();
 [2m 999[0m |       console.log('üöÄ –ü–≠–ö API –æ—Ç–≤–µ—Ç:', data);
 [2m1000[0m | 
 [2m1001[0m |       if (response.ok && !data.hasError && data.transfers && data.transfers.length > 0) {
 [2m1002[0m |         const transfer = data.transfers[0]; // –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —Ç–∞—Ä–∏—Ñ (–∞–≤—Ç–æ)
 [2m1003[0m |         
 [2m1004[0m |         if (!transfer.hasError) {
 [2m1005[0m |           // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —É—Å–ª—É–≥
 [2m1006[0m |           const services = [];
 [2m1007[0m |           let totalCalculated = 0;
 [2m1008[0m | 
 [2m1009[0m |           const processServices = (servicesList: any[], parentName = '') => {
 [2m1010[0m |             servicesList.forEach(service => {
 [2m1011[0m |               const serviceName = parentName ? `${parentName} - ${service.info}` : service.info;
 [2m1012[0m |               const serviceCost = parseFloat(service.cost) || 0;
 [2m1013[0m |               
 [2m1014[0m |               if (serviceCost > 0) {
 [2m1015[0m |                 services.push({
 [2m1016[0m |                   name: serviceName,
 [2m1017[0m |                   description: service.serviceType,
 [2m1018[0m |                   price: serviceCost
 [2m1019[0m |                 });
 [2m1020[0m |                 totalCalculated += serviceCost;
 [2m1021[0m |               }
 [2m1022[0m | 
 [2m1023[0m |               // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏
 [2m1024[0m |               if (service.services && Array.isArray(service.services)) {
 [2m1025[0m |                 processServices(service.services, serviceName);
 [2m1026[0m |               }
 [2m1027[0m |             });
 [2m1028[0m |           };
 [2m1029[0m | 
 [2m1030[0m |           if (transfer.services) {
 [2m1031[0m |             processServices(transfer.services);
 [2m1032[0m |           }
 [2m1033[0m | 
 [2m1034[0m |           return {
 [2m1035[0m |             company: '–ü–≠–ö',
 [2m1036[0m |             price: Math.round(transfer.costTotal),
 [2m1037[0m |             days: transfer.estDeliveryTime || 3,
 [2m1038[0m |             details: {
 [2m1039[0m |               note: `–î–æ—Å—Ç–∞–≤–∫–∞ ${form.fromCity} - ${form.toCity} (—Ç–∞—Ä–∏—Ñ ${transfer.type})`,
 [2m1040[0m |               services: services.length > 0 ? services : [
 [2m1041[0m |                 {
 [2m1042[0m |                   name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',
 [2m1043[0m |                   description: `${form.fromCity} - ${form.toCity}`,
 [2m1044[0m |                   price: Math.round(transfer.costTotal)
 [2m1045[0m |                 }
 [2m1046[0m |               ]
 [2m1047[0m |             },
 [2m1048[0m |             requestData,
 [2m1049[0m |             responseData: data,
 [2m1050[0m |             apiUrl
 [2m1051[0m |           };
 [2m1052[0m |         } else {
 [2m1053[0m |           throw new Error(transfer.errorMessage || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ç–∞—Ä–∏—Ñ–∞ –ü–≠–ö');
 [2m1054[0m |         }
 [2m1055[0m |       } else {
 [2m1056[0m |         throw new Error(data.errorMessage || '–û—à–∏–±–∫–∞ API –ü–≠–ö');
 [2m1057[0m |       }
 [2m1058[0m |       
 [2m1059[0m |     } catch (error: any) {
 [2m1060[0m |       console.error('üö® –û—à–∏–±–∫–∞ –ü–≠–ö API:', error);
 [2m1061[0m |       
 [2m1062[0m |       // –§–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
 [2m1063[0m |       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);
 [2m1064[0m |       let basePrice = totalWeight * 18; // 18 —Ä—É–± –∑–∞ –∫–≥ –¥–ª—è –ü–≠–ö
 [2m1065[0m |       
 [2m1066[0m |       if (form.fromAddressDelivery) basePrice += 600;
 [2m1067[0m |       if (form.toAddressDelivery) basePrice += 600;
 [2m1068[0m |       if (form.needInsurance && form.declaredValue > 0) basePrice += form.declaredValue * 0.012;
 [2m1069[0m |       if (form.needPackaging) basePrice += totalWeight * 25;
 [2m1070[0m |       if (form.needCarry) basePrice += 500;
 [2m1071[0m |       
 [2m1072[0m |       return {
 [2m1073[0m |         company: '–ü–≠–ö',
 [2m1074[0m |         price: Math.round(basePrice),
 [2m1075[0m |         days: 3,
 [2m1076[0m |         details: {
 [2m1077[0m |           note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ü–≠–ö (–æ—à–∏–±–∫–∞ API)',
 [2m1078[0m |           services: [
 [2m1079[0m |             {
 [2m1080[0m |               name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',
 [2m1081[0m |               description: `${form.fromCity} - ${form.toCity}`,
 [2m1082[0m |               price: Math.round(basePrice)
 [2m1083[0m |             }
 [2m1084[0m |           ]
 [2m1085[0m |         },
 [2m1086[0m |         requestData: null,
 [2m1087[0m |         responseData: null,
 [2m1088[0m |         apiUrl,
 [2m1089[0m |         error: `–û—à–∏–±–∫–∞ API –ü–≠–ö: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç.`
 [2m1090[0m |       };
 [2m1091[0m |     }
 [2m1092[0m |   };
 [2m1093[0m | 
 [2m1094[0m |   // –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Å–∫–ª–∞–¥–∞ –ü–≠–ö –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ API
 [2m1095[0m |   const findPekWarehouseId = async (address: string): Promise<string | null> => {
 [2m1096[0m |     try {
 [2m1097[0m |       // –ò—Å–ø–æ–ª—å–∑—É–µ–º API –ü–≠–ö –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ø–æ –∞–¥—Ä–µ—Å—É
 [2m1098[0m |       const response = await fetch('https://api.pecom.ru/v1/branches/findzonebyaddress', {
 [2m1099[0m |         method: 'POST',
 [2m1100[0m |         headers: {
 [2m1101[0m |           'Content-Type': 'application/json',
 [2m1102[0m |           'Authorization': 'Basic ' + btoa('C04C5BF2AE367BDCBDC71E7DA520A69B167D1984:')
 [2m1103[0m |         },
 [2m1104[0m |         body: JSON.stringify({
 [2m1105[0m |           address: address
 [2m1106[0m |         })
 [2m1107[0m |       });
 [2m1108[0m | 
 [2m1109[0m |       if (response.ok) {
 [2m1110[0m |         const data = await response.json();
 [2m1111[0m |         return data.mainWarehouseId || null;
 [2m1112[0m |       }
 [2m1113[0m |       
 [2m1114[0m |       // –§–æ–ª–ª–±—ç–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
 [2m1115[0m |       const fallbackWarehouses: { [key: string]: string } = {
 [2m1116[0m |         '–º–æ—Å–∫–≤–∞': 'dc6c746d-812d-11e4-bbfc-001999d8b3c5',
 [2m1117[0m |         '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': 'b436c978-086d-11e6-b6ca-00155d668909',
 [2m1118[0m |         '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '550e8400-e29b-41d4-a716-446655440000'
 [2m1119[0m |       };
 [2m1120[0m |       
 [2m1121[0m |       const normalizedCity = address.toLowerCase().trim()
 [2m1122[0m |         .replace(/—ë/g, '–µ')
 [2m1123[0m |         .replace(/[\s\-\.]+/g, '');
 [2m1124[0m |       
 [2m1125[0m |       for (const [city, warehouseId] of Object.entries(fallbackWarehouses)) {
 [2m1126[0m |         const normalizedCityKey = city.replace(/[\s\-\.]+/g, '');
 [2m1127[0m |         if (normalizedCity.includes(normalizedCityKey) || normalizedCityKey.includes(normalizedCity)) {
 [2m1128[0m |           return warehouseId;
 [2m1129[0m |         }
 [2m1130[0m |       }
 [2m1131[0m |       
 [2m1132[0m |       return null;
 [2m1133[0m |     } catch (error) {
 [2m1134[0m |       console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ü–≠–ö:', error);
 [2m1135[0m |       return null;
 [2m1136[0m |     }
 [2m1137[0m |   };
 [2m1138[0m | 
 [2m1139[0m |   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API
 [2m1140[0m |   const calculatePEK = async (): Promise<CalculationResult> => {
      : [33;1m        ^^^^^^|^^^^^[0m
      :               [33;1m`-- [33;1m`calculatePEK` redefined here[0m[0m
 [2m1141[0m |     const apiUrl = 'http://calc.pecom.ru/bitrix/components/pecom/calc/ajax.php';
 [2m1142[0m |     
 [2m1143[0m |     try {
      `----

Import trace for requested module:
./app/page.tsx
 ‚®Ø ./app/page.tsx
Error: 
  [31mx[0m the name `calculatePEK` is defined multiple times
      ,-[[36;1;4m/home/user/project/app/page.tsx[0m:897:1]
 [2m 897[0m |   };
 [2m 898[0m | 
 [2m 899[0m |   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API
 [2m 900[0m |   const calculatePEK = async (): Promise<CalculationResult> => {
      : [31;1m        ^^^^^^|^^^^^[0m
      :               [31;1m`-- [31;1mprevious definition of `calculatePEK` here[0m[0m
 [2m 901[0m |     const apiUrl = 'https://kabinet.pecom.ru/api/v1/calculateprice/';
 [2m 902[0m |     
 [2m 903[0m |     try {
 [2m 904[0m |       // –ü–æ–ª—É—á–∞–µ–º ID —Å–∫–ª–∞–¥–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º
 [2m 905[0m |       const senderWarehouseId = getPekWarehouseId(form.fromCity);
 [2m 906[0m |       const receiverWarehouseId = getPekWarehouseId(form.toCity);
 [2m 907[0m |       
 [2m 908[0m |       if (!senderWarehouseId || !receiverWarehouseId) {
 [2m 909[0m |         return {
 [2m 910[0m |           company: '–ü–≠–ö',
 [2m 911[0m |           price: 0,
 [2m 912[0m |           days: 0,
 [2m 913[0m |           error: `–°–∫–ª–∞–¥ –ü–≠–ö –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–æ—Ä–æ–¥–∞: ${!senderWarehouseId ? form.fromCity : ''} ${!receiverWarehouseId ? form.toCity : ''}`.trim(),
 [2m 914[0m |           apiUrl,
 [2m 915[0m |           requestData: { fromCity: form.fromCity, toCity: form.toCity },
 [2m 916[0m |           responseData: null
 [2m 917[0m |         };
 [2m 918[0m |       }
 [2m 919[0m | 
 [2m 920[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç—É –∑–∞–≤—Ç—Ä–∞ –¥–ª—è –∑–∞–±–æ—Ä–∞
 [2m 921[0m |       const tomorrow = new Date();
 [2m 922[0m |       tomorrow.setDate(tomorrow.getDate() + 1);
 [2m 923[0m |       const plannedDateTime = tomorrow.toISOString().slice(0, 19); // 2023-02-28T14:00:00
 [2m 924[0m | 
 [2m 925[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ –≥—Ä—É–∑–æ–≤
 [2m 926[0m |       const cargos = form.cargos.map(cargo => ({
 [2m 927[0m |         length: cargo.length / 100, // –ø–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–µ—Ç—Ä—ã
 [2m 928[0m |         width: cargo.width / 100,
 [2m 929[0m |         height: cargo.height / 100,
 [2m 930[0m |         volume: (cargo.length * cargo.width * cargo.height) / 1000000, // –º3
 [2m 931[0m |         weight: cargo.weight,
 [2m 932[0m |         isHP: form.needPackaging, // –∑–∞—â–∏—Ç–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞
 [2m 933[0m |         sealingPositionsCount: 0
 [2m 934[0m |       }));
 [2m 935[0m | 
 [2m 936[0m |       // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –ü–≠–ö
 [2m 937[0m |       const requestData = {
 [2m 938[0m |         currencyCode: "643", // —Ä—É–±–ª–∏
 [2m 939[0m |         types: [3], // —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ –ø–µ—Ä–µ–≤–æ–∑–∫–∞
 [2m 940[0m |         senderWarehouseId,
 [2m 941[0m |         receiverWarehouseId,
 [2m 942[0m |         isOpenCarSender: false,
 [2m 943[0m |         isOpenCarReceiver: false,
 [2m 944[0m |         isHyperMarket: false,
 [2m 945[0m |         plannedDateTime,
 [2m 946[0m |         isInsurance: form.needInsurance && form.declaredValue > 0,
 [2m 947[0m |         isInsurancePrice: form.needInsurance ? form.declaredValue : 0,
 [2m 948[0m |         isPickUp: form.fromAddressDelivery,
 [2m 949[0m |         isDelivery: form.toAddressDelivery,
 [2m 950[0m |         needReturnDocuments: false,
 [2m 951[0m |         needArrangeTransportationDocuments: false,
 [2m 952[0m |         senderDistanceType: 0,
 [2m 953[0m |         receiverDistanceType: 0,
 [2m 954[0m |         cargos
 [2m 955[0m |       };
 [2m 956[0m | 
 [2m 957[0m |       // –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏ –ü–†–† –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
 [2m 958[0m |       if (form.needCarry) {
 [2m 959[0m |         requestData.pickupServices = {
 [2m 960[0m |           isLoading: true,
 [2m 961[0m |           floor: 0,
 [2m 962[0m |           carryingDistance: 0,
 [2m 963[0m |           isElevator: false
 [2m 964[0m |         };
 [2m 965[0m |         requestData.deliveryServices = {
 [2m 966[0m |           isLoading: true,
 [2m 967[0m |           floor: 0,
 [2m 968[0m |           carryingDistance: 0,
 [2m 969[0m |           isElevator: false
 [2m 970[0m |         };
 [2m 971[0m |       }
 [2m 972[0m | 
 [2m 973[0m |       // –î–æ–±–∞–≤–ª—è–µ–º –∞–¥—Ä–µ—Å–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞
 [2m 974[0m |       if (form.fromAddressDelivery) {
 [2m 975[0m |         requestData.pickup = {
 [2m 976[0m |           address: form.fromAddress || `–†–æ—Å—Å–∏—è, ${form.fromCity}`
 [2m 977[0m |         };
 [2m 978[0m |       }
 [2m 979[0m |       
 [2m 980[0m |       if (form.toAddressDelivery) {
 [2m 981[0m |         requestData.delivery = {
 [2m 982[0m |           address: form.toAddress || `–†–æ—Å—Å–∏—è, ${form.toCity}`
 [2m 983[0m |         };
 [2m 984[0m |       }
 [2m 985[0m | 
 [2m 986[0m |       console.log('üöÄ –ü–≠–ö API –∑–∞–ø—Ä–æ—Å:', requestData);
 [2m 987[0m | 
 [2m 988[0m |       const response = await fetch(apiUrl, {
 [2m 989[0m |         method: 'POST',
 [2m 990[0m |         headers: {
 [2m 991[0m |           'Content-Type': 'application/json;charset=utf-8',
 [2m 992[0m |           'Accept': 'application/json',
 [2m 993[0m |           'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`
 [2m 994[0m |         },
 [2m 995[0m |         body: JSON.stringify(requestData)
 [2m 996[0m |       });
 [2m 997[0m | 
 [2m 998[0m |       const data = await response.json();
 [2m 999[0m |       console.log('üöÄ –ü–≠–ö API –æ—Ç–≤–µ—Ç:', data);
 [2m1000[0m | 
 [2m1001[0m |       if (response.ok && !data.hasError && data.transfers && data.transfers.length > 0) {
 [2m1002[0m |         const transfer = data.transfers[0]; // –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —Ç–∞—Ä–∏—Ñ (–∞–≤—Ç–æ)
 [2m1003[0m |         
 [2m1004[0m |         if (!transfer.hasError) {
 [2m1005[0m |           // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —É—Å–ª—É–≥
 [2m1006[0m |           const services = [];
 [2m1007[0m |           let totalCalculated = 0;
 [2m1008[0m | 
 [2m1009[0m |           const processServices = (servicesList: any[], parentName = '') => {
 [2m1010[0m |             servicesList.forEach(service => {
 [2m1011[0m |               const serviceName = parentName ? `${parentName} - ${service.info}` : service.info;
 [2m1012[0m |               const serviceCost = parseFloat(service.cost) || 0;
 [2m1013[0m |               
 [2m1014[0m |               if (serviceCost > 0) {
 [2m1015[0m |                 services.push({
 [2m1016[0m |                   name: serviceName,
 [2m1017[0m |                   description: service.serviceType,
 [2m1018[0m |                   price: serviceCost
 [2m1019[0m |                 });
 [2m1020[0m |                 totalCalculated += serviceCost;
 [2m1021[0m |               }
 [2m1022[0m | 
 [2m1023[0m |               // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏
 [2m1024[0m |               if (service.services && Array.isArray(service.services)) {
 [2m1025[0m |                 processServices(service.services, serviceName);
 [2m1026[0m |               }
 [2m1027[0m |             });
 [2m1028[0m |           };
 [2m1029[0m | 
 [2m1030[0m |           if (transfer.services) {
 [2m1031[0m |             processServices(transfer.services);
 [2m1032[0m |           }
 [2m1033[0m | 
 [2m1034[0m |           return {
 [2m1035[0m |             company: '–ü–≠–ö',
 [2m1036[0m |             price: Math.round(transfer.costTotal),
 [2m1037[0m |             days: transfer.estDeliveryTime || 3,
 [2m1038[0m |             details: {
 [2m1039[0m |               note: `–î–æ—Å—Ç–∞–≤–∫–∞ ${form.fromCity} - ${form.toCity} (—Ç–∞—Ä–∏—Ñ ${transfer.type})`,
 [2m1040[0m |               services: services.length > 0 ? services : [
 [2m1041[0m |                 {
 [2m1042[0m |                   name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',
 [2m1043[0m |                   description: `${form.fromCity} - ${form.toCity}`,
 [2m1044[0m |                   price: Math.round(transfer.costTotal)
 [2m1045[0m |                 }
 [2m1046[0m |               ]
 [2m1047[0m |             },
 [2m1048[0m |             requestData,
 [2m1049[0m |             responseData: data,
 [2m1050[0m |             apiUrl
 [2m1051[0m |           };
 [2m1052[0m |         } else {
 [2m1053[0m |           throw new Error(transfer.errorMessage || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ç–∞—Ä–∏—Ñ–∞ –ü–≠–ö');
 [2m1054[0m |         }
 [2m1055[0m |       } else {
 [2m1056[0m |         throw new Error(data.errorMessage || '–û—à–∏–±–∫–∞ API –ü–≠–ö');
 [2m1057[0m |       }
 [2m1058[0m |       
 [2m1059[0m |     } catch (error: any) {
 [2m1060[0m |       console.error('üö® –û—à–∏–±–∫–∞ –ü–≠–ö API:', error);
 [2m1061[0m |       
 [2m1062[0m |       // –§–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
 [2m1063[0m |       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);
 [2m1064[0m |       let basePrice = totalWeight * 18; // 18 —Ä—É–± –∑–∞ –∫–≥ –¥–ª—è –ü–≠–ö
 [2m1065[0m |       
 [2m1066[0m |       if (form.fromAddressDelivery) basePrice += 600;
 [2m1067[0m |       if (form.toAddressDelivery) basePrice += 600;
 [2m1068[0m |       if (form.needInsurance && form.declaredValue > 0) basePrice += form.declaredValue * 0.012;
 [2m1069[0m |       if (form.needPackaging) basePrice += totalWeight * 25;
 [2m1070[0m |       if (form.needCarry) basePrice += 500;
 [2m1071[0m |       
 [2m1072[0m |       return {
 [2m1073[0m |         company: '–ü–≠–ö',
 [2m1074[0m |         price: Math.round(basePrice),
 [2m1075[0m |         days: 3,
 [2m1076[0m |         details: {
 [2m1077[0m |           note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ü–≠–ö (–æ—à–∏–±–∫–∞ API)',
 [2m1078[0m |           services: [
 [2m1079[0m |             {
 [2m1080[0m |               name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',
 [2m1081[0m |               description: `${form.fromCity} - ${form.toCity}`,
 [2m1082[0m |               price: Math.round(basePrice)
 [2m1083[0m |             }
 [2m1084[0m |           ]
 [2m1085[0m |         },
 [2m1086[0m |         requestData: null,
 [2m1087[0m |         responseData: null,
 [2m1088[0m |         apiUrl,
 [2m1089[0m |         error: `–û—à–∏–±–∫–∞ API –ü–≠–ö: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç.`
 [2m1090[0m |       };
 [2m1091[0m |     }
 [2m1092[0m |   };
 [2m1093[0m | 
 [2m1094[0m |   // –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Å–∫–ª–∞–¥–∞ –ü–≠–ö –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ API
 [2m1095[0m |   const findPekWarehouseId = async (address: string): Promise<string | null> => {
 [2m1096[0m |     try {
 [2m1097[0m |       // –ò—Å–ø–æ–ª—å–∑—É–µ–º API –ü–≠–ö –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ø–æ –∞–¥—Ä–µ—Å—É
 [2m1098[0m |       const response = await fetch('https://api.pecom.ru/v1/branches/findzonebyaddress', {
 [2m1099[0m |         method: 'POST',
 [2m1100[0m |         headers: {
 [2m1101[0m |           'Content-Type': 'application/json',
 [2m1102[0m |           'Authorization': 'Basic ' + btoa('C04C5BF2AE367BDCBDC71E7DA520A69B167D1984:')
 [2m1103[0m |         },
 [2m1104[0m |         body: JSON.stringify({
 [2m1105[0m |           address: address
 [2m1106[0m |         })
 [2m1107[0m |       });
 [2m1108[0m | 
 [2m1109[0m |       if (response.ok) {
 [2m1110[0m |         const data = await response.json();
 [2m1111[0m |         return data.mainWarehouseId || null;
 [2m1112[0m |       }
 [2m1113[0m |       
 [2m1114[0m |       // –§–æ–ª–ª–±—ç–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
 [2m1115[0m |       const fallbackWarehouses: { [key: string]: string } = {
 [2m1116[0m |         '–º–æ—Å–∫–≤–∞': 'dc6c746d-812d-11e4-bbfc-001999d8b3c5',
 [2m1117[0m |         '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': 'b436c978-086d-11e6-b6ca-00155d668909',
 [2m1118[0m |         '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '550e8400-e29b-41d4-a716-446655440000'
 [2m1119[0m |       };
 [2m1120[0m |       
 [2m1121[0m |       const normalizedCity = address.toLowerCase().trim()
 [2m1122[0m |         .replace(/—ë/g, '–µ')
 [2m1123[0m |         .replace(/[\s\-\.]+/g, '');
 [2m1124[0m |       
 [2m1125[0m |       for (const [city, warehouseId] of Object.entries(fallbackWarehouses)) {
 [2m1126[0m |         const normalizedCityKey = city.replace(/[\s\-\.]+/g, '');
 [2m1127[0m |         if (normalizedCity.includes(normalizedCityKey) || normalizedCityKey.includes(normalizedCity)) {
 [2m1128[0m |           return warehouseId;
 [2m1129[0m |         }
 [2m1130[0m |       }
 [2m1131[0m |       
 [2m1132[0m |       return null;
 [2m1133[0m |     } catch (error) {
 [2m1134[0m |       console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ü–≠–ö:', error);
 [2m1135[0m |       return null;
 [2m1136[0m |     }
 [2m1137[0m |   };
 [2m1138[0m | 
 [2m1139[0m |   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API
 [2m1140[0m |   const calculatePEK = async (): Promise<CalculationResult> => {
      : [33;1m        ^^^^^^|^^^^^[0m
      :               [33;1m`-- [33;1m`calculatePEK` redefined here[0m[0m
 [2m1141[0m |     const apiUrl = 'http://calc.pecom.ru/bitrix/components/pecom/calc/ajax.php';
 [2m1142[0m |     
 [2m1143[0m |     try {
      `----

Import trace for requested module:
./app/page.tsx
 GET / 500 in 8911ms
 GET / 500 in 49ms
 ‚ö† Cross origin request detected from 4000-i859b80wqs6c2fhjwbj2w.e2b.app to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
