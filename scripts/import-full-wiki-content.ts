/**
 * Скрипт для импорта полного контента вики-инструкции
 * Запуск: npx tsx scripts/import-full-wiki-content.ts
 */

import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

interface WikiPageData {
  slug: string;
  title: string;
  content: string;
  order: number;
  parentId?: string | null;
}

const wikiPages: WikiPageData[] = [
  // Блок 1: Главная страница
  {
    slug: 'introduction',
    title: 'Инструкция для менеджера по логистике',
    content: JSON.stringify({
      sections: [
        {
          id: 'intro-1',
          title: 'Введение',
          content: 'Эта инструкция предназначена для менеджеров по логистике компании Лавсит. Здесь собраны основные принципы, процессы, инструменты и контакты, необходимые для эффективной работы в премиум-сегменте мебельного производства.',
          order: 0
        },
        {
          id: 'intro-2',
          title: 'Культура и структура компании',
          content: `Мы работаем в **премиум-сегменте** мебельного производства. Наша цель - обеспечить клиентам идеальный опыт доставки.

**AJTBD (Always Just The Best Delivery)** - каждая доставка должна быть идеальной. Мы не просто доставляем мебель, мы создаем незабываемый опыт для клиента.

**Клиентократия** - клиент находится в центре всех наших решений. Каждое действие оценивается с точки зрения ценности для клиента.

**Product Heroes** - мы стремимся создавать "героев продукта" через отличный сервис. Клиент должен стать амбассадором нашего бренда благодаря качеству доставки и сервиса.`,
          order: 1
        },
        {
          id: 'intro-3',
          title: 'Цели и задачи отдела логистики',
          content: `Отдел логистики состоит из:
- **Два логиста** - координация доставок, работа с клиентами, расчеты
- **Кладовщик** - управление складом, учет товаров
- **Команда экспедиторов-сборщиков** - доставка и сборка мебели

**Основные задачи:**
1. Обеспечить своевременную доставку мебели премиум-класса
2. Поддерживать высокий уровень коммуникации с клиентами
3. Координировать работу между производством, складом и доставкой
4. Обеспечить прозрачность всех процессов для клиента`,
          order: 2
        },
        {
          id: 'intro-4',
          title: 'Роль логиста',
          content: `Логист - это **ключевое звено** между клиентом, производством, складом и доставкой. 

**От качества работы логиста зависит:**
- Удовлетворенность клиента
- Репутация компании
- Повторные покупки
- Рекомендации друзьям и знакомым

**Каждое взаимодействие должно быть на уровне премиум-сервиса:**
- Быстрая реакция на запросы
- Проактивное информирование
- Решение проблем до их возникновения
- Персонализированный подход к каждому клиенту`,
          order: 3
        }
      ]
    }),
    order: 0,
    parentId: null
  },
  // Блок 2: Ежедневное расписание
  {
    slug: 'daily-schedule',
    title: 'Ежедневное расписание',
    content: JSON.stringify({
      sections: [
        {
          id: 'schedule-1',
          title: 'Расписание рабочего дня (8:00 - 20:00)',
          content: `Рабочий день логиста структурирован для максимальной эффективности и обеспечения премиум-сервиса.`,
          order: 0,
          columns: [
            {
              id: 'col-8-10',
              title: '8:00 - 10:00',
              content: `**Проверка чатов по отгрузкам**

Проверьте все чаты в Telegram:
- [Обращения в команду Логистики](https://web.telegram.org/k/#-2349029418)
- [Команда логистики](https://web.telegram.org/k/#-2258996699)
- [Отгрузка Сахи](https://web.telegram.org/k/#-2403968562)
- [Отгрузки СитиСервис](https://web.telegram.org/k/#-2463430303)
- [Отгрузки Лавсит](https://web.telegram.org/k/#-2347564431)
- [Лавсит. Доставка в СПб](https://web.telegram.org/k/#-2733756745)

**Задачи:**
- Обработать все входящие сообщения
- Проверить статусы отгрузок
- Выявить проблемные ситуации
- Составить план действий на день`,
              order: 0
            },
            {
              id: 'col-10-11',
              title: '10:00 - 11:00',
              content: `**Обработка входящих заказов в Битриксе**

[Вход в Битрикс24](https://lavsit.bitrix24.ru/)

**Задачи:**
- Проверить новые заказы
- Рассылка сообщений с уведомлением о готовности
- Вопрос по дате доставки каждому клиенту
- Фиксация предпочтений клиента`,
              order: 1
            },
            {
              id: 'col-11-13',
              title: '11:00 - 13:00',
              content: `**Подтверждение доставки на следующий день**

**Задачи:**
- Связаться с клиентами, запланированными на завтра
- Подтвердить время доставки
- Уточнить адрес и контакты
- Предупредить о необходимости присутствия
- Решить все вопросы заранее`,
              order: 2
            },
            {
              id: 'col-13-14',
              title: '13:00 - 14:00',
              content: `**Подготовка списков отгрузок для производства**

**Задачи:**
- Составить список отгрузок на следующий день
- Отправить списки в производство
- Согласовать время готовности
- Координировать со складом`,
              order: 3
            },
            {
              id: 'col-14-16',
              title: '14:00 - 16:00',
              content: `**Работа с междугородними доставками**

**Задачи:**
- Расчет стоимости междугородней доставки
- Согласование отгрузок с межгородом
- Работа с транспортными компаниями
- Оформление документов`,
              order: 4
            },
            {
              id: 'col-16-18',
              title: '16:00 - 18:00',
              content: `**Поддержка экспедиторов и контроль входящих**

**Задачи:**
- Поддержка экспедиторов в процессе доставки
- Контроль входящих сообщений от клиентов
- Оперативная корректировка отгрузок
- Координация склада, экспедиторов и клиентов`,
              order: 5
            },
            {
              id: 'col-18-20',
              title: '18:00 - 20:00',
              content: `**Завершение дня и планирование**

**Задачи:**
- Проверка новых сообщений в Битриксе
- Оперативная корректировка отгрузок
- Ответы на возникшие вопросы
- Контроль платного хранения (рассылка уведомлений + расчет сумм)
- Планирование на следующий день`,
              order: 6
            }
          ]
        }
      ]
    }),
    order: 1,
    parentId: null
  },
  // Блок 3: Полезные ссылки
  {
    slug: 'useful-links',
    title: 'Полезные ссылки',
    content: JSON.stringify({
      sections: [
        {
          id: 'links-1',
          title: 'Telegram чаты',
          content: 'Все чаты для работы с отгрузками и координации:',
          order: 0,
          columns: [
            {
              id: 'link-tg-1',
              title: 'Обращения в команду Логистики',
              content: '[Открыть чат](https://web.telegram.org/k/#-2349029418)',
              order: 0
            },
            {
              id: 'link-tg-2',
              title: 'Команда логистики',
              content: '[Открыть чат](https://web.telegram.org/k/#-2258996699)',
              order: 1
            },
            {
              id: 'link-tg-3',
              title: 'Отгрузка Сахи',
              content: '[Открыть чат](https://web.telegram.org/k/#-2403968562)',
              order: 2
            },
            {
              id: 'link-tg-4',
              title: 'Отгрузки СитиСервис',
              content: '[Открыть чат](https://web.telegram.org/k/#-2463430303)',
              order: 3
            },
            {
              id: 'link-tg-5',
              title: 'Отгрузки Лавсит',
              content: '[Открыть чат](https://web.telegram.org/k/#-2347564431)',
              order: 4
            },
            {
              id: 'link-tg-6',
              title: 'Лавсит. Доставка в СПб',
              content: '[Открыть чат](https://web.telegram.org/k/#-2733756745)',
              order: 5
            }
          ]
        },
        {
          id: 'links-2',
          title: 'Google Sheets',
          content: 'Основные таблицы для работы:',
          order: 1,
          columns: [
            {
              id: 'link-sheet-1',
              title: 'Логистика',
              content: '[Открыть таблицу](https://docs.google.com/spreadsheets/d/1ZTRCsSU6NEq36KZBPs9c3zEAstM6GDQ6EiowGf6uA2c/edit?gid=0#gid=0)',
              order: 0
            },
            {
              id: 'link-sheet-2',
              title: 'Экономика',
              content: '[Открыть таблицу](https://docs.google.com/spreadsheets/d/1T_DyUQcfs2bM-hBVeVuCIIItt2bJjaZGqQlkr-1kCWM/edit?pli=1&gid=1558920191#gid=1558920191)',
              order: 1
            },
            {
              id: 'link-sheet-3',
              title: 'Забота',
              content: '[Открыть таблицу](https://docs.google.com/spreadsheets/d/1ysUYilvGyWaY8cJ-v9DunYsf-SFGD1cWSW8u2IUFkQk/edit?gid=153995768#gid=153995768)',
              order: 2
            }
          ]
        },
        {
          id: 'links-3',
          title: 'Системы',
          content: 'Доступ к рабочим системам:',
          order: 2,
          columns: [
            {
              id: 'link-sys-1',
              title: 'Битрикс24',
              content: '[Вход в систему](https://lavsit.bitrix24.ru/)',
              order: 0
            }
          ]
        }
      ]
    }),
    order: 2,
    parentId: null
  },
  // Блок 4: Контакты
  {
    slug: 'contacts',
    title: 'Контакты',
    content: JSON.stringify({
      sections: [
        {
          id: 'contacts-1',
          title: 'Команда логистики',
          content: 'Основные контакты команды логистики:',
          order: 0,
          contacts: [
            {
              id: 'contact-1',
              name: 'Логист 1',
              phone: '+7 (XXX) XXX-XX-XX',
              email: 'logist1@lavsit.ru',
              position: 'Менеджер по логистике',
              notes: 'Основной логист, координация доставок'
            },
            {
              id: 'contact-2',
              name: 'Логист 2',
              phone: '+7 (XXX) XXX-XX-XX',
              email: 'logist2@lavsit.ru',
              position: 'Менеджер по логистике',
              notes: 'Второй логист, работа с междугородними доставками'
            }
          ]
        },
        {
          id: 'contacts-2',
          title: 'Склад',
          content: 'Контакты склада:',
          order: 1,
          contacts: [
            {
              id: 'contact-3',
              name: 'Кладовщик',
              phone: '+7 (XXX) XXX-XX-XX',
              email: 'sklad@lavsit.ru',
              position: 'Кладовщик',
              notes: 'Управление складом, учет товаров'
            }
          ]
        },
        {
          id: 'contacts-3',
          title: 'Экспедиторы и сборщики',
          content: 'Команда доставки и сборки:',
          order: 2,
          contacts: [
            {
              id: 'contact-4',
              name: 'Руководитель экспедиторов',
              phone: '+7 (XXX) XXX-XX-XX',
              email: 'expedition@lavsit.ru',
              position: 'Руководитель экспедиции',
              notes: 'Координация команды экспедиторов-сборщиков'
            }
          ]
        }
      ]
    }),
    order: 3,
    parentId: null
  },
  // Блок 5: Аккаунты
  {
    slug: 'accounts',
    title: 'Аккаунты и доступы',
    content: JSON.stringify({
      sections: [
        {
          id: 'accounts-1',
          title: 'Битрикс24',
          content: `**Система учета заказов и клиентов**

[Вход в систему](https://lavsit.bitrix24.ru/)

**Доступ:**
- Логин: [указать логин]
- Пароль: [указать пароль]

**Основные функции:**
- Просмотр и обработка заказов
- Работа с клиентами
- Отслеживание статусов доставок
- История коммуникаций`,
          order: 0
        },
        {
          id: 'accounts-2',
          title: 'Google Sheets',
          content: `**Доступ к таблицам:**

Все таблицы доступны через корпоративный аккаунт Google.

**Основные таблицы:**
- [Логистика](https://docs.google.com/spreadsheets/d/1ZTRCsSU6NEq36KZBPs9c3zEAstM6GDQ6EiowGf6uA2c/edit?gid=0#gid=0)
- [Экономика](https://docs.google.com/spreadsheets/d/1T_DyUQcfs2bM-hBVeVuCIIItt2bJjaZGqQlkr-1kCWM/edit?pli=1&gid=1558920191#gid=1558920191)
- [Забота](https://docs.google.com/spreadsheets/d/1ysUYilvGyWaY8cJ-v9DunYsf-SFGD1cWSW8u2IUFkQk/edit?gid=153995768#gid=153995768)`,
          order: 1
        }
      ]
    }),
    order: 4,
    parentId: null
  },
  // Блок 6: Примеры сообщений и скрипты
  {
    slug: 'scripts',
    title: 'Примеры сообщений и скрипты',
    content: JSON.stringify({
      sections: [
        {
          id: 'scripts-1',
          title: 'Уведомление о готовности заказа',
          content: `**Шаблон сообщения:**

Здравствуйте, [Имя клиента]!

Отличные новости! Ваш заказ [номер заказа] готов к доставке.

Для согласования удобной даты и времени доставки, пожалуйста, уточните:
- Предпочтительные даты доставки
- Удобное время (с [время] до [время])
- Адрес доставки (если отличается от указанного)

Мы свяжемся с вами в ближайшее время для подтверждения деталей.

С уважением,
Команда Лавсит`,
          order: 0
        },
        {
          id: 'scripts-2',
          title: 'Согласование доставки',
          content: `**Шаблон сообщения:**

Здравствуйте, [Имя клиента]!

Подтверждаем доставку вашего заказа [номер заказа] на [дата] в [время].

**Детали доставки:**
- Дата: [дата]
- Время: [время]
- Адрес: [адрес]
- Контактное лицо: [имя, телефон]

**Важно:**
- Пожалуйста, обеспечьте присутствие на указанное время
- Убедитесь, что есть доступ для заноса мебели
- Если возникнут изменения, сообщите нам заранее

Если у вас есть вопросы, мы всегда на связи!

С уважением,
Команда Лавсит`,
          order: 1
        },
        {
          id: 'scripts-3',
          title: 'Работа с доплатами',
          content: `**Шаблон сообщения о доплате:**

Здравствуйте, [Имя клиента]!

По вашему заказу [номер заказа] требуется доплата за [причина доплаты] в размере [сумма] рублей.

**Детали:**
- Причина доплаты: [описание]
- Сумма: [сумма] руб.
- Способы оплаты: [способы]

Пожалуйста, произведите оплату до [дата], чтобы мы могли отгрузить ваш заказ в запланированные сроки.

Если у вас есть вопросы, готовы обсудить детали.

С уважением,
Команда Лавсит`,
          order: 2
        },
        {
          id: 'scripts-4',
          title: 'Уведомление о платном хранении',
          content: `**Шаблон сообщения:**

Здравствуйте, [Имя клиента]!

Ваш заказ [номер заказа] готов и находится на складе.

**Информация о хранении:**
- Дата готовности: [дата]
- Текущий срок хранения: [дни] дней
- Стоимость хранения: [сумма] руб./день
- Текущая сумма: [сумма] руб.

Для согласования доставки или продления хранения, пожалуйста, свяжитесь с нами.

С уважением,
Команда Лавсит`,
          order: 3
        }
      ]
    }),
    order: 5,
    parentId: null
  },
  // Блок 7: Ценность отдела логистики
  {
    slug: 'logistics-value',
    title: 'Ценность отдела логистики',
    content: JSON.stringify({
      sections: [
        {
          id: 'value-1',
          title: 'Какую ценность несет отдел логистики',
          content: `Отдел логистики - это **ключевой элемент** создания ценности для клиента в премиум-сегменте.

**Основная ценность:**
1. **Обеспечение идеального опыта доставки (AJTBD)**
   - Каждая доставка должна быть безупречной
   - Клиент получает не просто мебель, а полный сервис
   - Создание положительных эмоций от взаимодействия

2. **Создание "героев продукта" (Product Heroes)**
   - Клиенты становятся амбассадорами бренда
   - Рекомендации друзьям и знакомым
   - Повторные покупки благодаря качеству сервиса

3. **Клиентократия в действии**
   - Клиент в центре всех решений
   - Быстрое решение проблем
   - Проактивное информирование

**Метрики ценности:**
- Процент доставок в срок: **цель 98%+**
- Время от готовности до доставки: **цель < 3 дней**
- Процент клиентов, готовых рекомендовать: **цель 90%+**
- Процент повторных покупок: **цель 40%+**`,
          order: 0
        },
        {
          id: 'value-2',
          title: 'Вклад в бизнес',
          content: `**Количественные показатели:**

1. **Скорость оборота**
   - Сокращение времени от готовности до доставки увеличивает оборачиваемость склада
   - Быстрая доставка = быстрее оплата = лучше cash flow

2. **Снижение затрат на хранение**
   - Эффективная логистика снижает сроки хранения
   - Меньше платного хранения = меньше затрат

3. **Увеличение лояльности**
   - Качественный сервис = повторные покупки
   - Рекомендации = новый клиент без затрат на рекламу

4. **Снижение рекламаций**
   - Правильная координация = меньше повреждений
   - Проактивное решение проблем = меньше жалоб`,
          order: 1
        }
      ]
    }),
    order: 6,
    parentId: null
  },
  // Блок 8: Метрики качества работы
  {
    slug: 'quality-metrics',
    title: 'Метрики качества работы',
    content: JSON.stringify({
      sections: [
        {
          id: 'metrics-1',
          title: 'Количественная оценка качества работы',
          content: `**Метрики без опросов клиентов (по принципам Клиентократии и Product Heroes):**

**1. Метрики скорости реакции:**
- Среднее время ответа на сообщение клиента: **цель < 15 минут**
- Процент ответов в течение 15 минут: **цель 95%+**
- Время обработки заявки на доставку: **цель < 1 часа**

**2. Метрики выполнения обещаний:**
- Процент доставок в согласованное время: **цель 98%+**
- Процент доставок в срок (от готовности): **цель 95%+**
- Процент выполненных обещаний клиенту: **цель 99%+**

**3. Метрики проактивности:**
- Процент клиентов, уведомленных о готовности до их запроса: **цель 90%+**
- Процент клиентов, уведомленных о статусе доставки: **цель 100%**
- Процент проблем, решенных до обращения клиента: **цель 80%+**

**4. Метрики принятия доплат:**
- Процент доплат, принятых без возражений: **цель 85%+**
- Время от запроса доплаты до оплаты: **цель < 24 часа**
- Процент клиентов, согласившихся на доплату: **цель 90%+**

**5. Метрики повторных взаимодействий:**
- Процент клиентов, вернувшихся с новым заказом: **цель 40%+**
- Процент клиентов, рекомендовавших друзьям: **цель 30%+**
- Среднее количество заказов на клиента: **цель 1.5+**`,
          order: 0
        },
        {
          id: 'metrics-2',
          title: 'Система премирования',
          content: `**Премирование основано на реальных метриках:**

**Базовые метрики (обязательные для премии):**
- Время ответа < 15 минут: **95%+**
- Доставки в срок: **98%+**
- Выполнение обещаний: **99%+**

**Дополнительные метрики (увеличивают премию):**
- Проактивные уведомления: **90%+** (+10% к премии)
- Принятие доплат без возражений: **85%+** (+10% к премии)
- Повторные заказы клиентов: **40%+** (+15% к премии)
- Рекомендации друзьям: **30%+** (+15% к премии)

**Максимальная премия:** при достижении всех метрик`,
          order: 1
        }
      ]
    }),
    order: 7,
    parentId: null
  },
  // Блок 9: Метрики общения
  {
    slug: 'communication-metrics',
    title: 'Метрики общения и коммуникации',
    content: JSON.stringify({
      sections: [
        {
          id: 'comm-1',
          title: 'Метрики для логистов',
          content: `**Основные метрики:**

1. **Скорость реакции:**
   - Среднее время ответа: **< 15 минут**
   - Процент ответов в течение 15 минут: **95%+**
   - Процент ответов в течение 1 часа: **100%**

2. **Качество коммуникации:**
   - Процент полных ответов (без необходимости уточнений): **90%+**
   - Процент проактивных сообщений: **80%+**
   - Процент сообщений с конкретными датами/временем: **100%**

3. **Решение проблем:**
   - Процент проблем, решенных с первого обращения: **85%+**
   - Время решения проблемы: **< 24 часа**
   - Процент клиентов, довольных решением: **95%+**`,
          order: 0
        },
        {
          id: 'comm-2',
          title: 'Метрики для кладовщика',
          content: `**Основные метрики:**

1. **Точность учета:**
   - Процент совпадений фактического наличия с учетными данными: **99%+**
   - Количество ошибок в учете: **< 1 в месяц**

2. **Скорость обработки:**
   - Время подготовки заказа к отгрузке: **< 2 часа**
   - Процент заказов, подготовленных в срок: **100%**

3. **Коммуникация:**
   - Время ответа на запрос логиста: **< 30 минут**
   - Процент проактивных уведомлений о проблемах: **100%**`,
          order: 1
        },
        {
          id: 'comm-3',
          title: 'Метрики для экспедиторов/сборщиков',
          content: `**Основные метрики:**

1. **Пунктуальность:**
   - Процент доставок в согласованное время: **98%+**
   - Процент доставок с опозданием < 30 минут: **100%**

2. **Качество доставки:**
   - Процент доставок без повреждений: **99%+**
   - Процент правильной сборки: **100%**

3. **Коммуникация:**
   - Процент уведомлений о прибытии: **100%**
   - Время ответа на запрос логиста: **< 15 минут**
   - Процент проактивных сообщений о проблемах: **100%**`,
          order: 2
        }
      ]
    }),
    order: 8,
    parentId: null
  },
  // Блок 10: Ключевое обещание клиенту
  {
    slug: 'client-promise',
    title: 'Ключевое обещание клиенту',
    content: JSON.stringify({
      sections: [
        {
          id: 'promise-1',
          title: 'Формулировка обещания',
          content: `**Наше ключевое обещание клиенту:**

"Мы доставим вашу мебель премиум-класса в согласованное время с безупречным качеством сервиса. Вы получите не просто мебель, а полный опыт премиум-обслуживания, где каждая деталь продумана для вашего комфорта."

**Детали обещания:**
1. **Пунктуальность:** Доставка в точно согласованное время (±15 минут)
2. **Качество:** Без повреждений, правильная сборка, чистота после сборки
3. **Коммуникация:** Проактивное информирование на каждом этапе
4. **Решение проблем:** Любая проблема решается в течение 24 часов
5. **Персонализация:** Учет всех ваших пожеланий и особенностей`,
          order: 0
        },
        {
          id: 'promise-2',
          title: 'Отслеживание выполнения',
          content: `**Метрики выполнения обещания:**

1. **Пунктуальность:**
   - Доставка в согласованное время: **98%+**
   - Уведомление об опоздании заранее: **100%**

2. **Качество:**
   - Доставки без повреждений: **99%+**
   - Правильная сборка: **100%**
   - Чистота после сборки: **100%**

3. **Коммуникация:**
   - Уведомление о готовности: **100%**
   - Уведомление о статусе доставки: **100%**
   - Проактивные сообщения: **90%+**

4. **Решение проблем:**
   - Время решения проблемы: **< 24 часа**
   - Процент решенных проблем: **100%**
   - Удовлетворенность решением: **95%+**

**Отслеживание:**
- Все метрики фиксируются в системе
- Еженедельный анализ выполнения обещания
- Корректирующие действия при отклонениях`,
          order: 1
        }
      ]
    }),
    order: 9,
    parentId: null
  },
  // Блок 11: Процессы работы
  {
    slug: 'work-processes',
    title: 'Процессы работы',
    content: JSON.stringify({
      sections: [
        {
          id: 'process-1',
          title: 'Согласование отгрузок',
          content: `**Процесс согласования отгрузок:**

1. **С производителями:**
   - Проверка наличия товара
   - Подтверждение отгрузки
   - Оформление документов
   - Согласование времени готовности

2. **Со складом:**
   - Координация времени прихода
   - Оформление накладных
   - Проверка комплектности
   - Подготовка к отгрузке

3. **С экспедиторами:**
   - Проверка маршрутных листов
   - Согласование времени прибытия
   - Координация маршрутов
   - Контроль выполнения

4. **С клиентами:**
   - Согласование времени доставки
   - Уточнение условий
   - Подтверждение адреса
   - Предупреждение о доставке`,
          order: 0
        },
        {
          id: 'process-2',
          title: 'Работа с оплатами',
          content: `**Процесс работы с оплатами:**

1. **Доплаты клиентов:**
   - Расчет доплаты за срочную доставку
   - Расчет доплаты за дополнительные услуги
   - Фиксация в системе
   - Уведомление клиента
   - Контроль оплаты

2. **Оплата за хранение:**
   - Расчет стоимости хранения
   - Уведомление клиента
   - Контроль оплаты
   - Отслеживание сроков

3. **Документирование:**
   - Все платежи фиксируются в CRM
   - Документы сохраняются
   - Отчетность по платежам`,
          order: 1
        },
        {
          id: 'process-3',
          title: 'Оформление заказов',
          content: `**Процесс оформления заказов:**

1. **Через транспортные компании:**
   - Заполнение T-квитанций
   - Оформление договоров
   - Расчет стоимости
   - Отслеживание доставки

2. **Прямые машины:**
   - Оформление маршрутов
   - Согласование с водителями
   - Расчет стоимости
   - Контроль выполнения

3. **Документооборот:**
   - Все документы в системе
   - Копии для клиента
   - Отчетность`,
          order: 2
        },
        {
          id: 'process-4',
          title: 'Обработка рекламаций',
          content: `**Процесс обработки рекламаций:**

1. **Прием рекламации:**
   - Регистрация в системе
   - Фиксация деталей проблемы
   - Определение приоритета

2. **Решение проблемы:**
   - Анализ причины
   - Согласование решения с клиентом
   - Организация доставки/ремонта
   - Контроль выполнения

3. **Завершение:**
   - Получение подтверждения от клиента
   - Фиксация в системе
   - Анализ для предотвращения повторения`,
          order: 3
        }
      ]
    }),
    order: 10,
    parentId: null
  },
  // Блок 12: Регламенты и стандарты
  {
    slug: 'regulations',
    title: 'Регламенты и стандарты',
    content: JSON.stringify({
      sections: [
        {
          id: 'reg-1',
          title: 'Время реакции',
          content: `**Стандарты времени реакции:**

- **На сообщения клиентов:** в течение 15 минут в рабочее время (8:00-20:00)
- **На заявки на отгрузку:** в течение 1 часа
- **На рекламации:** немедленно, в течение 30 минут
- **На запросы коллег:** в течение 2 часов
- **На экстренные ситуации:** немедленно

**Принципы:**
- Быстрая реакция = высокий уровень сервиса
- Проактивность лучше реактивности
- Клиент не должен ждать`,
          order: 0
        },
        {
          id: 'reg-2',
          title: 'Качество коммуникации',
          content: `**Стандарты коммуникации:**

1. **Тон общения:**
   - Всегда вежливый и профессиональный
   - Дружелюбный, но не фамильярный
   - Уважительный к клиенту

2. **Содержание сообщений:**
   - Полные и точные ответы на вопросы
   - Конкретные даты и время
   - Проактивное информирование о статусах
   - Использование проверенной информации

3. **Документирование:**
   - Важные договоренности подтверждаются письменно
   - Все согласования фиксируются в CRM
   - История коммуникаций сохраняется`,
          order: 1
        },
        {
          id: 'reg-3',
          title: 'Документальное оформление',
          content: `**Стандарты документации:**

1. **Все согласования фиксируются в CRM:**
   - Дата и время доставки
   - Адрес и контакты
   - Особые условия
   - Доплаты и их причины

2. **Важные договоренности подтверждаются письменно:**
   - Email или сообщение в мессенджере
   - Сохранение в истории коммуникаций

3. **Отчеты формируются по установленному шаблону:**
   - Ежедневные отчеты до 18:00
   - Еженедельные отчеты
   - Отчеты по метрикам

4. **Все платежи документируются:**
   - Фиксация в системе
   - Сохранение документов
   - Отчетность`,
          order: 2
        }
      ]
    }),
    order: 11,
    parentId: null
  },
  // Блок 13: Работа с клиентами
  {
    slug: 'client-work',
    title: 'Работа с клиентами',
    content: JSON.stringify({
      sections: [
        {
          id: 'client-1',
          title: 'Принципы общения',
          content: `**Основные принципы работы с клиентами:**

1. **Клиент в центре:**
   - Каждое решение оценивается с точки зрения клиента
   - Приоритет - удовлетворенность клиента
   - Клиент всегда прав (в рамках разумного)

2. **Проактивность:**
   - Информируем клиента до его запроса
   - Предупреждаем о возможных проблемах
   - Предлагаем решения заранее

3. **Персонализация:**
   - Учитываем особенности каждого клиента
   - Запоминаем предпочтения
   - Адаптируем подход

4. **Прозрачность:**
   - Честная информация о статусах
   - Понятные объяснения процессов
   - Открытость в коммуникации`,
          order: 0
        },
        {
          id: 'client-2',
          title: 'Скрипты общения',
          content: `**Типовые ситуации и скрипты:**

1. **Первое обращение клиента:**
   - Приветствие и представление
   - Выяснение потребностей
   - Предложение решения
   - Следующие шаги

2. **Согласование доставки:**
   - Предложение удобных дат
   - Уточнение деталей
   - Подтверждение
   - Напоминание перед доставкой

3. **Решение проблем:**
   - Признание проблемы
   - Извинения
   - Предложение решения
   - Контроль выполнения

4. **Завершение доставки:**
   - Проверка удовлетворенности
   - Благодарность
   - Просьба о рекомендации
   - Информация о следующем заказе`,
          order: 1
        },
        {
          id: 'client-3',
          title: 'Обработка рекламаций',
          content: `**Процесс обработки рекламаций:**

1. **Прием рекламации:**
   - Выслушать клиента полностью
   - Зафиксировать все детали
   - Не оправдываться, а решать проблему
   - Извиниться за неудобства

2. **Анализ и решение:**
   - Быстро определить причину
   - Предложить решение
   - Согласовать с клиентом
   - Выполнить в кратчайшие сроки

3. **Завершение:**
   - Убедиться в удовлетворенности
   - Получить подтверждение
   - Проанализировать для предотвращения повторения
   - Зафиксировать в системе`,
          order: 2
        }
      ]
    }),
    order: 12,
    parentId: null
  }
];

async function importPages() {
  try {
    console.log('Начало импорта полного контента вики...');

    for (const pageData of wikiPages) {
      // Проверить существование страницы
      const existing = await prisma.wikiPage.findUnique({
        where: { slug: pageData.slug }
      });

      if (existing) {
        // Обновить существующую страницу
        const updated = await prisma.wikiPage.update({
          where: { slug: pageData.slug },
          data: {
            title: pageData.title,
            content: pageData.content,
            order: pageData.order,
            parentId: pageData.parentId || null
          }
        });

        // Создать новую версию
        const lastVersion = await prisma.wikiVersion.findFirst({
          where: { pageId: updated.id },
          orderBy: { version: 'desc' }
        });

        await prisma.wikiVersion.create({
          data: {
            pageId: updated.id,
            title: updated.title,
            content: updated.content,
            version: (lastVersion?.version || 0) + 1,
            changeNote: 'Обновление контента',
            createdBy: null
          }
        });

        console.log(`✓ Обновлена страница: ${pageData.title}`);
      } else {
        // Создать новую страницу
        const page = await prisma.wikiPage.create({
          data: {
            slug: pageData.slug,
            title: pageData.title,
            content: pageData.content,
            order: pageData.order,
            parentId: pageData.parentId || null,
            isActive: true
          }
        });

        // Создать первую версию
        await prisma.wikiVersion.create({
          data: {
            pageId: page.id,
            title: page.title,
            content: page.content,
            version: 1,
            changeNote: 'Создание страницы',
            createdBy: null
          }
        });

        console.log(`✓ Создана страница: ${pageData.title}`);
      }
    }

    console.log('Импорт завершен успешно!');
  } catch (error) {
    console.error('Ошибка при импорте:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
  }
}

importPages();

