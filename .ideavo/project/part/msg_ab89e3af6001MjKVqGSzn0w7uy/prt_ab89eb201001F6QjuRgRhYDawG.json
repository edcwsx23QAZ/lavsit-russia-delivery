{
  "id": "prt_ab89eb201001F6QjuRgRhYDawG",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_ab89e3af6001MjKVqGSzn0w7uy",
  "type": "tool",
  "callID": "call_fb337531e5554b3c992e1a2b",
  "tool": "write",
  "state": {
    "status": "completed",
    "input": {
      "content": "// Direct test of NordWheel API route fix\nimport { NextRequest } from 'next/server';\n\nasync function testNordWheelRoute() {\n  console.log('üß™ Testing NordWheel route with warehouse delivery...');\n  \n  // Simulate warehouse delivery request\n  const warehouseRequest = {\n    dispatch: {\n      location: {\n        type: 'terminal',\n        city_fias: '504ac4f9-0a3a-4c7b-9c2e-1a4a6b8b0c7e' // –õ–æ—Å–∏–Ω–æ-–ü–µ—Ç—Ä–æ–≤—Å–∫–∏–π\n      }\n    },\n    destination: {\n      location: {\n        type: 'terminal',\n        city_fias: 'c2deb16a-0330-4f05-821f-1d09c93331e6' // –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥\n      }\n    },\n    cargo: {\n      total_weight: 50,\n      total_volume: 0.2,\n      total_quantity: 1\n    },\n    insurance: 0,\n    insurance_refuse: true,\n    services: {\n      is_package: false,\n      is_documents_return: false,\n      is_fragile: false\n    },\n    promocode: null\n  };\n\n  try {\n    // Test the actual NordWheel API directly\n    const apiUrl = 'https://api.nordw.orog.ru/api/v1/calculate';\n    const apiKey = '5|WYpV9f788Y2ASobpv3xy6N5qxtIUaKhxFF4yWETOfc398950';\n    \n    console.log('üì¶ Sending request to NordWheel API:', JSON.stringify(warehouseRequest, null, 2));\n    \n    const response = await fetch(apiUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${apiKey}`,\n        'User-Agent': 'DeliveryCalculator/1.0',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify(warehouseRequest)\n    });\n    \n    const responseText = await response.text();\n    console.log('üì• Response status:', response.status, response.statusText);\n    console.log('üì• Response body:', responseText.substring(0, 1000));\n    \n    if (response.ok) {\n      const data = JSON.parse(responseText);\n      if (data.auto || data.avia) {\n        console.log('‚úÖ SUCCESS: NordWheel warehouse delivery works!');\n        console.log('üí∞ Price options available:', {\n          auto: data.auto ? data.auto.total_amount : 'N/A',\n          avia: data.avia ? data.avia.total_amount : 'N/A'\n        });\n        return true;\n      } else {\n        console.log('‚ùå ISSUE: No delivery options in response');\n        return false;\n      }\n    } else {\n      console.log('‚ùå ERROR: NordWheel API returned error');\n      try {\n        const errorData = JSON.parse(responseText);\n        console.log('‚ùå Error details:', errorData);\n      } catch (e) {\n        console.log('‚ùå Raw error response:', responseText);\n      }\n      return false;\n    }\n    \n  } catch (error) {\n    console.error('‚ùå Test failed:', error.message);\n    return false;\n  }\n}\n\n// Run test\ntestNordWheelRoute().then(success => {\n  console.log('\\nüèÅ Test completed:', success ? 'SUCCESS' : 'FAILED');\n  process.exit(success ? 0 : 1);\n});",
      "filePath": "/home/user/project/test-nordwheel-direct.js"
    },
    "output": "",
    "title": "test-nordwheel-direct.js",
    "metadata": {
      "diagnostics": {},
      "filepath": "/home/user/project/test-nordwheel-direct.js",
      "exists": false
    },
    "time": {
      "start": 1764033999364,
      "end": 1764033999365
    }
  }
}