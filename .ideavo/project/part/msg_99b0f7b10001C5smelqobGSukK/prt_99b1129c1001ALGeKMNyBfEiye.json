{
  "id": "prt_99b1129c1001ALGeKMNyBfEiye",
  "messageID": "msg_99b0f7b10001C5smelqobGSukK",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "write",
  "callID": "toolu_019sxFEVPy93ffPrzZ854aaJ",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/components/diagnostic/FullTestingResults.tsx",
      "content": "'use client';\n\nimport React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Progress } from '@/components/ui/progress';\nimport { Badge } from '@/components/ui/badge';\nimport { BarChart3, Activity, CheckCircle, XCircle, Clock, Target } from 'lucide-react';\n\ninterface TestResult {\n  company: string;\n  status: 'passed' | 'failed' | 'timeout' | 'skipped';\n  message: string;\n  details?: any;\n  timing: number;\n  timestamp: string;\n}\n\ninterface TestSummary {\n  total: number;\n  passed: number;\n  failed: number;\n  skipped: number;\n  averageTime: number;\n  successRate: number;\n  errors: string[];\n}\n\ninterface FullTestingResultsProps {\n  fullTestResults: {\n    summary: TestSummary;\n    details: TestResult[];\n  } | null;\n  testProgress: number;\n  isFullTesting: boolean;\n}\n\nexport default function FullTestingResults({\n  fullTestResults,\n  testProgress,\n  isFullTesting\n}: FullTestingResultsProps) {\n  if (!fullTestResults && !isFullTesting) {\n    return null;\n  }\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'passed': return <CheckCircle className=\"h-4 w-4 text-green-400\" />;\n      case 'failed': return <XCircle className=\"h-4 w-4 text-red-400\" />;\n      case 'timeout': return <Clock className=\"h-4 w-4 text-yellow-400\" />;\n      case 'skipped': return <Target className=\"h-4 w-4 text-gray-400\" />;\n      default: return <Activity className=\"h-4 w-4 text-gray-400\" />;\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'passed': return 'text-green-400';\n      case 'failed': return 'text-red-400';\n      case 'timeout': return 'text-yellow-400';\n      case 'skipped': return 'text-gray-400';\n      default: return 'text-gray-400';\n    }\n  };\n\n  return (\n    <Card className=\"border-green-500 bg-green-900/20 mt-6\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <BarChart3 className=\"h-5 w-5 text-green-400\" />\n          <span className=\"text-white\">Результаты полного тестирования</span>\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        {isFullTesting && (\n          <div className=\"mb-6\">\n            <div className=\"flex justify-between items-center mb-2\">\n              <span className=\"text-white\">Прогресс тестирования</span>\n              <span className=\"text-gray-300\">{testProgress}%</span>\n            </div>\n            <Progress value={testProgress} className=\"h-2\" />\n          </div>\n        )}\n\n        {fullTestResults && (\n          <div className=\"space-y-6\">\n            {/* Статистика */}\n            <div className=\"grid grid-cols-2 md:grid-cols-6 gap-4\">\n              <div className=\"bg-gray-800 p-3 rounded text-center\">\n                <div className=\"text-2xl font-bold text-white\">{fullTestResults.summary.total}</div>\n                <div className=\"text-sm text-gray-400\">Всего тестов</div>\n              </div>\n              <div className=\"bg-gray-800 p-3 rounded text-center\">\n                <div className=\"text-2xl font-bold text-green-400\">{fullTestResults.summary.passed}</div>\n                <div className=\"text-sm text-gray-400\">Успешных</div>\n              </div>\n              <div className=\"bg-gray-800 p-3 rounded text-center\">\n                <div className=\"text-2xl font-bold text-red-400\">{fullTestResults.summary.failed}</div>\n                <div className=\"text-sm text-gray-400\">Неудачных</div>\n              </div>\n              <div className=\"bg-gray-800 p-3 rounded text-center\">\n                <div className=\"text-2xl font-bold text-gray-400\">{fullTestResults.summary.skipped}</div>\n                <div className=\"text-sm text-gray-400\">Пропущено</div>\n              </div>\n              <div className=\"bg-gray-800 p-3 rounded text-center\">\n                <div className=\"text-2xl font-bold text-blue-400\">\n                  {fullTestResults.summary.successRate.toFixed(1)}%\n                </div>\n                <div className=\"text-sm text-gray-400\">Успешность</div>\n              </div>\n              <div className=\"bg-gray-800 p-3 rounded text-center\">\n                <div className=\"text-2xl font-bold text-purple-400\">{fullTestResults.summary.averageTime}мс</div>\n                <div className=\"text-sm text-gray-400\">Среднее время</div>\n              </div>\n            </div>\n\n            {/* Статистика по компаниям */}\n            <div>\n              <h4 className=\"font-medium mb-2 text-white\">Статистика по транспортным компаниям:</h4>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\n                {Array.from(new Set(fullTestResults.details.map(d => d.company))).map(company => {\n                  const companyResults = fullTestResults.details.filter(d => d.company === company);\n                  const passed = companyResults.filter(r => r.status === 'passed').length;\n                  const total = companyResults.length;\n                  const rate = total > 0 ? (passed / total * 100).toFixed(1) : 0;\n                  \n                  return (\n                    <div key={company} className=\"bg-gray-800 p-3 rounded\">\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-white font-medium\">{company}</span>\n                        <Badge variant=\"outline\" className={\n                          rate === '100.0' ? 'border-green-400 text-green-400' :\n                          parseFloat(rate.toString()) >= 80 ? 'border-yellow-400 text-yellow-400' :\n                          'border-red-400 text-red-400'\n                        }>\n                          {rate}%\n                        </Badge>\n                      </div>\n                      <div className=\"text-sm text-gray-400\">\n                        {passed}/{total} тестов пройдено\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Ошибки */}\n            {fullTestResults.summary.errors.length > 0 && (\n              <div>\n                <div className=\"font-medium mb-2 text-white\">Найденные ошибки ({fullTestResults.summary.errors.length}):</div>\n                <div className=\"space-y-2\">\n                  {fullTestResults.summary.errors.map((error, index) => (\n                    <div key={index} className=\"bg-red-900/20 border border-red-500 p-3 rounded\">\n                      <div className=\"text-red-400 text-sm\">{error}</div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Подробные результаты */}\n            <details className=\"bg-gray-800 rounded p-4\">\n              <summary className=\"cursor-pointer text-sm font-medium text-white\">Подробные результаты ({fullTestResults.details.length} записей)</summary>\n              <div className=\"mt-4 space-y-3\">\n                {fullTestResults.details.map((result, index) => (\n                  <div key={index} className=\"border border-gray-600 rounded p-3\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        {getStatusIcon(result.status)}\n                        <span className=\"font-medium text-white\">{result.company}</span>\n                        <Badge variant=\"outline\" className={getStatusColor(result.status)}>\n                          {result.status}\n                        </Badge>\n                      </div>\n                      <div className=\"text-sm text-gray-400\">\n                        {result.timing}мс | {new Date(result.timestamp).toLocaleTimeString()}\n                      </div>\n                    </div>\n                    <div className=\"text-sm text-gray-300 mb-2\">{result.message}</div>\n                    {result.details && (\n                      <details className=\"mt-2\">\n                        <summary className=\"cursor-pointer text-sm text-gray-300\">Подробности</summary>\n                        <pre className=\"text-xs mt-2 p-2 bg-gray-900 rounded overflow-auto text-gray-300\">\n                          {JSON.stringify(result.details, null, 2)}\n                        </pre>\n                      </details>\n                    )}\n                  </div>\n                ))}\n              </div>\n            </details>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "filepath": "/home/user/project/components/diagnostic/FullTestingResults.tsx",
      "exists": false
    },
    "title": "components/diagnostic/FullTestingResults.tsx",
    "time": {
      "start": 1759243242178,
      "end": 1759243242179
    }
  }
}