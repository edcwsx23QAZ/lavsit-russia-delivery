{
  "id": "prt_994a8fa43002Cy0G5jdLqj3tg9",
  "messageID": "msg_994a8ab34001qLgDJLb6WXUjHW",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "multiedit",
  "callID": "toolu_01FYSM2eQiUMqw5HXDEVbv5d",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/components/TruckVisualization.tsx",
      "edits": [
        {
          "oldString": "'use client';\n\nimport React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Truck } from 'lucide-react';",
          "newString": "'use client';\n\nimport React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Truck, RotateCcw, RotateCw } from 'lucide-react';"
        },
        {
          "oldString": "export default function TruckVisualization({ cargos, isVisible = false }: TruckVisualizationProps) {",
          "newString": "export default function TruckVisualization({ cargos, isVisible = false }: TruckVisualizationProps) {\n  const [rotationAngle, setRotationAngle] = useState(0); // Угол поворота в градусах"
        },
        {
          "oldString": "  // Вычисление проекционных вершин для 3D отображения\n  const calculateProjectedVertices = (placement: CargoPlacement) => {\n    const { x, y, z, orientation } = placement;\n    const angle = orientation.rotationAngle * Math.PI / 180;\n    \n    // Основные вершины параллелепипеда\n    const vertices3D = [\n      [x, y, z],\n      [x + orientation.length * Math.cos(angle), y + orientation.length * Math.sin(angle), z],\n      [x + orientation.length * Math.cos(angle) - orientation.width * Math.sin(angle), \n       y + orientation.length * Math.sin(angle) + orientation.width * Math.cos(angle), z],\n      [x - orientation.width * Math.sin(angle), y + orientation.width * Math.cos(angle), z],\n      // Верхние вершины\n      [x, y, z + orientation.height],\n      [x + orientation.length * Math.cos(angle), y + orientation.length * Math.sin(angle), z + orientation.height],\n      [x + orientation.length * Math.cos(angle) - orientation.width * Math.sin(angle), \n       y + orientation.length * Math.sin(angle) + orientation.width * Math.cos(angle), z + orientation.height],\n      [x - orientation.width * Math.sin(angle), y + orientation.width * Math.cos(angle), z + orientation.height]\n    ];\n\n    // Изометрическая проекция (вид сзади 3/4)\n    return vertices3D.map(([x3d, y3d, z3d]) => {\n      const scale = 0.08; // Масштаб для отображения\n      const offsetX = 50;\n      const offsetY = 300;\n      \n      // Изометрия: поворот на 45° по Y, потом наклон на 30°\n      const projX = (x3d - y3d) * Math.cos(Math.PI / 6) * scale + offsetX;\n      const projY = offsetY - ((x3d + y3d) * Math.sin(Math.PI / 6) + z3d) * scale;\n      \n      return { x: projX, y: projY };\n    });\n  };",
          "newString": "  // Вычисление проекционных вершин для 3D отображения\n  const calculateProjectedVertices = (placement: CargoPlacement) => {\n    const { x, y, z, orientation } = placement;\n    const angle = orientation.rotationAngle * Math.PI / 180;\n    \n    // Основные вершины параллелепипеда\n    const vertices3D = [\n      [x, y, z],\n      [x + orientation.length * Math.cos(angle), y + orientation.length * Math.sin(angle), z],\n      [x + orientation.length * Math.cos(angle) - orientation.width * Math.sin(angle), \n       y + orientation.length * Math.sin(angle) + orientation.width * Math.cos(angle), z],\n      [x - orientation.width * Math.sin(angle), y + orientation.width * Math.cos(angle), z],\n      // Верхние вершины\n      [x, y, z + orientation.height],\n      [x + orientation.length * Math.cos(angle), y + orientation.length * Math.sin(angle), z + orientation.height],\n      [x + orientation.length * Math.cos(angle) - orientation.width * Math.sin(angle), \n       y + orientation.length * Math.sin(angle) + orientation.width * Math.cos(angle), z + orientation.height],\n      [x - orientation.width * Math.sin(angle), y + orientation.width * Math.cos(angle), z + orientation.height]\n    ];\n\n    // Применяем поворот камеры\n    const cameraAngle = rotationAngle * Math.PI / 180;\n    const rotatedVertices = vertices3D.map(([x3d, y3d, z3d]) => {\n      const rotX = x3d * Math.cos(cameraAngle) - y3d * Math.sin(cameraAngle);\n      const rotY = x3d * Math.sin(cameraAngle) + y3d * Math.cos(cameraAngle);\n      return [rotX, rotY, z3d];\n    });\n\n    // Изометрическая проекция с центрированием\n    return rotatedVertices.map(([x3d, y3d, z3d]) => {\n      const scale = 0.08; // Масштаб для отображения\n      const svgWidth = 600;\n      const svgHeight = 400;\n      const offsetX = svgWidth / 2; // Центрируем по горизонтали\n      const offsetY = svgHeight * 0.75; // Смещаем вниз для лучшего вида\n      \n      // Изометрия: поворот на 45° по Y, потом наклон на 30°\n      const projX = (x3d - y3d) * Math.cos(Math.PI / 6) * scale + offsetX;\n      const projY = offsetY - ((x3d + y3d) * Math.sin(Math.PI / 6) + z3d) * scale;\n      \n      return { x: projX, y: projY };\n    });\n  };\n\n  // Вычисление вершин кузова с учетом поворота\n  const calculateTruckVertices = () => {\n    const vertices3D = [\n      // Нижние вершины кузова\n      [0, 0, 0],\n      [TRUCK_DIMENSIONS.length, 0, 0],\n      [TRUCK_DIMENSIONS.length, TRUCK_DIMENSIONS.width, 0],\n      [0, TRUCK_DIMENSIONS.width, 0],\n      // Верхние вершины кузова\n      [0, 0, TRUCK_DIMENSIONS.height],\n      [TRUCK_DIMENSIONS.length, 0, TRUCK_DIMENSIONS.height],\n      [TRUCK_DIMENSIONS.length, TRUCK_DIMENSIONS.width, TRUCK_DIMENSIONS.height],\n      [0, TRUCK_DIMENSIONS.width, TRUCK_DIMENSIONS.height]\n    ];\n\n    // Применяем поворот камеры\n    const cameraAngle = rotationAngle * Math.PI / 180;\n    const rotatedVertices = vertices3D.map(([x3d, y3d, z3d]) => {\n      const rotX = x3d * Math.cos(cameraAngle) - y3d * Math.sin(cameraAngle);\n      const rotY = x3d * Math.sin(cameraAngle) + y3d * Math.cos(cameraAngle);\n      return [rotX, rotY, z3d];\n    });\n\n    // Изометрическая проекция с центрированием\n    return rotatedVertices.map(([x3d, y3d, z3d]) => {\n      const scale = 0.08;\n      const svgWidth = 600;\n      const svgHeight = 400;\n      const offsetX = svgWidth / 2;\n      const offsetY = svgHeight * 0.75;\n      \n      const projX = (x3d - y3d) * Math.cos(Math.PI / 6) * scale + offsetX;\n      const projY = offsetY - ((x3d + y3d) * Math.sin(Math.PI / 6) + z3d) * scale;\n      \n      return { x: projX, y: projY };\n    });\n  };\n\n  // Функция для получения первых двух слов из названия товара\n  const getProductShortName = (productName?: string) => {\n    if (!productName) return '';\n    const words = productName.trim().split(/\\s+/);\n    return words.slice(0, 2).join(' ');\n  };"
        },
        {
          "oldString": "  const stats = calculateStats();\n\n  if (!isVisible) return null;",
          "newString": "  const stats = calculateStats();\n  const truckVertices = calculateTruckVertices();\n\n  if (!isVisible) return null;"
        },
        {
          "oldString": "      <CardContent>\n        {/* 3D SVG визуализация кузова */}\n        <div className=\"bg-gray-900 p-4 rounded-lg mb-4\">\n          <svg \n            viewBox=\"0 0 600 400\" \n            className=\"w-full h-96 border border-gray-600 bg-gray-950\"\n            style={{ maxHeight: '480px' }}\n          >\n            {/* Контур кузова в изометрии */}\n            <g stroke=\"#4B5563\" strokeWidth=\"2\" fill=\"none\">\n              {/* Задняя стенка */}\n              <rect x=\"50\" y=\"100\" width=\"163\" height=\"163\" strokeDasharray=\"3,3\" />\n              \n              {/* Правая боковая стенка */}\n              <polygon points=\"213,100 350,50 350,213 213,263\" strokeDasharray=\"3,3\" />\n              \n              {/* Пол */}\n              <polygon points=\"50,263 213,263 350,213 187,213\" fill=\"#374151\" fillOpacity=\"0.3\" />\n              \n              {/* Верх */}\n              <polygon points=\"50,100 213,100 350,50 187,50\" strokeDasharray=\"3,3\" />\n              \n              {/* Левая стенка (видимая часть) */}\n              <line x1=\"50\" y1=\"100\" x2=\"187\" y2=\"50\" strokeDasharray=\"3,3\" />\n              <line x1=\"50\" y1=\"263\" x2=\"187\" y2=\"213\" strokeDasharray=\"3,3\" />\n            </g>\n            \n            {/* Размеры кузова */}\n            <text x=\"300\" y=\"40\" textAnchor=\"middle\" fill=\"#9CA3AF\" fontSize=\"10\">\n              4200×2025×2025 мм\n            </text>",
          "newString": "      <CardContent>\n        {/* Кнопки управления поворотом */}\n        <div className=\"flex justify-center gap-4 mb-4\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setRotationAngle(prev => prev - 45)}\n            className=\"flex items-center gap-2 text-white border-gray-600 hover:bg-gray-700\"\n          >\n            <RotateCcw className=\"h-4 w-4\" />\n            Повернуть влево\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setRotationAngle(0)}\n            className=\"text-white border-gray-600 hover:bg-gray-700\"\n          >\n            Сброс\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setRotationAngle(prev => prev + 45)}\n            className=\"flex items-center gap-2 text-white border-gray-600 hover:bg-gray-700\"\n          >\n            <RotateCw className=\"h-4 w-4\" />\n            Повернуть вправо\n          </Button>\n        </div>\n\n        {/* 3D SVG визуализация кузова */}\n        <div className=\"bg-gray-900 p-4 rounded-lg mb-4\">\n          <svg \n            viewBox=\"0 0 600 400\" \n            className=\"w-full h-96 border border-gray-600 bg-gray-950\"\n            style={{ maxHeight: '480px' }}\n          >\n            {/* Контур кузова в изометрии */}\n            <g stroke=\"#4B5563\" strokeWidth=\"2\" fill=\"none\">\n              {/* Пол кузова */}\n              <polygon \n                points={`${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[3].x},${truckVertices[3].y}`}\n                fill=\"#374151\" \n                fillOpacity=\"0.3\" \n              />\n              \n              {/* Задняя стенка */}\n              <polygon \n                points={`${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[5].x},${truckVertices[5].y} ${truckVertices[4].x},${truckVertices[4].y}`}\n                strokeDasharray=\"3,3\" \n              />\n              \n              {/* Правая боковая стенка */}\n              <polygon \n                points={`${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[6].x},${truckVertices[6].y} ${truckVertices[5].x},${truckVertices[5].y}`}\n                strokeDasharray=\"3,3\" \n              />\n              \n              {/* Передняя стенка */}\n              <polygon \n                points={`${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[3].x},${truckVertices[3].y} ${truckVertices[7].x},${truckVertices[7].y} ${truckVertices[6].x},${truckVertices[6].y}`}\n                strokeDasharray=\"3,3\" \n              />\n              \n              {/* Левая боковая стенка */}\n              <polygon \n                points={`${truckVertices[3].x},${truckVertices[3].y} ${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[4].x},${truckVertices[4].y} ${truckVertices[7].x},${truckVertices[7].y}`}\n                strokeDasharray=\"3,3\" \n              />\n              \n              {/* Верх кузова */}\n              <polygon \n                points={`${truckVertices[4].x},${truckVertices[4].y} ${truckVertices[5].x},${truckVertices[5].y} ${truckVertices[6].x},${truckVertices[6].y} ${truckVertices[7].x},${truckVertices[7].y}`}\n                strokeDasharray=\"3,3\" \n              />\n            </g>\n            \n            {/* Размеры кузова */}\n            <text x=\"300\" y=\"30\" textAnchor=\"middle\" fill=\"#9CA3AF\" fontSize=\"12\" fontWeight=\"bold\">\n              4200×2025×2025 мм\n            </text>\n            <text x=\"300\" y=\"45\" textAnchor=\"middle\" fill=\"#6B7280\" fontSize=\"10\">\n              Поворот: {rotationAngle}°\n            </text>"
        },
        {
          "oldString": "                  <span className=\"text-gray-300\">\n                    Груз {index + 1}: {Math.round(placement.orientation.length)}×{Math.round(placement.orientation.width)}×{Math.round(placement.orientation.height)} мм\n                    {placement.orientation.rotationAngle !== 0 && (\n                      <span className=\"text-blue-300\"> (повернут {placement.orientation.rotationAngle}°)</span>\n                    )}\n                  </span>",
          "newString": "                  <span className=\"text-gray-300\">\n                    Груз {index + 1}{getProductShortName(placement.cargo.productName) && (\n                      <span className=\"text-blue-300\"> \"{getProductShortName(placement.cargo.productName)}\"</span>\n                    )}: {Math.round(placement.orientation.length)}×{Math.round(placement.orientation.width)}×{Math.round(placement.orientation.height)} мм\n                    {placement.orientation.rotationAngle !== 0 && (\n                      <span className=\"text-blue-300\"> (повернут {placement.orientation.rotationAngle}°)</span>\n                    )}\n                  </span>"
        }
      ]
    },
    "output": "",
    "metadata": {
      "results": [
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/components/TruckVisualization.tsx\n===================================================================\n--- /home/user/project/components/TruckVisualization.tsx\n+++ /home/user/project/components/TruckVisualization.tsx\n@@ -1,9 +1,10 @@\n 'use client';\n \n-import React from 'react';\n+import React, { useState } from 'react';\n import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n-import { Truck } from 'lucide-react';\n+import { Button } from '@/components/ui/button';\n+import { Truck, RotateCcw, RotateCw } from 'lucide-react';\n \n interface Cargo {\n   id: string;\n   length: number; // в мм\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/components/TruckVisualization.tsx\n===================================================================\n--- /home/user/project/components/TruckVisualization.tsx\n+++ /home/user/project/components/TruckVisualization.tsx\n@@ -54,8 +54,9 @@\n   '#10AC84', '#EE5A24', '#0984E3', '#6C5CE7', '#FD79A8'\n ];\n \n export default function TruckVisualization({ cargos, isVisible = false }: TruckVisualizationProps) {\n+  const [rotationAngle, setRotationAngle] = useState(0); // Угол поворота в градусах\n   \n   // Функция проверки ключевых слов\n   const isChairOrSeat = (productName?: string) => {\n     if (!productName) return false;\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/components/TruckVisualization.tsx\n===================================================================\n--- /home/user/project/components/TruckVisualization.tsx\n+++ /home/user/project/components/TruckVisualization.tsx\n@@ -384,13 +384,23 @@\n      y + orientation.length * Math.sin(angle) + orientation.width * Math.cos(angle), z + orientation.height],\n     [x - orientation.width * Math.sin(angle), y + orientation.width * Math.cos(angle), z + orientation.height]\n   ];\n \n-  // Изометрическая проекция (вид сзади 3/4)\n-  return vertices3D.map(([x3d, y3d, z3d]) => {\n+  // Применяем поворот камеры\n+  const cameraAngle = rotationAngle * Math.PI / 180;\n+  const rotatedVertices = vertices3D.map(([x3d, y3d, z3d]) => {\n+    const rotX = x3d * Math.cos(cameraAngle) - y3d * Math.sin(cameraAngle);\n+    const rotY = x3d * Math.sin(cameraAngle) + y3d * Math.cos(cameraAngle);\n+    return [rotX, rotY, z3d];\n+  });\n+\n+  // Изометрическая проекция с центрированием\n+  return rotatedVertices.map(([x3d, y3d, z3d]) => {\n     const scale = 0.08; // Масштаб для отображения\n-    const offsetX = 50;\n-    const offsetY = 300;\n+    const svgWidth = 600;\n+    const svgHeight = 400;\n+    const offsetX = svgWidth / 2; // Центрируем по горизонтали\n+    const offsetY = svgHeight * 0.75; // Смещаем вниз для лучшего вида\n     \n     // Изометрия: поворот на 45° по Y, потом наклон на 30°\n     const projX = (x3d - y3d) * Math.cos(Math.PI / 6) * scale + offsetX;\n     const projY = offsetY - ((x3d + y3d) * Math.sin(Math.PI / 6) + z3d) * scale;\n@@ -398,8 +408,53 @@\n     return { x: projX, y: projY };\n   });\n };\n \n+// Вычисление вершин кузова с учетом поворота\n+const calculateTruckVertices = () => {\n+  const vertices3D = [\n+    // Нижние вершины кузова\n+    [0, 0, 0],\n+    [TRUCK_DIMENSIONS.length, 0, 0],\n+    [TRUCK_DIMENSIONS.length, TRUCK_DIMENSIONS.width, 0],\n+    [0, TRUCK_DIMENSIONS.width, 0],\n+    // Верхние вершины кузова\n+    [0, 0, TRUCK_DIMENSIONS.height],\n+    [TRUCK_DIMENSIONS.length, 0, TRUCK_DIMENSIONS.height],\n+    [TRUCK_DIMENSIONS.length, TRUCK_DIMENSIONS.width, TRUCK_DIMENSIONS.height],\n+    [0, TRUCK_DIMENSIONS.width, TRUCK_DIMENSIONS.height]\n+  ];\n+\n+  // Применяем поворот камеры\n+  const cameraAngle = rotationAngle * Math.PI / 180;\n+  const rotatedVertices = vertices3D.map(([x3d, y3d, z3d]) => {\n+    const rotX = x3d * Math.cos(cameraAngle) - y3d * Math.sin(cameraAngle);\n+    const rotY = x3d * Math.sin(cameraAngle) + y3d * Math.cos(cameraAngle);\n+    return [rotX, rotY, z3d];\n+  });\n+\n+  // Изометрическая проекция с центрированием\n+  return rotatedVertices.map(([x3d, y3d, z3d]) => {\n+    const scale = 0.08;\n+    const svgWidth = 600;\n+    const svgHeight = 400;\n+    const offsetX = svgWidth / 2;\n+    const offsetY = svgHeight * 0.75;\n+    \n+    const projX = (x3d - y3d) * Math.cos(Math.PI / 6) * scale + offsetX;\n+    const projY = offsetY - ((x3d + y3d) * Math.sin(Math.PI / 6) + z3d) * scale;\n+    \n+    return { x: projX, y: projY };\n+  });\n+};\n+\n+// Функция для получения первых двух слов из названия товара\n+const getProductShortName = (productName?: string) => {\n+  if (!productName) return '';\n+  const words = productName.trim().split(/\\s+/);\n+  return words.slice(0, 2).join(' ');\n+};\n+\n const placements = calculateCargoPlacement();\n \n // Расчет статистики\n const calculateStats = () => {\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/components/TruckVisualization.tsx\n===================================================================\n--- /home/user/project/components/TruckVisualization.tsx\n+++ /home/user/project/components/TruckVisualization.tsx\n@@ -491,8 +491,9 @@\n   };\n };\n \n const stats = calculateStats();\n+const truckVertices = calculateTruckVertices();\n \n if (!isVisible) return null;\n \n return (\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/components/TruckVisualization.tsx\n===================================================================\n--- /home/user/project/components/TruckVisualization.tsx\n+++ /home/user/project/components/TruckVisualization.tsx\n@@ -504,8 +504,38 @@\n     3D Визуализация размещения в кузове (вид сзади 3/4)\n   </CardTitle>\n </CardHeader>\n <CardContent>\n+  {/* Кнопки управления поворотом */}\n+  <div className=\"flex justify-center gap-4 mb-4\">\n+    <Button\n+      variant=\"outline\"\n+      size=\"sm\"\n+      onClick={() => setRotationAngle(prev => prev - 45)}\n+      className=\"flex items-center gap-2 text-white border-gray-600 hover:bg-gray-700\"\n+    >\n+      <RotateCcw className=\"h-4 w-4\" />\n+      Повернуть влево\n+    </Button>\n+    <Button\n+      variant=\"outline\"\n+      size=\"sm\"\n+      onClick={() => setRotationAngle(0)}\n+      className=\"text-white border-gray-600 hover:bg-gray-700\"\n+    >\n+      Сброс\n+    </Button>\n+    <Button\n+      variant=\"outline\"\n+      size=\"sm\"\n+      onClick={() => setRotationAngle(prev => prev + 45)}\n+      className=\"flex items-center gap-2 text-white border-gray-600 hover:bg-gray-700\"\n+    >\n+      <RotateCw className=\"h-4 w-4\" />\n+      Повернуть вправо\n+    </Button>\n+  </div>\n+\n   {/* 3D SVG визуализация кузова */}\n   <div className=\"bg-gray-900 p-4 rounded-lg mb-4\">\n     <svg \n       viewBox=\"0 0 600 400\" \n@@ -513,29 +543,53 @@\n       style={{ maxHeight: '480px' }}\n     >\n       {/* Контур кузова в изометрии */}\n       <g stroke=\"#4B5563\" strokeWidth=\"2\" fill=\"none\">\n+        {/* Пол кузова */}\n+        <polygon \n+          points={`${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[3].x},${truckVertices[3].y}`}\n+          fill=\"#374151\" \n+          fillOpacity=\"0.3\" \n+        />\n+        \n         {/* Задняя стенка */}\n-        <rect x=\"50\" y=\"100\" width=\"163\" height=\"163\" strokeDasharray=\"3,3\" />\n+        <polygon \n+          points={`${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[5].x},${truckVertices[5].y} ${truckVertices[4].x},${truckVertices[4].y}`}\n+          strokeDasharray=\"3,3\" \n+        />\n         \n         {/* Правая боковая стенка */}\n-        <polygon points=\"213,100 350,50 350,213 213,263\" strokeDasharray=\"3,3\" />\n+        <polygon \n+          points={`${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[6].x},${truckVertices[6].y} ${truckVertices[5].x},${truckVertices[5].y}`}\n+          strokeDasharray=\"3,3\" \n+        />\n         \n-        {/* Пол */}\n-        <polygon points=\"50,263 213,263 350,213 187,213\" fill=\"#374151\" fillOpacity=\"0.3\" />\n+        {/* Передняя стенка */}\n+        <polygon \n+          points={`${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[3].x},${truckVertices[3].y} ${truckVertices[7].x},${truckVertices[7].y} ${truckVertices[6].x},${truckVertices[6].y}`}\n+          strokeDasharray=\"3,3\" \n+        />\n         \n-        {/* Верх */}\n-        <polygon points=\"50,100 213,100 350,50 187,50\" strokeDasharray=\"3,3\" />\n+        {/* Левая боковая стенка */}\n+        <polygon \n+          points={`${truckVertices[3].x},${truckVertices[3].y} ${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[4].x},${truckVertices[4].y} ${truckVertices[7].x},${truckVertices[7].y}`}\n+          strokeDasharray=\"3,3\" \n+        />\n         \n-        {/* Левая стенка (видимая часть) */}\n-        <line x1=\"50\" y1=\"100\" x2=\"187\" y2=\"50\" strokeDasharray=\"3,3\" />\n-        <line x1=\"50\" y1=\"263\" x2=\"187\" y2=\"213\" strokeDasharray=\"3,3\" />\n+        {/* Верх кузова */}\n+        <polygon \n+          points={`${truckVertices[4].x},${truckVertices[4].y} ${truckVertices[5].x},${truckVertices[5].y} ${truckVertices[6].x},${truckVertices[6].y} ${truckVertices[7].x},${truckVertices[7].y}`}\n+          strokeDasharray=\"3,3\" \n+        />\n       </g>\n       \n       {/* Размеры кузова */}\n-      <text x=\"300\" y=\"40\" textAnchor=\"middle\" fill=\"#9CA3AF\" fontSize=\"10\">\n+      <text x=\"300\" y=\"30\" textAnchor=\"middle\" fill=\"#9CA3AF\" fontSize=\"12\" fontWeight=\"bold\">\n         4200×2025×2025 мм\n       </text>\n+      <text x=\"300\" y=\"45\" textAnchor=\"middle\" fill=\"#6B7280\" fontSize=\"10\">\n+        Поворот: {rotationAngle}°\n+      </text>\n       \n       {/* Отображение размещенных грузов */}\n       {placements.map((placement, index) => {\n         const vertices = placement.projectedVertices;\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/components/TruckVisualization.tsx\n===================================================================\n--- /home/user/project/components/TruckVisualization.tsx\n+++ /home/user/project/components/TruckVisualization.tsx\n@@ -683,9 +683,11 @@\n   className=\"w-3 h-3 rounded\"\n   style={{ backgroundColor: placement.color }}\n />\n <span className=\"text-gray-300\">\n-  Груз {index + 1}: {Math.round(placement.orientation.length)}×{Math.round(placement.orientation.width)}×{Math.round(placement.orientation.height)} мм\n+  Груз {index + 1}{getProductShortName(placement.cargo.productName) && (\n+    <span className=\"text-blue-300\"> \"{getProductShortName(placement.cargo.productName)}\"</span>\n+  )}: {Math.round(placement.orientation.length)}×{Math.round(placement.orientation.width)}×{Math.round(placement.orientation.height)} мм\n   {placement.orientation.rotationAngle !== 0 && (\n     <span className=\"text-blue-300\"> (повернут {placement.orientation.rotationAngle}°)</span>\n   )}\n </span>\n"
        }
      ]
    },
    "title": "components/TruckVisualization.tsx",
    "time": {
      "start": 1759135776084,
      "end": 1759135776117
    }
  }
}