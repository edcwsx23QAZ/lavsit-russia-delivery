{
  "id": "prt_9951b6bd1001YZfqDoCQnKDQwy",
  "messageID": "msg_9951b4969001T0uSnMrXnTyG4B",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_01HcCAyu4Nsh88K8iQWEcQuB",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/components/TruckVisualization.tsx"
    },
    "output": "<file>\n00001| 'use client';\n00002| \n00003| import React, { useState } from 'react';\n00004| import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n00005| import { Button } from '@/components/ui/button';\n00006| import { Slider } from '@/components/ui/slider';\n00007| import { Truck, Move, RotateCw as Rotate3d } from 'lucide-react';\n00008| \n00009| interface Cargo {\n00010|   id: string;\n00011|   length: number; // –≤ –º–º\n00012|   width: number;  // –≤ –º–º\n00013|   height: number; // –≤ –º–º\n00014|   weight: number;\n00015|   productName?: string;\n00016| }\n00017| \n00018| interface Orientation {\n00019|   length: number;\n00020|   width: number;\n00021|   height: number;\n00022|   rotationAngle: number; // –≤ –≥—Ä–∞–¥—É—Å–∞—Ö\n00023|   flipped: boolean; // –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç –ª–∏ –≥—Ä—É–∑ –ø–æ –≤—ã—Å–æ—Ç–µ\n00024| }\n00025| \n00026| interface CargoPlacement {\n00027|   cargo: Cargo;\n00028|   x: number;\n00029|   y: number;\n00030|   z: number;\n00031|   orientation: Orientation;\n00032|   color: string;\n00033|   projectedVertices: Array<{x: number, y: number}>; // –î–ª—è 3D –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\n00034| }\n00035| \n00036| interface TruckVisualizationProps {\n00037|   cargos: Cargo[];\n00038|   isVisible?: boolean;\n00039| }\n00040| \n00041| // –†–∞–∑–º–µ—Ä—ã –∫—É–∑–æ–≤–∞ –≤ –º–º\n00042| const TRUCK_DIMENSIONS = {\n00043|   length: 4200,\n00044|   width: 2025,\n00045|   height: 2025\n00046| };\n00047| \n00048| // –£–≥–ª—ã –ø–æ–≤–æ—Ä–æ—Ç–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –≥—Ä—É–∑–æ–≤ (–≤ –≥—Ä–∞–¥—É—Å–∞—Ö)\n00049| const ROTATION_ANGLES = [0, 45, 90, 135, 180, 225, 270, 315];\n00050| \n00051| // –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–∑–æ–≤\n00052| const CARGO_COLORS = [\n00053|   '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FECA57',\n00054|   '#FF9FF3', '#54A0FF', '#5F27CD', '#00D2D3', '#FF9F43',\n00055|   '#10AC84', '#EE5A24', '#0984E3', '#6C5CE7', '#FD79A8'\n00056| ];\n00057| \n00058| export default function TruckVisualization({ cargos, isVisible = false }: TruckVisualizationProps) {\n00059|   // –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è 3D —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π (–≤–∏–¥ —Å–∑–∞–¥–∏ 3/4, —Å—Ç–æ—è—â–∏–π –Ω–∞ –∫–æ–ª–µ—Å–∞—Ö)\n00060|   const [rotationX, setRotationX] = useState(0);   // –ü–æ–≤–æ—Ä–æ—Ç –ø–æ –æ—Å–∏ X (0¬∞ - –ø–æ–ª –ø–∞—Ä–∞–ª–ª–µ–ª–µ–Ω X)\n00061|   const [rotationY, setRotationY] = useState(-45); // –ü–æ–≤–æ—Ä–æ—Ç –ø–æ –æ—Å–∏ Y (–∏–∑–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –≤–∏–¥ 3/4)\n00062|   const [rotationZ, setRotationZ] = useState(0);   // –ü–æ–≤–æ—Ä–æ—Ç –ø–æ –æ—Å–∏ Z\n00063|   const [positionX, setPositionX] = useState(50);  // –ü–æ–∑–∏—Ü–∏—è –ø–æ X (0-100%)\n00064|   const [positionY, setPositionY] = useState(50);  // –ü–æ–∑–∏—Ü–∏—è –ø–æ Y (—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)\n00065|   const [scale, setScale] = useState(70); // –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–∞—Å—à—Ç–∞–± –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏\n00066|   \n00067| \n00068|   \n00069|   // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤\n00070|   const isChairOrSeat = (productName?: string) => {\n00071|     if (!productName) return false;\n00072|     const lowerName = productName.toLowerCase();\n00073|     return lowerName.includes('—Å—Ç—É–ª') || lowerName.includes('–∫—Ä–µ—Å–ª–æ');\n00074|   };\n00075| \n00076|   // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–π –≥—Ä—É–∑–∞\n00077|   const generateOrientations = (cargo: Cargo): Orientation[] => {\n00078|     const orientations: Orientation[] = [];\n00079|     const baseDimensions = [\n00080|       [cargo.length, cargo.width, cargo.height],\n00081|       [cargo.width, cargo.length, cargo.height],\n00082|       [cargo.length, cargo.height, cargo.width],\n00083|       [cargo.height, cargo.length, cargo.width],\n00084|       [cargo.width, cargo.height, cargo.length],\n00085|       [cargo.height, cargo.width, cargo.length]\n00086|     ];\n00087| \n00088|     // –î–ª—è —Å—Ç—É–ª—å–µ–≤/–∫—Ä–µ—Å–µ–ª –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–æ–≤–æ—Ä–æ—Ç—ã (–Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å)\n00089|     const allowedDimensions = isChairOrSeat(cargo.productName) \n00090|       ? baseDimensions.slice(0, 2) // –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ (–±–µ–∑ –ø–æ–≤–æ—Ä–æ—Ç–∞ –ø–æ –≤—ã—Å–æ—Ç–µ)\n00091|       : baseDimensions;\n00092| \n00093|     allowedDimensions.forEach(([l, w, h]) => {\n00094|       ROTATION_ANGLES.forEach(angle => {\n00095|         // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –ø–æ—Å–ª–µ –ø–æ–≤–æ—Ä–æ—Ç–∞\n00096|         const rad = (angle * Math.PI) / 180;\n00097|         const cos = Math.abs(Math.cos(rad));\n00098|         const sin = Math.abs(Math.sin(rad));\n00099|         \n00100|         const rotatedLength = l * cos + w * sin;\n00101|         const rotatedWidth = l * sin + w * cos;\n00102| \n00103|         orientations.push({\n00104|           length: rotatedLength,\n00105|           width: rotatedWidth,\n00106|           height: h,\n00107|           rotationAngle: angle,\n00108|           flipped: h !== cargo.height\n00109|         });\n00110|       });\n00111|     });\n00112| \n00113|     return orientations;\n00114|   };\n00115| \n00116|   // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –¥–≤—É—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ —Å —É—á–µ—Ç–æ–º –ø–æ–≤–æ—Ä–æ—Ç–∞\n00117|   const checkCollision = (\n00118|     x1: number, y1: number, x2: number, y2: number,\n00119|     length1: number, width1: number, length2: number, width2: number,\n00120|     angle1: number, angle2: number\n00121|   ): boolean => {\n00122|     // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏\n00123|     const rad1 = (angle1 * Math.PI) / 180;\n00124|     const rad2 = (angle2 * Math.PI) / 180;\n00125|     \n00126|     const cos1 = Math.abs(Math.cos(rad1));\n00127|     const sin1 = Math.abs(Math.sin(rad1));\n00128|     const cos2 = Math.abs(Math.cos(rad2));\n00129|     const sin2 = Math.abs(Math.sin(rad2));\n00130|     \n00131|     const bbox1 = {\n00132|       minX: x1,\n00133|       maxX: x1 + length1 * cos1 + width1 * sin1,\n00134|       minY: y1,\n00135|       maxY: y1 + length1 * sin1 + width1 * cos1\n00136|     };\n00137|     \n00138|     const bbox2 = {\n00139|       minX: x2,\n00140|       maxX: x2 + length2 * cos2 + width2 * sin2,\n00141|       minY: y2,\n00142|       maxY: y2 + length2 * sin2 + width2 * cos2\n00143|     };\n00144| \n00145|     return !(bbox1.maxX <= bbox2.minX || bbox2.maxX <= bbox1.minX ||\n00146|              bbox1.maxY <= bbox2.minY || bbox2.maxY <= bbox1.minY);\n00147|   };\n00148| \n00149|   // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏\n00150|   const isPositionValid = (\n00151|     x: number, y: number, z: number,\n00152|     orientation: Orientation,\n00153|     placements: CargoPlacement[],\n00154|     cargo: Cargo\n00155|   ): boolean => {\n00156|     \n00157|     // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥—Ä–∞–Ω–∏—Ü—ã –∫—É–∑–æ–≤–∞\n00158|     const rad = (orientation.rotationAngle * Math.PI) / 180;\n00159|     const cos = Math.abs(Math.cos(rad));\n00160|     const sin = Math.abs(Math.sin(rad));\n00161|     \n00162|     const effectiveLength = orientation.length * cos + orientation.width * sin;\n00163|     const effectiveWidth = orientation.length * sin + orientation.width * cos;\n00164|     \n00165|     if (x + effectiveLength > TRUCK_DIMENSIONS.length || \n00166|         y + effectiveWidth > TRUCK_DIMENSIONS.width ||\n00167|         z + orientation.height > TRUCK_DIMENSIONS.height) {\n00168|       return false;\n00169|     }\n00170| \n00171|     // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å —É–∂–µ —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã–º–∏ –≥—Ä—É–∑–∞–º–∏\n00172|     for (const placement of placements) {\n00173|       // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –≤—ã—Å–æ—Ç–µ\n00174|       if (!(z >= placement.z + placement.orientation.height || \n00175|             z + orientation.height <= placement.z)) {\n00176|         \n00177|         // –ï—Å–ª–∏ –≤—ã—Å–æ—Ç—ã –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ –ø–ª–æ—â–∞–¥–∏\n00178|         if (checkCollision(\n00179|           x, y, placement.x, placement.y,\n00180|           orientation.length, orientation.width,\n00181|           placement.orientation.length, placement.orientation.width,\n00182|           orientation.rotationAngle, placement.orientation.rotationAngle\n00183|         )) {\n00184|           return false;\n00185|         }\n00186|       }\n00187|     }\n00188| \n00189|     // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è\n00190|     if (z > 0) { // –ì—Ä—É–∑ –Ω–µ –Ω–∞ –ø–æ–ª—É\n00191|       const supportingCargos = placements.filter(p => \n00192|         z === p.z + p.orientation.height && // –°—Ç–æ–∏—Ç –ø—Ä—è–º–æ –Ω–∞ –¥—Ä—É–≥–æ–º –≥—Ä—É–∑–µ\n00193|         !checkCollision(\n00194|           x, y, p.x, p.y,\n00195|           orientation.length, orientation.width,\n00196|           p.orientation.length, p.orientation.width,\n00197|           orientation.rotationAngle, p.orientation.rotationAngle\n00198|         ) === false // –ï—Å—Ç—å –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ –ø–ª–æ—â–∞–¥–∏ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞)\n00199|       );\n00200| \n00201|       if (supportingCargos.length === 0) {\n00202|         return false; // –î–æ–ª–∂–µ–Ω –Ω–∞ —á–µ–º-—Ç–æ —Å—Ç–æ—è—Ç—å\n00203|       }\n00204| \n00205|       // –ü—Ä–∞–≤–∏–ª–æ –ø–æ –≤–µ—Å—É\n00206|       for (const supporting of supportingCargos) {\n00207|         if (cargo.weight > supporting.cargo.weight) {\n00208|           return false;\n00209|         }\n00210|       }\n00211| \n00212|       // –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Å—Ç—É–ª—å–µ–≤/–∫—Ä–µ—Å–µ–ª\n00213|       if (isChairOrSeat(cargo.productName)) {\n00214|         const allSupportingAreChairs = supportingCargos.every(p => \n00215|           isChairOrSeat(p.cargo.productName)\n00216|         );\n00217|         \n00218|         if (!allSupportingAreChairs) {\n00219|           return false;\n00220|         }\n00221| \n00222|         // –ú–∞–∫—Å–∏–º—É–º 2 —Å—Ç—É–ª–∞ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–µ\n00223|         let chairLevels = 1;\n00224|         let currentZ = z;\n00225|         \n00226|         while (currentZ > 0) {\n00227|           const chairsBelow = placements.filter(p =>\n00228|             p.z + p.orientation.height === currentZ &&\n00229|             isChairOrSeat(p.cargo.productName)\n00230|           );\n00231|           \n00232|           if (chairsBelow.length > 0) {\n00233|             chairLevels++;\n00234|             currentZ = Math.min(...chairsBelow.map(p => p.z));\n00235|           } else {\n00236|             break;\n00237|           }\n00238|         }\n00239|         \n00240|         if (chairLevels > 2) {\n00241|           return false;\n00242|         }\n00243|       } else {\n00244|         // –û–±—ã—á–Ω—ã–µ –≥—Ä—É–∑—ã –Ω–µ–ª—å–∑—è —Å—Ç–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç—É–ª—å—è\n00245|         const hasChairSupport = supportingCargos.some(p => \n00246|           isChairOrSeat(p.cargo.productName)\n00247|         );\n00248|         \n00249|         if (hasChairSupport) {\n00250|           return false;\n00251|         }\n00252|       }\n00253|     }\n00254| \n00255|     return true;\n00256|   };\n00257| \n00258|   // –†–∞—Å—á–µ—Ç –ø–ª–æ—â–∞–¥–∏ –ø–æ–ª–∞, –∑–∞–Ω–∏–º–∞–µ–º–æ–π —Ä–∞–∑–º–µ—â–µ–Ω–∏—è–º–∏\n00259|   const calculateFloorArea = (placements: CargoPlacement[], newPlacement?: CargoPlacement) => {\n00260|     const allPlacements = newPlacement ? [...placements, newPlacement] : placements;\n00261|     \n00262|     if (allPlacements.length === 0) return 0;\n00263| \n00264|     let minX = Infinity, maxX = 0, minY = Infinity, maxY = 0;\n00265| \n00266|     allPlacements.forEach(p => {\n00267|       const rad = (p.orientation.rotationAngle * Math.PI) / 180;\n00268|       const cos = Math.abs(Math.cos(rad));\n00269|       const sin = Math.abs(Math.sin(rad));\n00270|       \n00271|       const effectiveLength = p.orientation.length * cos + p.orientation.width * sin;\n00272|       const effectiveWidth = p.orientation.length * sin + p.orientation.width * cos;\n00273|       \n00274|       minX = Math.min(minX, p.x);\n00275|       maxX = Math.max(maxX, p.x + effectiveLength);\n00276|       minY = Math.min(minY, p.y);\n00277|       maxY = Math.max(maxY, p.y + effectiveWidth);\n00278|     });\n00279| \n00280|     return (maxX - minX) * (maxY - minY);\n00281|   };\n00282| \n00283|   // 3D –º–∞—Ç—Ä–∏—á–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏\n00284|   const applyRotations = (vertices: number[][]) => {\n00285|     const radX = (rotationX * Math.PI) / 180;\n00286|     const radY = (rotationY * Math.PI) / 180;\n00287|     const radZ = (rotationZ * Math.PI) / 180;\n00288| \n00289|     return vertices.map(([x, y, z]) => {\n00290|       // –ü–æ–≤–æ—Ä–æ—Ç –ø–æ –æ—Å–∏ X\n00291|       let newY = y * Math.cos(radX) - z * Math.sin(radX);\n00292|       let newZ = y * Math.sin(radX) + z * Math.cos(radX);\n00293|       y = newY;\n00294|       z = newZ;\n00295| \n00296|       // –ü–æ–≤–æ—Ä–æ—Ç –ø–æ –æ—Å–∏ Y\n00297|       let newX = x * Math.cos(radY) + z * Math.sin(radY);\n00298|       newZ = -x * Math.sin(radY) + z * Math.cos(radY);\n00299|       x = newX;\n00300|       z = newZ;\n00301| \n00302|       // –ü–æ–≤–æ—Ä–æ—Ç –ø–æ –æ—Å–∏ Z\n00303|       newX = x * Math.cos(radZ) - y * Math.sin(radZ);\n00304|       newY = x * Math.sin(radZ) + y * Math.cos(radZ);\n00305|       \n00306|       return [newX, newY, newZ];\n00307|     });\n00308|   };\n00309| \n00310|   // –ü—Ä–æ–µ–∫—Ü–∏—è 3D —Ç–æ—á–µ–∫ –Ω–∞ 2D –ø–ª–æ—Å–∫–æ—Å—Ç—å —Å —É—á–µ—Ç–æ–º –ø–æ–∑–∏—Ü–∏–∏ –∏ –º–∞—Å—à—Ç–∞–±–∞\n00311|   const project3DTo2D = (vertices: number[][]) => {\n00312|     const currentScale = (scale / 100) * 0.15; // –ë–∞–∑–æ–≤—ã–π –º–∞—Å—à—Ç–∞–±\n00313|     const svgWidth = 600;\n00314|     const svgHeight = 400;\n00315|     const offsetX = (positionX / 100) * svgWidth;\n00316|     const offsetY = (positionY / 100) * svgHeight;\n00317|     \n00318|     return vertices.map(([x, y, z]) => {\n00319|       // –ü—Ä–æ—Å—Ç–∞—è –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è —Å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–æ–π\n00320|       const perspective = 1 + z * 0.0001;\n00321|       const projX = (x * currentScale / perspective) + offsetX;\n00322|       const projY = offsetY - (y * currentScale / perspective) - (z * currentScale * 0.7 / perspective);\n00323|       \n00324|       return { x: projX, y: projY };\n00325|     });\n00326|   };\n00327| \n00328|   // –û—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–∑–º–µ—â–µ–Ω–∏—è\n00329|   const calculateCargoPlacement = (): CargoPlacement[] => {\n00330|     if (!cargos.length) return [];\n00331| \n00332|     // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≥—Ä—É–∑—ã\n00333|     const validCargos = cargos.filter(cargo => \n00334|       cargo.length > 0 && cargo.width > 0 && cargo.height > 0 && cargo.weight > 0\n00335|     );\n00336| \n00337|     if (!validCargos.length) return [];\n00338| \n00339|     // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: —Å—Ç—É–ª—å—è –ø–µ—Ä–≤—ã–º–∏, –ø–æ—Ç–æ–º –ø–æ –≤–µ—Å—É, –ø–æ—Ç–æ–º –ø–æ –æ–±—ä–µ–º—É\n00340|     const sortedCargos = [...validCargos].sort((a, b) => {\n00341|       const aIsChair = isChairOrSeat(a.productName);\n00342|       const bIsChair = isChairOrSeat(b.productName);\n00343|       \n00344|       if (aIsChair && !bIsChair) return -1;\n00345|       if (!aIsChair && bIsChair) return 1;\n00346|       \n00347|       const weightDiff = b.weight - a.weight;\n00348|       if (weightDiff !== 0) return weightDiff;\n00349|       \n00350|       const volumeA = a.length * a.width * a.height;\n00351|       const volumeB = b.length * b.width * b.height;\n00352|       return volumeB - volumeA;\n00353|     });\n00354| \n00355|     const placements: CargoPlacement[] = [];\n00356| \n00357|     sortedCargos.forEach((cargo, index) => {\n00358|       const color = CARGO_COLORS[index % CARGO_COLORS.length];\n00359|       const orientations = generateOrientations(cargo);\n00360|       \n00361|       let bestPlacement: CargoPlacement | null = null;\n00362|       let bestScore = Infinity;\n00363| \n00364|       // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ Z –ø–æ–∑–∏—Ü–∏–∏\n00365|       const possibleZ = [0];\n00366|       placements.forEach(p => {\n00367|         const topZ = p.z + p.orientation.height;\n00368|         if (topZ <= TRUCK_DIMENSIONS.height - 100) { // –ú–∏–Ω–∏–º—É–º 100–º–º —Å–≤–µ—Ä—Ö—É\n00369|           possibleZ.push(topZ);\n00370|         }\n00371|       });\n00372|       \n00373|       const uniqueZ = possibleZ.filter((value, index, self) => self.indexOf(value) === index);\n00374|       const sortedZ = uniqueZ.sort((a, b) => a - b);\n00375| \n00376|       // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø–æ–∑–∏—Ü–∏–∏\n00377|       for (const orientation of orientations) {\n00378|         for (const z of sortedZ) {\n00379|           if (z + orientation.height > TRUCK_DIMENSIONS.height) continue;\n00380| \n00381|           // –ë–æ–ª–µ–µ —á–∞—Å—Ç–∞—è —Å–µ—Ç–∫–∞ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è\n00382|           const step = 25; // 25–º–º —à–∞–≥\n00383|           \n00384|           for (let y = 0; y <= TRUCK_DIMENSIONS.width - 50; y += step) {\n00385|             for (let x = 0; x <= TRUCK_DIMENSIONS.length - 50; x += step) {\n00386|               \n00387|               if (isPositionValid(x, y, z, orientation, placements, cargo)) {\n00388|                 const testPlacement: CargoPlacement = {\n00389|                   cargo,\n00390|                   x, y, z,\n00391|                   orientation,\n00392|                   color,\n00393|                   projectedVertices: []\n00394|                 };\n00395| \n00396|                 // –û—Ü–µ–Ω–∫–∞: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–ª–æ—â–∞–¥–∏ –ø–æ–ª–∞, –ø–æ—Ç–æ–º –≤—ã—Å–æ—Ç–∞, –ø–æ—Ç–æ–º –æ–±—ä–µ–º\n00397|                 const floorArea = calculateFloorArea(placements, testPlacement);\n00398|                 const heightPenalty = z * 0.001;\n00399|                 const volumePenalty = (floorArea * orientation.height) * 0.000001;\n00400|                 const score = floorArea + heightPenalty + volumePenalty;\n00401| \n00402|                 if (score < bestScore) {\n00403|                   bestScore = score;\n00404|                   bestPlacement = testPlacement;\n00405|                 }\n00406|               }\n00407|             }\n00408|           }\n00409|         }\n00410|       }\n00411| \n00412|       if (bestPlacement) {\n00413|         // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã –¥–ª—è 3D –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\n00414|         bestPlacement.projectedVertices = calculateProjectedVertices(bestPlacement);\n00415|         placements.push(bestPlacement);\n00416|       }\n00417|     });\n00418| \n00419|     return placements;\n00420|   };\n00421| \n00422|   // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –≤–µ—Ä—à–∏–Ω –¥–ª—è 3D –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä—É–∑–æ–≤\n00423|   const calculateProjectedVertices = (placement: CargoPlacement) => {\n00424|     const { x, y, z, orientation } = placement;\n00425|     const angle = orientation.rotationAngle * Math.PI / 180;\n00426|     \n00427|     // –û—Å–Ω–æ–≤–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã –ø–∞—Ä–∞–ª–ª–µ–ª–µ–ø–∏–ø–µ–¥–∞\n00428|     const vertices3D = [\n00429|       [x, y, z],\n00430|       [x + orientation.length * Math.cos(angle), y + orientation.length * Math.sin(angle), z],\n00431|       [x + orientation.length * Math.cos(angle) - orientation.width * Math.sin(angle), \n00432|        y + orientation.length * Math.sin(angle) + orientation.width * Math.cos(angle), z],\n00433|       [x - orientation.width * Math.sin(angle), y + orientation.width * Math.cos(angle), z],\n00434|       // –í–µ—Ä—Ö–Ω–∏–µ –≤–µ—Ä—à–∏–Ω—ã\n00435|       [x, y, z + orientation.height],\n00436|       [x + orientation.length * Math.cos(angle), y + orientation.length * Math.sin(angle), z + orientation.height],\n00437|       [x + orientation.length * Math.cos(angle) - orientation.width * Math.sin(angle), \n00438|        y + orientation.length * Math.sin(angle) + orientation.width * Math.cos(angle), z + orientation.height],\n00439|       [x - orientation.width * Math.sin(angle), y + orientation.width * Math.cos(angle), z + orientation.height]\n00440|     ];\n00441| \n00442|     // –ü—Ä–∏–º–µ–Ω—è–µ–º 3D –ø–æ–≤–æ—Ä–æ—Ç—ã –∏ –ø—Ä–æ–µ–∫—Ü–∏—é\n00443|     const rotatedVertices = applyRotations(vertices3D);\n00444|     return project3DTo2D(rotatedVertices);\n00445|   };\n00446| \n00447|   // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω –∫—É–∑–æ–≤–∞\n00448|   const calculateTruckVertices = () => {\n00449|     const vertices3D = [\n00450|       // –ù–∏–∂–Ω–∏–µ –≤–µ—Ä—à–∏–Ω—ã –∫—É–∑–æ–≤–∞\n00451|       [0, 0, 0],\n00452|       [TRUCK_DIMENSIONS.length, 0, 0],\n00453|       [TRUCK_DIMENSIONS.length, TRUCK_DIMENSIONS.width, 0],\n00454|       [0, TRUCK_DIMENSIONS.width, 0],\n00455|       // –í–µ—Ä—Ö–Ω–∏–µ –≤–µ—Ä—à–∏–Ω—ã –∫—É–∑–æ–≤–∞\n00456|       [0, 0, TRUCK_DIMENSIONS.height],\n00457|       [TRUCK_DIMENSIONS.length, 0, TRUCK_DIMENSIONS.height],\n00458|       [TRUCK_DIMENSIONS.length, TRUCK_DIMENSIONS.width, TRUCK_DIMENSIONS.height],\n00459|       [0, TRUCK_DIMENSIONS.width, TRUCK_DIMENSIONS.height]\n00460|     ];\n00461| \n00462|     const rotatedVertices = applyRotations(vertices3D);\n00463|     return project3DTo2D(rotatedVertices);\n00464|   };\n00465| \n00466|   // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω –∫–∞–±–∏–Ω—ã –∏ —à–∞—Å—Å–∏\n00467|   const calculateCabinAndChassisVertices = () => {\n00468|     const cabinLength = 2000; // 2 –º–µ—Ç—Ä–∞\n00469|     const cabinHeight = 2500; // 2.5 –º–µ—Ç—Ä–∞  \n00470|     const cabinWidth = TRUCK_DIMENSIONS.width;\n00471|     const chassisHeight = 300; // –í—ã—Å–æ—Ç–∞ —à–∞—Å—Å–∏\n00472|     \n00473|     // –ö–∞–±–∏–Ω–∞ (–≤–ø–µ—Ä–µ–¥–∏ –∫—É–∑–æ–≤–∞)\n00474|     const cabinVertices = [\n00475|       // –ù–∏–∂–Ω–∏–µ –≤–µ—Ä—à–∏–Ω—ã –∫–∞–±–∏–Ω—ã\n00476|       [-cabinLength, 0, 0],\n00477|       [0, 0, 0],\n00478|       [0, cabinWidth, 0],\n00479|       [-cabinLength, cabinWidth, 0],\n00480|       // –í–µ—Ä—Ö–Ω–∏–µ –≤–µ—Ä—à–∏–Ω—ã –∫–∞–±–∏–Ω—ã\n00481|       [-cabinLength, 0, cabinHeight],\n00482|       [0, 0, cabinHeight],\n00483|       [0, cabinWidth, cabinHeight],\n00484|       [-cabinLength, cabinWidth, cabinHeight]\n00485|     ];\n00486| \n00487|     // –®–∞—Å—Å–∏ (–ø–æ–¥ –∫–∞–±–∏–Ω–æ–π –∏ –∫—É–∑–æ–≤–æ–º)\n00488|     const chassisVertices = [\n00489|       // –®–∞—Å—Å–∏ –ø–æ–¥ –∫–∞–±–∏–Ω–æ–π\n00490|       [-cabinLength, cabinWidth * 0.2, -chassisHeight],\n00491|       [0, cabinWidth * 0.2, -chassisHeight],\n00492|       [0, cabinWidth * 0.8, -chassisHeight],\n00493|       [-cabinLength, cabinWidth * 0.8, -chassisHeight],\n00494|       // –®–∞—Å—Å–∏ –ø–æ–¥ –∫—É–∑–æ–≤–æ–º\n00495|       [0, cabinWidth * 0.2, -chassisHeight],\n00496|       [TRUCK_DIMENSIONS.length, cabinWidth * 0.2, -chassisHeight],\n00497|       [TRUCK_DIMENSIONS.length, cabinWidth * 0.8, -chassisHeight],\n00498|       [0, cabinWidth * 0.8, -chassisHeight]\n00499|     ];\n00500| \n00501|     // –ö–æ–ª–µ—Å–∞\n00502|     const wheelRadius = 200;\n00503|     const wheelVertices = [\n00504|       // –ü–µ—Ä–µ–¥–Ω–∏–µ –∫–æ–ª–µ—Å–∞\n00505|       [-cabinLength * 0.8, 0, -chassisHeight],\n00506|       [-cabinLength * 0.8, cabinWidth, -chassisHeight],\n00507|       // –ó–∞–¥–Ω–∏–µ –∫–æ–ª–µ—Å–∞\n00508|       [TRUCK_DIMENSIONS.length * 0.8, 0, -chassisHeight],\n00509|       [TRUCK_DIMENSIONS.length * 0.8, cabinWidth, -chassisHeight]\n00510|     ];\n00511| \n00512|     const rotatedCabin = applyRotations(cabinVertices);\n00513|     const rotatedChassis = applyRotations(chassisVertices);\n00514|     const rotatedWheels = applyRotations(wheelVertices);\n00515|     \n00516|     return {\n00517|       cabin: project3DTo2D(rotatedCabin),\n00518|       chassis: project3DTo2D(rotatedChassis),\n00519|       wheels: project3DTo2D(rotatedWheels),\n00520|       wheelRadius: wheelRadius * (scale / 100) * 0.15\n00521|     };\n00522|   };\n00523| \n00524| \n00525| \n00526|   // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö —Å–ª–æ–≤ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞\n00527|   const getProductShortName = (productName?: string) => {\n00528|     if (!productName) return '';\n00529|     const words = productName.trim().split(/\\s+/);\n00530|     return words.slice(0, 2).join(' ');\n00531|   };\n00532| \n00533|   const placements = calculateCargoPlacement();\n00534| \n00535|   // –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏\n00536|   const calculateStats = () => {\n00537|     if (!placements.length) return null;\n00538| \n00539|     const floorArea = calculateFloorArea(placements);\n00540|     \n00541|     let maxX = 0, maxY = 0, maxZ = 0;\n00542|     placements.forEach(p => {\n00543|       const rad = (p.orientation.rotationAngle * Math.PI) / 180;\n00544|       const cos = Math.abs(Math.cos(rad));\n00545|       const sin = Math.abs(Math.sin(rad));\n00546|       \n00547|       const effectiveLength = p.orientation.length * cos + p.orientation.width * sin;\n00548|       const effectiveWidth = p.orientation.length * sin + p.orientation.width * cos;\n00549|       \n00550|       maxX = Math.max(maxX, p.x + effectiveLength);\n00551|       maxY = Math.max(maxY, p.y + effectiveWidth);\n00552|       maxZ = Math.max(maxZ, p.z + p.orientation.height);\n00553|     });\n00554| \n00555|     const occupiedVolume = (maxX * maxY * maxZ) / 1000000000; // –≤ –º¬≥\n00556|     const floorUtilization = (floorArea / ((TRUCK_DIMENSIONS.length * TRUCK_DIMENSIONS.width))) * 100;\n00557| \n00558|     return {\n00559|       occupiedFloorArea: (floorArea / 1000000).toFixed(2), // –≤ –º¬≤\n00560|       occupiedVolume: occupiedVolume.toFixed(3),\n00561|       floorUtilization: floorUtilization.toFixed(1),\n00562|       dimensions: {\n00563|         length: (maxX / 1000).toFixed(2),\n00564|         width: (maxY / 1000).toFixed(2),\n00565|         height: (maxZ / 1000).toFixed(2)\n00566|       }\n00567|     };\n00568|   };\n00569| \n00570|   const stats = calculateStats();\n00571|   const truckVertices = calculateTruckVertices();\n00572|   const truckComponents = calculateCabinAndChassisVertices();\n00573| \n00574|   if (!isVisible) return null;\n00575| \n00576|   return (\n00577|     <Card className=\"bg-gray-800 border-gray-700\">\n00578|       <CardHeader className=\"pb-3\">\n00579|         <CardTitle className=\"text-white flex items-center gap-2 text-lg\">\n00580|           <Truck className=\"h-4 w-4\" />\n00581|           –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è 3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä—É–∑–æ–≤–∏–∫–∞ —Å —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –≥—Ä—É–∑–∞\n00582|         </CardTitle>\n00583|       </CardHeader>\n00584|       <CardContent>\n00585|         {/* –û—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Ç–∫–∞: —Å–ª–µ–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Å–ø—Ä–∞–≤–∞ 3D */}\n00586|         <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-6\">\n00587|           {/* –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞ */}\n00588|           <div className=\"space-y-4\">\n00589|             {/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è */}\n00590|             {stats && (\n00591|               <div className=\"bg-gray-800 p-4 rounded-lg\">\n00592|                 <h4 className=\"font-medium text-white mb-4\">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è</h4>\n00593|                 <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n00594|                   <div className=\"space-y-2\">\n00595|                     <h5 className=\"font-medium text-gray-300\">–ó–∞–Ω—è—Ç—ã–µ —Ä–∞–∑–º–µ—Ä—ã:</h5>\n00596|                     <div className=\"text-gray-400 space-y-1\">\n00597|                       <div>–î–ª–∏–Ω–∞: {stats.dimensions.length} –º</div>\n00598|                       <div>–®–∏—Ä–∏–Ω–∞: {stats.dimensions.width} –º</div>\n00599|                       <div>–í—ã—Å–æ—Ç–∞: {stats.dimensions.height} –º</div>\n00600|                     </div>\n00601|                   </div>\n00602|                   <div className=\"space-y-2\">\n00603|                     <h5 className=\"font-medium text-gray-300\">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:</h5>\n00604|                     <div className=\"text-gray-400 space-y-1\">\n00605|                       <div>–ü–ª–æ—â–∞–¥—å –ø–æ–ª–∞: {stats.occupiedFloorArea} –º¬≤</div>\n00606|                       <div>–û–±—ä–µ–º: {stats.occupiedVolume} –º¬≥</div>\n00607|                       <div>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–∞: {stats.floorUtilization}%</div>\n00608|                     </div>\n00609|                   </div>\n00610|                 </div>\n00611|               </div>\n00612|             )}\n00613| \n00614|             {/* –õ–µ–≥–µ–Ω–¥–∞ –≥—Ä—É–∑–æ–≤ */}\n00615|             {placements.length > 0 && (\n00616|               <div className=\"bg-gray-800 p-4 rounded-lg\">\n00617|                 <h4 className=\"font-medium text-white mb-3\">üì¶ –†–∞–∑–º–µ—â–µ–Ω–Ω—ã–µ –≥—Ä—É–∑—ã</h4>\n00618|                 <div className=\"grid grid-cols-1 gap-2 text-xs max-h-80 overflow-y-auto\">\n00619|                   {placements.map((placement, index) => (\n00620|                     <div key={`legend-${index}`} className=\"flex items-center gap-2 p-2 bg-gray-700 rounded\">\n00621|                       <div \n00622|                         className=\"w-4 h-4 rounded flex-shrink-0\"\n00623|                         style={{ backgroundColor: placement.color }}\n00624|                       />\n00625|                       <span className=\"text-gray-300 flex-1\">\n00626|                         <span className=\"font-medium\">–ì—Ä—É–∑ {index + 1}</span>\n00627|                         {getProductShortName(placement.cargo.productName) && (\n00628|                           <span className=\"text-blue-300\"> \"{getProductShortName(placement.cargo.productName)}\"</span>\n00629|                         )}\n00630|                         <br />\n00631|                         <span className=\"text-xs text-gray-400\">\n00632|                           {Math.round(placement.orientation.length)}√ó{Math.round(placement.orientation.width)}√ó{Math.round(placement.orientation.height)} –º–º\n00633|                           {placement.orientation.rotationAngle !== 0 && (\n00634|                             <span className=\"text-blue-300\"> (–ø–æ–≤–µ—Ä–Ω—É—Ç {placement.orientation.rotationAngle}¬∞)</span>\n00635|                           )}\n00636|                         </span>\n00637|                       </span>\n00638|                     </div>\n00639|                   ))}\n00640|                 </div>\n00641|               </div>\n00642|             )}\n00643|           </div>\n00644| \n00645|           {/* –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: 3D –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è */}\n00646|           <div className=\"space-y-4\">\n00647|             {/* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 3D –º–æ–¥–µ–ª—å—é */}\n00648|             <div className=\"bg-gray-800 p-4 rounded-lg space-y-4\">\n00649|               <div className=\"flex items-center justify-between\">\n00650|                 <h4 className=\"text-white font-medium flex items-center gap-2\">\n00651|                   <Rotate3d className=\"h-4 w-4\" />\n00652|                   üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3D –º–æ–¥–µ–ª—å—é\n00653|                 </h4>\n00654|                 <Button\n00655|                   variant=\"outline\"\n00656|                   size=\"sm\"\n00657|                   onClick={() => {\n00658|                     setRotationX(0);\n00659|                     setRotationY(-45);\n00660|                     setRotationZ(0);\n00661|                     setPositionX(50);\n00662|                     setPositionY(50);\n00663|                     setScale(70);\n00664|                   }}\n00665|                   className=\"text-white border-gray-600 hover:bg-gray-700\"\n00666|                 >\n00667|                   –°–±—Ä–æ—Å\n00668|                 </Button>\n00669|               </div>\n00670|               \n00671|               <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n00672|                 {/* –°–ª–∞–π–¥–µ—Ä—ã –ø–æ–≤–æ—Ä–æ—Ç–æ–≤ */}\n00673|                 <div className=\"space-y-4\">\n00674|                   <div className=\"space-y-2\">\n00675|                     <label className=\"text-sm text-gray-300 flex items-center gap-2\">\n00676|                       <Rotate3d className=\"h-3 w-3\" />\n00677|                       –ü–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –æ—Å–∏ X: {rotationX.toFixed(0)}¬∞\n00678|                     </label>\n00679|                     <Slider\n00680|                       value={[rotationX]}\n00681|                       onValueChange={(value) => setRotationX(value[0])}\n00682|                       max={360}\n00683|                       min={-360}\n00684|                       step={5}\n00685|                       className=\"w-full\"\n00686|                     />\n00687|                   </div>\n00688|                   \n00689|                   <div className=\"space-y-2\">\n00690|                     <label className=\"text-sm text-gray-300 flex items-center gap-2\">\n00691|                       <Rotate3d className=\"h-3 w-3\" />\n00692|                       –ü–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –æ—Å–∏ Y: {rotationY.toFixed(0)}¬∞\n00693|                     </label>\n00694|                     <Slider\n00695|                       value={[rotationY]}\n00696|                       onValueChange={(value) => setRotationY(value[0])}\n00697|                       max={360}\n00698|                       min={-360}\n00699|                       step={5}\n00700|                       className=\"w-full\"\n00701|                     />\n00702|                   </div>\n00703| \n00704|                   <div className=\"space-y-2\">\n00705|                     <label className=\"text-sm text-gray-300\">\n00706|                       –ü–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ –æ—Å–∏ Z: {rotationZ.toFixed(0)}¬∞\n00707|                     </label>\n00708|                     <Slider\n00709|                       value={[rotationZ]}\n00710|                       onValueChange={(value) => setRotationZ(value[0])}\n00711|                       max={360}\n00712|                       min={-360}\n00713|                       step={5}\n00714|                       className=\"w-full\"\n00715|                     />\n00716|                   </div>\n00717|                 </div>\n00718|                 \n00719|                 {/* –°–ª–∞–π–¥–µ—Ä—ã –ø–æ–∑–∏—Ü–∏–∏ –∏ –º–∞—Å—à—Ç–∞–±–∞ */}\n00720|                 <div className=\"space-y-4\">\n00721|                   <div className=\"space-y-2\">\n00722|                     <label className=\"text-sm text-gray-300 flex items-center gap-2\">\n00723|                       <Move className=\"h-3 w-3\" />\n00724|                       –ü–æ–∑–∏—Ü–∏—è X: {positionX.toFixed(0)}%\n00725|                     </label>\n00726|                     <Slider\n00727|                       value={[positionX]}\n00728|                       onValueChange={(value) => setPositionX(value[0])}\n00729|                       max={100}\n00730|                       min={0}\n00731|                       step={1}\n00732|                       className=\"w-full\"\n00733|                     />\n00734|                   </div>\n00735|                   \n00736|                   <div className=\"space-y-2\">\n00737|                     <label className=\"text-sm text-gray-300\">\n00738|                       –ü–æ–∑–∏—Ü–∏—è Y: {positionY.toFixed(0)}%\n00739|                     </label>\n00740|                     <Slider\n00741|                       value={[positionY]}\n00742|                       onValueChange={(value) => setPositionY(value[0])}\n00743|                       max={100}\n00744|                       min={0}\n00745|                       step={1}\n00746|                       className=\"w-full\"\n00747|                     />\n00748|                   </div>\n00749| \n00750|                   <div className=\"space-y-2\">\n00751|                     <label className=\"text-sm text-gray-300\">\n00752|                       –ú–∞—Å—à—Ç–∞–±: {scale.toFixed(0)}%\n00753|                     </label>\n00754|                     <Slider\n00755|                       value={[scale]}\n00756|                       onValueChange={(value) => setScale(value[0])}\n00757|                       max={100}\n00758|                       min={10}\n00759|                       step={1}\n00760|                       className=\"w-full\"\n00761|                     />\n00762|                   </div>\n00763|                 </div>\n00764|               </div>\n00765|             </div>\n00766| \n00767|             {/* 3D SVG –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫—É–∑–æ–≤–∞ */}\n00768|             <div className=\"bg-gray-900 p-4 rounded-lg\">\n00769|               <svg \n00770|                 viewBox=\"0 0 600 400\" \n00771|                 className=\"w-full h-96 border border-gray-600 bg-gray-950\"\n00772|                 style={{ maxHeight: '480px' }}\n00773|               >\n00774|                 {/* –†–∞–∑–º–µ—Ä—ã –∫—É–∑–æ–≤–∞ */}\n00775|                 <text x=\"300\" y=\"20\" textAnchor=\"middle\" fill=\"#9CA3AF\" fontSize=\"12\" fontWeight=\"bold\">\n00776|                   üöõ –ì—Ä—É–∑–æ–≤–∏–∫ —Å –∫—É–∑–æ–≤–æ–º 4200√ó2025√ó2025 –º–º\n00777|                 </text>\n00778|                 \n00779|                 {/* –ö–∞–±–∏–Ω–∞ –≥—Ä—É–∑–æ–≤–∏–∫–∞ */}\n00780|                 <g stroke=\"#10B981\" strokeWidth=\"2\" fill=\"#065F46\" fillOpacity=\"0.3\">\n00781|                   {/* –ü–µ—Ä–µ–¥–Ω—è—è —Å—Ç–µ–Ω–∫–∞ –∫–∞–±–∏–Ω—ã */}\n00782|                   <polygon \n00783|                     points={`${truckComponents.cabin[0].x},${truckComponents.cabin[0].y} ${truckComponents.cabin[1].x},${truckComponents.cabin[1].y} ${truckComponents.cabin[5].x},${truckComponents.cabin[5].y} ${truckComponents.cabin[4].x},${truckComponents.cabin[4].y}`}\n00784|                   />\n00785|                   \n00786|                   {/* –ü—Ä–∞–≤–∞—è –±–æ–∫–æ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –∫–∞–±–∏–Ω—ã */}\n00787|                   <polygon \n00788|                     points={`${truckComponents.cabin[1].x},${truckComponents.cabin[1].y} ${truckComponents.cabin[2].x},${truckComponents.cabin[2].y} ${truckComponents.cabin[6].x},${truckComponents.cabin[6].y} ${truckComponents.cabin[5].x},${truckComponents.cabin[5].y}`}\n00789|                     fillOpacity=\"0.4\"\n00790|                   />\n00791|                   \n00792|                   {/* –í–µ—Ä—Ö –∫–∞–±–∏–Ω—ã */}\n00793|                   <polygon \n00794|                     points={`${truckComponents.cabin[4].x},${truckComponents.cabin[4].y} ${truckComponents.cabin[5].x},${truckComponents.cabin[5].y} ${truckComponents.cabin[6].x},${truckComponents.cabin[6].y} ${truckComponents.cabin[7].x},${truckComponents.cabin[7].y}`}\n00795|                     fillOpacity=\"0.5\"\n00796|                   />\n00797|                   \n00798|                   {/* –õ–µ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ –∫–∞–±–∏–Ω—ã */}\n00799|                   <polygon \n00800|                     points={`${truckComponents.cabin[3].x},${truckComponents.cabin[3].y} ${truckComponents.cabin[0].x},${truckComponents.cabin[0].y} ${truckComponents.cabin[4].x},${truckComponents.cabin[4].y} ${truckComponents.cabin[7].x},${truckComponents.cabin[7].y}`}\n00801|                     fillOpacity=\"0.2\"\n00802|                   />\n00803|                 </g>\n00804|                 \n00805|                 {/* –®–∞—Å—Å–∏ */}\n00806|                 <g stroke=\"#374151\" strokeWidth=\"3\" fill=\"#1F2937\">\n00807|                   {/* –®–∞—Å—Å–∏ –ø–æ–¥ –∫–∞–±–∏–Ω–æ–π */}\n00808|                   <polygon \n00809|                     points={`${truckComponents.chassis[0].x},${truckComponents.chassis[0].y} ${truckComponents.chassis[1].x},${truckComponents.chassis[1].y} ${truckComponents.chassis[2].x},${truckComponents.chassis[2].y} ${truckComponents.chassis[3].x},${truckComponents.chassis[3].y}`}\n00810|                   />\n00811|                   \n00812|                   {/* –®–∞—Å—Å–∏ –ø–æ–¥ –∫—É–∑–æ–≤–æ–º */}\n00813|                   <polygon \n00814|                     points={`${truckComponents.chassis[4].x},${truckComponents.chassis[4].y} ${truckComponents.chassis[5].x},${truckComponents.chassis[5].y} ${truckComponents.chassis[6].x},${truckComponents.chassis[6].y} ${truckComponents.chassis[7].x},${truckComponents.chassis[7].y}`}\n00815|                   />\n00816|                 </g>\n00817|                 \n00818|                 {/* –ö–æ–ª–µ—Å–∞ */}\n00819|                 <g fill=\"#1F2937\" stroke=\"#374151\" strokeWidth=\"2\">\n00820|                   {truckComponents.wheels.map((wheel, index) => (\n00821|                     <circle \n00822|                       key={`wheel-${index}`}\n00823|                       cx={wheel.x} \n00824|                       cy={wheel.y} \n00825|                       r={Math.max(truckComponents.wheelRadius, 3)}\n00826|                     />\n00827|                   ))}\n00828|                 </g>\n00829|                 \n00830|                 {/* –ö–æ–Ω—Ç—É—Ä –∫—É–∑–æ–≤–∞ –≤ –∏–∑–æ–º–µ—Ç—Ä–∏–∏ */}\n00831|                 <g stroke=\"#EF4444\" strokeWidth=\"2\" fill=\"none\">\n00832|                   {/* –ü–æ–ª –∫—É–∑–æ–≤–∞ */}\n00833|                   <polygon \n00834|                     points={`${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[3].x},${truckVertices[3].y}`}\n00835|                     fill=\"#7F1D1D\" \n00836|                     fillOpacity=\"0.3\" \n00837|                   />\n00838|                   \n00839|                   {/* –ó–∞–¥–Ω—è—è —Å—Ç–µ–Ω–∫–∞ */}\n00840|                   <polygon \n00841|                     points={`${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[5].x},${truckVertices[5].y} ${truckVertices[4].x},${truckVertices[4].y}`}\n00842|                     strokeDasharray=\"3,3\" \n00843|                   />\n00844|                   \n00845|                   {/* –ü—Ä–∞–≤–∞—è –±–æ–∫–æ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ */}\n00846|                   <polygon \n00847|                     points={`${truckVertices[1].x},${truckVertices[1].y} ${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[6].x},${truckVertices[6].y} ${truckVertices[5].x},${truckVertices[5].y}`}\n00848|                     strokeDasharray=\"3,3\" \n00849|                   />\n00850|                   \n00851|                   {/* –ü–µ—Ä–µ–¥–Ω—è—è —Å—Ç–µ–Ω–∫–∞ */}\n00852|                   <polygon \n00853|                     points={`${truckVertices[2].x},${truckVertices[2].y} ${truckVertices[3].x},${truckVertices[3].y} ${truckVertices[7].x},${truckVertices[7].y} ${truckVertices[6].x},${truckVertices[6].y}`}\n00854|                     strokeDasharray=\"3,3\" \n00855|                   />\n00856|                   \n00857|                   {/* –õ–µ–≤–∞—è –±–æ–∫–æ–≤–∞—è —Å—Ç–µ–Ω–∫–∞ */}\n00858|                   <polygon \n00859|                     points={`${truckVertices[3].x},${truckVertices[3].y} ${truckVertices[0].x},${truckVertices[0].y} ${truckVertices[4].x},${truckVertices[4].y} ${truckVertices[7].x},${truckVertices[7].y}`}\n00860|                     strokeDasharray=\"3,3\" \n00861|                   />\n00862|                   \n00863|                   {/* –í–µ—Ä—Ö –∫—É–∑–æ–≤–∞ */}\n00864|                   <polygon \n00865|                     points={`${truckVertices[4].x},${truckVertices[4].y} ${truckVertices[5].x},${truckVertices[5].y} ${truckVertices[6].x},${truckVertices[6].y} ${truckVertices[7].x},${truckVertices[7].y}`}\n00866|                     strokeDasharray=\"3,3\" \n00867|                   />\n00868|                 </g>\n00869|                 \n00870|                 {/* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤ */}\n00871|                 {placements.map((placement, index) => {\n00872|                   const vertices = placement.projectedVertices;\n00873|                   if (vertices.length < 8) return null;\n00874| \n00875|                   return (\n00876|                     <g key={`cargo-3d-${index}`}>\n00877|                       {/* –ù–∏–∂–Ω—è—è –≥—Ä–∞–Ω—å */}\n00878|                       <polygon\n00879|                         points={`${vertices[0].x},${vertices[0].y} ${vertices[1].x},${vertices[1].y} ${vertices[2].x},${vertices[2].y} ${vertices[3].x},${vertices[3].y}`}\n00880|                         fill={placement.color}\n00881|                         fillOpacity=\"0.6\"\n00882|                         stroke={placement.color}\n00883|                         strokeWidth=\"1\"\n00884|                       />\n00885|                       \n00886|                       {/* –í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω—å */}\n00887|                       <polygon\n00888|                         points={`${vertices[4].x},${vertices[4].y} ${vertices[5].x},${vertices[5].y} ${vertices[6].x},${vertices[6].y} ${vertices[7].x},${vertices[7].y}`}\n00889|                         fill={placement.color}\n00890|                         fillOpacity=\"0.8\"\n00891|                         stroke={placement.color}\n00892|                         strokeWidth=\"1\"\n00893|                       />\n00894|                       \n00895|                       {/* –ë–æ–∫–æ–≤—ã–µ –≥—Ä–∞–Ω–∏ */}\n00896|                       <polygon\n00897|                         points={`${vertices[1].x},${vertices[1].y} ${vertices[2].x},${vertices[2].y} ${vertices[6].x},${vertices[6].y} ${vertices[5].x},${vertices[5].y}`}\n00898|                         fill={placement.color}\n00899|                         fillOpacity=\"0.7\"\n00900|                         stroke={placement.color}\n00901|                         strokeWidth=\"1\"\n00902|                       />\n00903|                       \n00904|                       <polygon\n00905|                         points={`${vertices[2].x},${vertices[2].y} ${vertices[3].x},${vertices[3].y} ${vertices[7].x},${vertices[7].y} ${vertices[6].x},${vertices[6].y}`}\n00906|                         fill={placement.color}\n00907|                         fillOpacity=\"0.5\"\n00908|                         stroke={placement.color}\n00909|                         strokeWidth=\"1\"\n00910|                       />\n00911| \n00912|                       {/* –ù–æ–º–µ—Ä –≥—Ä—É–∑–∞ */}\n00913|                       <text\n00914|                         x={(vertices[4].x + vertices[6].x) / 2}\n00915|                         y={(vertices[4].y + vertices[6].y) / 2}\n00916|                         textAnchor=\"middle\"\n00917|                         dominantBaseline=\"middle\"\n00918|                         fill=\"white\"\n00919|                         fontSize=\"8\"\n00920|                         fontWeight=\"bold\"\n00921|                       >\n00922|                         {index + 1}\n00923|                       </text>\n00924|                     </g>\n00925|                   );\n00926|                 })}\n00927|               </svg>\n00928|             </div>\n00929|           </div>\n00930|         </div>\n00931|       </CardContent>\n00932|     </Card>\n00933|   );\n00934| }\n</file>",
    "metadata": {
      "preview": "'use client';\n\nimport React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Slider } from '@/components/ui/slider';\nimport { Truck, Move, RotateCw as Rotate3d } from 'lucide-react';\n\ninterface Cargo {\n  id: string;\n  length: number; // –≤ –º–º\n  width: number;  // –≤ –º–º\n  height: number; // –≤ –º–º\n  weight: number;\n  productName?: string;\n}\n\ninterface Orientation {\n  length: number;\n  width: number;"
    },
    "title": "components/TruckVisualization.tsx",
    "time": {
      "start": 1759143226958,
      "end": 1759143226963
    }
  }
}