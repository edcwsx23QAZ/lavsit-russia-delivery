{
  "id": "prt_ab47a0434001eHStBjqFVSkyoN",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_ab479f6be001vNjroPlEVESrSN",
  "type": "tool",
  "callID": "call_5b263814054a4cf68f4bedb0",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/components/CalculationProgress.tsx"
    },
    "output": "<file>\n00001| 'use client';\n00002| \n00003| import React from 'react';\n00004| import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n00005| import { Progress } from '@/components/ui/progress';\n00006| import { Badge } from '@/components/ui/badge';\n00007| import { Loader2, CheckCircle, XCircle, Clock } from 'lucide-react';\n00008| \n00009| interface CompanyProgress {\n00010|   name: string;\n00011|   status: 'pending' | 'loading' | 'completed' | 'error';\n00012|   progress?: number;\n00013|   error?: string;\n00014|   duration?: number;\n00015| }\n00016| \n00017| interface CalculationProgressProps {\n00018|   companies: CompanyProgress[];\n00019|   totalDuration?: number;\n00020|   isVisible: boolean;\n00021| }\n00022| \n00023| export default function CalculationProgress({ \n00024|   companies, \n00025|   totalDuration = 0, \n00026|   isVisible \n00027| }: CalculationProgressProps) {\n00028|   if (!isVisible) return null;\n00029| \n00030|   const completedCount = companies.filter(c => c.status === 'completed').length;\n00031|   const errorCount = companies.filter(c => c.status === 'error').length;\n00032|   const loadingCount = companies.filter(c => c.status === 'loading').length;\n00033|   const totalCount = companies.length;\n00034|   const overallProgress = totalCount > 0 ? (completedCount + errorCount) / totalCount * 100 : 0;\n00035| \n00036|   const getStatusIcon = (status: CompanyProgress['status']) => {\n00037|     switch (status) {\n00038|       case 'loading':\n00039|         return <Loader2 className=\"h-4 w-4 animate-spin text-blue-500\" />;\n00040|       case 'completed':\n00041|         return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\n00042|       case 'error':\n00043|         return <XCircle className=\"h-4 w-4 text-red-500\" />;\n00044|       default:\n00045|         return <Clock className=\"h-4 w-4 text-gray-400\" />;\n00046|     }\n00047|   };\n00048| \n00049|   const getStatusColor = (status: CompanyProgress['status']) => {\n00050|     switch (status) {\n00051|       case 'loading':\n00052|         return 'bg-blue-500';\n00053|       case 'completed':\n00054|         return 'bg-green-500';\n00055|       case 'error':\n00056|         return 'bg-red-500';\n00057|       default:\n00058|         return 'bg-gray-300';\n00059|     }\n00060|   };\n00061| \n00062|   return (\n00063|     <Card className=\"w-full\">\n00064|       <CardHeader className=\"pb-3\">\n00065|         <CardTitle className=\"flex items-center justify-between text-lg\">\n00066|           <span className=\"flex items-center gap-2\">\n00067|             <Loader2 className=\"h-5 w-5 animate-spin\" />\n00068|             Расчет стоимости доставки\n00069|           </span>\n00070|           <div className=\"flex items-center gap-2 text-sm font-normal\">\n00071|             {totalDuration > 0 && (\n00072|               <Badge variant=\"outline\" className=\"text-xs\">\n00073|                 {totalDuration.toFixed(0)}мс\n00074|               </Badge>\n00075|             )}\n00076|             <Badge variant={errorCount > 0 ? \"destructive\" : \"default\"}>\n00077|               {completedCount}/{totalCount} завершено\n00078|             </Badge>\n00079|           </div>\n00080|         </CardTitle>\n00081|         <Progress value={overallProgress} className=\"w-full\" />\n00082|       </CardHeader>\n00083|       \n00084|       <CardContent className=\"space-y-3\">\n00085|         <div className=\"grid gap-3\">\n00086|           {companies.map((company, index) => (\n00087|             <div \n00088|               key={company.name} \n00089|               className=\"flex items-center justify-between p-3 rounded-lg border bg-card\"\n00090|             >\n00091|               <div className=\"flex items-center gap-3\">\n00092|                 {getStatusIcon(company.status)}\n00093|                 <div>\n00094|                   <div className=\"font-medium\">{company.name}</div>\n00095|                   {company.error && (\n00096|                     <div className=\"text-xs text-red-600 mt-1 max-w-md\">\n00097|                       {company.error}\n00098|                     </div>\n00099|                   )}\n00100|                   {company.duration && company.status === 'completed' && (\n00101|                     <div className=\"text-xs text-green-600 mt-1\">\n00102|                       Выполнено за {company.duration.toFixed(0)}мс\n00103|                     </div>\n00104|                   )}\n00105|                 </div>\n00106|               </div>\n00107|               \n00108|               <div className=\"flex items-center gap-2\">\n00109|                 {company.status === 'loading' && company.progress !== undefined && (\n00110|                   <div className=\"w-20\">\n00111|                     <Progress value={company.progress} className=\"h-2\" />\n00112|                   </div>\n00113|                 )}\n00114|                 \n00115|                 <Badge \n00116|                   variant={company.status === 'error' ? 'destructive' : 'secondary'}\n00117|                   className=\"text-xs\"\n00118|                 >\n00119|                   {company.status === 'pending' && 'Ожидание'}\n00120|                   {company.status === 'loading' && 'Выполняется'}\n00121|                   {company.status === 'completed' && 'Завершено'}\n00122|                   {company.status === 'error' && 'Ошибка'}\n00123|                 </Badge>\n00124|               </div>\n00125|             </div>\n00126|           ))}\n00127|         </div>\n00128|         \n00129|         {/* Статистика */}\n00130|         <div className=\"flex justify-between items-center pt-3 border-t text-sm text-muted-foreground\">\n00131|           <div className=\"flex gap-4\">\n00132|             <span>Завершено: {completedCount}</span>\n00133|             {errorCount > 0 && <span className=\"text-red-600\">Ошибок: {errorCount}</span>}\n00134|             {loadingCount > 0 && <span>Выполняется: {loadingCount}</span>}\n00135|           </div>\n00136|           <div>\n00137|             Общий прогресс: {overallProgress.toFixed(0)}%\n00138|           </div>\n00139|         </div>\n00140|       </CardContent>\n00141|     </Card>\n00142|   );\n00143| }\n</file>",
    "title": "components/CalculationProgress.tsx",
    "metadata": {
      "preview": "'use client';\n\nimport React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Progress } from '@/components/ui/progress';\nimport { Badge } from '@/components/ui/badge';\nimport { Loader2, CheckCircle, XCircle, Clock } from 'lucide-react';\n\ninterface CompanyProgress {\n  name: string;\n  status: 'pending' | 'loading' | 'completed' | 'error';\n  progress?: number;\n  error?: string;\n  duration?: number;\n}\n\ninterface CalculationProgressProps {\n  companies: CompanyProgress[];\n  totalDuration?: number;\n  isVisible: boolean;"
    },
    "time": {
      "start": 1763964486710,
      "end": 1763964486712
    }
  }
}