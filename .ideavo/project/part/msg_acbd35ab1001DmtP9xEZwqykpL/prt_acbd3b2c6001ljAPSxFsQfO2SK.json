{
  "id": "prt_acbd3b2c6001ljAPSxFsQfO2SK",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_acbd35ab1001DmtP9xEZwqykpL",
  "type": "tool",
  "callID": "call_5ff5f44f55de42858bfd99f3",
  "tool": "write",
  "state": {
    "status": "completed",
    "input": {
      "content": "#!/usr/bin/env node\n\n/**\n * Ð¢ÐµÑÑ‚ Ð´Ð»Ñ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Vozovoz API Ñ ÑÐ°Ð¹Ñ‚Ð¾Ð¼\n * ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹: ÐœÐ¾ÑÐºÐ²Ð° (Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð») -> Ð¡ÐŸÐ‘ (Ð°Ð´Ñ€ÐµÑ: ÐÐµÐ²ÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾ÑÐ¿ÐµÐºÑ‚ Ð´.132)\n * Ð“Ñ€ÑƒÐ·: 200*100*100ÑÐ¼, 100ÐºÐ³\n */\n\nconst VOZOVOZ_TOKEN = 'sBDUaEmzVBO6syQWHvHxmjxJQiON2BZplQaqrU3N';\n\n// Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ñ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼Ð¸ Ð¸Ð· ÑÐ°Ð¹Ñ‚Ð°\nconst TEST_REQUEST = {\n  object: \"price\",\n  action: \"get\",\n  params: {\n    cargo: {\n      dimension: {\n        max: {\n          length: 2.0,    // 200ÑÐ¼ = 2Ð¼\n          width: 1.0,     // 100ÑÐ¼ = 1Ð¼  \n          height: 1.0,    // 100ÑÐ¼ = 1Ð¼\n          weight: 100     // 100ÐºÐ³\n        },\n        quantity: 1,\n        volume: 2.0 * 1.0 * 1.0,  // 2.0 Ð¼Â³\n        weight: 100\n      },\n      insuranceNdv: true  // Ð¡Ñ‚Ñ€Ð°Ñ…Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð±ÐµÐ· Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð½Ð¾Ð¹ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸\n    },\n    gateway: {\n      dispatch: {\n        point: {\n          location: \"ÐœÐ¾ÑÐºÐ²Ð°\",\n          terminal: \"default\"  // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ñ‚ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ð°\n        }\n      },\n      destination: {\n        point: {\n          location: \"Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³\",\n          address: \"ÐÐµÐ²ÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾ÑÐ¿ÐµÐºÑ‚ Ð´.132\"  // Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° Ð´Ð¾ Ð°Ð´Ñ€ÐµÑÐ°\n        }\n      }\n    }\n  }\n};\n\n// ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ñ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¼ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸ÐµÐ¼ Ð°Ð´Ñ€ÐµÑÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ\nconst TEST_REQUEST_PRECISE = {\n  object: \"price\",\n  action: \"get\",\n  params: {\n    cargo: {\n      dimension: {\n        max: {\n          length: 2.0,\n          width: 1.0,\n          height: 1.0,\n          weight: 100\n        },\n        quantity: 1,\n        volume: 2.0,\n        weight: 100\n      },\n      insuranceNdv: true\n    },\n    gateway: {\n      dispatch: {\n        point: {\n          location: \"ÐœÐ¾ÑÐºÐ²Ð°\",\n          address: \"Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»\"  // ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ \"Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»\" Ð² Ð°Ð´Ñ€ÐµÑÐµ\n        }\n      },\n      destination: {\n        point: {\n          location: \"Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³\",\n          address: \"ÐÐµÐ²ÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾ÑÐ¿ÐµÐºÑ‚ Ð´.132\"\n        }\n      }\n    }\n  }\n};\n\n// Ð¢ÐµÑÑ‚ Ñ Ñ€Ð°Ð·Ð½Ñ‹Ð¼Ð¸ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð°Ð¼Ð¸ Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¹\nconst LOCATION_VARIANTS = [\n  {\n    name: \"ÐœÐ¾ÑÐºÐ²Ð° (Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð») -> Ð¡ÐŸÐ‘ (Ð°Ð´Ñ€ÐµÑ)\",\n    request: TEST_REQUEST\n  },\n  {\n    name: \"ÐœÐ¾ÑÐºÐ²Ð° (Ð°Ð´Ñ€ÐµÑ: Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð») -> Ð¡ÐŸÐ‘ (Ð°Ð´Ñ€ÐµÑ)\",\n    request: TEST_REQUEST_PRECISE\n  },\n  {\n    name: \"ÐœÐ¾ÑÐºÐ²Ð° (Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð») -> Ð¡ÐŸÐ‘ (Ð°Ð´Ñ€ÐµÑ Ñ Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð¼)\",\n    request: {\n      ...TEST_REQUEST,\n      params: {\n        ...TEST_REQUEST.params,\n        gateway: {\n          dispatch: {\n            point: {\n              location: \"ÐœÐ¾ÑÐºÐ²Ð°\",\n              terminal: \"default\"\n            }\n          },\n          destination: {\n            point: {\n              location: \"Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³\",\n              address: \"ÐÐµÐ²ÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾ÑÐ¿ÐµÐºÑ‚ Ð´.132, 191025\"\n            }\n          }\n        }\n      }\n    }\n  },\n  {\n    name: \"ÐœÐ¾ÑÐºÐ²Ð° (Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð») -> Ð¡ÐŸÐ‘ (Ð°Ð´Ñ€ÐµÑ + Ñ€Ð°Ð¹Ð¾Ð½)\",\n    request: {\n      ...TEST_REQUEST,\n      params: {\n        ...TEST_REQUEST.params,\n        gateway: {\n          dispatch: {\n            point: {\n              location: \"ÐœÐ¾ÑÐºÐ²Ð°\",\n              terminal: \"default\"\n            }\n          },\n          destination: {\n            point: {\n              location: \"Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³, Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð¹Ð¾Ð½\",\n              address: \"ÐÐµÐ²ÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾ÑÐ¿ÐµÐºÑ‚ Ð´.132\"\n            }\n          }\n        }\n      }\n    }\n  }\n];\n\nasync function makeVozovozRequest(requestData, testName) {\n  console.log(`\\nðŸšš Ð¢ÐµÑÑ‚: ${testName}`);\n  console.log('ðŸ“¤ Ð—Ð°Ð¿Ñ€Ð¾Ñ:', JSON.stringify(requestData, null, 2));\n  \n  try {\n    const response = await fetch(`https://vozovoz.ru/api/?token=${VOZOVOZ_TOKEN}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n      },\n      body: JSON.stringify(requestData)\n    });\n\n    console.log(`ðŸ“¥ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ: ${response.status} ${response.statusText}`);\n    \n    if (!response.ok) {\n      const errorText = await response.text();\n      console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ°:', errorText);\n      return null;\n    }\n\n    const data = await response.json();\n    console.log('ðŸ“¥ ÐžÑ‚Ð²ÐµÑ‚:', JSON.stringify(data, null, 2));\n    \n    return data;\n  } catch (error) {\n    console.error('âŒ ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°:', error.message);\n    return null;\n  }\n}\n\nfunction analyzeResponse(response, testName) {\n  if (!response || !response.response) {\n    console.log(`âŒ ${testName}: ÐÐµÑ‚ Ð²Ð°Ð»Ð¸Ð´Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð°`);\n    return null;\n  }\n  \n  const resp = response.response;\n  console.log(`\\nðŸ” ÐÐ½Ð°Ð»Ð¸Ð· Ð¾Ñ‚Ð²ÐµÑ‚Ð°: ${testName}`);\n  console.log('='.repeat(50));\n  \n  console.log(`ðŸ’° Ð˜Ñ‚Ð¾Ð³Ð¾Ð²Ð°Ñ Ñ†ÐµÐ½Ð°: ${resp.price} â‚½`);\n  console.log(`ðŸ’° Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ Ñ†ÐµÐ½Ð°: ${resp.basePrice} â‚½`);\n  \n  if (resp.service && Array.isArray(resp.service)) {\n    console.log('\\nðŸ“¦ Ð”ÐµÑ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑƒÑÐ»ÑƒÐ³:');\n    let totalCalculated = 0;\n    \n    resp.service.forEach((service, index) => {\n      console.log(`   ${index + 1}. ${service.name}: ${service.price} â‚½ (Ð±Ð°Ð·Ð°: ${service.basePrice} â‚½)`);\n      totalCalculated += service.price;\n    });\n    \n    console.log(`\\nðŸ§® Ð¡ÑƒÐ¼Ð¼Ð° ÑƒÑÐ»ÑƒÐ³: ${totalCalculated} â‚½`);\n    console.log(`ðŸ§® Ð˜Ñ‚Ð¾Ð³Ð¾Ð²Ð°Ñ Ñ†ÐµÐ½Ð° Ð¸Ð· Ð¾Ñ‚Ð²ÐµÑ‚Ð°: ${resp.price} â‚½`);\n    console.log(`ðŸ§® Ð Ð°Ð·Ð½Ð¸Ñ†Ð°: ${totalCalculated - resp.price} â‚½`);\n  }\n  \n  if (resp.deliveryTime) {\n    console.log(`\\nâ° Ð¡Ñ€Ð¾ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸: ${resp.deliveryTime.from}-${resp.deliveryTime.to} Ð´Ð½ÐµÐ¹`);\n  }\n  \n  if (resp.warnings && resp.warnings.length > 0) {\n    console.log('\\nâš ï¸ ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ñ:');\n    resp.warnings.forEach(warning => console.log(`   - ${warning}`));\n  }\n  \n  return resp;\n}\n\nasync function runComparisonTest() {\n  console.log('ðŸšš Ð¡Ð ÐÐ’ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐ«Ð™ Ð¢Ð•Ð¡Ð¢ VOZOVOZ API vs Ð¡ÐÐ™Ð¢');\n  console.log('='.repeat(60));\n  console.log('ðŸ“‹ ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ñ ÑÐ°Ð¹Ñ‚Ð°: 10,956 â‚½');\n  console.log('ðŸ“‹ Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ API: 11,250 â‚½');\n  console.log(`ðŸ“‹ Ð Ð°Ð·Ð½Ð¸Ñ†Ð°: ${11250 - 10956} â‚½`);\n  console.log('='.repeat(60));\n  \n  const results = [];\n  \n  for (const variant of LOCATION_VARIANTS) {\n    const response = await makeVozovozRequest(variant.request, variant.name);\n    const analyzed = analyzeResponse(response, variant.name);\n    \n    results.push({\n      name: variant.name,\n      response: analyzed,\n      price: analyzed?.price || 0,\n      basePrice: analyzed?.basePrice || 0\n    });\n    \n    // Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð¼ÐµÐ¶Ð´Ñƒ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°Ð¼Ð¸\n    await new Promise(resolve => setTimeout(resolve, 2000));\n  }\n  \n  // Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·\n  console.log('\\nðŸ“Š Ð¡Ð ÐÐ’ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐ«Ð™ ÐÐÐÐ›Ð˜Ð—');\n  console.log('='.repeat(60));\n  \n  results.forEach(result => {\n    const diff = result.price - 10956;\n    const diffPercent = ((diff / 10956) * 100).toFixed(1);\n    console.log(`${result.name}:`);\n    console.log(`   Ð¦ÐµÐ½Ð°: ${result.price} â‚½`);\n    console.log(`   Ð Ð°Ð·Ð½Ð¸Ñ†Ð° Ñ ÑÐ°Ð¹Ñ‚Ð¾Ð¼: ${diff > 0 ? '+' : ''}${diff} â‚½ (${diff > 0 ? '+' : ''}${diffPercent}%)`);\n  });\n  \n  // ÐŸÐ¾Ð¸ÑÐº Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ\n  const closest = results.reduce((best, current) => {\n    const bestDiff = Math.abs(best.price - 10956);\n    const currentDiff = Math.abs(current.price - 10956);\n    return currentDiff < bestDiff ? current : best;\n  });\n  \n  console.log(`\\nðŸŽ¯ Ð›ÑƒÑ‡ÑˆÐµÐµ ÑÐ¾Ð²Ð¿Ð°Ð´ÐµÐ½Ð¸Ðµ: ${closest.name}`);\n  console.log(`   Ð¦ÐµÐ½Ð°: ${closest.price} â‚½`);\n  console.log(`   Ð Ð°Ð·Ð½Ð¸Ñ†Ð°: ${closest.price - 10956} â‚½`);\n  \n  console.log('\\nðŸ Ð¢Ð•Ð¡Ð¢ Ð—ÐÐ’Ð•Ð Ð¨Ð•Ð');\n}\n\n// Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ñ‚ÐµÑÑ‚\nrunComparisonTest().catch(console.error);",
      "filePath": "/home/user/project/test-vozovoz-comparison.js"
    },
    "output": "",
    "title": "test-vozovoz-comparison.js",
    "metadata": {
      "diagnostics": {},
      "filepath": "/home/user/project/test-vozovoz-comparison.js",
      "exists": false
    },
    "time": {
      "start": 1764356240079,
      "end": 1764356240091
    }
  }
}