{
  "id": "prt_ab468ae310018v9SiQ8T2sdkRc",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_ab4689303002GhccAof5IU4nhi",
  "type": "tool",
  "callID": "call_2756d9bb8bce4cd8914173c1",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx",
      "limit": 200,
      "offset": 2000
    },
    "output": "<file>\n02001|             data.data.packages.forEach((pkg: any, index: number) => {\n02002|               console.log(`üí∞ Package [${index}] (–≤–∫–ª—é—á–µ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å):`, pkg);\n02003|             });\n02004|           } else {\n02005|             Object.entries(data.data.packages).forEach(([key, pkg]: [string, any]) => {\n02006|               console.log(`üí∞ Package [${key}] (–≤–∫–ª—é—á–µ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å):`, pkg);\n02007|             });\n02008|           }\n02009|         } else {\n02010|           console.log('üí∞ ‚ùå –£–ø–∞–∫–æ–≤–∫–∞ –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∞—Å—å');\n02011|         }\n02012| \n02013|         // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–∞–∫ —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –¥–∞—Ç–∞–º–∏ pickup –∏ arrivalToOspReceiver\n02014|         let deliveryDays = 0;\n02015|         try {\n02016|           console.log('=== –ü–û–ò–°–ö –î–ê–¢ –í –û–¢–í–ï–¢–ï ===');\n02017|           \n02018|           // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –º–µ—Å—Ç–∞ –≥–¥–µ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–∞—Ç—ã\n02019|           console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data.data?.pickup:', data.data?.pickup);\n02020|           console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data.pickup:', data.pickup);\n02021|           console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data?.pickup:', data?.pickup);\n02022|           console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data.data?.arrivalToOspReceiver:', data.data?.arrivalToOspReceiver);\n02023|           console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data.arrivalToOspReceiver:', data.arrivalToOspReceiver);\n02024|           console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data?.arrivalToOspReceiver:', data?.arrivalToOspReceiver);\n02025|           \n02026|           // –ë–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π –ø–æ–∏—Å–∫ –≤–æ –≤—Å–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ data\n02027|           const findDateInObject = (obj: any, fieldName: string): string | null => {\n02028|             if (!obj || typeof obj !== 'object') return null;\n02029|             \n02030|             for (const [key, value] of Object.entries(obj)) {\n02031|               if (key === fieldName && typeof value === 'string') {\n02032|                 return value;\n02033|               }\n02034|               if (typeof value === 'object' && value !== null) {\n02035|                 const found = findDateInObject(value, fieldName);\n02036|                 if (found) return found;\n02037|               }\n02038|             }\n02039|             return null;\n02040|           };\n02041|           \n02042|           const pickup = findDateInObject(data, 'pickup');\n02043|           const arrivalToOspReceiver = findDateInObject(data, 'arrivalToOspReceiver');\n02044|           \n02045|           console.log('–ù–ê–ô–î–ï–ù–ù–´–ï –î–ê–¢–´:');\n02046|           console.log('pickup:', pickup);\n02047|           console.log('arrivalToOspReceiver:', arrivalToOspReceiver);\n02048|           \n02049|           if (pickup && arrivalToOspReceiver) {\n02050|             // –ü–∞—Ä—Å–∏–º –¥–∞—Ç—ã (—Ñ–æ—Ä–º–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å \"2025-09-27\" –∏–ª–∏ \"2025-09-27 10:00:00\")\n02051|             const pickupDate = new Date(pickup);\n02052|             const arrivalDate = new Date(arrivalToOspReceiver);\n02053|             \n02054|             console.log('–ü–∞—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ pickup:', pickupDate);\n02055|             console.log('–ü–∞—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ arrival:', arrivalDate);\n02056|             \n02057|             // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞—Ç—ã –≤–∞–ª–∏–¥–Ω—ã\n02058|             if (!isNaN(pickupDate.getTime()) && !isNaN(arrivalDate.getTime())) {\n02059|               // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–Ω–æ—Å—Ç—å –≤ –¥–Ω—è—Ö\n02060|               const timeDiff = arrivalDate.getTime() - pickupDate.getTime();\n02061|               deliveryDays = Math.max(1, Math.ceil(timeDiff / (1000 * 3600 * 24))); // –ú–∏–Ω–∏–º—É–º 1 –¥–µ–Ω—å\n02062|               \n02063|               console.log('–†–∞–∑–Ω–æ—Å—Ç—å –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö:', timeDiff);\n02064|               console.log('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ - –í–´–ß–ò–°–õ–ï–ù —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:', deliveryDays, '–¥–Ω–µ–π');\n02065|             } else {\n02066|               console.error('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ - –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞—Ç—ã –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞');\n02067|               console.error('pickup Date object:', pickupDate);\n02068|               console.error('arrival Date object:', arrivalDate);\n02069|             }\n02070|           } else {\n02071|             console.warn('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ - –ù–µ –Ω–∞–π–¥–µ–Ω—ã –¥–∞—Ç—ã pickup –∏–ª–∏ arrivalToOspReceiver');\n02072|             console.log('pickup –Ω–∞–π–¥–µ–Ω:', !!pickup, pickup);\n02073|             console.log('arrivalToOspReceiver –Ω–∞–π–¥–µ–Ω:', !!arrivalToOspReceiver, arrivalToOspReceiver);\n02074|           }\n02075|         } catch (error) {\n02076|           console.error('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ - –û—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:', error);\n02077|         }\n02078| \n02079|         console.log('üí∞ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ò–¢–û–ì–û–í–ê–Ø –°–¢–û–ò–ú–û–°–¢–¨:', Math.round(totalPrice));\n02080|         \n02081|         return {\n02082|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n02083|           price: Math.round(totalPrice),\n02084|           days: deliveryDays || 0,\n02085|           details: data.data || {},\n02086|           requestData,\n02087|           responseData: data,\n02088|           apiUrl,\n02089|           sessionId: sessionID\n02090|         };\n02091|       } else {\n02092|         const errorMessage = data.metadata?.detail || \n02093|                            data.metadata?.message || \n02094|                            data.errors?.[0]?.detail || \n02095|                            (data.metadata?.status !== 200 ? `HTTP ${data.metadata?.status}` : '') ||\n02096|                            '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏';\n02097|         return {\n02098|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n02099|           price: 0,\n02100|           days: 0,\n02101|           error: errorMessage,\n02102|           requestData,\n02103|           responseData: data,\n02104|           apiUrl,\n02105|           sessionId: sessionID\n02106|         };\n02107|       }\n02108|     } catch (error: any) {\n02109|       return {\n02110|         company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n02111|         price: 0,\n02112|         days: 0,\n02113|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n02114|         requestData: null,\n02115|         responseData: null,\n02116|         apiUrl\n02117|       };\n02118|     }\n02119|   };\n02120| \n02121| \n02122| \n02123|   // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–Ω–æ–π –∑–æ–Ω—ã –∏ —Å–∫–ª–∞–¥–∞ –ü–≠–ö –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏\n02124|   const getPekZoneByAddress = async (address: string) => {\n02125|     try {\n02126|       console.log(`üîç –ü–≠–ö: –ø–æ–∏—Å–∫ –∑–æ–Ω—ã –¥–ª—è –∞–¥—Ä–µ—Å–∞ \"${address}\"`);\n02127| \n02128|       const result = await enhancedApiRequest(\n02129|         '/api/pek',\n02130|         {\n02131|           method: 'POST',\n02132|           headers: {\n02133|             'Content-Type': 'application/json',\n02134|           },\n02135|           body: JSON.stringify({\n02136|             method: 'findzonebyaddress',\n02137|             address: address\n02138|           })\n02139|         },\n02140|         { operation: 'findzonebyaddress', company: '–ü–≠–ö' }\n02141|       );\n02142| \n02143|       if (result && typeof result === 'object' && 'success' in result && !result.success) {\n02144|         console.error(`‚ùå –ü–≠–ö API –æ—à–∏–±–∫–∞:`, result.error);\n02145|         console.log(`üîÑ –ü–≠–ö: –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ñ–æ–ª–ª–±—ç–∫ –º–µ—Ç–æ–¥—É –¥–ª—è \"${address}\"`);\n02146|         return getPekZoneFallback(address);\n02147|       }\n02148| \n02149|       const response = result as Response;\n02150|       console.log(`üì° –ü–≠–ö API —Å—Ç–∞—Ç—É—Å: ${response.status} ${response.statusText}`);\n02151| \n02152|       if (!response.ok) {\n02153|         let errorData;\n02154|         try {\n02155|           errorData = await response.json();\n02156|         } catch {\n02157|           errorData = { error: '–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–∞—Ä—Å–∏—Ç—å –æ—Ç–≤–µ—Ç' };\n02158|         }\n02159| \n02160|         console.error(`‚ùå –ü–≠–ö API –æ—à–∏–±–∫–∞ ${response.status}:`, errorData);\n02161| \n02162|         // –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫\n02163|         if (response.status === 401) {\n02164|           console.error('‚ùå –ü–≠–ö: –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω');\n02165|         } else if (response.status === 404) {\n02166|           console.error('‚ùå –ü–≠–ö: –ú–µ—Ç–æ–¥ API –Ω–µ –Ω–∞–π–¥–µ–Ω');\n02167|         } else if (response.status === 400) {\n02168|           console.error('‚ùå –ü–≠–ö: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞');\n02169|         } else if (response.status >= 500) {\n02170|           console.error('‚ùå –ü–≠–ö: –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ü–≠–ö');\n02171|         }\n02172| \n02173|         console.log(`üîÑ –ü–≠–ö: –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ñ–æ–ª–ª–±—ç–∫ –º–µ—Ç–æ–¥—É –¥–ª—è \"${address}\"`);\n02174|         return getPekZoneFallback(address);\n02175|       }\n02176| \n02177|       const data = await response.json();\n02178|       console.log(`‚úÖ –ü–≠–ö –∑–æ–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞:`, data);\n02179| \n02180|       if (data.zoneId && data.mainWarehouseId) {\n02181|         return {\n02182|           zoneId: data.zoneId,\n02183|           zoneName: data.zoneName,\n02184|           branchUID: data.branchUID,\n02185|           branchCode: data.branchCode,\n02186|           branchTitle: data.branchTitle,\n02187|           mainWarehouseId: data.mainWarehouseId,\n02188|           warehousePoint: data.warehousePoint,\n02189|           geoData: data.GeoData,\n02190|           precision: data.GeoData?.precision\n02191|         };\n02192|       }\n02193| \n02194|       console.warn(`‚ö†Ô∏è –ü–≠–ö: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç:`, data);\n02195|       return getPekZoneFallback(address);\n02196| \n02197|     } catch (error) {\n02198|       console.error('‚ùå –ü–≠–ö: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∑–æ–Ω—ã:', error);\n02199|       return getPekZoneFallback(address);\n02200|     }\n\n(File has more lines. Use 'offset' parameter to read beyond line 2200)\n</file>",
    "title": "app/page.tsx",
    "metadata": {
      "preview": "            data.data.packages.forEach((pkg: any, index: number) => {\n              console.log(`üí∞ Package [${index}] (–≤–∫–ª—é—á–µ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å):`, pkg);\n            });\n          } else {\n            Object.entries(data.data.packages).forEach(([key, pkg]: [string, any]) => {\n              console.log(`üí∞ Package [${key}] (–≤–∫–ª—é—á–µ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å):`, pkg);\n            });\n          }\n        } else {\n          console.log('üí∞ ‚ùå –£–ø–∞–∫–æ–≤–∫–∞ –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∞—Å—å');\n        }\n\n        // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–∞–∫ —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –¥–∞—Ç–∞–º–∏ pickup –∏ arrivalToOspReceiver\n        let deliveryDays = 0;\n        try {\n          console.log('=== –ü–û–ò–°–ö –î–ê–¢ –í –û–¢–í–ï–¢–ï ===');\n          \n          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –º–µ—Å—Ç–∞ –≥–¥–µ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–∞—Ç—ã\n          console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data.data?.pickup:', data.data?.pickup);\n          console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º data.pickup:', data.pickup);"
    },
    "time": {
      "start": 1763963350579,
      "end": 1763963350583
    }
  }
}