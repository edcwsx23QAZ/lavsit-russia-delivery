{
  "id": "prt_98d1f47b7001gy3fdi7Ag8LvvM",
  "messageID": "msg_98d1c8257001tXyH32kmscqHU2",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "edit",
  "callID": "toolu_01AxsabyeuYhuh879xaWtS71",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/diagnostic/page.tsx",
      "oldString": "  const testVozovozAPI = async () => {\n    setIsTestingVozovoz(true);\n    const startTime = Date.now();\n    \n    try {\n      console.log('ðŸ”§ ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÑƒ Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API...');\n      \n      const testData = {\n        object: \"price\",\n        action: \"get\",\n        params: {\n          cargo: {\n            dimension: {\n              quantity: 1,\n              volume: 0.1,\n              weight: 10\n            }\n          },\n          gateway: {\n            dispatch: {\n              point: {\n                location: \"ÐœÐ¾ÑÐºÐ²Ð°\",\n                terminal: \"default\"\n              }\n            },\n            destination: {\n              point: {\n                location: \"Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³\",\n                terminal: \"default\"\n              }\n            }\n          }\n        }\n      };\n\n      const response = await fetch('/api/vozovoz', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(testData)\n      });\n\n      const data = await response.json();\n      const timing = Date.now() - startTime;\n\n      console.log('ðŸ”§ Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ð¾Ñ‚Ð²ÐµÑ‚:', data);\n\n      if (response.ok && data.response) {\n        updateResult('vozovoz', {\n          status: 'success',\n          message: `Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½ Ñ‚Ð°Ñ€Ð¸Ñ„: ${data.response?.price || 'N/A'} â‚½`,\n          details: data.response,\n          response: data,\n          requestData: testData,\n          timing\n        });\n      } else {\n        updateResult('vozovoz', {\n          status: 'warning',\n          message: `Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ð²ÐµÑ€Ð½ÑƒÐ» Ð¾ÑˆÐ¸Ð±ÐºÑƒ: ${data.error || 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°'}`,\n          details: data.details,\n          response: data,\n          requestData: testData,\n          timing\n        });\n      }\n    } catch (error: any) {\n      console.error('ðŸ”§ Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ð¾ÑˆÐ¸Ð±ÐºÐ°:', error);\n      updateResult('vozovoz', {\n        status: 'error',\n        message: `ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API: ${error.message}`,\n        details: error,\n        timing: Date.now() - startTime\n      });\n    } finally {\n      setIsTestingVozovoz(false);\n    }\n  };",
      "newString": "  const testVozovozAPI = async () => {\n    setIsTestingVozovoz(true);\n    const startTime = Date.now();\n    \n    try {\n      console.log('ðŸ”§ ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÑƒ Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API...');\n      \n      const testData = {\n        object: \"price\",\n        action: \"get\",\n        params: {\n          cargo: {\n            dimension: {\n              quantity: 1,\n              volume: 0.1,\n              weight: 10\n            }\n          },\n          gateway: {\n            dispatch: {\n              point: {\n                location: \"ÐœÐ¾ÑÐºÐ²Ð°\",\n                terminal: \"default\"\n              }\n            },\n            destination: {\n              point: {\n                location: \"Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³\",\n                terminal: \"default\"\n              }\n            }\n          }\n        }\n      };\n\n      const response = await fetch('/api/vozovoz', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(testData)\n      });\n\n      const data = await response.json();\n      const timing = Date.now() - startTime;\n\n      console.log('ðŸ”§ Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ð¾Ñ‚Ð²ÐµÑ‚:', data);\n\n      if (response.ok && data.response) {\n        updateResult('vozovoz', {\n          status: 'success',\n          message: `Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½ Ñ‚Ð°Ñ€Ð¸Ñ„: ${data.response?.price || 'N/A'} â‚½`,\n          details: data.response,\n          response: data,\n          requestData: testData,\n          timing\n        });\n      } else {\n        updateResult('vozovoz', {\n          status: 'warning',\n          message: `Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ð²ÐµÑ€Ð½ÑƒÐ» Ð¾ÑˆÐ¸Ð±ÐºÑƒ: ${data.error || 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°'}`,\n          details: data.details,\n          response: data,\n          requestData: testData,\n          timing\n        });\n      }\n    } catch (error: any) {\n      console.error('ðŸ”§ Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API Ð¾ÑˆÐ¸Ð±ÐºÐ°:', error);\n      updateResult('vozovoz', {\n        status: 'error',\n        message: `ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð’Ð¾Ð·Ð¾Ð²Ð¾Ð· API: ${error.message}`,\n        details: error,\n        timing: Date.now() - startTime\n      });\n    } finally {\n      setIsTestingVozovoz(false);\n    }\n  };\n\n  const testNordWheelAPI = async () => {\n    setIsTestingNordWheel(true);\n    const startTime = Date.now();\n    \n    try {\n      console.log('ðŸ”§ ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÑƒ Nord Wheel API...');\n      \n      const params = new URLSearchParams({\n        from: '91', // ÐœÐ¾ÑÐºÐ²Ð°\n        to: '92', // Ð¡ÐŸÐ±\n        pickup: '0',\n        deliver: '0',\n        weight: '10',\n        volume: '0.1',\n        oversized: '0',\n        package: '0',\n        packageCount: '1',\n        insurance: '0',\n        sum: '50000',\n        documentsReturn: '0',\n        fragile: '1',\n        length: '1',\n        width: '1',\n        height: '1'\n      });\n\n      const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n      const fullUrl = `${apiUrl}?${params.toString()}`;\n      \n      const response = await fetch(fullUrl);\n      const data = await response.json();\n      const timing = Date.now() - startTime;\n\n      console.log('ðŸ”§ Nord Wheel API Ð¾Ñ‚Ð²ÐµÑ‚:', data);\n\n      if (response.ok && data.status === 'success' && data.data) {\n        updateResult('nordwheel', {\n          status: 'success',\n          message: `Nord Wheel API Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½ Ñ‚Ð°Ñ€Ð¸Ñ„: ${data.data?.total || 'N/A'} â‚½`,\n          details: data.data,\n          response: data,\n          requestData: Object.fromEntries(params),\n          timing\n        });\n      } else {\n        updateResult('nordwheel', {\n          status: 'warning',\n          message: `Nord Wheel API Ð²ÐµÑ€Ð½ÑƒÐ» Ð¾ÑˆÐ¸Ð±ÐºÑƒ: ${data.error || data.message || 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°'}`,\n          details: data.details,\n          response: data,\n          requestData: Object.fromEntries(params),\n          timing\n        });\n      }\n    } catch (error: any) {\n      console.error('ðŸ”§ Nord Wheel API Ð¾ÑˆÐ¸Ð±ÐºÐ°:', error);\n      updateResult('nordwheel', {\n        status: 'error',\n        message: `ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° Nord Wheel API: ${error.message}`,\n        details: error,\n        timing: Date.now() - startTime\n      });\n    } finally {\n      setIsTestingNordWheel(false);\n    }\n  };"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "diff": "Index: /home/user/project/app/diagnostic/page.tsx\n===================================================================\n--- /home/user/project/app/diagnostic/page.tsx\n+++ /home/user/project/app/diagnostic/page.tsx\n@@ -319,8 +319,75 @@\n     setIsTestingVozovoz(false);\n   }\n };\n \n+const testNordWheelAPI = async () => {\n+  setIsTestingNordWheel(true);\n+  const startTime = Date.now();\n+  \n+  try {\n+    console.log('ðŸ”§ ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÑƒ Nord Wheel API...');\n+    \n+    const params = new URLSearchParams({\n+      from: '91', // ÐœÐ¾ÑÐºÐ²Ð°\n+      to: '92', // Ð¡ÐŸÐ±\n+      pickup: '0',\n+      deliver: '0',\n+      weight: '10',\n+      volume: '0.1',\n+      oversized: '0',\n+      package: '0',\n+      packageCount: '1',\n+      insurance: '0',\n+      sum: '50000',\n+      documentsReturn: '0',\n+      fragile: '1',\n+      length: '1',\n+      width: '1',\n+      height: '1'\n+    });\n+\n+    const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n+    const fullUrl = `${apiUrl}?${params.toString()}`;\n+    \n+    const response = await fetch(fullUrl);\n+    const data = await response.json();\n+    const timing = Date.now() - startTime;\n+\n+    console.log('ðŸ”§ Nord Wheel API Ð¾Ñ‚Ð²ÐµÑ‚:', data);\n+\n+    if (response.ok && data.status === 'success' && data.data) {\n+      updateResult('nordwheel', {\n+        status: 'success',\n+        message: `Nord Wheel API Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½ Ñ‚Ð°Ñ€Ð¸Ñ„: ${data.data?.total || 'N/A'} â‚½`,\n+        details: data.data,\n+        response: data,\n+        requestData: Object.fromEntries(params),\n+        timing\n+      });\n+    } else {\n+      updateResult('nordwheel', {\n+        status: 'warning',\n+        message: `Nord Wheel API Ð²ÐµÑ€Ð½ÑƒÐ» Ð¾ÑˆÐ¸Ð±ÐºÑƒ: ${data.error || data.message || 'ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°'}`,\n+        details: data.details,\n+        response: data,\n+        requestData: Object.fromEntries(params),\n+        timing\n+      });\n+    }\n+  } catch (error: any) {\n+    console.error('ðŸ”§ Nord Wheel API Ð¾ÑˆÐ¸Ð±ÐºÐ°:', error);\n+    updateResult('nordwheel', {\n+      status: 'error',\n+      message: `ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° Nord Wheel API: ${error.message}`,\n+      details: error,\n+      timing: Date.now() - startTime\n+    });\n+  } finally {\n+    setIsTestingNordWheel(false);\n+  }\n+};\n+\n const testAllAPIs = async () => {\n   await Promise.all([\n     testPEKAPI(),\n     testDellinAPI(), \n"
    },
    "title": "app/diagnostic/page.tsx",
    "time": {
      "start": 1759009281165,
      "end": 1759009281176
    }
  }
}