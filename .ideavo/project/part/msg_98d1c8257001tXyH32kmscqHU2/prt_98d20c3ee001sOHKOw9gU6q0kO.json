{
  "id": "prt_98d20c3ee001sOHKOw9gU6q0kO",
  "messageID": "msg_98d1c8257001tXyH32kmscqHU2",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "edit",
  "callID": "toolu_01AFZH6RJbkgLogjGicny9Fx",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/diagnostic/page.tsx",
      "oldString": "        <div className=\"flex gap-4 mb-6\">\n          <Button onClick={testAllAPIs} className=\"bg-blue-600 hover:bg-blue-700\">\n            <Activity className=\"h-4 w-4 mr-2\" />\n            Тестировать все API\n          </Button>\n          <Button onClick={() => window.open('/env-check', '_blank')} variant=\"outline\">\n            <Building2 className=\"h-4 w-4 mr-2\" />\n            Проверить переменные окружения\n          </Button>\n          <Button onClick={() => window.close()} variant=\"outline\">\n            Закрыть\n          </Button>\n        </div>",
      "newString": "        <div className=\"flex gap-4 mb-6 flex-wrap\">\n          <Button onClick={testAllAPIs} className=\"bg-blue-600 hover:bg-blue-700\">\n            <Activity className=\"h-4 w-4 mr-2\" />\n            Тестировать все API\n          </Button>\n          <Button \n            onClick={runFullTesting} \n            disabled={isFullTesting}\n            className=\"bg-purple-600 hover:bg-purple-700\"\n          >\n            <TestTube className=\"h-4 w-4 mr-2\" />\n            {isFullTesting ? 'Полное тестирование...' : 'Полное тестирование'}\n          </Button>\n          <Button onClick={() => window.open('/env-check', '_blank')} variant=\"outline\">\n            <Building2 className=\"h-4 w-4 mr-2\" />\n            Проверить переменные окружения\n          </Button>\n          <Button onClick={() => window.close()} variant=\"outline\">\n            Закрыть\n          </Button>\n        </div>\n\n        {/* Результаты полного тестирования */}\n        {fullTestResults && (\n          <Card className=\"border-gray-700 bg-gray-900 mb-6\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <TestTube className=\"h-5 w-5 text-purple-400\" />\n                Результаты полного тестирования\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-blue-400\">{fullTestResults.summary.totalTests}</div>\n                  <div className=\"text-sm text-gray-400\">Всего тестов</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-green-400\">{fullTestResults.summary.successful}</div>\n                  <div className=\"text-sm text-gray-400\">Успешных</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-red-400\">{fullTestResults.summary.failed}</div>\n                  <div className=\"text-sm text-gray-400\">Неудачных</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-yellow-400\">\n                    {((fullTestResults.summary.successful / fullTestResults.summary.totalTests) * 100).toFixed(1)}%\n                  </div>\n                  <div className=\"text-sm text-gray-400\">Успешность</div>\n                </div>\n              </div>\n              \n              {fullTestResults.summary.errors.length > 0 && (\n                <Alert className=\"border-red-500 bg-red-900/20 mb-4\">\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <AlertDescription>\n                    <div className=\"font-medium mb-2\">Найденные ошибки:</div>\n                    <ul className=\"list-disc list-inside text-sm space-y-1\">\n                      {fullTestResults.summary.errors.slice(0, 10).map((error, index) => (\n                        <li key={index}>{error}</li>\n                      ))}\n                      {fullTestResults.summary.errors.length > 10 && (\n                        <li>... и еще {fullTestResults.summary.errors.length - 10} ошибок</li>\n                      )}\n                    </ul>\n                  </AlertDescription>\n                </Alert>\n              )}\n              \n              <details className=\"mt-4\">\n                <summary className=\"cursor-pointer text-sm font-medium\">Подробные результаты</summary>\n                <div className=\"mt-2 max-h-96 overflow-y-auto\">\n                  <pre className=\"text-xs p-2 bg-gray-800 rounded\">\n                    {JSON.stringify(fullTestResults.details, null, 2)}\n                  </pre>\n                </div>\n              </details>\n            </CardContent>\n          </Card>\n        )}"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "diff": "Index: /home/user/project/app/diagnostic/page.tsx\n===================================================================\n--- /home/user/project/app/diagnostic/page.tsx\n+++ /home/user/project/app/diagnostic/page.tsx\n@@ -764,13 +764,21 @@\n   <h1 className=\"text-3xl font-bold mb-2\">Диагностика транспортных компаний</h1>\n   <p className=\"text-gray-400\">Проверка работоспособности API всех подключенных ТК</p>\n </div>\n \n-<div className=\"flex gap-4 mb-6\">\n+<div className=\"flex gap-4 mb-6 flex-wrap\">\n   <Button onClick={testAllAPIs} className=\"bg-blue-600 hover:bg-blue-700\">\n     <Activity className=\"h-4 w-4 mr-2\" />\n     Тестировать все API\n   </Button>\n+  <Button \n+    onClick={runFullTesting} \n+    disabled={isFullTesting}\n+    className=\"bg-purple-600 hover:bg-purple-700\"\n+  >\n+    <TestTube className=\"h-4 w-4 mr-2\" />\n+    {isFullTesting ? 'Полное тестирование...' : 'Полное тестирование'}\n+  </Button>\n   <Button onClick={() => window.open('/env-check', '_blank')} variant=\"outline\">\n     <Building2 className=\"h-4 w-4 mr-2\" />\n     Проверить переменные окружения\n   </Button>\n@@ -778,8 +786,68 @@\n     Закрыть\n   </Button>\n </div>\n \n+{/* Результаты полного тестирования */}\n+{fullTestResults && (\n+  <Card className=\"border-gray-700 bg-gray-900 mb-6\">\n+    <CardHeader>\n+      <CardTitle className=\"flex items-center gap-2\">\n+        <TestTube className=\"h-5 w-5 text-purple-400\" />\n+        Результаты полного тестирования\n+      </CardTitle>\n+    </CardHeader>\n+    <CardContent>\n+      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\">\n+        <div className=\"text-center\">\n+          <div className=\"text-2xl font-bold text-blue-400\">{fullTestResults.summary.totalTests}</div>\n+          <div className=\"text-sm text-gray-400\">Всего тестов</div>\n+        </div>\n+        <div className=\"text-center\">\n+          <div className=\"text-2xl font-bold text-green-400\">{fullTestResults.summary.successful}</div>\n+          <div className=\"text-sm text-gray-400\">Успешных</div>\n+        </div>\n+        <div className=\"text-center\">\n+          <div className=\"text-2xl font-bold text-red-400\">{fullTestResults.summary.failed}</div>\n+          <div className=\"text-sm text-gray-400\">Неудачных</div>\n+        </div>\n+        <div className=\"text-center\">\n+          <div className=\"text-2xl font-bold text-yellow-400\">\n+            {((fullTestResults.summary.successful / fullTestResults.summary.totalTests) * 100).toFixed(1)}%\n+          </div>\n+          <div className=\"text-sm text-gray-400\">Успешность</div>\n+        </div>\n+      </div>\n+      \n+      {fullTestResults.summary.errors.length > 0 && (\n+        <Alert className=\"border-red-500 bg-red-900/20 mb-4\">\n+          <AlertCircle className=\"h-4 w-4\" />\n+          <AlertDescription>\n+            <div className=\"font-medium mb-2\">Найденные ошибки:</div>\n+            <ul className=\"list-disc list-inside text-sm space-y-1\">\n+              {fullTestResults.summary.errors.slice(0, 10).map((error, index) => (\n+                <li key={index}>{error}</li>\n+              ))}\n+              {fullTestResults.summary.errors.length > 10 && (\n+                <li>... и еще {fullTestResults.summary.errors.length - 10} ошибок</li>\n+              )}\n+            </ul>\n+          </AlertDescription>\n+        </Alert>\n+      )}\n+      \n+      <details className=\"mt-4\">\n+        <summary className=\"cursor-pointer text-sm font-medium\">Подробные результаты</summary>\n+        <div className=\"mt-2 max-h-96 overflow-y-auto\">\n+          <pre className=\"text-xs p-2 bg-gray-800 rounded\">\n+            {JSON.stringify(fullTestResults.details, null, 2)}\n+          </pre>\n+        </div>\n+      </details>\n+    </CardContent>\n+  </Card>\n+)}\n+\n <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n   {/* ПЭК */}\n   <Card className=\"border-gray-700 bg-gray-900\">\n     <CardHeader>\n"
    },
    "title": "app/diagnostic/page.tsx",
    "time": {
      "start": 1759009373188,
      "end": 1759009373201
    }
  }
}