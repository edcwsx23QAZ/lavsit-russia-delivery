{
  "id": "prt_98d1fa202001er2IihCMfgyV6k",
  "messageID": "msg_98d1c8257001tXyH32kmscqHU2",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "edit",
  "callID": "toolu_019VtMZk6GU5pB8Hev94nmKs",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/diagnostic/page.tsx",
      "oldString": "  const testAllAPIs = async () => {\n    await Promise.all([\n      testPEKAPI(),\n      testDellinAPI(), \n      testRailContinentAPI(),\n      testVozovozAPI()\n    ]);\n  };",
      "newString": "  const testAllAPIs = async () => {\n    await Promise.all([\n      testPEKAPI(),\n      testDellinAPI(), \n      testRailContinentAPI(),\n      testVozovozAPI(),\n      testNordWheelAPI()\n    ]);\n  };\n\n  // üîß –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç\n  const generateTestCargos = (count: number) => {\n    const cargos = [];\n    for (let i = 0; i < count; i++) {\n      cargos.push({\n        length: 50 + Math.floor(Math.random() * 150), // 50-200 —Å–º\n        width: 30 + Math.floor(Math.random() * 120),  // 30-150 —Å–º  \n        height: 20 + Math.floor(Math.random() * 180), // 20-200 —Å–º\n        weight: 5 + Math.floor(Math.random() * 95)    // 5-100 –∫–≥\n      });\n    }\n    return cargos;\n  };\n\n  // üîß –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –æ–ø—Ü–∏–π\n  const generateOptionsCombinations = () => {\n    const combinations = [];\n    const options = [\n      { name: 'fromAddressDelivery', values: [true, false] },\n      { name: 'toAddressDelivery', values: [true, false] },\n      { name: 'needPackaging', values: [true, false] },\n      { name: 'needInsurance', values: [true, false] }\n    ];\n\n    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (2^4 = 16 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)\n    for (let i = 0; i < Math.pow(2, options.length); i++) {\n      const combination: any = {\n        fromCity: '–ú–æ—Å–∫–≤–∞',\n        toCity: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n        fromAddress: '—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1',\n        toAddress: '–ù–µ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç, 1',\n        declaredValue: 50000\n      };\n      \n      options.forEach((option, index) => {\n        combination[option.name] = Boolean(i & (1 << index));\n      });\n      \n      combinations.push(combination);\n    }\n    \n    return combinations;\n  };\n\n  // üîß –§—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–¥–Ω–æ–π –¢–ö —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏\n  const testSingleTK = async (tkName: string, testData: any) => {\n    const startTime = Date.now();\n    let apiUrl = '';\n    let requestData: any = {};\n    \n    try {\n      switch (tkName) {\n        case 'pek':\n          apiUrl = '/api/pek';\n          requestData = { method: 'calculateprice', ...testData };\n          break;\n        case 'dellin':\n          // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–π —Ä–∞—Å—á–µ—Ç –∫–∞–∫ –≤ –≥–ª–∞–≤–Ω–æ–º –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ\n          apiUrl = 'DELLIN_DIRECT';\n          requestData = testData;\n          break;\n        case 'railcontinent':\n          apiUrl = '/api/rail-continent';\n          requestData = {\n            city_sender: testData.fromCity,\n            city_receiver: testData.toCity,\n            weight: testData.cargos.reduce((sum: number, cargo: any) => sum + cargo.weight, 0),\n            volume: testData.cargos.reduce((sum: number, cargo: any) => \n              sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n            ),\n            quantity: testData.cargos.length, // üîß –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä\n            length: Math.max(...testData.cargos.map((c: any) => c.length)) / 100,\n            width: Math.max(...testData.cargos.map((c: any) => c.width)) / 100,\n            height: Math.max(...testData.cargos.map((c: any) => c.height)) / 100,\n            declared_cost: testData.declaredValue,\n            pickup: testData.fromAddressDelivery ? '1' : '0',\n            delivery: testData.toAddressDelivery ? '1' : '0',\n            packaging: testData.needPackaging ? '1' : '0',\n            insurance: testData.needInsurance ? '1' : '0',\n            tariff: 'auto'\n          };\n          break;\n        case 'vozovoz':\n          apiUrl = '/api/vozovoz';\n          requestData = {\n            object: \"price\",\n            action: \"get\",\n            params: {\n              cargo: {\n                dimension: {\n                  quantity: testData.cargos.length,\n                  volume: testData.cargos.reduce((sum: number, cargo: any) => \n                    sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n                  ),\n                  weight: testData.cargos.reduce((sum: number, cargo: any) => sum + cargo.weight, 0)\n                },\n                ...(testData.needInsurance && testData.declaredValue > 0 ? {\n                  insurance: testData.declaredValue\n                } : {}),\n                ...(testData.needPackaging ? {\n                  wrapping: {\n                    palletCollar: testData.cargos.reduce((sum: number, cargo: any) => \n                      sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n                    )\n                  }\n                } : {})\n              },\n              gateway: {\n                dispatch: {\n                  point: {\n                    location: testData.fromCity,\n                    ...(testData.fromAddressDelivery ? {\n                      address: testData.fromAddress || \"–∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\"\n                    } : {\n                      terminal: \"default\"\n                    })\n                  }\n                },\n                destination: {\n                  point: {\n                    location: testData.toCity,\n                    ...(testData.toAddressDelivery ? {\n                      address: testData.toAddress || \"–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω–∏—è\"\n                    } : {\n                      terminal: \"default\"\n                    })\n                  }\n                }\n              }\n            }\n          };\n          break;\n        case 'nordwheel':\n          const totalWeight = testData.cargos.reduce((sum: number, cargo: any) => sum + cargo.weight, 0);\n          const totalVolume = testData.cargos.reduce((sum: number, cargo: any) => \n            sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n          );\n          const maxLength = Math.max(...testData.cargos.map((c: any) => c.length));\n          const maxWidth = Math.max(...testData.cargos.map((c: any) => c.width));\n          const maxHeight = Math.max(...testData.cargos.map((c: any) => c.height));\n          const isOversized = maxLength > 200 || maxWidth > 200 || maxHeight > 200 || totalWeight > 1000;\n          \n          const params = new URLSearchParams({\n            from: '91',\n            to: '92',\n            pickup: testData.fromAddressDelivery ? '1' : '0',\n            deliver: testData.toAddressDelivery ? '1' : '0',\n            weight: totalWeight.toString(),\n            volume: totalVolume.toString(),\n            oversized: isOversized ? '1' : '0',\n            package: testData.needPackaging ? '1' : '0',\n            packageCount: testData.cargos.length.toString(),\n            insurance: testData.needInsurance ? '1' : '0',\n            sum: testData.declaredValue.toString(),\n            documentsReturn: '0',\n            fragile: '1',\n            length: (maxLength / 100).toString(),\n            width: (maxWidth / 100).toString(),\n            height: (maxHeight / 100).toString(),\n            multiplePackages: testData.cargos.length > 1 ? '1' : '0'\n          });\n          \n          apiUrl = `https://nordw.ru/tools/api/calc/calculate/?${params.toString()}`;\n          requestData = Object.fromEntries(params);\n          break;\n      }\n\n      let response: any;\n      let data: any;\n\n      if (tkName === 'nordwheel') {\n        response = await fetch(apiUrl);\n        data = await response.json();\n      } else if (tkName === 'dellin') {\n        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –≤ –º–∞—Å—Å–æ–≤–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n        return {\n          tk: tkName,\n          status: 'skipped',\n          message: '–ü—Ä–æ–ø—É—â–µ–Ω–æ (—Å–ª–æ–∂–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)',\n          timing: Date.now() - startTime,\n          requestData,\n          cargoCount: testData.cargos.length\n        };\n      } else {\n        response = await fetch(apiUrl, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(requestData)\n        });\n        data = await response.json();\n      }\n\n      const timing = Date.now() - startTime;\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¢–ö\n      let isSuccess = false;\n      let price = 0;\n      \n      switch (tkName) {\n        case 'pek':\n          isSuccess = response.ok && data.success;\n          price = data.data?.price || 0;\n          break;\n        case 'railcontinent':\n          isSuccess = response.ok && data.result === 'success';\n          price = data.data?.auto?.priceTotal || 0;\n          break;\n        case 'vozovoz':\n          isSuccess = response.ok && data.response;\n          price = data.response?.price || 0;\n          break;\n        case 'nordwheel':\n          isSuccess = response.ok && data.status === 'success' && data.data;\n          price = data.data?.total || 0;\n          break;\n      }\n\n      return {\n        tk: tkName,\n        status: isSuccess ? 'success' : 'error',\n        message: isSuccess ? `–¢–∞—Ä–∏—Ñ: ${price} ‚ÇΩ` : (data.error || data.message || '–û—à–∏–±–∫–∞'),\n        timing,\n        price,\n        requestData,\n        responseData: data,\n        cargoCount: testData.cargos.length\n      };\n\n    } catch (error: any) {\n      return {\n        tk: tkName,\n        status: 'error',\n        message: `–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`,\n        timing: Date.now() - startTime,\n        requestData,\n        cargoCount: testData.cargos.length,\n        error: error.message\n      };\n    }\n  };\n\n  // üîß –ü–û–õ–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï\n  const runFullTesting = async () => {\n    setIsFullTesting(true);\n    setFullTestResults(null);\n    \n    const allResults: any[] = [];\n    const errors: string[] = [];\n    let totalTests = 0;\n    let successful = 0;\n    \n    console.log('üß™ ===== –ù–ê–ß–ê–õ–û –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø =====');\n    \n    try {\n      const transportCompanies = ['pek', 'railcontinent', 'vozovoz', 'nordwheel'];\n      const cargoCountTests = [1, 2, 3, 5, 10, 20, 50]; // –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ 50 –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç\n      const optionCombinations = generateOptionsCombinations();\n      \n      console.log(`üß™ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤: ${transportCompanies.length} –¢–ö √ó ${cargoCountTests.length} –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –º–µ—Å—Ç √ó ${optionCombinations.length} –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –æ–ø—Ü–∏–π = ${transportCompanies.length * cargoCountTests.length * optionCombinations.length}`);\n      \n      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏\n      const maxTestsPerTK = 20; // 20 —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –¢–ö (–≤–º–µ—Å—Ç–æ –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)\n      \n      for (const tk of transportCompanies) {\n        console.log(`üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ${tk.toUpperCase()}...`);\n        let testsForTK = 0;\n        \n        // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–ª–∏—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç\n        for (const cargoCount of cargoCountTests) {\n          if (testsForTK >= maxTestsPerTK) break;\n          \n          // –í—ã–±–∏—Ä–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –æ–ø—Ü–∏–π (–Ω–µ –≤—Å–µ, –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏)\n          const selectedCombinations = optionCombinations.slice(0, Math.min(3, Math.floor(maxTestsPerTK / cargoCountTests.length)));\n          \n          for (const options of selectedCombinations) {\n            if (testsForTK >= maxTestsPerTK) break;\n            \n            const testData = {\n              ...options,\n              cargos: generateTestCargos(cargoCount)\n            };\n            \n            console.log(`üß™ ${tk}: ${cargoCount} –º–µ—Å—Ç, –æ–ø—Ü–∏–∏: [${Object.entries(options).filter(([k, v]) => typeof v === 'boolean' && v).map(([k, v]) => k).join(', ') || '–±–∞–∑–æ–≤—ã–µ'}]`);\n            \n            const result = await testSingleTK(tk, testData);\n            allResults.push(result);\n            totalTests++;\n            testsForTK++;\n            \n            if (result.status === 'success') {\n              successful++;\n              console.log(`‚úÖ ${tk}: ${result.message} (${result.timing}ms)`);\n            } else if (result.status === 'skipped') {\n              console.log(`‚è≠Ô∏è ${tk}: ${result.message}`);\n            } else {\n              console.log(`‚ùå ${tk}: ${result.message} (${result.timing}ms)`);\n              errors.push(`${tk}: ${result.message}`);\n            }\n            \n            // –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏\n            await new Promise(resolve => setTimeout(resolve, 100));\n          }\n        }\n      }\n      \n      const summary = {\n        totalTests,\n        successful,\n        failed: totalTests - successful,\n        errors\n      };\n      \n      setFullTestResults({\n        summary,\n        details: allResults\n      });\n      \n      console.log('üß™ ===== –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø =====');\n      console.log(`üìä –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: ${totalTests}`);\n      console.log(`‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö: ${successful}`);\n      console.log(`‚ùå –ù–µ—É–¥–∞—á–Ω—ã—Ö: ${totalTests - successful}`);\n      console.log(`üìà –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: ${((successful / totalTests) * 100).toFixed(1)}%`);\n      \n      if (errors.length > 0) {\n        console.log('‚ùå –û—à–∏–±–∫–∏:');\n        errors.forEach(error => console.log(`   - ${error}`));\n      }\n      \n    } catch (error: any) {\n      console.error('üß™ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', error);\n      errors.push(`–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`);\n      \n      setFullTestResults({\n        summary: { totalTests, successful, failed: totalTests - successful, errors },\n        details: allResults\n      });\n    } finally {\n      setIsFullTesting(false);\n      console.log('üß™ ===== –ö–û–ù–ï–¶ –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø =====');\n    }\n  };"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "diff": "Index: /home/user/project/app/diagnostic/page.tsx\n===================================================================\n--- /home/user/project/app/diagnostic/page.tsx\n+++ /home/user/project/app/diagnostic/page.tsx\n@@ -391,12 +391,355 @@\n   await Promise.all([\n     testPEKAPI(),\n     testDellinAPI(), \n     testRailContinentAPI(),\n-    testVozovozAPI()\n+    testVozovozAPI(),\n+    testNordWheelAPI()\n   ]);\n };\n \n+// üîß –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç\n+const generateTestCargos = (count: number) => {\n+  const cargos = [];\n+  for (let i = 0; i < count; i++) {\n+    cargos.push({\n+      length: 50 + Math.floor(Math.random() * 150), // 50-200 —Å–º\n+      width: 30 + Math.floor(Math.random() * 120),  // 30-150 —Å–º  \n+      height: 20 + Math.floor(Math.random() * 180), // 20-200 —Å–º\n+      weight: 5 + Math.floor(Math.random() * 95)    // 5-100 –∫–≥\n+    });\n+  }\n+  return cargos;\n+};\n+\n+// üîß –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –æ–ø—Ü–∏–π\n+const generateOptionsCombinations = () => {\n+  const combinations = [];\n+  const options = [\n+    { name: 'fromAddressDelivery', values: [true, false] },\n+    { name: 'toAddressDelivery', values: [true, false] },\n+    { name: 'needPackaging', values: [true, false] },\n+    { name: 'needInsurance', values: [true, false] }\n+  ];\n+\n+  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (2^4 = 16 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)\n+  for (let i = 0; i < Math.pow(2, options.length); i++) {\n+    const combination: any = {\n+      fromCity: '–ú–æ—Å–∫–≤–∞',\n+      toCity: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n+      fromAddress: '—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1',\n+      toAddress: '–ù–µ–≤—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç, 1',\n+      declaredValue: 50000\n+    };\n+    \n+    options.forEach((option, index) => {\n+      combination[option.name] = Boolean(i & (1 << index));\n+    });\n+    \n+    combinations.push(combination);\n+  }\n+  \n+  return combinations;\n+};\n+\n+// üîß –§—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–¥–Ω–æ–π –¢–ö —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏\n+const testSingleTK = async (tkName: string, testData: any) => {\n+  const startTime = Date.now();\n+  let apiUrl = '';\n+  let requestData: any = {};\n+  \n+  try {\n+    switch (tkName) {\n+      case 'pek':\n+        apiUrl = '/api/pek';\n+        requestData = { method: 'calculateprice', ...testData };\n+        break;\n+      case 'dellin':\n+        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–π —Ä–∞—Å—á–µ—Ç –∫–∞–∫ –≤ –≥–ª–∞–≤–Ω–æ–º –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ\n+        apiUrl = 'DELLIN_DIRECT';\n+        requestData = testData;\n+        break;\n+      case 'railcontinent':\n+        apiUrl = '/api/rail-continent';\n+        requestData = {\n+          city_sender: testData.fromCity,\n+          city_receiver: testData.toCity,\n+          weight: testData.cargos.reduce((sum: number, cargo: any) => sum + cargo.weight, 0),\n+          volume: testData.cargos.reduce((sum: number, cargo: any) => \n+            sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n+          ),\n+          quantity: testData.cargos.length, // üîß –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä\n+          length: Math.max(...testData.cargos.map((c: any) => c.length)) / 100,\n+          width: Math.max(...testData.cargos.map((c: any) => c.width)) / 100,\n+          height: Math.max(...testData.cargos.map((c: any) => c.height)) / 100,\n+          declared_cost: testData.declaredValue,\n+          pickup: testData.fromAddressDelivery ? '1' : '0',\n+          delivery: testData.toAddressDelivery ? '1' : '0',\n+          packaging: testData.needPackaging ? '1' : '0',\n+          insurance: testData.needInsurance ? '1' : '0',\n+          tariff: 'auto'\n+        };\n+        break;\n+      case 'vozovoz':\n+        apiUrl = '/api/vozovoz';\n+        requestData = {\n+          object: \"price\",\n+          action: \"get\",\n+          params: {\n+            cargo: {\n+              dimension: {\n+                quantity: testData.cargos.length,\n+                volume: testData.cargos.reduce((sum: number, cargo: any) => \n+                  sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n+                ),\n+                weight: testData.cargos.reduce((sum: number, cargo: any) => sum + cargo.weight, 0)\n+              },\n+              ...(testData.needInsurance && testData.declaredValue > 0 ? {\n+                insurance: testData.declaredValue\n+              } : {}),\n+              ...(testData.needPackaging ? {\n+                wrapping: {\n+                  palletCollar: testData.cargos.reduce((sum: number, cargo: any) => \n+                    sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n+                  )\n+                }\n+              } : {})\n+            },\n+            gateway: {\n+              dispatch: {\n+                point: {\n+                  location: testData.fromCity,\n+                  ...(testData.fromAddressDelivery ? {\n+                    address: testData.fromAddress || \"–∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\"\n+                  } : {\n+                    terminal: \"default\"\n+                  })\n+                }\n+              },\n+              destination: {\n+                point: {\n+                  location: testData.toCity,\n+                  ...(testData.toAddressDelivery ? {\n+                    address: testData.toAddress || \"–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω–∏—è\"\n+                  } : {\n+                    terminal: \"default\"\n+                  })\n+                }\n+              }\n+            }\n+          }\n+        };\n+        break;\n+      case 'nordwheel':\n+        const totalWeight = testData.cargos.reduce((sum: number, cargo: any) => sum + cargo.weight, 0);\n+        const totalVolume = testData.cargos.reduce((sum: number, cargo: any) => \n+          sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n+        );\n+        const maxLength = Math.max(...testData.cargos.map((c: any) => c.length));\n+        const maxWidth = Math.max(...testData.cargos.map((c: any) => c.width));\n+        const maxHeight = Math.max(...testData.cargos.map((c: any) => c.height));\n+        const isOversized = maxLength > 200 || maxWidth > 200 || maxHeight > 200 || totalWeight > 1000;\n+        \n+        const params = new URLSearchParams({\n+          from: '91',\n+          to: '92',\n+          pickup: testData.fromAddressDelivery ? '1' : '0',\n+          deliver: testData.toAddressDelivery ? '1' : '0',\n+          weight: totalWeight.toString(),\n+          volume: totalVolume.toString(),\n+          oversized: isOversized ? '1' : '0',\n+          package: testData.needPackaging ? '1' : '0',\n+          packageCount: testData.cargos.length.toString(),\n+          insurance: testData.needInsurance ? '1' : '0',\n+          sum: testData.declaredValue.toString(),\n+          documentsReturn: '0',\n+          fragile: '1',\n+          length: (maxLength / 100).toString(),\n+          width: (maxWidth / 100).toString(),\n+          height: (maxHeight / 100).toString(),\n+          multiplePackages: testData.cargos.length > 1 ? '1' : '0'\n+        });\n+        \n+        apiUrl = `https://nordw.ru/tools/api/calc/calculate/?${params.toString()}`;\n+        requestData = Object.fromEntries(params);\n+        break;\n+    }\n+\n+    let response: any;\n+    let data: any;\n+\n+    if (tkName === 'nordwheel') {\n+      response = await fetch(apiUrl);\n+      data = await response.json();\n+    } else if (tkName === 'dellin') {\n+      // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –≤ –º–∞—Å—Å–æ–≤–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–∑-–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n+      return {\n+        tk: tkName,\n+        status: 'skipped',\n+        message: '–ü—Ä–æ–ø—É—â–µ–Ω–æ (—Å–ª–æ–∂–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)',\n+        timing: Date.now() - startTime,\n+        requestData,\n+        cargoCount: testData.cargos.length\n+      };\n+    } else {\n+      response = await fetch(apiUrl, {\n+        method: 'POST',\n+        headers: { 'Content-Type': 'application/json' },\n+        body: JSON.stringify(requestData)\n+      });\n+      data = await response.json();\n+    }\n+\n+    const timing = Date.now() - startTime;\n+\n+    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¢–ö\n+    let isSuccess = false;\n+    let price = 0;\n+    \n+    switch (tkName) {\n+      case 'pek':\n+        isSuccess = response.ok && data.success;\n+        price = data.data?.price || 0;\n+        break;\n+      case 'railcontinent':\n+        isSuccess = response.ok && data.result === 'success';\n+        price = data.data?.auto?.priceTotal || 0;\n+        break;\n+      case 'vozovoz':\n+        isSuccess = response.ok && data.response;\n+        price = data.response?.price || 0;\n+        break;\n+      case 'nordwheel':\n+        isSuccess = response.ok && data.status === 'success' && data.data;\n+        price = data.data?.total || 0;\n+        break;\n+    }\n+\n+    return {\n+      tk: tkName,\n+      status: isSuccess ? 'success' : 'error',\n+      message: isSuccess ? `–¢–∞—Ä–∏—Ñ: ${price} ‚ÇΩ` : (data.error || data.message || '–û—à–∏–±–∫–∞'),\n+      timing,\n+      price,\n+      requestData,\n+      responseData: data,\n+      cargoCount: testData.cargos.length\n+    };\n+\n+  } catch (error: any) {\n+    return {\n+      tk: tkName,\n+      status: 'error',\n+      message: `–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`,\n+      timing: Date.now() - startTime,\n+      requestData,\n+      cargoCount: testData.cargos.length,\n+      error: error.message\n+    };\n+  }\n+};\n+\n+// üîß –ü–û–õ–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï\n+const runFullTesting = async () => {\n+  setIsFullTesting(true);\n+  setFullTestResults(null);\n+  \n+  const allResults: any[] = [];\n+  const errors: string[] = [];\n+  let totalTests = 0;\n+  let successful = 0;\n+  \n+  console.log('üß™ ===== –ù–ê–ß–ê–õ–û –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø =====');\n+  \n+  try {\n+    const transportCompanies = ['pek', 'railcontinent', 'vozovoz', 'nordwheel'];\n+    const cargoCountTests = [1, 2, 3, 5, 10, 20, 50]; // –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ 50 –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç\n+    const optionCombinations = generateOptionsCombinations();\n+    \n+    console.log(`üß™ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤: ${transportCompanies.length} –¢–ö √ó ${cargoCountTests.length} –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –º–µ—Å—Ç √ó ${optionCombinations.length} –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –æ–ø—Ü–∏–π = ${transportCompanies.length * cargoCountTests.length * optionCombinations.length}`);\n+    \n+    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏\n+    const maxTestsPerTK = 20; // 20 —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –¢–ö (–≤–º–µ—Å—Ç–æ –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)\n+    \n+    for (const tk of transportCompanies) {\n+      console.log(`üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ${tk.toUpperCase()}...`);\n+      let testsForTK = 0;\n+      \n+      // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–ª–∏—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç\n+      for (const cargoCount of cargoCountTests) {\n+        if (testsForTK >= maxTestsPerTK) break;\n+        \n+        // –í—ã–±–∏—Ä–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –æ–ø—Ü–∏–π (–Ω–µ –≤—Å–µ, –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏)\n+        const selectedCombinations = optionCombinations.slice(0, Math.min(3, Math.floor(maxTestsPerTK / cargoCountTests.length)));\n+        \n+        for (const options of selectedCombinations) {\n+          if (testsForTK >= maxTestsPerTK) break;\n+          \n+          const testData = {\n+            ...options,\n+            cargos: generateTestCargos(cargoCount)\n+          };\n+          \n+          console.log(`üß™ ${tk}: ${cargoCount} –º–µ—Å—Ç, –æ–ø—Ü–∏–∏: [${Object.entries(options).filter(([k, v]) => typeof v === 'boolean' && v).map(([k, v]) => k).join(', ') || '–±–∞–∑–æ–≤—ã–µ'}]`);\n+          \n+          const result = await testSingleTK(tk, testData);\n+          allResults.push(result);\n+          totalTests++;\n+          testsForTK++;\n+          \n+          if (result.status === 'success') {\n+            successful++;\n+            console.log(`‚úÖ ${tk}: ${result.message} (${result.timing}ms)`);\n+          } else if (result.status === 'skipped') {\n+            console.log(`‚è≠Ô∏è ${tk}: ${result.message}`);\n+          } else {\n+            console.log(`‚ùå ${tk}: ${result.message} (${result.timing}ms)`);\n+            errors.push(`${tk}: ${result.message}`);\n+          }\n+          \n+          // –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏\n+          await new Promise(resolve => setTimeout(resolve, 100));\n+        }\n+      }\n+    }\n+    \n+    const summary = {\n+      totalTests,\n+      successful,\n+      failed: totalTests - successful,\n+      errors\n+    };\n+    \n+    setFullTestResults({\n+      summary,\n+      details: allResults\n+    });\n+    \n+    console.log('üß™ ===== –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø =====');\n+    console.log(`üìä –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: ${totalTests}`);\n+    console.log(`‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö: ${successful}`);\n+    console.log(`‚ùå –ù–µ—É–¥–∞—á–Ω—ã—Ö: ${totalTests - successful}`);\n+    console.log(`üìà –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: ${((successful / totalTests) * 100).toFixed(1)}%`);\n+    \n+    if (errors.length > 0) {\n+      console.log('‚ùå –û—à–∏–±–∫–∏:');\n+      errors.forEach(error => console.log(`   - ${error}`));\n+    }\n+    \n+  } catch (error: any) {\n+    console.error('üß™ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', error);\n+    errors.push(`–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`);\n+    \n+    setFullTestResults({\n+      summary: { totalTests, successful, failed: totalTests - successful, errors },\n+      details: allResults\n+    });\n+  } finally {\n+    setIsFullTesting(false);\n+    console.log('üß™ ===== –ö–û–ù–ï–¶ –ü–û–õ–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø =====');\n+  }\n+};\n+\n const getStatusIcon = (status: string) => {\n   switch (status) {\n     case 'success': return <CheckCircle className=\"h-4 w-4 text-green-400\" />;\n     case 'warning': return <AlertCircle className=\"h-4 w-4 text-yellow-400\" />;\n"
    },
    "title": "app/diagnostic/page.tsx",
    "time": {
      "start": 1759009335599,
      "end": 1759009335653
    }
  }
}