{
  "id": "prt_ab88633ba001JhoRAnPdgCWYwG",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_ab884a02a001rwdG159rbde9Pt",
  "type": "tool",
  "callID": "call_1567367903644d6db52b865a",
  "tool": "multiedit",
  "state": {
    "status": "completed",
    "input": {
      "edits": [
        {
          "newString": "  const calculateNordWheel = async (): Promise<CalculationResult> => {\n    const apiUrl = '/api/nordwheel';\n\n    try {\n      // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      validateMultipleCargos(form.cargos);\n      \n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n\n      // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      const maxLength = Math.max(...form.cargos.map(c => c.length));\n      const maxWidth = Math.max(...form.cargos.map(c => c.width));\n      const maxHeight = Math.max(...form.cargos.map(c => c.height));\n      \n      // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      console.log('üåê Nord Wheel: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n      console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n      console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);\n      console.log(`   - –û–±—â–∏–π –æ–±—ä–µ–º: ${totalVolume.toFixed(3)} –º¬≥`);\n      console.log(`   - –û—Ç–∫—É–¥–∞: ${form.fromCity} (${form.fromTerminal ? '—Ç–µ—Ä–º–∏–Ω–∞–ª' : '–∞–¥—Ä–µ—Å'})`);\n      console.log(`   - –ö—É–¥–∞: ${form.toCity} (${form.toTerminal ? '—Ç–µ—Ä–º–∏–Ω–∞–ª' : '–∞–¥—Ä–µ—Å'})`);\n      \n      form.cargos.forEach((cargo, index) => {\n        console.log(`   üì¶ –ú–µ—Å—Ç–æ ${index + 1}:`);\n        console.log(`     - –ì–∞–±–∞—Ä–∏—Ç—ã: ${cargo.length}√ó${cargo.width}√ó${cargo.height} —Å–º`);\n        console.log(`     - –í–µ—Å: ${cargo.weight} –∫–≥`);\n        console.log(`     - –û–±—ä–µ–º: ${((cargo.length * cargo.width * cargo.height) / 1000000).toFixed(3)} –º¬≥`);\n      });\n\n      if (form.cargos.length > 1) {\n        console.log(`   üìê –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${maxLength}√ó${maxWidth}√ó${maxHeight} —Å–º`);\n      }\n\n      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è FIAS –∫–æ–¥–∞ –≥–æ—Ä–æ–¥–∞\n      const getCityFias = (cityName: string): string => {\n        const cityFiasMap: Record<string, string> = {\n          '–º–æ—Å–∫–≤–∞': '0c5b2444-70a0-4932-980c-b4dc0d3f02b5',\n          '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': 'c2deb16a-0330-4f05-821f-1d09c93331e6',\n          '—Å–ø–±': 'c2deb16a-0330-4f05-821f-1d09c93331e6',\n          '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '2763c110-cb8b-416a-9dac-ad28a55b4402',\n          '–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫': '8dea00e3-9aab-4d8e-887c-ef2aaa546456',\n          '–∫–∞–∑–∞–Ω—å': '93b3df57-4c89-44df-ac42-96f05e9cd3b9',\n          '–Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥': '555e7d61-d9a7-4ba6-9770-6caa8198c483',\n          '—á–µ–ª—è–±–∏–Ω—Å–∫': 'a376e68d-724a-4472-be7c-891bdb09ae32',\n          '–æ–º—Å–∫': 'bb035cc3-1dc2-4627-9d25-a1bf5fed073d',\n          '—Ä–æ—Å—Ç–æ–≤-–Ω–∞-–¥–æ–Ω—É': 'c1cfe4b9-f7c2-423c-abfa-6ed5cb24d83e',\n          '—É—Ñ–∞': '7339e834-2cb4-473c-9c6e-93f3dcd66011',\n          '–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫': '9b968c73-f4d4-4012-8da8-3dacd4d4c1bd',\n          '–ø–µ—Ä–º—å': '4dc222e8-1f6a-4c36-894b-2b4a8c8a9b08',\n          '–≤–æ—Ä–æ–Ω–µ–∂': '5bf5ddff-6353-4a3d-80c4-6fb27f00c6c1',\n          '–≤–æ–ª–≥–æ–≥—Ä–∞–¥': 'da051ec8-da2e-4a66-b542-473b8d221ab6'\n        };\n\n        const normalizedCity = cityName.toLowerCase().trim()\n          .replace(/^–≥\\s+/, '') // –£–±–∏—Ä–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å \"–≥ \"\n          .replace(/^–≥–æ—Ä–æ–¥\\s+/, '') // –£–±–∏—Ä–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å \"–≥–æ—Ä–æ–¥ \"\n          .replace(/\\s+/g, ' '); // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø—Ä–æ–±–µ–ª—ã\n\n        return cityFiasMap[normalizedCity] || '0c5b2444-70a0-4932-980c-b4dc0d3f02b5'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ú–æ—Å–∫–≤–∞\n      };\n      // üèôÔ∏è –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–æ—Ä–º—ã\n      const getDispatchLocation = () => {\n        if (form.fromTerminal) {\n          return {\n            type: 'terminal' as const,\n            // –î–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π FIAS –∫–æ–¥ –≥–æ—Ä–æ–¥–∞\n            city_fias: getCityFias(form.fromCity)\n          };\n        } else {\n          return {\n            type: 'address' as const,\n            address: form.fromAddress || form.fromCity // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–¥—Ä–µ—Å –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –≥–æ—Ä–æ–¥\n          };\n        }\n      };\n\n      const getDestinationLocation = () => {\n        if (form.toTerminal) {\n          return {\n            type: 'terminal' as const,\n            // –î–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π FIAS –∫–æ–¥ –≥–æ—Ä–æ–¥–∞\n            city_fias: getCityFias(form.toCity)\n          };\n        } else {\n          return {\n            type: 'address' as const,\n            address: form.toAddress || form.toCity // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–¥—Ä–µ—Å –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –≥–æ—Ä–æ–¥\n          };\n        }\n      };\n\n      // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –Ω–æ–≤–æ–≥–æ API NordWheel —Å —É—á–µ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–æ—Ä–º—ã\n      const requestData = {\n        dispatch: {\n          location: getDispatchLocation()\n        },\n        destination: {\n          location: getDestinationLocation()\n        },\n        cargo: {\n          total_weight: totalWeight,\n          total_volume: totalVolume,\n          total_quantity: form.cargos.length\n        },\n        insurance: form.needInsurance && form.declaredValue ? form.declaredValue : 0,\n        insurance_refuse: !form.needInsurance,\n        services: {\n          is_package: form.needPackaging,\n          is_documents_return: false,\n          is_fragile: false\n        },\n        promocode: null\n      };\n\n      console.log('üöõ Nord Wheel –Ω–æ–≤—ã–π API –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n\n      const result = await enhancedApiRequest(\n        apiUrl,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(requestData)\n        },\n        { operation: 'calculate', company: 'Nord Wheel' }\n      );\n\n      if (result && typeof result === 'object' && 'success' in result && !result.success) {\n        console.error('‚ùå Nord Wheel API –æ—à–∏–±–∫–∞:', result.error);\n        return {\n          company: 'Nord Wheel',\n          price: 0,\n          days: 0,\n          error: result.error.userMessage || result.error.message,\n          apiUrl,\n          requestData\n        };\n      }\n\n      const response = result as Response;\n      const data = await response.json();\n      console.log('üöõ Nord Wheel API –æ—Ç–≤–µ—Ç:', data);",
          "oldString": "  const calculateNordWheel = async (): Promise<CalculationResult> => {\n    const apiUrl = 'https://api.nordw.orog.ru/api/v1/calculate';\n\n    try {\n      // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      validateMultipleCargos(form.cargos);\n      \n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n\n      // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      const maxLength = Math.max(...form.cargos.map(c => c.length));\n      const maxWidth = Math.max(...form.cargos.map(c => c.width));\n      const maxHeight = Math.max(...form.cargos.map(c => c.height));\n      \n      // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      console.log('üåê Nord Wheel: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n      console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n      console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);\n      console.log(`   - –û–±—â–∏–π –æ–±—ä–µ–º: ${totalVolume.toFixed(3)} –º¬≥`);\n      console.log(`   - –û—Ç–∫—É–¥–∞: ${form.fromCity} (${form.fromTerminal ? '—Ç–µ—Ä–º–∏–Ω–∞–ª' : '–∞–¥—Ä–µ—Å'})`);\n      console.log(`   - –ö—É–¥–∞: ${form.toCity} (${form.toTerminal ? '—Ç–µ—Ä–º–∏–Ω–∞–ª' : '–∞–¥—Ä–µ—Å'})`);\n      \n      form.cargos.forEach((cargo, index) => {\n        console.log(`   üì¶ –ú–µ—Å—Ç–æ ${index + 1}:`);\n        console.log(`     - –ì–∞–±–∞—Ä–∏—Ç—ã: ${cargo.length}√ó${cargo.width}√ó${cargo.height} —Å–º`);\n        console.log(`     - –í–µ—Å: ${cargo.weight} –∫–≥`);\n        console.log(`     - –û–±—ä–µ–º: ${((cargo.length * cargo.width * cargo.height) / 1000000).toFixed(3)} –º¬≥`);\n      });\n\n      if (form.cargos.length > 1) {\n        console.log(`   üìê –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${maxLength}√ó${maxWidth}√ó${maxHeight} —Å–º`);\n      }\n\n      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è FIAS –∫–æ–¥–∞ –≥–æ—Ä–æ–¥–∞\n      const getCityFias = (cityName: string): string => {\n        const cityFiasMap: Record<string, string> = {\n          '–º–æ—Å–∫–≤–∞': '0c5b2444-70a0-4932-980c-b4dc0d3f02b5',\n          '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': 'c2deb16a-0330-4f05-821f-1d09c93331e6',\n          '—Å–ø–±': 'c2deb16a-0330-4f05-821f-1d09c93331e6',\n          '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '2763c110-cb8b-416a-9dac-ad28a55b4402',\n          '–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫': '8dea00e3-9aab-4d8e-887c-ef2aaa546456',\n          '–∫–∞–∑–∞–Ω—å': '93b3df57-4c89-44df-ac42-96f05e9cd3b9',\n          '–Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥': '555e7d61-d9a7-4ba6-9770-6caa8198c483',\n          '—á–µ–ª—è–±–∏–Ω—Å–∫': 'a376e68d-724a-4472-be7c-891bdb09ae32',\n          '–æ–º—Å–∫': 'bb035cc3-1dc2-4627-9d25-a1bf5fed073d',\n          '—Ä–æ—Å—Ç–æ–≤-–Ω–∞-–¥–æ–Ω—É': 'c1cfe4b9-f7c2-423c-abfa-6ed5cb24d83e',\n          '—É—Ñ–∞': '7339e834-2cb4-473c-9c6e-93f3dcd66011',\n          '–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫': '9b968c73-f4d4-4012-8da8-3dacd4d4c1bd',\n          '–ø–µ—Ä–º—å': '4dc222e8-1f6a-4c36-894b-2b4a8c8a9b08',\n          '–≤–æ—Ä–æ–Ω–µ–∂': '5bf5ddff-6353-4a3d-80c4-6fb27f00c6c1',\n          '–≤–æ–ª–≥–æ–≥—Ä–∞–¥': 'da051ec8-da2e-4a66-b542-473b8d221ab6'\n        };\n\n        const normalizedCity = cityName.toLowerCase().trim()\n          .replace(/^–≥\\s+/, '') // –£–±–∏—Ä–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å \"–≥ \"\n          .replace(/^–≥–æ—Ä–æ–¥\\s+/, '') // –£–±–∏—Ä–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å \"–≥–æ—Ä–æ–¥ \"\n          .replace(/\\s+/g, ' '); // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø—Ä–æ–±–µ–ª—ã\n\n        return cityFiasMap[normalizedCity] || '0c5b2444-70a0-4932-980c-b4dc0d3f02b5'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ú–æ—Å–∫–≤–∞\n      };\n      // üèôÔ∏è –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–æ—Ä–º—ã\n      const getDispatchLocation = () => {\n        if (form.fromTerminal) {\n          return {\n            type: 'terminal' as const,\n            // –î–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π FIAS –∫–æ–¥ –≥–æ—Ä–æ–¥–∞\n            city_fias: getCityFias(form.fromCity)\n          };\n        } else {\n          return {\n            type: 'address' as const,\n            address: form.fromAddress || form.fromCity // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–¥—Ä–µ—Å –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –≥–æ—Ä–æ–¥\n          };\n        }\n      };\n\n      const getDestinationLocation = () => {\n        if (form.toTerminal) {\n          return {\n            type: 'terminal' as const,\n            // –î–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π FIAS –∫–æ–¥ –≥–æ—Ä–æ–¥–∞\n            city_fias: getCityFias(form.toCity)\n          };\n        } else {\n          return {\n            type: 'address' as const,\n            address: form.toAddress || form.toCity // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–¥—Ä–µ—Å –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –≥–æ—Ä–æ–¥\n          };\n        }\n      };\n\n      // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –Ω–æ–≤–æ–≥–æ API NordWheel —Å —É—á–µ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–æ—Ä–º—ã\n      const requestData = {\n        dispatch: {\n          location: getDispatchLocation()\n        },\n        destination: {\n          location: getDestinationLocation()\n        },\n        cargo: {\n          total_weight: totalWeight,\n          total_volume: totalVolume,\n          total_quantity: form.cargos.length\n        },\n        insurance: form.needInsurance && form.declaredValue ? form.declaredValue : 0,\n        insurance_refuse: !form.needInsurance,\n        services: {\n          is_package: form.needPackaging,\n          is_documents_return: false,\n          is_fragile: false\n        },\n        promocode: null\n      };\n\n      console.log('üöõ Nord Wheel –Ω–æ–≤—ã–π API –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${process.env.NORDWHEEL_API_KEY || '5|WYpV9f788Y2ASobpv3xy6N5qxtIUaKhxFF4yWETOfc398950'}`\n        },\n        body: JSON.stringify(requestData)\n      });\n\n      if (!response.ok) {\n        console.error('‚ùå Nord Wheel API –æ—à–∏–±–∫–∞:', response.status, response.statusText);\n        const errorDetails = response.status === 401 ? '–ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á' :\n                            response.status === 400 ? '–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å' :\n                            response.status === 404 ? '–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω' :\n                            response.status === 500 ? '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' :\n                            `–û—à–∏–±–∫–∞ API: ${response.status} ${response.statusText}`;\n        \n        return {\n          company: 'Nord Wheel',\n          price: 0,\n          days: 0,\n          error: errorDetails,\n          apiUrl,\n          requestData\n        };\n      }\n\n      const data = await response.json();\n      console.log('üöõ Nord Wheel API –æ—Ç–≤–µ—Ç:', data);"
        }
      ],
      "filePath": "/home/user/project/app/page.tsx"
    },
    "output": "",
    "title": "app/page.tsx",
    "metadata": {
      "results": [
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -3549,9 +3549,9 @@\n };\n \n // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n const calculateNordWheel = async (): Promise<CalculationResult> => {\n-  const apiUrl = 'https://api.nordw.orog.ru/api/v1/calculate';\n+  const apiUrl = '/api/nordwheel';\n \n   try {\n     // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n     validateMultipleCargos(form.cargos);\n@@ -3667,35 +3667,33 @@\n     };\n \n     console.log('üöõ Nord Wheel –Ω–æ–≤—ã–π API –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n \n-    const response = await fetch(apiUrl, {\n-      method: 'POST',\n-      headers: {\n-        'Content-Type': 'application/json',\n-        'Authorization': `Bearer ${process.env.NORDWHEEL_API_KEY || '5|WYpV9f788Y2ASobpv3xy6N5qxtIUaKhxFF4yWETOfc398950'}`\n+    const result = await enhancedApiRequest(\n+      apiUrl,\n+      {\n+        method: 'POST',\n+        headers: {\n+          'Content-Type': 'application/json'\n+        },\n+        body: JSON.stringify(requestData)\n       },\n-      body: JSON.stringify(requestData)\n-    });\n+      { operation: 'calculate', company: 'Nord Wheel' }\n+    );\n \n-    if (!response.ok) {\n-      console.error('‚ùå Nord Wheel API –æ—à–∏–±–∫–∞:', response.status, response.statusText);\n-      const errorDetails = response.status === 401 ? '–ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á' :\n-                          response.status === 400 ? '–ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å' :\n-                          response.status === 404 ? '–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω' :\n-                          response.status === 500 ? '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' :\n-                          `–û—à–∏–±–∫–∞ API: ${response.status} ${response.statusText}`;\n-      \n+    if (result && typeof result === 'object' && 'success' in result && !result.success) {\n+      console.error('‚ùå Nord Wheel API –æ—à–∏–±–∫–∞:', result.error);\n       return {\n         company: 'Nord Wheel',\n         price: 0,\n         days: 0,\n-        error: errorDetails,\n+        error: result.error.userMessage || result.error.message,\n         apiUrl,\n         requestData\n       };\n     }\n \n+    const response = result as Response;\n     const data = await response.json();\n     console.log('üöõ Nord Wheel API –æ—Ç–≤–µ—Ç:', data);\n \n      // –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ API - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã\n"
        }
      ]
    },
    "time": {
      "start": 1764032394172,
      "end": 1764032394207
    }
  }
}