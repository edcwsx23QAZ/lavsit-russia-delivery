{
  "id": "prt_986fca339001B0LdalI9p54Dcu",
  "messageID": "msg_986fbf1ca001eb408qkiFUIken",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "write",
  "callID": "toolu_01B1VbvqU2yutX28sfn71JV1",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/pek-test/page.tsx",
      "content": "'use client';\n\nimport { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\n\nexport default function PekTestPage() {\n  const [results, setResults] = useState<{ [key: string]: any }>({});\n  const [loading, setLoading] = useState<{ [key: string]: boolean }>({});\n  const [testAddress, setTestAddress] = useState('–≥ –ú–æ—Å–∫–≤–∞, –®–º–∏—Ç–æ–≤—Å–∫–∏–π –ø—Ä–æ–µ–∑–¥, –¥ 1, –∫–≤ 39');\n\n  const runTest = async (testName: string, testFunction: () => Promise<any>) => {\n    setLoading(prev => ({ ...prev, [testName]: true }));\n    try {\n      const result = await testFunction();\n      setResults(prev => ({ ...prev, [testName]: result }));\n    } catch (error: any) {\n      setResults(prev => ({ \n        ...prev, \n        [testName]: { \n          error: true, \n          message: error.message,\n          stack: error.stack \n        } \n      }));\n    } finally {\n      setLoading(prev => ({ ...prev, [testName]: false }));\n    }\n  };\n\n  const renderResult = (testName: string) => {\n    const result = results[testName];\n    if (!result && !loading[testName]) return null;\n    \n    if (loading[testName]) {\n      return <div className=\"text-blue-600 font-mono text-sm\">üîÑ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...</div>;\n    }\n    \n    return (\n      <Textarea \n        value={JSON.stringify(result, null, 2)} \n        readOnly \n        className=\"font-mono text-sm h-48 mt-2\"\n      />\n    );\n  };\n\n  // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–∫—Å–∏ (—Ç–µ—Å—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥)\n  const testProxyHealth = async () => {\n    const response = await fetch('/api/pek', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ method: 'test' })\n    });\n\n    return {\n      status: response.status,\n      statusText: response.statusText,\n      ok: response.ok,\n      data: await response.json()\n    };\n  };\n\n  // –¢–µ—Å—Ç 2: –ü–æ–∏—Å–∫ –∑–æ–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏\n  const testFindZoneByAddress = async () => {\n    const response = await fetch('/api/pek', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        method: 'findzonebyaddress',\n        address: testAddress\n      })\n    });\n\n    return {\n      status: response.status,\n      statusText: response.statusText,\n      ok: response.ok,\n      data: await response.json()\n    };\n  };\n\n  // –¢–µ—Å—Ç 3: –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏\n  const testSimpleProxy = async () => {\n    const response = await fetch('/api/pek-simple', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ method: 'test' })\n    });\n\n    return {\n      status: response.status,\n      statusText: response.statusText,\n      ok: response.ok,\n      data: await response.json()\n    };\n  };\n\n  // –¢–µ—Å—Ç 4: –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –∫ –ü–≠–ö —á–µ—Ä–µ–∑ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏\n  const testDirectThroughProxy = async () => {\n    const response = await fetch('/api/pek-simple', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ method: 'direct' })\n    });\n\n    return {\n      status: response.status,\n      statusText: response.statusText,\n      ok: response.ok,\n      data: await response.json()\n    };\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-4\">\n      <div className=\"max-w-6xl mx-auto space-y-6\">\n        <div className=\"text-center\">\n          <h1 className=\"text-3xl font-bold mb-2\">üß™ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ü–≠–ö API</h1>\n          <p className=\"text-gray-600\">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ (–±–µ–∑ CORS –æ—à–∏–±–æ–∫)</p>\n        </div>\n\n        {/* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–∞ */}\n        <Card>\n          <CardHeader>\n            <CardTitle>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              <div>\n                <label className=\"block text-sm font-medium mb-1\">–¢–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å:</label>\n                <Input\n                  value={testAddress}\n                  onChange={(e) => setTestAddress(e.target.value)}\n                  placeholder=\"–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\"\n                />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {/* –¢–µ—Å—Ç 1 */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∫—Å–∏ (—Ç–µ—Å—Ç)</CardTitle>\n              <p className=\"text-sm text-gray-600\">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏ API</p>\n            </CardHeader>\n            <CardContent>\n              <Button \n                onClick={() => runTest('proxy', testProxyHealth)}\n                disabled={loading.proxy}\n                className=\"mb-3\"\n              >\n                –¢–µ—Å—Ç –ø—Ä–æ–∫—Å–∏\n              </Button>\n              {renderResult('proxy')}\n            </CardContent>\n          </Card>\n\n          {/* –¢–µ—Å—Ç 2 */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">2. –ü–æ–∏—Å–∫ –∑–æ–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É</CardTitle>\n              <p className=\"text-sm text-gray-600\">–†–µ–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –ü–≠–ö API —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏</p>\n            </CardHeader>\n            <CardContent>\n              <Button \n                onClick={() => runTest('zone', testFindZoneByAddress)}\n                disabled={loading.zone}\n                className=\"mb-3\"\n              >\n                –ü–æ–∏—Å–∫ –∑–æ–Ω—ã\n              </Button>\n              {renderResult('zone')}\n            </CardContent>\n          </Card>\n\n          {/* –¢–µ—Å—Ç 3 */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">3. –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏</CardTitle>\n              <p className=\"text-sm text-gray-600\">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∞—Å–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏</p>\n            </CardHeader>\n            <CardContent>\n              <Button \n                onClick={() => runTest('simple', testSimpleProxy)}\n                disabled={loading.simple}\n                className=\"mb-3\"\n              >\n                –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–∫—Å–∏\n              </Button>\n              {renderResult('simple')}\n            </CardContent>\n          </Card>\n\n          {/* –¢–µ—Å—Ç 4 */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">4. –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –ü–≠–ö</CardTitle>\n              <p className=\"text-sm text-gray-600\">–ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –∫ API –ü–≠–ö —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏</p>\n            </CardHeader>\n            <CardContent>\n              <Button \n                onClick={() => runTest('direct', testDirectThroughProxy)}\n                disabled={loading.direct}\n                className=\"mb-3\"\n              >\n                –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤\n              </Button>\n              {renderResult('direct')}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">üöÄ –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <Button \n              onClick={async () => {\n                console.log('üöÄ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ü–≠–ö API');\n                \n                // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ\n                await runTest('proxy', testProxyHealth);\n                await runTest('simple', testSimpleProxy);\n                await runTest('zone', testFindZoneByAddress);\n                await runTest('direct', testDirectThroughProxy);\n                \n                console.log('‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');\n              }}\n              disabled={Object.values(loading).some(Boolean)}\n              className=\"w-full bg-blue-600 hover:bg-blue-700\"\n            >\n              üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –í–°–ï –¢–ï–°–¢–´\n            </Button>\n          </CardContent>\n        </Card>\n\n        {/* –°—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">üìã –°–ø—Ä–∞–≤–∫–∞</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-sm space-y-2\">\n              <p><strong>–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</strong></p>\n              <ul className=\"list-disc list-inside space-y-1 text-gray-600\">\n                <li><strong>–¢–µ—Å—Ç 1:</strong> –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç—É—Å \"OK\" –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–∫—Å–∏</li>\n                <li><strong>–¢–µ—Å—Ç 2:</strong> –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∑–æ–Ω–µ –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞</li>\n                <li><strong>–¢–µ—Å—Ç 3:</strong> –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è</li>\n                <li><strong>–¢–µ—Å—Ç 4:</strong> –î–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –∫ API –ü–≠–ö —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π</li>\n              </ul>\n              <div className=\"mt-4 p-3 bg-yellow-50 rounded-lg\">\n                <p className=\"text-yellow-800\">\n                  <strong>üí° –°–æ–≤–µ—Ç:</strong> –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ \n                  <a href=\"/env-check\" className=\"text-blue-600 underline ml-1\">/env-check</a>\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "filepath": "/home/user/project/app/pek-test/page.tsx",
      "exists": true
    },
    "title": "app/pek-test/page.tsx",
    "time": {
      "start": 1758906359502,
      "end": 1758906359506
    }
  }
}