{
  "id": "prt_9e320395e001oNUL407RZWGpRF",
  "messageID": "msg_9e3202ec6001X8XuxRRuTM2JLH",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "call_47507123",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "app/page.tsx",
      "offset": 2900
    },
    "output": "<file>\n02901|       const optimalHeight = calculateOptimalHeight(form.cargos);\n02902|       \n02903|       // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n02904|       console.log('üöÇ Rail Continent: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n02905|       console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n02906|       console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);\n02907|       console.log(`   - –û–±—â–∏–π –æ–±—ä–µ–º: ${totalVolume.toFixed(3)} –º¬≥`);\n02908|       \n02909|       form.cargos.forEach((cargo, index) => {\n02910|         console.log(`   üì¶ –ú–µ—Å—Ç–æ ${index + 1}:`);\n02911|         console.log(`     - –ì–∞–±–∞—Ä–∏—Ç—ã: ${cargo.length}√ó${cargo.width}√ó${cargo.height} —Å–º`);\n02912|         console.log(`     - –í–µ—Å: ${cargo.weight} –∫–≥`);\n02913|         console.log(`     - –û–±—ä–µ–º: ${((cargo.length * cargo.width * cargo.height) / 1000000).toFixed(3)} –º¬≥`);\n02914|       });\n02915|       \n02916|       if (form.cargos.length > 1) {\n02917|         const maxLength = Math.max(...form.cargos.map(c => c.length));\n02918|         const maxWidth = Math.max(...form.cargos.map(c => c.width));\n02919|         const maxHeight = Math.max(...form.cargos.map(c => c.height));\n02920|         console.log(`   üìê –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${maxLength}√ó${maxWidth}√ó${maxHeight} —Å–º`);\n02921|         console.log(`   üîß –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${(optimalLength*100).toFixed(0)}√ó${(optimalWidth*100).toFixed(0)}√ó${(optimalHeight*100).toFixed(0)} —Å–º`);\n02922|       }\n02923|       \n02924|       // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä quantity –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã\n02925|       const requestData = {\n02926|         city_sender: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n02927|         city_receiver: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n02928|         weight: totalWeight,\n02929|         volume: totalVolume,\n02930|         quantity: form.cargos.length, // üîß –î–û–ë–ê–í–õ–ï–ù–û: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç\n02931|         length: optimalLength,        // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞\n02932|         width: optimalWidth,          // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞  \n02933|         height: optimalHeight,        // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞\n02934|         declared_cost: form.declaredValue,\n02935|         pickup: form.fromAddressDelivery ? '1' : '0',\n02936|         delivery: form.toAddressDelivery ? '1' : '0',\n02937|         packaging: form.needPackaging ? '1' : '0',\n02938|         insurance: form.needInsurance ? '1' : '0',\n02939|         tariff: 'auto' // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞\n02940|       };\n02941| \n02942|       console.log('üöÇ Rail Continent –∑–∞–ø—Ä–æ—Å:', requestData);\n02943| \n02944|       const response = await fetch(apiUrl, {\n02945|         method: 'POST',\n02946|         headers: {\n02947|           'Content-Type': 'application/json',\n02948|         },\n02949|         body: JSON.stringify(requestData)\n02950|       });\n02951| \n02952|       const data = await response.json();\n02953|       console.log('üöÇ Rail Continent –æ—Ç–≤–µ—Ç:', data);\n02954| \n02955|       if (response.ok && data.result === 'success' && data.data) {\n02956|         // –í—ã–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–π —Ç–∞—Ä–∏—Ñ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π)\n02957|         const autoTariff = data.data.auto;\n02958|         \n02959|         if (autoTariff) {\n02960|           // –°–æ–±–∏—Ä–∞–µ–º –¥–µ—Ç–∞–ª–∏ –ø–æ —É—Å–ª—É–≥–∞–º –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n02961|           const services: { name: string; description: string; price: number }[] = [];\n02962|           let totalPrice = 0;\n02963|           \n02964|           console.log('üöÇ Rail Continent –¥–µ—Ç–∞–ª–∏ —Ç–∞—Ä–∏—Ñ–∞:', {\n02965|             price_with_out_sale: autoTariff.price_with_out_sale,\n02966|             pricePackage: autoTariff.pricePackage,\n02967|             priceInsurance: autoTariff.priceInsurance,\n02968|             needPackaging: form.needPackaging,\n02969|             needInsurance: form.needInsurance,\n02970|             declaredValue: form.declaredValue\n02971|           });\n02972|           \n02973|           console.log('üöÇ Rail Continent —á–µ–∫–±–æ–∫—Å—ã —Å–æ—Å—Ç–æ—è–Ω–∏–µ:');\n02974|           console.log('   - –£–ø–∞–∫–æ–≤–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è:', form.needPackaging);\n02975|           console.log('   - –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è:', form.needInsurance);\n02976|           console.log('   - –ó–∞—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', form.declaredValue);\n02977|           \n02978|           // –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –≥—Ä—É–∑–∞\n02979|           if (autoTariff.price_with_out_sale) {\n02980|             const deliveryPrice = parseFloat(autoTariff.price_with_out_sale);\n02981|             console.log('üöÇ –î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞:', deliveryPrice);\n02982|             services.push({\n02983|               name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n02984|               description: `${autoTariff.type} (${autoTariff.rsType})`,\n02985|               price: deliveryPrice\n02986|             });\n02987|             totalPrice += deliveryPrice;\n02988|           }\n02989|           \n02990|           // –£–ø–∞–∫–æ–≤–∫–∞\n02991|           if (form.needPackaging && autoTariff.pricePackage) {\n02992|             const packagingPrice = parseFloat(autoTariff.pricePackage);\n02993|             console.log('üöÇ –£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞:', packagingPrice);\n02994|             services.push({\n02995|               name: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n02996|               description: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞',\n02997|               price: packagingPrice\n02998|             });\n02999|             totalPrice += packagingPrice;\n03000|           }\n03001|           \n03002|           // –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ\n03003|           if (form.needInsurance && autoTariff.priceInsurance) {\n03004|             const insuranceCost = Math.round(form.declaredValue * parseFloat(autoTariff.priceInsurance) / 100);\n03005|             console.log('üöÇ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞:', insuranceCost, '(', form.declaredValue, '*', autoTariff.priceInsurance, '%)');\n03006|             services.push({\n03007|               name: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n03008|               description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n03009|               price: insuranceCost\n03010|             });\n03011|             totalPrice += insuranceCost;\n03012|           }\n03013| \n03014|           console.log('üöÇ Rail Continent –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', totalPrice);\n03015|           console.log('üöÇ Rail Continent —É—Å–ª—É–≥–∏:', services);\n03016| \n03017|           // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º, –Ω–æ –Ω–µ –≤–∫–ª—é—á–∞–µ–º –≤ –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å)\n03018|           const additionalServices: { name: string; description: string; price: number }[] = [];\n03019|           \n03020|           // –¢–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–µ —Å–±–æ—Ä—ã\n03021|           if (autoTariff.terminalEnter1) {\n03022|             additionalServices.push({\n03023|               name: '–¢–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π —Å–±–æ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è',\n03024|               description: '–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–∑–∞ –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ',\n03025|               price: parseInt(autoTariff.terminalEnter1)\n03026|             });\n03027|           }\n03028|           \n03029|           // –ó–∞–±–æ—Ä/–¥–æ—Å—Ç–∞–≤–∫–∞\n03030|           if (form.fromAddressDelivery && autoTariff.pricePickup && parseInt(autoTariff.pricePickup) > 0) {\n03031|             additionalServices.push({\n03032|               name: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n03033|               description: '–û—Ç –∞–¥—Ä–µ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è',\n03034|               price: parseInt(autoTariff.pricePickup)\n03035|             });\n03036|           }\n03037|           \n03038|           if (form.toAddressDelivery && autoTariff.priceDelivery && parseInt(autoTariff.priceDelivery) > 0) {\n03039|             additionalServices.push({\n03040|               name: '–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –∞–¥—Ä–µ—Å—É',\n03041|               description: '–î–æ –∞–¥—Ä–µ—Å–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è',\n03042|               price: parseInt(autoTariff.priceDelivery)\n03043|             });\n03044|           }\n03045| \n03046|           return {\n03047|             company: 'Rail Continent',\n03048|             price: Math.round(totalPrice),\n03049|             days: parseInt(autoTariff.duration) || 5,\n03050|             details: {\n03051|               tariff: `${autoTariff.type} - ${autoTariff.service}`,\n03052|               transportType: autoTariff.rsType,\n03053|               weight: totalWeight,\n03054|               volume: totalVolume,\n03055|               route: `${form.fromCity} - ${form.toCity}`,\n03056|               services,\n03057|               additionalServices,\n03058|               allTariffs: data.data\n03059|             },\n03060|             requestData,\n03061|             responseData: data,\n03062|             apiUrl\n03063|           };\n03064|         } else {\n03065|           return {\n03066|             company: 'Rail Continent',\n03067|             price: 0,\n03068|             days: 0,\n03069|             error: '–ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–π —Ç–∞—Ä–∏—Ñ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞',\n03070|             requestData,\n03071|             responseData: data,\n03072|             apiUrl\n03073|           };\n03074|         }\n03075|       } else {\n03076|         return {\n03077|           company: 'Rail Continent',\n03078|           price: 0,\n03079|           days: 0,\n03080|           error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ Rail Continent',\n03081|           requestData,\n03082|           responseData: data,\n03083|           apiUrl\n03084|         };\n03085|       }\n03086|     } catch (error: any) {\n03087|       console.error('üöÇ Rail Continent –æ—à–∏–±–∫–∞:', error);\n03088|       return {\n03089|         company: 'Rail Continent',\n03090|         price: 0,\n03091|         days: 0,\n03092|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03093|         apiUrl\n03094|       };\n03095|     }\n03096|   };\n03097| \n03098|   const calculateVozovoz = async (): Promise<CalculationResult> => {\n03099|     const apiUrl = '/api/vozovoz';\n03100|     \n03101|     try {\n03102|       // –í—ã—á–∏—Å–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞\n03103|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03104|       const totalVolume = form.cargos.reduce((sum, cargo) => \n03105|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n03106|       );\n03107|       \n03108|       // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –í–æ–∑–æ–≤–æ–∑\n03109|       const maxDimensions = form.cargos.reduce((max, cargo) => {\n03110|         const length = cargo.length / 1000; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –º–º –≤ –º\n03111|         const width = cargo.width / 1000;\n03112|         const height = cargo.height / 1000;\n03113|         const weight = cargo.weight;\n03114|         \n03115|         return {\n03116|           length: Math.max(max.length, length),\n03117|           width: Math.max(max.width, width),\n03118|           height: Math.max(max.height, height),\n03119|           weight: Math.max(max.weight, weight)\n03120|         };\n03121|       }, { length: 0, width: 0, height: 0, weight: 0 });\n03122|       \n03123|       console.log('üöö –í–æ–∑–æ–≤–æ–∑: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');\n03124|       console.log('   - –û–±—â–∏–π –≤–µ—Å:', totalWeight, '–∫–≥');\n03125|       console.log('   - –û–±—â–∏–π –æ–±—ä–µ–º:', totalVolume, '–º¬≥');\n03126|       console.log('   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã:', maxDimensions);\n03127|       console.log('   - –û—Ç–∫—É–¥–∞:', form.fromCity);\n03128|       console.log('   - –ö—É–¥–∞:', form.toCity);\n03129|       \n03130|        // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è API Vozovoz —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n03131|        const requestData = {\n03132|          object: \"price\",\n03133|          action: \"get\",\n03134|          params: {\n03135|            cargo: {\n03136|              dimension: {\n03137|                max: {                              // ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É max\n03138|                  length: maxDimensions.length,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n03139|                  width: maxDimensions.width,       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n03140|                  height: maxDimensions.height,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n03141|                  weight: maxDimensions.weight      // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –∫–≥\n03142|                },\n03143|                quantity: form.cargos.length,       // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç\n03144|                volume: totalVolume,                // –û–±—â–∏–π –æ–±—ä–µ–º –≤ –º¬≥\n03145|                weight: totalWeight                 // –û–±—â–∏–π –≤–µ—Å –≤ –∫–≥\n03146|              },\n03147|              ...(form.needInsurance && form.declaredValue > 0 ? {\n03148|                insurance: form.declaredValue,      // ‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ\n03149|                insuranceNdv: false                 // –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n03150|              } : {\n03151|                insuranceNdv: true                  // –í–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n03152|              }),\n03153|               ...(form.needPackaging ? {\n03154|                 wrapping: {\n03155|                   \"hardPackageVolume\": totalVolume  // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ \"–ñ—ë—Å—Ç–∫–∞—è —É–ø–∞–∫–æ–≤–∫–∞\" –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n03156|                 }\n03157|               } : {})\n03158|            },\n03159|            gateway: {\n03160|              dispatch: {\n03161|                point: {\n03162|                  location: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n03163|                  // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n03164|                  ...(form.fromAddressDelivery ? {\n03165|                    address: form.fromAddress || \"–∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\"\n03166|                  } : {\n03167|                    terminal: \"default\"\n03168|                  })\n03169|                }\n03170|              },\n03171|              destination: {\n03172|                point: {\n03173|                  location: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n03174|                  // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n03175|                  ...(form.toAddressDelivery ? {\n03176|                    address: form.toAddress || \"–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω–∏—è\"\n03177|                  } : {\n03178|                    terminal: \"default\"\n03179|                  })\n03180|                }\n03181|              }\n03182|            }\n03183|          }\n03184|        };\n03185| \n03186|       console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03187| \n03188|       const response = await fetch(apiUrl, {\n03189|         method: 'POST',\n03190|         headers: {\n03191|           'Content-Type': 'application/json',\n03192|         },\n03193|         body: JSON.stringify(requestData)\n03194|       });\n03195| \n03196|       const data = await response.json();\n03197|       console.log('üöö –í–æ–∑–æ–≤–æ–∑ –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n03198| \n03199|       if (response.ok && data.response) {\n03200|         const responseData = data.response;\n03201|         \n03202|         console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:', responseData);\n03203|         \n03204|         // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n03205|         const services: { name: string; description: string; price: number }[] = [];\n03206|         let totalPrice = responseData.price || responseData.basePrice || 0;\n03207|         \n03208|         // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API\n03209|         if (responseData.service && Array.isArray(responseData.service)) {\n03210|           console.log('üöö –í–æ–∑–æ–≤–æ–∑ –Ω–∞–π–¥–µ–Ω –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥:', responseData.service.length);\n03211|           \n03212|           responseData.service.forEach((service: any, index: number) => {\n03213|             console.log(`üöö –£—Å–ª—É–≥–∞ [${index}]:`, service);\n03214|             if (service.price > 0) {\n03215|               services.push({\n03216|                 name: service.name || '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞',\n03217|                 description: service.description || '',\n03218|                 price: service.price\n03219|               });\n03220|             }\n03221|           });\n03222|         } else {\n03223|           console.log('üöö –í–æ–∑–æ–≤–æ–∑: –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—É—Å—Ç');\n03224|           \n03225|           // –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤–∞ —É—Å–ª—É–≥ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n03226|           if (responseData.basePrice && responseData.basePrice > 0) {\n03227|             services.push({\n03228|               name: '–ë–∞–∑–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞',\n03229|               description: `${form.fromCity} - ${form.toCity}`,\n03230|               price: responseData.basePrice\n03231|             });\n03232|           }\n03233|           \n03234|           // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë –æ—Ç–¥–µ–ª—å–Ω–æ\n03235|           if (responseData.price !== responseData.basePrice && responseData.price > 0) {\n03236|             const discount = (responseData.basePrice || 0) - responseData.price;\n03237|             if (discount > 0) {\n03238|               services.push({\n03239|                 name: '–°–∫–∏–¥–∫–∞',\n03240|                 description: '–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —Å–∫–∏–¥–∫–∞',\n03241|                 price: -discount\n03242|               });\n03243|             }\n03244|           }\n03245|         }\n03246|         \n03247|         // –ï—Å–ª–∏ –Ω–∏–∫–∞–∫–∏—Ö —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n03248|         if (services.length === 0 && totalPrice > 0) {\n03249|           services.push({\n03250|             name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n03251|             description: `${form.fromCity} - ${form.toCity}`,\n03252|             price: totalPrice\n03253|           });\n03254|         }\n03255| \n03256|         console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', totalPrice);\n03257|         console.log('üöö –í–æ–∑–æ–≤–æ–∑ —É—Å–ª—É–≥–∏:', services);\n03258| \n03259|         return {\n03260|           company: '–í–æ–∑–æ–≤–æ–∑',\n03261|           price: Math.round(totalPrice),\n03262|           days: responseData.deliveryTime?.to || responseData.deliveryTime?.from || 3,\n03263|           details: {\n03264|             note: `–î–æ—Å—Ç–∞–≤–∫–∞ ${form.fromCity} - ${form.toCity}`,\n03265|             services,\n03266|             basePrice: responseData.basePrice,\n03267|             finalPrice: responseData.price,\n03268|             deliveryTime: responseData.deliveryTime,\n03269|             weight: totalWeight,\n03270|             volume: totalVolume\n03271|           },\n03272|           requestData,\n03273|           responseData: data,\n03274|           apiUrl\n03275|         };\n03276|       } else {\n03277|         return {\n03278|           company: '–í–æ–∑–æ–≤–æ–∑',\n03279|           price: 0,\n03280|           days: 0,\n03281|           error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –í–æ–∑–æ–≤–æ–∑',\n03282|           requestData,\n03283|           responseData: data,\n03284|           apiUrl\n03285|         };\n03286|       }\n03287|     } catch (error: any) {\n03288|       console.error('üöö –í–æ–∑–æ–≤–æ–∑ –æ—à–∏–±–∫–∞:', error);\n03289|       return {\n03290|         company: '–í–æ–∑–æ–≤–æ–∑',\n03291|         price: 0,\n03292|         days: 0,\n03293|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03294|         apiUrl\n03295|       };\n03296|     }\n03297|   };\n03298| \n03299|   // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n03300|   const calculateNordWheel = async (): Promise<CalculationResult> => {\n03301|     const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n03302|     \n03303|     try {\n03304|       // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03305|       validateMultipleCargos(form.cargos);\n03306|       \n03307|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03308|       const totalVolume = form.cargos.reduce((sum, cargo) => \n03309|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n03310|       );\n03311| \n03312|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03313|       const maxLength = Math.max(...form.cargos.map(c => c.length));\n03314|       const maxWidth = Math.max(...form.cargos.map(c => c.width));\n03315|       const maxHeight = Math.max(...form.cargos.map(c => c.height));\n03316|       \n03317|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç (>2–º –ø–æ –ª—é–±–æ–º—É –∏–∑–º–µ—Ä–µ–Ω–∏—é)\n03318|       const isOversized = maxLength > 200 || maxWidth > 200 || maxHeight > 200 || totalWeight > 1000;\n03319|       \n03320|       // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03321|       console.log('üåê Nord Wheel: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n03322|       console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n03323|       console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);\n03324|       console.log(`   - –û–±—â–∏–π –æ–±—ä–µ–º: ${totalVolume.toFixed(3)} –º¬≥`);\n03325|       \n03326|       form.cargos.forEach((cargo, index) => {\n03327|         console.log(`   üì¶ –ú–µ—Å—Ç–æ ${index + 1}:`);\n03328|         console.log(`     - –ì–∞–±–∞—Ä–∏—Ç—ã: ${cargo.length}√ó${cargo.width}√ó${cargo.height} —Å–º`);\n03329|         console.log(`     - –í–µ—Å: ${cargo.weight} –∫–≥`);\n03330|         console.log(`     - –û–±—ä–µ–º: ${((cargo.length * cargo.width * cargo.height) / 1000000).toFixed(3)} –º¬≥`);\n03331|       });\n03332|       \n03333|       if (form.cargos.length > 1) {\n03334|         console.log(`   üìê –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${maxLength}√ó${maxWidth}√ó${maxHeight} —Å–º`);\n03335|         console.log(`   üöõ –ù–µ–≥–∞–±–∞—Ä–∏—Ç: ${isOversized ? '–î–ê' : '–ù–ï–¢'}`);\n03336|       }\n03337| \n03338|       // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã –≥–∞–±–∞—Ä–∏—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —É–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç–∞\n03339|       const params = new URLSearchParams({\n03340|         from: '91', // –ú–æ—Å–∫–≤–∞ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n03341|         to: '92', // –°–ü–± (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n03342|         pickup: form.fromAddressDelivery ? '1' : '0',\n03343|         deliver: form.toAddressDelivery ? '1' : '0',\n03344|         weight: totalWeight.toString(),\n03345|         volume: totalVolume.toString(),\n03346|         oversized: isOversized ? '1' : '0', // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç–∞\n03347|         package: form.needPackaging ? '1' : '0',\n03348|         packageCount: form.cargos.length.toString(),\n03349|         insurance: form.needInsurance ? '1' : '0',\n03350|         sum: form.declaredValue.toString(),\n03351|         documentsReturn: '0',\n03352|         fragile: '1',\n03353|         // üîß –î–û–ë–ê–í–õ–ï–ù–û: –ì–∞–±–∞—Ä–∏—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã\n03354|         length: (maxLength / 100).toString(),      // –≤ –º–µ—Ç—Ä–∞—Ö\n03355|         width: (maxWidth / 100).toString(),        // –≤ –º–µ—Ç—Ä–∞—Ö\n03356|         height: (maxHeight / 100).toString(),      // –≤ –º–µ—Ç—Ä–∞—Ö\n03357|         // üîß –î–û–ë–ê–í–õ–ï–ù–û: –§–ª–∞–≥ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03358|         multiplePackages: form.cargos.length > 1 ? '1' : '0'\n03359|       });\n03360| \n03361|       const requestData = Object.fromEntries(params);\n03362|       const fullUrl = `${apiUrl}?${params.toString()}`;\n03363| \n03364|       const response = await fetch(fullUrl);\n03365|       const data = await response.json();\n03366| \n03367|       if (response.ok && data.status === 'success' && data.data) {\n03368|         return {\n03369|           company: 'Nord Wheel',\n03370|           price: data.data.total || 0,\n03371|           days: data.data.days || 0,\n03372|           details: {\n03373|             ...data.data,\n03374|             totalCost: data.data.total,\n03375|             deliveryCost: data.data.door,\n03376|             terminalCost: data.data.terminal,\n03377|             pickupCost: data.data.pick,\n03378|             deliveryToDoorCost: data.data.deliver,\n03379|             additionalServices: (data.data.total || 0) - (data.data.door || 0)\n03380|           },\n03381|           requestData,\n03382|           responseData: data,\n03383|           apiUrl: fullUrl\n03384|         };\n03385|       } else {\n03386|         return {\n03387|           company: 'Nord Wheel',\n03388|           price: 0,\n03389|           days: 0,\n03390|           error: '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ Nord Wheel',\n03391|           requestData,\n03392|           responseData: data,\n03393|           apiUrl: fullUrl\n03394|         };\n03395|       }\n03396|     } catch (error: any) {\n03397|       return {\n03398|         company: 'Nord Wheel',\n03399|         price: 0,\n03400|         days: 0,\n03401|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03402|         apiUrl\n03403|       };\n03404|     }\n03405|   };\n03406| \n03407|   const calculateCdek = async (): Promise<CalculationResult> => {\n03408|     const apiUrl = '/api/cdek';\n03409|     \n03410|     try {\n03411|       validateMultipleCargos(form.cargos);\n03412|       \n03413|       const packages = form.cargos.map(cargo => ({\n03414|         height: cargo.height,\n03415|         length: cargo.length,\n03416|         width: cargo.width,\n03417|         weight: cargo.weight * 1000\n03418|       }));\n03419| \n03420|       const requestData: any = {\n03421|         from_city: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n03422|         to_city: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n03423|         packages: packages\n03424|       };\n03425| \n03426|       if (form.needInsurance && form.declaredValue > 0) {\n03427|         requestData.services = [{\n03428|           code: 'INSURANCE',\n03429|           parameter: form.declaredValue\n03430|         }];\n03431|         console.log('üì¶ CDEK: –¥–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ', form.declaredValue);\n03432|       }\n03433| \n03434|       console.log('üì¶ CDEK –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03435|       console.log('üì¶ CDEK –º–∞—Ä—à—Ä—É—Ç:', {\n03436|         fromAddressDelivery: form.fromAddressDelivery,\n03437|         fromLavsiteWarehouse: form.fromLavsiteWarehouse,\n03438|         toAddressDelivery: form.toAddressDelivery\n03439|       });\n03440| \n03441|       const response = await fetch(apiUrl, {\n03442|         method: 'POST',\n03443|         headers: {\n03444|           'Content-Type': 'application/json',\n03445|         },\n03446|         body: JSON.stringify(requestData)\n03447|       });\n03448| \n03449|       const data = await response.json();\n03450|       console.log('üì¶ CDEK –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω, —Ç–∞—Ä–∏—Ñ–æ–≤:', data.tariff_codes?.length || 0);\n03451| \n03452|       if (response.ok && data.tariff_codes && data.tariff_codes.length > 0) {\n03453|         const isFromDoor = form.fromAddressDelivery || form.fromLavsiteWarehouse;\n03454|         const isToDoor = form.toAddressDelivery;\n03455|         \n03456|         let deliveryMode: number;\n03457|         let deliveryModeText: string;\n03458|         \n03459|         if (isFromDoor && isToDoor) {\n03460|           deliveryMode = 1;\n03461|           deliveryModeText = '–¥–≤–µ—Ä—å-–¥–≤–µ—Ä—å';\n03462|         } else if (isFromDoor && !isToDoor) {\n03463|           deliveryMode = 2;\n03464|           deliveryModeText = '–¥–≤–µ—Ä—å-—Å–∫–ª–∞–¥';\n03465|         } else if (!isFromDoor && isToDoor) {\n03466|           deliveryMode = 3;\n03467|           deliveryModeText = '—Å–∫–ª–∞–¥-–¥–≤–µ—Ä—å';\n03468|         } else {\n03469|           deliveryMode = 4;\n03470|           deliveryModeText = '—Å–∫–ª–∞–¥-—Å–∫–ª–∞–¥';\n03471|         }\n03472| \n03473|         console.log(`üì¶ CDEK –≤—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º –¥–æ—Å—Ç–∞–≤–∫–∏: ${deliveryMode} (${deliveryModeText})`);\n03474| \n03475|         const filteredTariffs = data.tariff_codes.filter((t: any) => t.delivery_mode === deliveryMode);\n03476|         \n03477|         console.log(`üì¶ CDEK –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è —Ä–µ–∂–∏–º–∞ ${deliveryModeText}:`, filteredTariffs.length);\n03478| \n03479|         if (filteredTariffs.length === 0) {\n03480|           return {\n03481|             company: '–°–î–≠–ö',\n03482|             price: 0,\n03483|             days: 0,\n03484|             error: `–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∞ ${deliveryModeText}`,\n03485|             requestData,\n03486|             responseData: data,\n03487|             apiUrl\n03488|           };\n03489|         }\n03490| \n03491|         const bestTariff = filteredTariffs.reduce((min: any, tariff: any) => \n03492|           (tariff.delivery_sum < min.delivery_sum) ? tariff : min\n03493|         );\n03494| \n03495|         console.log(`üì¶ CDEK –ª—É—á—à–∏–π —Ç–∞—Ä–∏—Ñ: ${bestTariff.tariff_name} - ${bestTariff.delivery_sum}‚ÇΩ`);\n03496| \n03497|         const detailsRequest: any = {\n03498|           ...requestData,\n03499|           tariff_code: bestTariff.tariff_code,\n03500|           get_details: true\n03501|         };\n03502| \n03503|         console.log('üì¶ CDEK: –∑–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏...');\n03504| \n03505|         const detailsResponse = await fetch(apiUrl, {\n03506|           method: 'POST',\n03507|           headers: {\n03508|             'Content-Type': 'application/json',\n03509|           },\n03510|           body: JSON.stringify(detailsRequest)\n03511|         });\n03512| \n03513|         let tariffDetails: any = null;\n03514|         if (detailsResponse.ok) {\n03515|           const detailsData = await detailsResponse.json();\n03516|           tariffDetails = detailsData.tariff_details;\n03517|           console.log('üì¶ CDEK –¥–µ—Ç–∞–ª–∏ —Ç–∞—Ä–∏—Ñ–∞:', tariffDetails);\n03518|         }\n03519| \n03520|         const finalPrice = tariffDetails?.total_sum || bestTariff.delivery_sum;\n03521|         \n03522|         return {\n03523|           company: '–°–î–≠–ö',\n03524|           price: Math.round(finalPrice),\n03525|           days: bestTariff.period_max || 0,\n03526|           details: {\n03527|             tariff_name: bestTariff.tariff_name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n03528|             tariff_code: bestTariff.tariff_code,\n03529|             delivery_mode: deliveryModeText,\n03530|             period_min: bestTariff.period_min,\n03531|             period_max: bestTariff.period_max,\n03532|             calendar_min: bestTariff.calendar_min,\n03533|             calendar_max: bestTariff.calendar_max,\n03534|             all_tariffs: filteredTariffs,\n03535|             services: tariffDetails?.services || [],\n03536|             delivery_sum: tariffDetails?.delivery_sum || bestTariff.delivery_sum,\n03537|             total_sum: finalPrice,\n03538|             weight_calc: tariffDetails?.weight_calc\n03539|           },\n03540|           requestData,\n03541|           responseData: data,\n03542|           apiUrl\n03543|         };\n03544|       } else {\n03545|         return {\n03546|           company: '–°–î–≠–ö',\n03547|           price: 0,\n03548|           days: 0,\n03549|           error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –°–î–≠–ö',\n03550|           requestData,\n03551|           responseData: data,\n03552|           apiUrl\n03553|         };\n03554|       }\n03555|     } catch (error: any) {\n03556|       console.error('üì¶ –°–î–≠–ö –æ—à–∏–±–∫–∞:', error);\n03557|       return {\n03558|         company: '–°–î–≠–ö',\n03559|         price: 0,\n03560|         days: 0,\n03561|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03562|         apiUrl\n03563|       };\n03564|     }\n03565|   };\n03566| \n03567|   const calculateKit = async (): Promise<CalculationResult> => {\n03568|     const apiUrl = '/api/kit';\n03569|     \n03570|     try {\n03571|       validateMultipleCargos(form.cargos);\n03572|       \n03573|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03574| \n03575|       const requestData = {\n03576|         from_city: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n03577|         to_city: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n03578|         declared_price: form.declaredValue || 10000,\n03579|         service: ['S089']\n03580|       };\n03581| \n03582|       console.log('üöõ –ö–ò–¢ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03583| \n03584|       const response = await fetch(apiUrl, {\n03585|         method: 'POST',\n03586|         headers: {\n03587|           'Content-Type': 'application/json',\n03588|         },\n03589|         body: JSON.stringify(requestData)\n03590|       });\n03591| \n03592|       const data = await response.json();\n03593|       console.log('üöõ –ö–ò–¢ –æ—Ç–≤–µ—Ç:', data);\n03594| \n03595|       if (response.ok && Array.isArray(data) && data.length > 0) {\n03596|         const rubData = data.find((item: any) => {\n03597|           const tariffData: any = Object.values(item)[0];\n03598|           return tariffData?.currency_code === 'RUB';\n03599|         });\n03600|         \n03601|         if (rubData) {\n03602|           const tariffKey = Object.keys(rubData)[0];\n03603|           const tariffData: any = rubData[tariffKey];\n03604|           \n03605|           console.log('üöõ –ö–ò–¢ –≤—ã–±—Ä–∞–Ω —Ç–∞—Ä–∏—Ñ:', tariffKey, tariffData);\n03606| \n03607|           return {\n03608|             company: '–ö–ò–¢',\n03609|             price: Math.round(tariffData.cost || 0),\n03610|             days: tariffData.time || 0,\n03611|             details: {\n03612|               tariff_name: tariffData.name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n03613|               tariff_type: tariffKey,\n03614|               services: tariffData.detail || [],\n03615|               currency: tariffData.currency_code\n03616|             },\n03617|             requestData,\n03618|             responseData: data,\n03619|             apiUrl\n03620|           };\n03621|         }\n03622|       }\n03623| \n03624|       return {\n03625|         company: '–ö–ò–¢',\n03626|         price: 0,\n03627|         days: 0,\n03628|         error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –ö–ò–¢',\n03629|         requestData,\n03630|         responseData: data,\n03631|         apiUrl\n03632|       };\n03633|     } catch (error: any) {\n03634|       console.error('üöõ –ö–ò–¢ –æ—à–∏–±–∫–∞:', error);\n03635|       return {\n03636|         company: '–ö–ò–¢',\n03637|         price: 0,\n03638|         days: 0,\n03639|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03640|         apiUrl\n03641|       };\n03642|     }\n03643|   };\n03644| \n03645|   const handleCalculate = async () => {\n03646|     setCalculating(true);\n03647|     setCalculations([]);\n03648|     \n03649|     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ, –±–µ–∑ –¥–µ–±–∞—É–Ω—Å–∞)\n03650|     saveFormData({\n03651|       cargos: form.cargos,\n03652|       fromCity: form.fromCity,\n03653|       toCity: form.toCity,\n03654|       fromAddress: form.fromAddress,\n03655|       toAddress: form.toAddress,\n03656|       declaredValue: form.declaredValue,\n03657|       needPackaging: form.needPackaging,\n03658|       needLoading: form.needLoading,\n03659|       needCarry: form.needCarry,\n03660|       floor: form.floor,\n03661|       hasFreightLift: form.hasFreightLift,\n03662|       needInsurance: form.needInsurance,\n03663|       fromTerminal: form.fromTerminal,\n03664|       toTerminal: form.toTerminal,\n03665|       fromAddressDelivery: form.fromAddressDelivery,\n03666|       toAddressDelivery: form.toAddressDelivery,\n03667|       selectedProducts: form.selectedProducts,\n03668|     });\n03669|     \n03670|     try {\n03671|       // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—á–µ—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π\n03672|       const calculationFunctions: Promise<CalculationResult>[] = [];\n03673|       \n03674|       if (enabledCompanies.dellin) {\n03675|         calculationFunctions.push(calculateDellin());\n03676|       }\n03677|       if (enabledCompanies.pek) {\n03678|         calculationFunctions.push(calculatePEK());\n03679|       }\n03680|       if (enabledCompanies.nordwheel) {\n03681|         calculationFunctions.push(calculateNordWheel());\n03682|       }\n03683|       if (enabledCompanies.railcontinent) {\n03684|         calculationFunctions.push(calculateRailContinent());\n03685|       }\n03686|       if (enabledCompanies.vozovoz) {\n03687|         calculationFunctions.push(calculateVozovoz());\n03688|       }\n03689|       if (enabledCompanies.cdek) {\n03690|         calculationFunctions.push(calculateCdek());\n03691|       }\n03692|       if (enabledCompanies.kit) {\n03693|         calculationFunctions.push(calculateKit());\n03694|       }\n03695|       \n03696|       // –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞\n03697|       if (calculationFunctions.length === 0) {\n03698|         setCalculations([]);\n03699|         return;\n03700|       }\n03701|       \n03702|       const results = await Promise.all(calculationFunctions);\n03703|       \n03704|       // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–µ–Ω–µ\n03705|       const sortedResults = results\n03706|         .filter(result => !result.error)\n03707|         .sort((a, b) => a.price - b.price)\n03708|         .concat(results.filter(result => result.error));\n03709|       \n03710|       setCalculations(sortedResults);\n03711|     } catch (error) {\n03712|       console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ:', error);\n03713|     } finally {\n03714|       setCalculating(false);\n03715|     }\n03716|   };\n03717| \n03718|   const exportToPDF = () => {\n03719|     if (typeof window !== 'undefined') {\n03720|       // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –ø–µ—Ä–µ–¥ –ø–µ—á–∞—Ç—å—é\n03721|       const allExpanded = calculations.reduce((acc, calc) => {\n03722|         acc[calc.company] = true;\n03723|         return acc;\n03724|       }, {} as { [key: string]: boolean });\n03725|       \n03726|       setExpandedDetails(allExpanded);\n03727|       \n03728|       // –î–∞–µ–º –≤—Ä–µ–º—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM\n03729|       setTimeout(() => {\n03730|         window.print();\n03731|       }, 100);\n03732|     }\n03733|   };\n03734| \n03735|   const toggleDetails = (company: string) => {\n03736|     setExpandedDetails(prev => ({\n03737|       ...prev,\n03738|       [company]: !prev[company]\n03739|     }));\n03740|   };\n03741| \n03742|   const toggleDebugInfo = (company: string) => {\n03743|     setExpandedDebugInfo(prev => ({\n03744|       ...prev,\n03745|       [company]: !prev[company]\n03746|     }));\n03747|   };\n03748| \n03749|   // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—á–µ—Ç–∞\n03750|   const handleReset = () => {\n03751|     if (typeof window !== 'undefined') {\n03752|       // –û—á–∏—â–∞–µ–º localStorage\n03753|       localStorage.removeItem('deliveryForm');\n03754|       \n03755|       // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–æ—Ä–º—ã –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É\n03756|       setForm(initialFormState);\n03757|       \n03758|       // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n03759|       setCalculations([]);\n03760|       setExpandedDetails({});\n03761|       setExpandedDebugInfo({});\n03762|       setSuggestions([]);\n03763|       setShowSuggestions(false);\n03764|       setActiveField('');\n03765|       \n03766|       console.log('–§–æ—Ä–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é');\n03767|     }\n03768|   };\n03769| \n03770|   // –ü–∞—Ä—Å–µ—Ä –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è —á–∏—Ç–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞\n03771|   const parseCalculationDetails = (calc: CalculationResult) => {\n03772|     console.log('üîç parseCalculationDetails –ø–æ–ª—É—á–∏–ª calc:', calc?.company || 'undefined');\n03773|     console.log('üîç calc.details:', calc?.details ? '—Å—É—â–µ—Å—Ç–≤—É–µ—Ç' : 'undefined/null');\n03774|     console.log('üîç typeof calc.details:', typeof calc?.details);\n03775|     \n03776|     const details: { service: string; description: string; price: number }[] = [];\n03777|     \n03778|     try {\n03779|       if (calc.company === '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏' && calc.details) {\n03780|         console.log('üîç –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–µ—Ç–∞–ª–µ–π –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π...');\n03781|       // –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ (—É–∂–µ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –±–∞–∑–æ–≤—ã–µ —É—Å–ª—É–≥–∏ –∏ —É–ø–∞–∫–æ–≤–∫—É)\n03782|       let basePrice = calc.details?.price || calc.price || 0;\n03783|       \n03784|       // –†–∞–∑–±–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ\n03785|       let intercityPrice = 0;\n03786|       let derivalPrice = 0;\n03787|       let arrivalPrice = 0;\n03788|       let packagingPrice = 0;\n03789|       // packagingPremiums –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è - –Ω–∞–¥–±–∞–≤–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ pkg.price\n03790|       let insurancePrice = 0;\n03791|       \n03792|       // –ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞\n03793|       if (calc.details?.intercity?.price) {\n03794|         intercityPrice = calc.details.intercity.price;\n03795|         details.push({\n03796|           service: '–ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞',\n03797|           description: `${form.fromCity} - ${form.toCity}`,\n03798|           price: intercityPrice\n03799|         });\n03800|       }\n03801|       \n03802|       // –ó–∞–±–æ—Ä –≥—Ä—É–∑–∞\n03803|       if (calc.details?.derival?.price) {\n03804|         derivalPrice = calc.details.derival.price;\n03805|         details.push({\n03806|           service: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n03807|           description: '–û—Ç –∞–¥—Ä–µ—Å–∞',\n03808|           price: derivalPrice\n03809|         });\n03810|       }\n03811|       \n03812|       // –î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞\n03813|       if (calc.details?.arrival?.price) {\n03814|         arrivalPrice = calc.details.arrival.price;\n03815|         details.push({\n03816|           service: '–û—Ç–≤–æ–∑ –≥—Ä—É–∑–∞',\n03817|           description: '–î–æ –∞–¥—Ä–µ—Å–∞',\n03818|           price: arrivalPrice\n03819|         });\n03820|       }\n03821|       \n03822|       // –£–ø–∞–∫–æ–≤–∫–∞ (–Ω–∞–¥–±–∞–≤–∫–∏ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ pkg.price, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏)\n03823|       if (form.needPackaging && calc.details?.packages) {\n03824|         Object.entries(calc.details?.packages || {}).forEach(([key, pkg]: [string, any]) => {\n03825|           if (pkg.price && pkg.price > 0) {\n03826|             // –í—ã—á–∏—Å–ª—è–µ–º –±–∞–∑–æ–≤—É—é —Ü–µ–Ω—É —É–ø–∞–∫–æ–≤–∫–∏ (–±–µ–∑ –Ω–∞–¥–±–∞–≤–æ–∫) –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\n03827|             let basePkgPrice = pkg.price;\n03828|             let totalPremiums = 0;\n03829|             \n03830|             if (pkg.premiumDetails && Array.isArray(pkg.premiumDetails)) {\n03831|               totalPremiums = pkg.premiumDetails.reduce((sum: number, premium: any) => \n03832|                 sum + (premium.value || 0), 0);\n03833|               basePkgPrice = pkg.price - totalPremiums;\n03834|             }\n03835|             \n03836|             packagingPrice += pkg.price; // –í –æ–±—â—É—é —Å—É–º–º—É –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é —Ü–µ–Ω—É\n03837|             \n03838|             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—É—é —É–ø–∞–∫–æ–≤–∫—É\n03839|             details.push({\n03840|               service: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n03841|               description: '–£–ø–∞–∫–æ–≤–∞—Ç—å –≤ –∫–æ–º–ø–ª–µ–∫—Å ¬´–æ–±—Ä–µ—à—ë—Ç–∫–∞ + –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è¬ª',\n03842|               price: basePkgPrice\n03843|             });\n03844|             \n03845|             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–¥–±–∞–≤–∫–∏ –æ—Ç–¥–µ–ª—å–Ω–æ (–¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –æ–±—â–µ–π —Å—É–º–º–µ)\n03846|             if (pkg.premiumDetails && Array.isArray(pkg.premiumDetails)) {\n03847|               pkg.premiumDetails.forEach((premium: any) => {\n03848|                 if (premium.value && premium.value > 0) {\n03849|                   details.push({\n03850|                     service: '–ù–∞–¥–±–∞–≤–∫–∞ –∫ —É–ø–∞–∫–æ–≤–∫–µ',\n03851|                     description: premium.name || '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–¥–±–∞–≤–∫–∞',\n03852|                     price: premium.value\n03853|                   });\n03854|                 }\n03855|               });\n03856|             }\n03857|           }\n03858|         });\n03859|       }\n03860|       \n03861|       // –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ\n03862|       if (form.needInsurance && calc.details?.insurance) {\n03863|         insurancePrice = calc.details.insurance;\n03864|         details.push({\n03865|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n03866|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n03867|           price: insurancePrice\n03868|         });\n03869|       }\n03870|       \n03871|       // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n03872|       details.push({\n03873|         service: '–î–æ–ø.—É—Å–ª—É–≥–∏',\n03874|         description: '–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –≥—Ä—É–∑–∞',\n03875|         price: 15\n03876|       });\n03877|       \n03878|       // –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É —Å—É–º–º–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é, –¥–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞—Ç–æ–∫\n03879|       const calculatedSum = intercityPrice + derivalPrice + arrivalPrice + packagingPrice + insurancePrice + 15;\n03880|       const remainder = basePrice - calculatedSum;\n03881|       \n03882|       if (Math.abs(remainder) > 1) { // –ï—Å–ª–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –±–æ–ª—å—à–µ 1 —Ä—É–±–ª—è\n03883|         details.push({\n03884|           service: remainder > 0 ? '–ü—Ä–æ—á–∏–µ —É—Å–ª—É–≥–∏' : '–°–∫–∏–¥–∫–∞',\n03885|           description: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–±–æ—Ä—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏',\n03886|           price: remainder\n03887|         });\n03888|       }\n03889|     } else if (calc.company === 'Nord Wheel' && calc.details) {\n03890|       // –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –¥–ª—è Nord Wheel —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º\n03891|       if (calc.details.totalCost) {\n03892|         details.push({\n03893|           service: '–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏',\n03894|           description: '',\n03895|           price: calc.details.totalCost\n03896|         });\n03897|       }\n03898|       if (calc.details.deliveryCost) {\n03899|         details.push({\n03900|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n03901|           description: '',\n03902|           price: calc.details.deliveryCost\n03903|         });\n03904|       }\n03905|       if (calc.details.terminalCost) {\n03906|         details.push({\n03907|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –º–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n03908|           description: '',\n03909|           price: calc.details.terminalCost\n03910|         });\n03911|       }\n03912|       if (calc.details.pickupCost) {\n03913|         details.push({\n03914|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–±–æ—Ä–∞',\n03915|           description: '',\n03916|           price: calc.details.pickupCost\n03917|         });\n03918|       }\n03919|       if (calc.details.deliveryToDoorCost) {\n03920|         details.push({\n03921|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ –¥–≤–µ—Ä–∏',\n03922|           description: '',\n03923|           price: calc.details.deliveryToDoorCost\n03924|         });\n03925|       }\n03926|       if (calc.details.additionalServices && calc.details.additionalServices > 0) {\n03927|         details.push({\n03928|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ø.—É—Å–ª—É–≥',\n03929|           description: '',\n03930|           price: calc.details.additionalServices\n03931|         });\n03932|       }\n03933| \n03934|     } else if (calc.company === '–ü–≠–ö' && calc.details?.services) {\n03935|       // –î–ª—è –ü–≠–ö –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ API\n03936|       calc.details.services.forEach((service: any) => {\n03937|         if (service.price > 0) {\n03938|           details.push({\n03939|             service: service.name || '–£—Å–ª—É–≥–∞ –ü–≠–ö',\n03940|             description: service.description || '',\n03941|             price: service.price\n03942|           });\n03943|         }\n03944|       });\n03945|     } else if (calc.company === '–°–î–≠–ö' && calc.details) {\n03946|       const cdekServiceNames: Record<string, string> = {\n03947|         'INSURANCE': '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n03948|         'HEAVY_CARGO': '–¢—è–∂–µ–ª–æ–≤–µ—Å–Ω—ã–π –≥—Ä—É–∑',\n03949|         'DELIVERY_TO_DOOR': '–î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ –¥–≤–µ—Ä–∏',\n03950|         'PICKUP_FROM_SENDER': '–ó–∞–±–æ—Ä –æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è',\n03951|         'PACKAGE': '–£–ø–∞–∫–æ–≤–∫–∞',\n03952|         'TRYING_ON': '–ü—Ä–∏–º–µ—Ä–∫–∞ –Ω–∞ –¥–æ–º—É',\n03953|         'PART_DELIVERY': '–ß–∞—Å—Ç–∏—á–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞'\n03954|       };\n03955| \n03956|       if (calc.details.services && calc.details.services.length > 0) {\n03957|         calc.details.services.forEach((service: any) => {\n03958|           const serviceName = cdekServiceNames[service.code] || service.code || '–£—Å–ª—É–≥–∞ –°–î–≠–ö';\n03959|           const servicePrice = service.total_sum || service.sum || 0;\n03960|           \n03961|           if (servicePrice > 0) {\n03962|             details.push({\n03963|               service: serviceName,\n03964|               description: service.code === 'HEAVY_CARGO' \n03965|                 ? `–°–±–æ—Ä –∑–∞ –≥–∞–±–∞—Ä–∏—Ç–Ω—ã–π –≥—Ä—É–∑ (—Ä–∞—Å—á–µ—Ç–Ω—ã–π –≤–µ—Å: ${(calc.details.weight_calc / 1000).toFixed(0)} –∫–≥)`\n03966|                 : service.code === 'INSURANCE'\n03967|                 ? `–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${form.declaredValue?.toLocaleString() || 0} ‚ÇΩ`\n03968|                 : '',\n03969|               price: servicePrice\n03970|             });\n03971|           }\n03972|         });\n03973|         \n03974|         if (calc.details.delivery_sum && calc.details.total_sum) {\n03975|           details.push({\n03976|             service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n03977|             description: '',\n03978|             price: 0\n03979|           });\n03980|           details.push({\n03981|             service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏',\n03982|             description: calc.details.tariff_name || '–ü–µ—Ä–µ–≤–æ–∑–∫–∞',\n03983|             price: Math.round(calc.details.delivery_sum)\n03984|           });\n03985|           \n03986|           const additionalSum = calc.details.services.reduce((sum: number, s: any) => \n03987|             sum + (s.total_sum || s.sum || 0), 0\n03988|           );\n03989|           \n03990|           if (additionalSum > 0) {\n03991|             details.push({\n03992|               service: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏',\n03993|               description: '–î–æ–ø. —Å–±–æ—Ä—ã',\n03994|               price: Math.round(additionalSum)\n03995|             });\n03996|           }\n03997|           \n03998|           details.push({\n03999|             service: '–ò–¢–û–ì–û',\n04000|             description: '–ö –æ–ø–ª–∞—Ç–µ',\n04001|             price: Math.round(calc.details.total_sum)\n04002|           });\n04003|         }\n04004|       } else {\n04005|         details.push({\n04006|           service: '–¢–∞—Ä–∏—Ñ',\n04007|           description: calc.details.tariff_name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n04008|           price: calc.price\n04009|         });\n04010|         \n04011|         if (calc.details.delivery_mode) {\n04012|           details.push({\n04013|             service: '–†–µ–∂–∏–º –¥–æ—Å—Ç–∞–≤–∫–∏',\n04014|             description: calc.details.delivery_mode,\n04015|             price: 0\n04016|           });\n04017|         }\n04018|       }\n04019|       \n04020|       if (calc.details.period_min && calc.details.period_max) {\n04021|         details.push({\n04022|           service: '–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏',\n04023|           description: `${calc.details.period_min}-${calc.details.period_max} –¥–Ω–µ–π`,\n04024|           price: 0\n04025|         });\n04026|       }\n04027|       \n04028|       if (calc.details.weight_calc) {\n04029|         details.push({\n04030|           service: '–†–∞—Å—á–µ—Ç–Ω—ã–π –≤–µ—Å',\n04031|           description: `${calc.details.weight_calc} –∫–≥`,\n04032|           price: 0\n04033|         });\n04034|       }\n04035|     } else if (calc.company === '–í–æ–∑–æ–≤–æ–∑' && calc.details?.service) {\n04036|       // ‚úÖ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –í–æ–∑–æ–≤–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ API –æ—Ç–≤–µ—Ç–∞\n04037|       const basePrice = calc.details.basePrice || 0;\n04038|       const finalPrice = calc.details.price || calc.price || 0;\n04039|       const totalDiscount = basePrice - finalPrice;\n04040|       \n04041|       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é —É—Å–ª—É–≥—É —Å –±–∞–∑–æ–≤–æ–π —Ü–µ–Ω–æ–π –∏ —Å–∫–∏–¥–∫–æ–π\n04042|       calc.details.service.forEach((service: any) => {\n04043|         const serviceDiscount = (service.basePrice || 0) - (service.price || 0);\n04044|         \n04045|         // –û—Å–Ω–æ–≤–Ω–∞—è —É—Å–ª—É–≥–∞\n04046|         details.push({\n04047|           service: service.name || '–£—Å–ª—É–≥–∞ –í–æ–∑–æ–≤–æ–∑',\n04048|           description: '',\n04049|           price: service.price || 0\n04050|         });\n04051|         \n04052|         // –°–∫–∏–¥–∫–∞ –Ω–∞ —É—Å–ª—É–≥—É (–µ—Å–ª–∏ –µ—Å—Ç—å)\n04053|         if (serviceDiscount > 0) {\n04054|           details.push({\n04055|             service: `–°–∫–∏–¥–∫–∞ –Ω–∞ ${service.name?.toLowerCase() || '—É—Å–ª—É–≥—É'}`,\n04056|             description: `${(service.basePrice || 0).toLocaleString()} - ${(service.price || 0).toLocaleString()}`,\n04057|             price: -serviceDiscount\n04058|           });\n04059|         }\n04060|       });\n04061|       \n04062|       // –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –æ–±—â–∏–º–∏ —Å–∫–∏–¥–∫–∞–º–∏\n04063|       if (totalDiscount > 0) {\n04064|         details.push({\n04065|           service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04066|           description: '',\n04067|           price: 0\n04068|         });\n04069|         details.push({\n04070|           service: '–ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å',\n04071|           description: '–î–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–¥–æ–∫',\n04072|           price: basePrice\n04073|         });\n04074|         details.push({\n04075|           service: '–û–±—â–∏–µ —Å–∫–∏–¥–∫–∏',\n04076|           description: `–≠–∫–æ–Ω–æ–º–∏—è ${totalDiscount.toLocaleString()} ‚ÇΩ`,\n04077|           price: -totalDiscount\n04078|         });\n04079|         details.push({\n04080|           service: '–ò–¢–û–ì–û',\n04081|           description: '–ö –æ–ø–ª–∞—Ç–µ',\n04082|           price: finalPrice\n04083|         });\n04084|       }\n04085|     } else if (calc.company === '–ö–ò–¢' && calc.details?.services) {\n04086|       calc.details.services.forEach((service: any) => {\n04087|         details.push({\n04088|           service: service.name || '–£—Å–ª—É–≥–∞ –ö–ò–¢',\n04089|           description: service.code || '',\n04090|           price: service.price || 0\n04091|         });\n04092|       });\n04093|       \n04094|       if (calc.details.tariff_name) {\n04095|         details.push({\n04096|           service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04097|           description: '',\n04098|           price: 0\n04099|         });\n04100|         details.push({\n04101|           service: '–¢–∞—Ä–∏—Ñ',\n04102|           description: calc.details.tariff_name,\n04103|           price: 0\n04104|         });\n04105|         details.push({\n04106|           service: '–ò–¢–û–ì–û',\n04107|           description: calc.details.currency || 'RUB',\n04108|           price: calc.price\n04109|         });\n04110|       }\n04111|     } else {\n04112|       // –î–ª—è –¥—Ä—É–≥–∏—Ö –¢–ö - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n04113|       details.push({\n04114|         service: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n04115|         description: `${form.fromCity} - ${form.toCity}`,\n04116|         price: calc.price\n04117|       });\n04118|       \n04119|       if (form.needInsurance && form.declaredValue > 0) {\n04120|         details.push({\n04121|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n04122|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n04123|           price: Math.round(form.declaredValue * 0.02)\n04124|         });\n04125|       }\n04126|       \n04127|       if (form.needPackaging) {\n04128|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n04129|         details.push({\n04130|           service: '–£–ø–∞–∫–æ–≤–∫–∞',\n04131|           description: '',\n04132|           price: Math.round(totalWeight * 30)\n04133|         });\n04134|       }\n04135|     }\n04136|     \n04137|     return details;\n04138|   } catch (globalError) {\n04139|     console.error('‚ùå –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –û–®–ò–ë–ö–ê –≤ parseCalculationDetails:', globalError);\n04140|     console.error('‚ùå –°—Ç–µ–∫ –æ—à–∏–±–∫–∏:', globalError instanceof Error ? globalError.stack : '–ù–µ—Ç —Å—Ç–µ–∫–∞');\n04141|     console.log('‚ùå calc object:', calc);\n04142|     // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ\n04143|     return [{\n04144|       service: '–î–æ—Å—Ç–∞–≤–∫–∞',\n04145|       description: '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞',\n04146|       price: calc?.price || 0\n04147|     }];\n04148|   }\n04149| };\n04150| \n04151|   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏)\n04152|   if (!isLoaded) {\n04153|     return (\n04154|       <div className=\"min-h-screen bg-gray-900 text-white p-4 relative flex items-center justify-center\">\n04155|         <div className=\"text-center\">\n04156|           <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mx-auto mb-4\"></div>\n04157|           <p className=\"text-blue-400\">–ó–∞–≥—Ä—É–∑–∫–∞...</p>\n04158|         </div>\n04159|       </div>\n04160|     );\n04161|   }\n04162| \n04163|   return (\n04164|     <div className=\"min-h-screen bg-gray-900 text-white p-4 relative\">\n04165|       <div className=\"max-w-7xl mx-auto\">\n04166|         <div className=\"flex items-center justify-between mb-3\">\n04167|           <h1 className=\"text-xl font-bold text-blue-400\">\n04168|             –ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞ –õ–∞–≤—Å–∏—Ç\n04169|           </h1>\n04170|           \n04171|           {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */}\n04172|           <div className=\"flex items-center gap-4\">\n04173|             {isFormChanged ? (\n04174|               <div className=\"flex items-center gap-2 text-yellow-400 text-sm\">\n04175|                 <div className=\"w-2 h-2 bg-yellow-400 rounded-full animate-pulse\"></div>\n04176|                 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...\n04177|               </div>\n04178|             ) : lastSaveTime ? (\n04179|               <div className=\"flex items-center gap-2 text-green-400 text-sm\">\n04180|                 <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n04181|                 –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ {lastSaveTime.toLocaleTimeString()}\n04182|               </div>\n04183|             ) : hasStoredFormData() ? (\n04184|               <div className=\"flex items-center gap-2 text-blue-400 text-sm\">\n04185|                 <div className=\"w-2 h-2 bg-blue-400 rounded-full\"></div>\n04186|                 –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã\n04187|               </div>\n04188|             ) : null}\n04189|             \n04190|             {/* –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö */}\n04191|             {hasStoredFormData() && (\n04192|               <Button\n04193|                 onClick={() => {\n04194|                   if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã?')) {\n04195|                     clearFormData();\n04196|                     setForm(initialFormState);\n04197|                     setLastSaveTime(null);\n04198|                     setIsFormChanged(false);\n04199|                   }\n04200|                 }}\n04201|                 variant=\"outline\"\n04202|                 size=\"sm\"\n04203|                 className=\"border-red-500 text-red-400 hover:bg-red-900/20\"\n04204|               >\n04205|                 <Trash2 className=\"h-3 w-3 mr-1\" />\n04206|                 –û—á–∏—Å—Ç–∏—Ç—å\n04207|               </Button>\n04208|             )}\n04209|           </div>\n04210|         </div>\n04211|         \n04212|         {/* –ö–Ω–æ–ø–∫–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ */}\n04213|         <div className=\"flex justify-end mb-4\">\n04214|           <Button \n04215|             onClick={() => window.open('/diagnostic', '_blank')}\n04216|             variant=\"outline\" \n04217|             className=\"border-blue-500 text-blue-400 hover:bg-blue-900/20\"\n04218|           >\n04219|             <Settings className=\"h-4 w-4 mr-2\" />\n04220|             –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\n04221|           </Button>\n04222|         </div>\n04223|         \n04224|         <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3 h-[85vh]\">\n04225|           {/* –õ–µ–≤–∞—è —á–∞—Å—Ç—å - —Ñ–æ—Ä–º–∞ */}\n04226|           <div className=\"space-y-2 overflow-y-auto pr-2\">\n04227|             {/* –ö–∞—Ç–∞–ª–æ–≥ –º–µ–±–µ–ª–∏ */}\n04228|             <Card className=\"bg-gray-800 border-gray-700\">\n04229|               <CardHeader className=\"pb-2\">\n04230|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04231|                   <Package2 className=\"h-3 w-3\" />\n04232|                   –ö–∞—Ç–∞–ª–æ–≥ –º–µ–±–µ–ª–∏\n04233|                 </CardTitle>\n04234|               </CardHeader>\n04235|               <CardContent className=\"space-y-2\">\n04236|                 {/* –ü–æ–∏—Å–∫ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ */}\n04237|                 <ProductSearch \n04238|                   onProductAdd={handleProductAdd}\n04239|                   disabled={calculating}\n04240|                 />\n04241|                 \n04242|                 {/* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ */}\n04243|                 <ProductManager\n04244|                   products={form.selectedProducts}\n04245|                   onQuantityChange={handleProductQuantityChange}\n04246|                   onProductRemove={handleProductRemove}\n04247|                   disabled={calculating}\n04248|                 />\n04249|               </CardContent>\n04250|             </Card>\n04251| \n04252|             {/* –ì—Ä—É–∑—ã */}\n04253|             <Card className=\"bg-gray-800 border-gray-700\">\n04254|               <CardHeader className=\"pb-2\">\n04255|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04256|                   <Truck className=\"h-3 w-3\" />\n04257|                   –ì—Ä—É–∑—ã\n04258|                 </CardTitle>\n04259|               </CardHeader>\n04260|               <CardContent className=\"space-y-2\">\n04261|                 {groupCargosForDisplay(form.cargos).map((group, groupIndex) => (\n04262|                    <div key={`group_${groupIndex}`} className=\"border border-gray-600 rounded p-2\">\n04263|                     <div className=\"flex justify-between items-center mb-2\">\n04264|                       <h4 className=\"text-sm font-medium text-white\">\n04265|                         {group.isEmpty ? (\n04266|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1}`\n04267|                         ) : group.quantity === 1 ? (\n04268|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1}`\n04269|                         ) : (\n04270|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1} - ${group.quantity} –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –º–µ—Å—Ç–∞`\n04271|                         )}\n04272|                       </h4>\n04273|                       {form.cargos.length > 1 && group.quantity === 1 && (\n04274|                         <Button\n04275|                           variant=\"destructive\"\n04276|                           size=\"sm\"\n04277|                           onClick={() => removeCargo(form.cargos[group.indices[0]].id)}\n04278|                           className=\"h-6 text-xs\"\n04279|                         >\n04280|                           –£–¥–∞–ª–∏—Ç—å\n04281|                         </Button>\n04282|                       )}\n04283|                       {group.quantity > 1 && (\n04284|                         <Badge variant=\"secondary\" className=\"text-xs\">\n04285|                           {group.quantity} —à—Ç.\n04286|                         </Badge>\n04287|                       )}\n04288|                     </div>\n04289|                     \n04290|                     {group.isEmpty || group.quantity === 1 ? (\n04291|                       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞ –¥–ª—è –ø—É—Å—Ç—ã—Ö –≥—Ä—É–∑–æ–≤ –∏–ª–∏ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö\n04292|                       <div className=\"grid grid-cols-2 gap-2\">\n04293|                         <div>\n04294|                           <Label className=\"text-white text-xs\">–î–ª–∏–Ω–∞ (—Å–º)</Label>\n04295|                           <Input\n04296|                             type=\"number\"\n04297|                             value={form.cargos[group.indices[0]].length || ''}\n04298|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'length', Number(e.target.value))}\n04299|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04300|                           />\n04301|                         </div>\n04302|                         <div>\n04303|                           <Label className=\"text-white text-xs\">–®–∏—Ä–∏–Ω–∞ (—Å–º)</Label>\n04304|                           <Input\n04305|                             type=\"number\"\n04306|                             value={form.cargos[group.indices[0]].width || ''}\n04307|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'width', Number(e.target.value))}\n04308|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04309|                           />\n04310|                         </div>\n04311|                         <div>\n04312|                           <Label className=\"text-white text-xs\">–í—ã—Å–æ—Ç–∞ (—Å–º)</Label>\n04313|                           <Input\n04314|                             type=\"number\"\n04315|                             value={form.cargos[group.indices[0]].height || ''}\n04316|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'height', Number(e.target.value))}\n04317|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04318|                           />\n04319|                         </div>\n04320|                         <div>\n04321|                           <Label className=\"text-white text-xs\">–í–µ—Å (–∫–≥)</Label>\n04322|                           <Input\n04323|                             type=\"number\"\n04324|                             value={form.cargos[group.indices[0]].weight || ''}\n04325|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'weight', Number(e.target.value))}\n04326|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04327|                           />\n04328|                         </div>\n04329|                       </div>\n04330|                     ) : (\n04331|                       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –≥—Ä—É–ø–ø\n04332|                       <div className=\"grid grid-cols-2 gap-2 text-sm text-gray-300\">\n04333|                         <div>–î–ª–∏–Ω–∞: {group.length} —Å–º</div>\n04334|                         <div>–®–∏—Ä–∏–Ω–∞: {group.width} —Å–º</div>\n04335|                         <div>–í—ã—Å–æ—Ç–∞: {group.height} —Å–º</div>\n04336|                         <div>–í–µ—Å: {group.weight} –∫–≥</div>\n04337|                         <div className=\"col-span-2 text-xs text-blue-300 mt-1\">\n04338|                           –û–±—â–∏–π –≤–µ—Å: {(group.weight * group.quantity).toFixed(1)} –∫–≥, \n04339|                           –æ–±—ä–µ–º: {((group.length * group.width * group.height * group.quantity) / 1000000).toFixed(3)} –º¬≥\n04340|                         </div>\n04341|                       </div>\n04342|                     )}\n04343|                   </div>\n04344|                 ))}\n04345|                  <Button onClick={addCargo} className=\"w-full h-7 text-xs\" variant=\"outline\">\n04346|                   <Plus className=\"h-3 w-3 mr-1\" />\n04347|                   –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑\n04348|                 </Button>\n04349|               </CardContent>\n04350|             </Card>\n04351| \n04352|             {/* –ú–∞—Ä—à—Ä—É—Ç */}\n04353|             <Card className=\"bg-gray-800 border-gray-700\">\n04354|               <CardHeader className=\"pb-2\">\n04355|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04356|                   <Map className=\"h-3 w-3\" />\n04357|                   –ú–∞—Ä—à—Ä—É—Ç\n04358|                 </CardTitle>\n04359|               </CardHeader>\n04360|               <CardContent className=\"space-y-2\">\n04361|                 {/* –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */}\n04362|                 <div className=\"space-y-2\">\n04363|                   <Label className=\"text-sm font-medium text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</Label>\n04364|                   <div className=\"flex gap-3 flex-wrap\">\n04365|                     <label className=\"flex items-center space-x-1\">\n04366|                       <input\n04367|                         type=\"radio\"\n04368|                         name=\"fromDelivery\"\n04369|                         checked={form.fromTerminal}\n04370|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: true, fromAddressDelivery: false, fromLavsiteWarehouse: false }))}\n04371|                       />\n04372|                       <span className=\"text-white text-xs\">–û—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n04373|                     </label>\n04374|                     <label className=\"flex items-center space-x-1\">\n04375|                       <input\n04376|                         type=\"radio\"\n04377|                         name=\"fromDelivery\"\n04378|                         checked={form.fromAddressDelivery && !form.fromLavsiteWarehouse}\n04379|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: false, fromAddressDelivery: true, fromLavsiteWarehouse: false }))}\n04380|                       />\n04381|                       <span className=\"text-white text-xs\">–û—Ç –∞–¥—Ä–µ—Å–∞</span>\n04382|                     </label>\n04383|                     <label className=\"flex items-center space-x-1\">\n04384|                       <Checkbox\n04385|                         id=\"lavsiteWarehouse\"\n04386|                         checked={form.fromLavsiteWarehouse}\n04387|                         onCheckedChange={handleLavsiteWarehouseChange}\n04388|                       />\n04389|                       <span className=\"text-white text-xs cursor-pointer\">–°–æ —Å–∫–ª–∞–¥–∞ –õ–∞–≤—Å–∏—Ç</span>\n04390|                     </label>\n04391|                   </div>\n04392|                   \n04393|                   <div>\n04394|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n04395|                     <Input\n04396|                       value={form.fromCity}\n04397|                       onChange={(e) => !form.fromLavsiteWarehouse && handleAddressChange('fromCity', e.target.value, e.target)}\n04398|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n04399|                       disabled={form.fromLavsiteWarehouse}\n04400|                       className={`bg-gray-700 border-gray-600 h-7 text-white text-xs ${form.fromLavsiteWarehouse ? 'opacity-50 cursor-not-allowed' : ''}`}\n04401|                     />\n04402|                   </div>\n04403|                   \n04404|                   {form.fromAddressDelivery && (\n04405|                     <div>\n04406|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n04407|                       <Input\n04408|                         value={form.fromAddress}\n04409|                         onChange={(e) => !form.fromLavsiteWarehouse && handleAddressChange('fromAddress', e.target.value, e.target)}\n04410|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n04411|                         disabled={form.fromLavsiteWarehouse}\n04412|                         className={`bg-gray-700 border-gray-600 h-7 text-white text-xs ${form.fromLavsiteWarehouse ? 'opacity-50 cursor-not-allowed' : ''}`}\n04413|                       />\n04414|                     </div>\n04415|                   )}\n04416|                 </div>\n04417| \n04418|                 {/* –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ */}\n04419|                 <div className=\"space-y-2\">\n04420|                   <Label className=\"text-sm font-medium text-white\">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</Label>\n04421|                   <div className=\"flex gap-3 flex-wrap\">\n04422|                     <label className=\"flex items-center space-x-1\">\n04423|                       <input\n04424|                         type=\"radio\"\n04425|                         name=\"toDelivery\"\n04426|                         checked={form.toTerminal}\n04427|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: true, toAddressDelivery: false }))}\n04428|                       />\n04429|                       <span className=\"text-white text-xs\">–î–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n04430|                     </label>\n04431|                     <label className=\"flex items-center space-x-1\">\n04432|                       <input\n04433|                         type=\"radio\"\n04434|                         name=\"toDelivery\"\n04435|                         checked={form.toAddressDelivery}\n04436|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: false, toAddressDelivery: true }))}\n04437|                       />\n04438|                       <span className=\"text-white text-xs\">–î–æ –∞–¥—Ä–µ—Å–∞</span>\n04439|                     </label>\n04440|                   </div>\n04441|                   \n04442|                   <div>\n04443|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</Label>\n04444|                     <Input\n04445|                       value={form.toCity}\n04446|                       onChange={(e) => handleAddressChange('toCity', e.target.value, e.target)}\n04447|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n04448|                       className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04449|                     />\n04450|                   </div>\n04451|                   \n04452|                   {form.toAddressDelivery && (\n04453|                     <div>\n04454|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</Label>\n04455|                       <Input\n04456|                         value={form.toAddress}\n04457|                         onChange={(e) => handleAddressChange('toAddress', e.target.value, e.target)}\n04458|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n04459|                         className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04460|                       />\n04461|                     </div>\n04462|                   )}\n04463|                 </div>\n04464| \n04465|                 <div>\n04466|                   <Label className=\"text-white text-xs\">–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)</Label>\n04467|                   <Input\n04468|                     type=\"number\"\n04469|                     value={form.declaredValue || ''}\n04470|                     onChange={(e) => setForm(prev => ({ ...prev, declaredValue: Number(e.target.value) }))}\n04471|                     className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04472|                   />\n04473|                 </div>\n04474|                 \n04475|                 <div className=\"space-y-2\">\n04476|                   <div className=\"flex items-center space-x-2\">\n04477|                     <Checkbox\n04478|                       id=\"packaging\"\n04479|                       checked={form.needPackaging}\n04480|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needPackaging: checked as boolean }))}\n04481|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04482|                     />\n04483|                     <Label htmlFor=\"packaging\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø–∞–∫–æ–≤–∫–∞</Label>\n04484|                   </div>\n04485|                   \n04486|                   <div className=\"flex items-center space-x-2\">\n04487|                     <Checkbox\n04488|                       id=\"insurance\"\n04489|                       checked={form.needInsurance}\n04490|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needInsurance: checked as boolean }))}\n04491|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04492|                     />\n04493|                     <Label htmlFor=\"insurance\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</Label>\n04494|                   </div>\n04495|                   \n04496|                   <div className=\"flex items-center space-x-2\">\n04497|                     <Checkbox\n04498|                       id=\"loading\"\n04499|                       checked={form.needLoading}\n04500|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needLoading: checked as boolean }))}\n04501|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04502|                     />\n04503|                     <Label htmlFor=\"loading\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≥—Ä—É–∑–∫–∞/—Ä–∞–∑–≥—Ä—É–∑–∫–∞</Label>\n04504|                   </div>\n04505|                   \n04506|                   <div className=\"flex items-center space-x-2\">\n04507|                     <Checkbox\n04508|                       id=\"carry\"\n04509|                       checked={form.needCarry}\n04510|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needCarry: checked as boolean }))}\n04511|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04512|                     />\n04513|                     <Label htmlFor=\"carry\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—ä–µ–º</Label>\n04514|                   </div>\n04515|                   \n04516|                   {form.needCarry && (\n04517|                     <div className=\"ml-6 space-y-2 border-l-2 border-gray-600 pl-3\">\n04518|                       <div>\n04519|                         <Label className=\"text-white text-xs\">–≠—Ç–∞–∂</Label>\n04520|                         <Input\n04521|                           type=\"number\"\n04522|                           value={form.floor}\n04523|                           onChange={(e) => setForm(prev => ({ ...prev, floor: Number(e.target.value) }))}\n04524|                           className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04525|                         />\n04526|                       </div>\n04527|                       <div className=\"flex items-center space-x-2\">\n04528|                         <Checkbox\n04529|                           id=\"freightLift\"\n04530|                           checked={form.hasFreightLift}\n04531|                           onCheckedChange={(checked) => setForm(prev => ({ ...prev, hasFreightLift: checked as boolean }))}\n04532|                         />\n04533|                         <Label htmlFor=\"freightLift\" className=\"text-white text-xs\">–ù–∞–ª–∏—á–∏–µ –≥—Ä—É–∑–æ–≤–æ–≥–æ –ª–∏—Ñ—Ç–∞</Label>\n04534|                       </div>\n04535|                     </div>\n04536|                   )}\n04537|                 </div>\n04538|                 \n04539|                 <div className=\"space-y-2\">\n04540|                   <Button \n04541|                     onClick={handleCalculate} \n04542|                     className=\"w-full bg-blue-600 hover:bg-blue-700 h-7 text-xs\" \n04543|                     disabled={calculating}\n04544|                   >\n04545|                     {calculating ? '–†–∞—Å—á–µ—Ç...' : '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å'}\n04546|                   </Button>\n04547|                   \n04548|                   <Button \n04549|                     onClick={handleReset} \n04550|                     variant=\"outline\" \n04551|                     className=\"w-full h-7 text-xs text-black border-gray-600 hover:bg-gray-700 hover:text-white\" \n04552|                     disabled={calculating}\n04553|                   >\n04554|                     –°–±—Ä–æ—Å–∏—Ç—å —Ä–∞—Å—á–µ—Ç\n04555|                   </Button>\n04556|                 </div>\n04557|               </CardContent>\n04558|             </Card>\n04559|           </div>\n04560| \n04561|           {/* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã */}\n04562|           <div className=\"space-y-2 overflow-y-auto\">\n04563|             {calculations.length > 0 && (\n04564|                  <div className=\"space-y-2\">\n04565|                 <div className=\"flex justify-between items-center\">\n04566|                   <h2 className=\"text-lg font-bold text-blue-400\">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>\n04567|                   <Button \n04568|                     onClick={exportToPDF} \n04569|                     variant=\"outline\" \n04570|                     size=\"sm\" \n04571|                     className=\"h-7 text-xs border-blue-500 text-blue-400 hover:bg-blue-900/20 print:hidden\"\n04572|                   >\n04573|                     –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF\n04574|                   </Button>\n04575|                 </div>\n04576|                 \n04577|                 {calculations.map((calc, index) => (\n04578|                    <Card key={index} className=\"bg-gray-800 border-gray-700 text-xs\">\n04579|                      <CardHeader className=\"pb-1\">\n04580|                       <div className=\"flex justify-between items-center\">\n04581|                          <CardTitle className=\"text-white flex items-center gap-2 text-xs\">\n04582|                            <Building2 className=\"h-3 w-3\" />\n04583|                           {calc.company}\n04584|                         </CardTitle>\n04585|                         {calc.error ? (\n04586|                           <Badge variant=\"destructive\" className=\"text-xs\">–û—à–∏–±–∫–∞</Badge>\n04587|                         ) : (\n04588|                           <Badge variant=\"default\" className=\"bg-green-600 text-xs\">\n04589|                             {calc.price.toLocaleString()} ‚ÇΩ\n04590|                           </Badge>\n04591|                         )}\n04592|                       </div>\n04593|                     </CardHeader>\n04594|                     <CardContent className=\"pt-0\">\n04595|                       <div className=\"space-y-2\">\n04596|                         {calc.error ? (\n04597|                           <div className=\"space-y-2\">\n04598|                             <Alert className=\"border-red-600\">\n04599|                               <AlertDescription className=\"text-white text-xs\">{calc.error}</AlertDescription>\n04600|                             </Alert>\n04601|                             {calc.price > 0 && (\n04602|                               <>\n04603|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n04604|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ä–æ–∫:</strong> {calc.days} –¥–Ω–µ–π</p>\n04605|                               </>\n04606|                             )}\n04607|                           </div>\n04608|                         ) : (\n04609|                           <>\n04610|                             <p className=\"text-white text-xs\"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n04611|                             <p className=\"text-white text-xs\"><strong>–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {calc.days} –¥–Ω–µ–π</p>\n04612|                           </>\n04613|                         )}\n04614|                         \n04615|                         <div className=\"flex gap-2 mt-2\">\n04616|                           {!calc.error && (\n04617|                             <Button\n04618|                               variant=\"outline\"\n04619|                               size=\"sm\"\n04620|                               onClick={() => toggleDetails(calc.company)}\n04621|                               className=\"h-6 text-xs\"\n04622|                             >\n04623|                               {expandedDetails[calc.company] ? '–°–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ' : '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ'}\n04624|                             </Button>\n04625|                           )}\n04626|                           <Button\n04627|                             variant=\"outline\"\n04628|                             size=\"sm\"\n04629|                             onClick={() => toggleDebugInfo(calc.company)}\n04630|                             className=\"h-6 text-xs\"\n04631|                           >\n04632|                             {expandedDebugInfo[calc.company] ? '–°–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–∫—É' : '–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}\n04633|                           </Button>\n04634|                         </div>\n04635|                         \n04636|                         {/* –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ */}\n04637|                         {!calc.error && (\n04638|                           <Collapsible open={expandedDetails[calc.company]}>\n04639|                             <CollapsibleContent className=\"mt-2\">\n04640|                               <div className=\"bg-gray-900 p-3 rounded text-xs\">\n04641|                                 <h4 className=\"font-bold mb-2 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞:</h4>\n04642|                                 {(() => {\n04643|                                   const details = parseCalculationDetails(calc);\n04644|                                   const totalPrice = details.reduce((sum, detail) => sum + detail.price, 0);\n04645|                                   \n04646|                                   return (\n04647|                                     <div className=\"space-y-1\">\n04648|                                       {details.map((detail, idx) => (\n04649|                                         <div key={idx} className=\"flex justify-between text-white\">\n04650|                                           <div>\n04651|                                             <div className=\"font-medium\">{detail.service}</div>\n04652|                                             {detail.description && (\n04653|                                               <div className=\"text-gray-400 text-xs\">{detail.description}</div>\n04654|                                             )}\n04655|                                           </div>\n04656|                                           <div className=\"font-medium\">{detail.price.toLocaleString()} ‚ÇΩ</div>\n04657|                                         </div>\n04658|                                       ))}\n04659|                                     </div>\n04660|                                   );\n04661|                                 })()}\n04662|                               </div>\n04663|                             </CollapsibleContent>\n04664|                           </Collapsible>\n04665|                         )}\n04666|                         \n04667|                         {/* –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è - –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ */}\n04668|                         <Collapsible open={expandedDebugInfo[calc.company]}>\n04669|                           <CollapsibleContent className=\"mt-2\">\n04670|                             <div className=\"bg-gray-900 p-3 rounded text-xs\">\n04671|                               <h4 className=\"font-bold mb-2 text-white\">–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>\n04672|                               \n04673|                               {calc.apiUrl && (\n04674|                                 <div className=\"mb-3\">\n04675|                                   <h5 className=\"font-bold mb-1 text-white\">–ó–∞–ø—Ä–æ—Å –∫ API:</h5>\n04676|                                   <p className=\"text-gray-300 break-all text-xs\">URL: {calc.apiUrl}</p>\n04677|                                 </div>\n04678|                               )}\n04679|                               \n04680|                               {calc.sessionId && (\n04681|                                 <div className=\"mb-3\">\n04682|                                   <h5 className=\"font-bold mb-1 text-white\">Session ID:</h5>\n04683|                                   <p className=\"text-gray-300 text-xs\">{calc.sessionId}</p>\n04684|                                 </div>\n04685|                               )}\n04686|                               \n04687|                               {calc.requestData && (\n04688|                                 <div className=\"mb-3\">\n04689|                                   <h5 className=\"font-bold mb-1 text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:</h5>\n04690|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04691|                                     {JSON.stringify(calc.requestData, null, 2)}\n04692|                                   </pre>\n04693|                                 </div>\n04694|                               )}\n04695|                               \n04696|                               {calc.responseData && (\n04697|                                 <div className=\"mb-3\">\n04698|                                   <h5 className=\"font-bold mb-1 text-white\">–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:</h5>\n04699|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04700|                                     {JSON.stringify(calc.responseData, null, 2)}\n04701|                                   </pre>\n04702|                                 </div>\n04703|                               )}\n04704|                               \n04705|                               {calc.details && (\n04706|                                 <div className=\"mb-3\">\n04707|                                   <h5 className=\"font-bold mb-1 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ (JSON):</h5>\n04708|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04709|                                     {JSON.stringify(calc.details, null, 2)}\n04710|                                   </pre>\n04711|                                 </div>\n04712|                               )}\n04713|                               \n04714|                               {calc.error && (\n04715|                                 <div className=\"mb-3\">\n04716|                                   <h5 className=\"font-bold mb-1 text-red-400\">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ:</h5>\n04717|                                   <p className=\"text-red-300 text-xs\">{calc.error}</p>\n04718|                                 </div>\n04719|                               )}\n04720|                             </div>\n04721|                           </CollapsibleContent>\n04722|                         </Collapsible>\n04723|                       </div>\n04724|                     </CardContent>\n04725|                   </Card>\n04726|                 ))}\n04727|               </div>\n04728|             )}\n04729| \n04730|             {/* –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –¢–ö - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º—ã–π */}\n04731|             <Card className=\"bg-gray-800 border-gray-700\">\n04732|               <CardHeader className=\"pb-2\">\n04733|                 <CardTitle className=\"text-white text-sm\">\n04734|                   –ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ ({COMPANIES_BASE.length})\n04735|                 </CardTitle>\n04736|               </CardHeader>\n04737|               <CardContent>\n04738|                 <div className=\"grid grid-cols-2 gap-2\">\n04739|                   {COMPANIES_BASE.map((company, index) => {\n04740|                     const isConnected = apiStatus[company.apiKey as keyof typeof apiStatus] === '–ø–æ–¥–∫–ª—é—á–µ–Ω–æ';\n04741|                     const statusText = apiStatus[company.apiKey as keyof typeof apiStatus];\n04742|                     const isEnabled = enabledCompanies[company.apiKey];\n04743|                     \n04744|                     // –û—Ç–ª–∞–¥–∫–∞ –¥–ª—è –ø–µ—Ä–≤—ã—Ö 3 –∫–æ–º–ø–∞–Ω–∏–π\n04745|                     if (index < 3) {\n04746|                       console.log(`üîç –ö–æ–º–ø–∞–Ω–∏—è ${index}: ${company.name}, apiKey: ${company.apiKey}, isEnabled: ${isEnabled}, statusText: ${statusText}`);\n04747|                     }\n04748|                     \n04749|                     return (\n04750|                       <div key={index} className=\"flex items-center justify-between p-1.5 bg-gray-700 rounded\">\n04751|                         <div className=\"flex items-center gap-2\">\n04752|                           <span className=\"text-lg\">{company.logo}</span>\n04753|                           <div>\n04754|                             <p className=\"font-medium text-white text-[10px] leading-tight\">{company.name}</p>\n04755|                             <Badge \n04756|                               variant={isConnected ? \"default\" : \"destructive\"} \n04757|                               className=\"text-[9px] py-0 px-1\"\n04758|                             >\n04759|                               {isConnected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∞' : statusText === '–ø—Ä–æ–≤–µ—Ä–∫–∞...' ? '–ü—Ä–æ–≤–µ—Ä–∫–∞...' : '–û—à–∏–±–∫–∞'}\n04760|                             </Badge>\n04761|                           </div>\n04762|                         </div>\n04763|                         <div className=\"flex items-center gap-2\">\n04764|                           <span className=\"text-[9px] text-gray-300\">\n04765|                             {isEnabled ? '–í–∫–ª' : '–í—ã–∫–ª'}\n04766|                           </span>\n04767|                           <Switch\n04768|                             checked={isEnabled}\n04769|                             onCheckedChange={(checked) => {\n04770|                               setEnabledCompanies(prev => ({\n04771|                                 ...prev,\n04772|                                 [company.apiKey]: checked\n04773|                               }));\n04774|                             }}\n04775|                             disabled={!isConnected}\n04776|                           />\n04777|                         </div>\n04778|                       </div>\n04779|                     );\n04780|                   })}\n04781|                 </div>\n04782|               </CardContent>\n04783|             </Card>\n04784| \n04785|             {/* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫—É–∑–æ–≤–∞ */}\n04786|             {calculations.length > 0 && (\n04787|               <TruckVisualization \n04788|                 cargos={form.cargos.map(cargo => ({\n04789|                   id: cargo.id,\n04790|                   length: cargo.length * 10, // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n04791|                   width: cargo.width * 10,   // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n04792|                   height: cargo.height * 10, // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n04793|                   weight: cargo.weight,\n04794|                   productName: form.selectedProducts?.find(p => \n04795|                     p.cargoIndexes.includes(form.cargos.indexOf(cargo))\n04796|                   )?.product.name\n04797|                 }))}\n04798|                 isVisible={true}\n04799|               />\n04800|             )}\n04801|           </div>\n04802|         </div>\n04803|       </div>\n04804| \n04805|       {/* –ê–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∏ */}\n04806|       {showSuggestions && suggestions.length > 0 && (\n04807|         <div \n04808|           className=\"fixed z-50 bg-gray-800 border border-gray-700 rounded-md shadow-lg max-w-sm w-full max-h-60 overflow-y-auto\"\n04809|           style={{\n04810|             top: suggestionPosition.top,\n04811|             left: suggestionPosition.left\n04812|           }}\n04813|         >\n04814|           <div className=\"p-1\">\n04815|             {suggestions.map((suggestion, index) => (\n04816|               <div\n04817|                 key={index}\n04818|                 className=\"p-2 hover:bg-gray-700 cursor-pointer text-xs text-white rounded transition-colors\"\n04819|                 onClick={() => selectSuggestion(suggestion)}\n04820|               >\n04821|                 {suggestion.value}\n04822|               </div>\n04823|             ))}\n04824|           </div>\n04825|         </div>\n04826|       )}\n04827|     </div>\n04828|   );\n04829| }\n</file>",
    "metadata": {
      "preview": "      const optimalHeight = calculateOptimalHeight(form.cargos);\n      \n      // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      console.log('üöÇ Rail Continent: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n      console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n      console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);\n      console.log(`   - –û–±—â–∏–π –æ–±—ä–µ–º: ${totalVolume.toFixed(3)} –º¬≥`);\n      \n      form.cargos.forEach((cargo, index) => {\n        console.log(`   üì¶ –ú–µ—Å—Ç–æ ${index + 1}:`);\n        console.log(`     - –ì–∞–±–∞—Ä–∏—Ç—ã: ${cargo.length}√ó${cargo.width}√ó${cargo.height} —Å–º`);\n        console.log(`     - –í–µ—Å: ${cargo.weight} –∫–≥`);\n        console.log(`     - –û–±—ä–µ–º: ${((cargo.length * cargo.width * cargo.height) / 1000000).toFixed(3)} –º¬≥`);\n      });\n      \n      if (form.cargos.length > 1) {\n        const maxLength = Math.max(...form.cargos.map(c => c.length));\n        const maxWidth = Math.max(...form.cargos.map(c => c.width));\n        const maxHeight = Math.max(...form.cargos.map(c => c.height));\n        console.log(`   üìê –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${maxLength}√ó${maxWidth}√ó${maxHeight} —Å–º`);"
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1760452163937,
      "end": 1760452163943
    }
  }
}