{
  "id": "prt_98d3fd77d001vO8EMP1frZSCjl",
  "messageID": "msg_98d3fc50c001PLPXA7nlwsrvNU",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_012U9Crjwj5LBii67oXAmynU",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/components/ProductManager.tsx"
    },
    "output": "<file>\n00001| 'use client';\n00002| \n00003| import React from 'react';\n00004| import { Button } from '@/components/ui/button';\n00005| import { Input } from '@/components/ui/input';\n00006| import { Badge } from '@/components/ui/badge';\n00007| import { Card, CardContent } from '@/components/ui/card';\n00008| import { Trash2, Package, Minus, Plus } from 'lucide-react';\n00009| import { ProductInForm } from '@/lib/furniture-types';\n00010| import { formatPrice, getProductSummary } from '@/lib/furniture-utils';\n00011| \n00012| interface ProductManagerProps {\n00013|   products: ProductInForm[];\n00014|   onQuantityChange: (productId: string, addedAt: number, newQuantity: number) => void;\n00015|   onProductRemove: (productId: string, addedAt: number) => void;\n00016|   disabled?: boolean;\n00017| }\n00018| \n00019| export default function ProductManager({ \n00020|   products, \n00021|   onQuantityChange, \n00022|   onProductRemove, \n00023|   disabled = false \n00024| }: ProductManagerProps) {\n00025|   \n00026|   if (products.length === 0) {\n00027|     return (\n00028|       <div className=\"text-gray-400 text-sm py-3 text-center\">\n00029|         Товары не добавлены. Используйте поиск выше для добавления мебели.\n00030|       </div>\n00031|     );\n00032|   }\n00033|   \n00034|   return (\n00035|     <div className=\"space-y-3\">\n00036|       {products.map((productInForm) => (\n00037|         <Card \n00038|           key={`${productInForm.product.id}_${productInForm.addedAt}`}\n00039|           className=\"bg-gray-700 border-gray-600\"\n00040|         >\n00041|           <CardContent className=\"p-3\">\n00042|             <div className=\"space-y-3\">\n00043|               {/* Заголовок товара */}\n00044|               <div className=\"flex items-start justify-between\">\n00045|                 <div className=\"flex-1 min-w-0\">\n00046|                   <h4 className=\"text-white font-medium text-sm truncate\">\n00047|                     {productInForm.product.name}\n00048|                   </h4>\n00049|                   <div className=\"flex items-center gap-2 mt-1\">\n00050|                     <Badge variant=\"outline\" className=\"text-xs border-gray-500\">\n00051|                       {productInForm.product.externalCode}\n00052|                     </Badge>\n00053|                     <div className=\"flex items-center text-gray-400 text-xs\">\n00054|                       <Package className=\"h-3 w-3 mr-1\" />\n00055|                       {getProductSummary(productInForm.product)}\n00056|                     </div>\n00057|                   </div>\n00058|                 </div>\n00059|                 \n00060|                 {/* Цена за единицу */}\n00061|                 <div className=\"text-right ml-3\">\n00062|                   <div className=\"text-green-400 font-medium text-sm\">\n00063|                     {formatPrice(productInForm.product.retailPrice)}\n00064|                   </div>\n00065|                   <div className=\"text-gray-400 text-xs\">\n00066|                     за единицу\n00067|                   </div>\n00068|                 </div>\n00069|               </div>\n00070|               \n00071|               {/* Управление количеством и удаление */}\n00072|               <div className=\"flex items-center justify-between\">\n00073|                 <div className=\"flex items-center gap-2\">\n00074|                   <span className=\"text-gray-300 text-sm\">Количество:</span>\n00075|                   \n00076|                   {/* Кнопки изменения количества */}\n00077|                   <div className=\"flex items-center bg-gray-800 rounded border border-gray-600\">\n00078|                     <Button\n00079|                       type=\"button\"\n00080|                       variant=\"ghost\"\n00081|                       size=\"sm\"\n00082|                       onClick={() => {\n00083|                         const newQuantity = Math.max(1, productInForm.quantity - 1);\n00084|                         onQuantityChange(productInForm.product.id, productInForm.addedAt, newQuantity);\n00085|                       }}\n00086|                       disabled={disabled || productInForm.quantity <= 1}\n00087|                       className=\"h-8 w-8 p-0 hover:bg-gray-700\"\n00088|                     >\n00089|                       <Minus className=\"h-3 w-3\" />\n00090|                     </Button>\n00091|                     \n00092|                     <Input\n00093|                       type=\"number\"\n00094|                       min=\"1\"\n00095|                       max=\"99\"\n00096|                       value={productInForm.quantity}\n00097|                       onChange={(e) => {\n00098|                         const newQuantity = Math.max(1, Math.min(99, parseInt(e.target.value) || 1));\n00099|                         onQuantityChange(productInForm.product.id, productInForm.addedAt, newQuantity);\n00100|                       }}\n00101|                       className=\"w-16 h-8 text-center bg-transparent border-0 text-white focus:ring-0 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n00102|                       disabled={disabled}\n00103|                     />\n00104|                     \n00105|                     <Button\n00106|                       type=\"button\"\n00107|                       variant=\"ghost\"\n00108|                       size=\"sm\"\n00109|                       onClick={() => {\n00110|                         const newQuantity = Math.min(99, productInForm.quantity + 1);\n00111|                         onQuantityChange(productInForm.product.id, productInForm.addedAt, newQuantity);\n00112|                       }}\n00113|                       disabled={disabled || productInForm.quantity >= 99}\n00114|                       className=\"h-8 w-8 p-0 hover:bg-gray-700\"\n00115|                     >\n00116|                       <Plus className=\"h-3 w-3\" />\n00117|                     </Button>\n00118|                   </div>\n00119|                   \n00120|                   <span className=\"text-gray-400 text-xs\">шт.</span>\n00121|                 </div>\n00122|                 \n00123|                 {/* Кнопка удаления */}\n00124|                 <Button\n00125|                   type=\"button\"\n00126|                   variant=\"destructive\"\n00127|                   size=\"sm\"\n00128|                   onClick={() => onProductRemove(productInForm.product.id, productInForm.addedAt)}\n00129|                   disabled={disabled}\n00130|                   className=\"h-8 px-3\"\n00131|                 >\n00132|                   <Trash2 className=\"h-3 w-3 mr-1\" />\n00133|                   Удалить\n00134|                 </Button>\n00135|               </div>\n00136|               \n00137|               {/* Итоговая стоимость товара */}\n00138|               {productInForm.quantity > 1 && (\n00139|                 <div className=\"pt-2 border-t border-gray-600\">\n00140|                   <div className=\"flex justify-between items-center\">\n00141|                     <span className=\"text-gray-300 text-sm\">Итого за товар:</span>\n00142|                     <span className=\"text-green-400 font-medium\">\n00143|                       {formatPrice(productInForm.totalPrice)}\n00144|                     </span>\n00145|                   </div>\n00146|                 </div>\n00147|               )}\n00148|               \n00149|               {/* Детали грузовых мест */}\n00150|               <details className=\"mt-2\">\n00151|                 <summary className=\"cursor-pointer text-xs text-gray-400 hover:text-gray-300\">\n00152|                   Грузовые места ({productInForm.product.cargoPlaces.length} на единицу, всего {productInForm.product.cargoPlaces.length * productInForm.quantity})\n00153|                 </summary>\n00154|                 <div className=\"mt-2 space-y-1\">\n00155|                   {productInForm.product.cargoPlaces.map((place) => (\n00156|                     <div key={place.placeNumber} className=\"text-xs text-gray-400 bg-gray-800 p-2 rounded\">\n00157|                       <span className=\"font-medium\">Место №{place.placeNumber}:</span>\n00158|                       {' '}\n00159|                       {place.length}×{place.depth}×{place.height} см, {place.weight} кг\n00160|                       {productInForm.quantity > 1 && (\n00161|                         <span className=\"ml-2 text-yellow-400\">\n00162|                           (×{productInForm.quantity} = {productInForm.quantity * place.weight} кг)\n00163|                         </span>\n00164|                       )}\n00165|                     </div>\n00166|                   ))}\n00167|                 </div>\n00168|               </details>\n00169|             </div>\n00170|           </CardContent>\n00171|         </Card>\n00172|       ))}\n00173|       \n00174|       {/* Итоговая статистика */}\n00175|       {products.length > 0 && (\n00176|         <Card className=\"bg-blue-900/20 border-blue-700\">\n00177|           <CardContent className=\"p-3\">\n00178|             <div className=\"space-y-2\">\n00179|               <div className=\"flex justify-between items-center\">\n00180|                 <span className=\"text-blue-300 font-medium\">Всего товаров:</span>\n00181|                 <span className=\"text-white\">\n00182|                   {products.reduce((sum, p) => sum + p.quantity, 0)} шт.\n00183|                 </span>\n00184|               </div>\n00185|               <div className=\"flex justify-between items-center\">\n00186|                 <span className=\"text-blue-300 font-medium\">Грузовых мест:</span>\n00187|                 <span className=\"text-white\">\n00188|                   {products.reduce((sum, p) => sum + p.product.cargoPlaces.length * p.quantity, 0)} шт.\n00189|                 </span>\n00190|               </div>\n00191|               <div className=\"flex justify-between items-center border-t border-blue-700 pt-2\">\n00192|                 <span className=\"text-blue-300 font-medium\">Общая стоимость:</span>\n00193|                 <span className=\"text-green-400 font-bold text-lg\">\n00194|                   {formatPrice(products.reduce((sum, p) => sum + p.totalPrice, 0))}\n00195|                 </span>\n00196|               </div>\n00197|             </div>\n00198|           </CardContent>\n00199|         </Card>\n00200|       )}\n00201|     </div>\n00202|   );\n00203| }\n</file>",
    "metadata": {
      "preview": "'use client';\n\nimport React from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Trash2, Package, Minus, Plus } from 'lucide-react';\nimport { ProductInForm } from '@/lib/furniture-types';\nimport { formatPrice, getProductSummary } from '@/lib/furniture-utils';\n\ninterface ProductManagerProps {\n  products: ProductInForm[];\n  onQuantityChange: (productId: string, addedAt: number, newQuantity: number) => void;\n  onProductRemove: (productId: string, addedAt: number) => void;\n  disabled?: boolean;\n}\n\nexport default function ProductManager({ \n  products, "
    },
    "title": "components/ProductManager.tsx",
    "time": {
      "start": 1759011395943,
      "end": 1759011395947
    }
  }
}