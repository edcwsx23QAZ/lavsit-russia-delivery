{
  "id": "prt_9ba11ef94001lXNovV2Wdfw4P0",
  "messageID": "msg_9ba118053001AJ1SfE478X1dIy",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_01Kgu5rbAfrvnUKXJGGW35H5",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx",
      "offset": 210,
      "limit": 150
    },
    "output": "<file>\n00211| \n00212|   // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ localStorage –≤ dev —Ä–µ–∂–∏–º–µ\n00213|   useEffect(() => {\n00214|     const isDev = typeof window !== 'undefined' && \n00215|                   (process.env.NODE_ENV === 'development' || \n00216|                    process.env.NODE_ENV === undefined ||\n00217|                    window.location.hostname.includes('localhost') || \n00218|                    window.location.hostname.includes('127.0.0.1') || \n00219|                    window.location.hostname.includes('.e2b.app'));\n00220|     \n00221|     if (isDev) {\n00222|       // –û—á–∏—â–∞–µ–º localStorage –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –≤ dev —Ä–µ–∂–∏–º–µ\n00223|       const devTimestamp = Date.now().toString();\n00224|       const lastDevTimestamp = localStorage.getItem('devTimestamp');\n00225|       \n00226|       if (lastDevTimestamp !== devTimestamp) {\n00227|         console.log('üßπ DEV: –û—á–∏—Å—Ç–∫–∞ localStorage –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö');\n00228|         localStorage.clear();\n00229|         localStorage.setItem('devTimestamp', devTimestamp);\n00230|       }\n00231|     }\n00232|   }, []);\n00233| \n00234|   // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ)\n00235|   useEffect(() => {\n00236|     // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ\n00237|     if (typeof window !== 'undefined' && !isLoaded) {\n00238|       try {\n00239|         // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞\n00240|         const currentVersion = 'v2.3.0-form-storage'; // –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º\n00241|         const savedVersion = localStorage.getItem('appVersion');\n00242|         \n00243|         if (savedVersion !== currentVersion) {\n00244|           console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ');\n00245|           localStorage.clear();\n00246|           localStorage.setItem('appVersion', currentVersion);\n00247|         }\n00248|         \n00249|         // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É\n00250|         const savedFormData = loadFormData();\n00251|         if (savedFormData) {\n00252|           // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\n00253|           const restoredForm: DeliveryForm = {\n00254|             cargos: savedFormData.cargos.length > 0 ? savedFormData.cargos : [{ id: '1', length: 0, width: 0, height: 0, weight: 0 }],\n00255|             fromCity: savedFormData.fromCity,\n00256|             toCity: savedFormData.toCity,\n00257|             fromAddress: savedFormData.fromAddress,\n00258|             toAddress: savedFormData.toAddress,\n00259|             declaredValue: savedFormData.declaredValue,\n00260|             needPackaging: savedFormData.needPackaging,\n00261|             needLoading: savedFormData.needLoading,\n00262|             needCarry: savedFormData.needCarry,\n00263|             floor: savedFormData.floor,\n00264|             hasFreightLift: savedFormData.hasFreightLift,\n00265|             needInsurance: savedFormData.needInsurance,\n00266|             fromTerminal: savedFormData.fromTerminal,\n00267|             toTerminal: savedFormData.toTerminal,\n00268|             fromAddressDelivery: savedFormData.fromAddressDelivery,\n00269|             toAddressDelivery: savedFormData.toAddressDelivery,\n00270|             fromLavsiteWarehouse: savedFormData.fromLavsiteWarehouse || false,\n00271|             selectedProducts: savedFormData.selectedProducts,\n00272|           };\n00273|           \n00274|           setForm(restoredForm);\n00275|           console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ localStorage');\n00276|           \n00277|           // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è Supabase\n00278|           const currentTime = Math.floor(Date.now() / 1000);\n00279|           console.log('üïí –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è (timestamp):', currentTime);\n00280|           console.log('üïí –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è (ISO):', new Date().toISOString());\n00281|         } else {\n00282|           // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏\n00283|           const oldSaved = localStorage.getItem('deliveryForm');\n00284|           if (oldSaved) {\n00285|             console.log('üîÑ –ù–∞–π–¥–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ç–∞—Ä–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è...');\n00286|             const oldForm = JSON.parse(oldSaved);\n00287|             if (!oldForm.cargos || oldForm.cargos.length === 0) {\n00288|               oldForm.cargos = [{ id: '1', length: 0, width: 0, height: 0, weight: 0 }];\n00289|             }\n00290|             setForm(oldForm);\n00291|             \n00292|             // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –∏ —É–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ\n00293|             saveFormData(oldForm);\n00294|             localStorage.removeItem('deliveryForm');\n00295|             console.log('‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');\n00296|           }\n00297|         }\n00298|         \n00299|         // –í—ã–≤–æ–¥–∏–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¢–ö –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏\n00300|         console.log('üìã –í—Å–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ –¢–ö:', COMPANIES_BASE.length);\n00301|         console.log('üìã –°–ø–∏—Å–æ–∫ –¢–ö:', COMPANIES_BASE.map(c => c.name));\n00302|         \n00303|       } catch (error) {\n00304|         console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:', error);\n00305|         // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ\n00306|       } finally {\n00307|         setIsLoaded(true);\n00308|       }\n00309|     }\n00310|   }, [isLoaded]);\n00311| \n00312|   // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã (—Å –¥–µ–±–∞—É–Ω—Å–æ–º)\n00313|   useEffect(() => {\n00314|     if (typeof window !== 'undefined' && isLoaded) {\n00315|       // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–±–∞—É–Ω—Å –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è\n00316|       debouncedSave({\n00317|         cargos: form.cargos,\n00318|         fromCity: form.fromCity,\n00319|         toCity: form.toCity,\n00320|         fromAddress: form.fromAddress,\n00321|         toAddress: form.toAddress,\n00322|         declaredValue: form.declaredValue,\n00323|         needPackaging: form.needPackaging,\n00324|         needLoading: form.needLoading,\n00325|         needCarry: form.needCarry,\n00326|         floor: form.floor,\n00327|         hasFreightLift: form.hasFreightLift,\n00328|         needInsurance: form.needInsurance,\n00329|         fromTerminal: form.fromTerminal,\n00330|         toTerminal: form.toTerminal,\n00331|         fromAddressDelivery: form.fromAddressDelivery,\n00332|         toAddressDelivery: form.toAddressDelivery,\n00333|         fromLavsiteWarehouse: form.fromLavsiteWarehouse,\n00334|         selectedProducts: form.selectedProducts,\n00335|       });\n00336|     }\n00337|   }, [form, isLoaded, debouncedSave]);\n00338| \n00339|   // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –ø—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n00340|   useEffect(() => {\n00341|     if (form.declaredValue > 0) {\n00342|       setForm(prev => ({ ...prev, needInsurance: true }));\n00343|     }\n00344|   }, [form.declaredValue]);\n00345| \n00346|   // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤\n00347|   useEffect(() => {\n00348|     const handleMessage = (event: MessageEvent) => {\n00349|       if (event.data && event.data.type === 'PRODUCTS_UPDATED') {\n00350|         console.log('üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤:', event.data.data);\n00351|         \n00352|         // –û—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫—ç—à–∏ —Ç–æ–≤–∞—Ä–æ–≤\n00353|         const keysToRemove: string[] = [];\n00354|         for (let i = 0; i < localStorage.length; i++) {\n00355|           const key = localStorage.key(i);\n00356|           if (key && (key.startsWith('furniture_') || key.startsWith('product_') || key.includes('ProductSearch'))) {\n00357|             keysToRemove.push(key);\n00358|           }\n00359|         }\n00360|         keysToRemove.forEach(key => localStorage.removeItem(key));\n\n(File has more lines. Use 'offset' parameter to read beyond line 360)\n</file>",
    "metadata": {
      "preview": "\n  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ localStorage –≤ dev —Ä–µ–∂–∏–º–µ\n  useEffect(() => {\n    const isDev = typeof window !== 'undefined' && \n                  (process.env.NODE_ENV === 'development' || \n                   process.env.NODE_ENV === undefined ||\n                   window.location.hostname.includes('localhost') || \n                   window.location.hostname.includes('127.0.0.1') || \n                   window.location.hostname.includes('.e2b.app'));\n    \n    if (isDev) {\n      // –û—á–∏—â–∞–µ–º localStorage –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –≤ dev —Ä–µ–∂–∏–º–µ\n      const devTimestamp = Date.now().toString();\n      const lastDevTimestamp = localStorage.getItem('devTimestamp');\n      \n      if (lastDevTimestamp !== devTimestamp) {\n        console.log('üßπ DEV: –û—á–∏—Å—Ç–∫–∞ localStorage –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö');\n        localStorage.clear();\n        localStorage.setItem('devTimestamp', devTimestamp);\n      }"
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1759763362561,
      "end": 1759763362563
    }
  }
}