{
  "id": "prt_a7148adcb001bgUln5h585mpyN",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "messageID": "msg_a71489e71002x59ObyNf6rfi3M",
  "type": "tool",
  "callID": "toolu_01L2Ezi7yA8pXUDBa8Nr77Zi",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "app/page.tsx",
      "limit": 100,
      "offset": 440
    },
    "output": "<file>\n00441|     \n00442|     return () => {\n00443|       window.removeEventListener('message', handleMessage);\n00444|     };\n00445|   }, []);\n00446| \n00447|   // Проверка статуса API при загрузке страницы\n00448|   useEffect(() => {\n00449|     if (typeof window !== 'undefined' && isLoaded) {\n00450|       checkAllAPIStatus();\n00451|     }\n00452|   }, [isLoaded]);\n00453| \n00454|   const checkAPIStatus = async (apiName: string, testFunction: () => Promise<any>) => {\n00455|     try {\n00456|       const result = await testFunction();\n00457|       if (result && !result.error) {\n00458|         setApiStatus(prev => ({ ...prev, [apiName]: 'подключено' }));\n00459|       } else {\n00460|         setApiStatus(prev => ({ ...prev, [apiName]: 'ошибка' }));\n00461|       }\n00462|     } catch (error) {\n00463|       setApiStatus(prev => ({ ...prev, [apiName]: 'ошибка' }));\n00464|     }\n00465|   };\n00466| \n00467|   const checkAllAPIStatus = async () => {\n00468|     // Тестовые данные для проверки\n00469|     const testData = {\n00470|       fromCity: 'Москва',\n00471|       toCity: 'Санкт-Петербург', \n00472|       cargos: [{ id: '1', length: 100, width: 100, height: 100, weight: 10 }],\n00473|       declaredValue: 50000,\n00474|       fromAddressDelivery: false,\n00475|       toAddressDelivery: false,\n00476|       needPackaging: false,\n00477|       needInsurance: false\n00478|     };\n00479| \n00480|     // Сохраняем текущее состояние формы\n00481|     const currentForm = form;\n00482|     \n00483|     // Временно устанавливаем тестовые данные\n00484|     setForm({\n00485|       ...form,\n00486|       fromCity: testData.fromCity,\n00487|       toCity: testData.toCity,\n00488|       cargos: testData.cargos,\n00489|       declaredValue: testData.declaredValue,\n00490|       fromAddressDelivery: testData.fromAddressDelivery,\n00491|       toAddressDelivery: testData.toAddressDelivery,\n00492|       needPackaging: testData.needPackaging,\n00493|       needInsurance: testData.needInsurance\n00494|     });\n00495| \n00496|     // Запускаем проверки параллельно\n00497|     Promise.all([\n00498|       checkAPIStatus('pek', async () => {\n00499|         try {\n00500|           const response = await fetch('/api/pek', {\n00501|             method: 'POST',\n00502|             headers: { 'Content-Type': 'application/json' },\n00503|             body: JSON.stringify({ method: 'test' })\n00504|           });\n00505|           const data = await response.json();\n00506|           if (data.status === 'OK') {\n00507|             return { success: true };\n00508|           } else {\n00509|             return { error: true };\n00510|           }\n00511|         } catch (error) {\n00512|           return { error: true };\n00513|         }\n00514|       }),\n00515|       \n00516|       checkAPIStatus('dellin', async () => {\n00517|         try {\n00518|           // Тестируем получение sessionID для Деловых Линий (тот же метод что в calculateDellin)\n00519|           const authResponse = await fetch('https://api.dellin.ru/v3/auth/login.json', {\n00520|             method: 'POST',\n00521|             headers: { 'Content-Type': 'application/json' },\n00522|             body: JSON.stringify({\n00523|               appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n00524|               login: 'service@lavsit.ru',\n00525|               password: 'edcwsx123QAZ'\n00526|             })\n00527|           });\n00528|           const authData = await authResponse.json();\n00529|           \n00530|           // Проверяем все возможные пути к sessionID как в calculateDellin\n00531|           if (authData.data?.sessionID || authData.sessionID || authData.data?.session) {\n00532|             return { success: true };\n00533|           } else {\n00534|             return { error: true };\n00535|           }\n00536|         } catch (error) {\n00537|           return { error: true };\n00538|         }\n00539|       }),\n00540|       \n\n(File has more lines. Use 'offset' parameter to read beyond line 540)\n</file>",
    "title": "app/page.tsx",
    "metadata": {
      "preview": "    \n    return () => {\n      window.removeEventListener('message', handleMessage);\n    };\n  }, []);\n\n  // Проверка статуса API при загрузке страницы\n  useEffect(() => {\n    if (typeof window !== 'undefined' && isLoaded) {\n      checkAllAPIStatus();\n    }\n  }, [isLoaded]);\n\n  const checkAPIStatus = async (apiName: string, testFunction: () => Promise<any>) => {\n    try {\n      const result = await testFunction();\n      if (result && !result.error) {\n        setApiStatus(prev => ({ ...prev, [apiName]: 'подключено' }));\n      } else {\n        setApiStatus(prev => ({ ...prev, [apiName]: 'ошибка' }));"
    },
    "time": {
      "start": 1762837180772,
      "end": 1762837180778
    }
  }
}