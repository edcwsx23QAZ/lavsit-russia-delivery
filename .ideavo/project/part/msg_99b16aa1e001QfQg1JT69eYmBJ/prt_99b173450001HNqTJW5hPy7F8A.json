{
  "id": "prt_99b173450001HNqTJW5hPy7F8A",
  "messageID": "msg_99b16aa1e001QfQg1JT69eYmBJ",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "write",
  "callID": "toolu_01HWq12sGMhyiZejkyHLqFbN",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/hooks/useDiagnosticState.ts",
      "content": "'use client';\n\nimport { useReducer, useCallback } from 'react';\n\nexport interface DiagnosticResult {\n  status: 'success' | 'warning' | 'error' | 'pending';\n  message: string;\n  details?: any;\n  response?: any;\n  requestData?: any;\n  timing?: number;\n}\n\nexport interface VehicleType {\n  id: string;\n  name: string;\n  length: number;\n  width: number;\n  height: number;\n}\n\nexport interface TestProgress {\n  currentTK: string;\n  completedTests: number;\n  totalPlannedTests: number;\n  stage: string;\n}\n\nexport interface FullTestResults {\n  summary: {\n    totalTests: number;\n    successful: number;\n    failed: number;\n    skipped: number;\n    errors: string[];\n    averageResponseTime: number;\n    successRate: number;\n  };\n  details: any[];\n  progressInfo: TestProgress | null;\n}\n\nexport interface DiagnosticState {\n  // Test loading states\n  isTestingPEK: boolean;\n  isTestingDellin: boolean;\n  isTestingRailContinent: boolean;\n  isTestingVozovoz: boolean;\n  isTestingNordWheel: boolean;\n  isFullTesting: boolean;\n  \n  // Results\n  diagnosticResults: { [key: string]: DiagnosticResult };\n  fullTestResults: FullTestResults | null;\n  testProgress: TestProgress & { progress: number } | null;\n  \n  // Vehicle management\n  vehicleTypes: VehicleType[];\n  newVehicle: { name: string; length: string; width: string; height: string };\n  isSaving: boolean;\n  hasUnsavedChanges: boolean;\n  saveStatus: 'idle' | 'saving' | 'success' | 'error';\n  \n  // Data updating\n  isUpdatingData: boolean;\n  updateStatus: 'idle' | 'updating' | 'success' | 'error';\n  lastUpdateTime: string | null;\n}\n\ntype DiagnosticAction =\n  | { type: 'SET_TESTING_STATE'; payload: { service: string; isLoading: boolean } }\n  | { type: 'SET_FULL_TESTING'; payload: boolean }\n  | { type: 'SET_DIAGNOSTIC_RESULT'; payload: { key: string; result: DiagnosticResult } }\n  | { type: 'SET_FULL_TEST_RESULTS'; payload: FullTestResults | null }\n  | { type: 'SET_TEST_PROGRESS'; payload: TestProgress & { progress: number } | null }\n  | { type: 'SET_VEHICLE_TYPES'; payload: VehicleType[] }\n  | { type: 'ADD_VEHICLE_TYPE'; payload: VehicleType }\n  | { type: 'REMOVE_VEHICLE_TYPE'; payload: string }\n  | { type: 'UPDATE_VEHICLE_TYPE'; payload: { id: string; field: string; value: string | number } }\n  | { type: 'SET_NEW_VEHICLE'; payload: { name: string; length: string; width: string; height: string } }\n  | { type: 'SET_SAVING_STATE'; payload: boolean }\n  | { type: 'SET_UNSAVED_CHANGES'; payload: boolean }\n  | { type: 'SET_SAVE_STATUS'; payload: 'idle' | 'saving' | 'success' | 'error' }\n  | { type: 'SET_UPDATING_DATA'; payload: boolean }\n  | { type: 'SET_UPDATE_STATUS'; payload: 'idle' | 'updating' | 'success' | 'error' }\n  | { type: 'SET_LAST_UPDATE_TIME'; payload: string | null }\n  | { type: 'RESET_DIAGNOSTIC_RESULTS' }\n  | { type: 'INITIALIZE_VEHICLE_TYPES'; payload: { vehicleTypes: VehicleType[]; lastUpdateTime: string | null } };\n\nconst initialState: DiagnosticState = {\n  isTestingPEK: false,\n  isTestingDellin: false,\n  isTestingRailContinent: false,\n  isTestingVozovoz: false,\n  isTestingNordWheel: false,\n  isFullTesting: false,\n  diagnosticResults: {},\n  fullTestResults: null,\n  testProgress: null,\n  vehicleTypes: [\n    { id: '1', name: 'Форд Транзит', length: 4200, width: 2025, height: 2025 },\n    { id: '2', name: 'Фура 18м3', length: 4200, width: 2200, height: 2000 }\n  ],\n  newVehicle: { name: '', length: '', width: '', height: '' },\n  isSaving: false,\n  hasUnsavedChanges: false,\n  saveStatus: 'idle',\n  isUpdatingData: false,\n  updateStatus: 'idle',\n  lastUpdateTime: null,\n};\n\nfunction diagnosticReducer(state: DiagnosticState, action: DiagnosticAction): DiagnosticState {\n  switch (action.type) {\n    case 'SET_TESTING_STATE':\n      const testingStateKey = `isTesting${action.payload.service}` as keyof DiagnosticState;\n      return {\n        ...state,\n        [testingStateKey]: action.payload.isLoading,\n      };\n    \n    case 'SET_FULL_TESTING':\n      return { ...state, isFullTesting: action.payload };\n    \n    case 'SET_DIAGNOSTIC_RESULT':\n      return {\n        ...state,\n        diagnosticResults: {\n          ...state.diagnosticResults,\n          [action.payload.key]: action.payload.result,\n        },\n      };\n    \n    case 'SET_FULL_TEST_RESULTS':\n      return { ...state, fullTestResults: action.payload };\n    \n    case 'SET_TEST_PROGRESS':\n      return { ...state, testProgress: action.payload };\n    \n    case 'SET_VEHICLE_TYPES':\n      return { ...state, vehicleTypes: action.payload };\n    \n    case 'ADD_VEHICLE_TYPE':\n      return {\n        ...state,\n        vehicleTypes: [...state.vehicleTypes, action.payload],\n        newVehicle: { name: '', length: '', width: '', height: '' },\n        hasUnsavedChanges: true,\n      };\n    \n    case 'REMOVE_VEHICLE_TYPE':\n      return {\n        ...state,\n        vehicleTypes: state.vehicleTypes.filter(vehicle => vehicle.id !== action.payload),\n        hasUnsavedChanges: true,\n      };\n    \n    case 'UPDATE_VEHICLE_TYPE':\n      return {\n        ...state,\n        vehicleTypes: state.vehicleTypes.map(vehicle =>\n          vehicle.id === action.payload.id\n            ? { ...vehicle, [action.payload.field]: action.payload.value }\n            : vehicle\n        ),\n        hasUnsavedChanges: true,\n      };\n    \n    case 'SET_NEW_VEHICLE':\n      return { ...state, newVehicle: action.payload };\n    \n    case 'SET_SAVING_STATE':\n      return { ...state, isSaving: action.payload };\n    \n    case 'SET_UNSAVED_CHANGES':\n      return { ...state, hasUnsavedChanges: action.payload };\n    \n    case 'SET_SAVE_STATUS':\n      return { ...state, saveStatus: action.payload };\n    \n    case 'SET_UPDATING_DATA':\n      return { ...state, isUpdatingData: action.payload };\n    \n    case 'SET_UPDATE_STATUS':\n      return { ...state, updateStatus: action.payload };\n    \n    case 'SET_LAST_UPDATE_TIME':\n      return { ...state, lastUpdateTime: action.payload };\n    \n    case 'RESET_DIAGNOSTIC_RESULTS':\n      return { ...state, diagnosticResults: {} };\n    \n    case 'INITIALIZE_VEHICLE_TYPES':\n      return {\n        ...state,\n        vehicleTypes: action.payload.vehicleTypes,\n        lastUpdateTime: action.payload.lastUpdateTime,\n      };\n    \n    default:\n      return state;\n  }\n}\n\nexport function useDiagnosticState() {\n  const [state, dispatch] = useReducer(diagnosticReducer, initialState);\n\n  // Memoized action creators\n  const setTestingState = useCallback((service: string, isLoading: boolean) => {\n    dispatch({ type: 'SET_TESTING_STATE', payload: { service, isLoading } });\n  }, []);\n\n  const setFullTesting = useCallback((isLoading: boolean) => {\n    dispatch({ type: 'SET_FULL_TESTING', payload: isLoading });\n  }, []);\n\n  const setDiagnosticResult = useCallback((key: string, result: DiagnosticResult) => {\n    dispatch({ type: 'SET_DIAGNOSTIC_RESULT', payload: { key, result } });\n  }, []);\n\n  const setFullTestResults = useCallback((results: FullTestResults | null) => {\n    dispatch({ type: 'SET_FULL_TEST_RESULTS', payload: results });\n  }, []);\n\n  const setTestProgress = useCallback((progress: TestProgress & { progress: number } | null) => {\n    dispatch({ type: 'SET_TEST_PROGRESS', payload: progress });\n  }, []);\n\n  const setVehicleTypes = useCallback((vehicleTypes: VehicleType[]) => {\n    dispatch({ type: 'SET_VEHICLE_TYPES', payload: vehicleTypes });\n  }, []);\n\n  const addVehicleType = useCallback((vehicle: VehicleType) => {\n    dispatch({ type: 'ADD_VEHICLE_TYPE', payload: vehicle });\n  }, []);\n\n  const removeVehicleType = useCallback((id: string) => {\n    dispatch({ type: 'REMOVE_VEHICLE_TYPE', payload: id });\n  }, []);\n\n  const updateVehicleType = useCallback((id: string, field: string, value: string | number) => {\n    dispatch({ type: 'UPDATE_VEHICLE_TYPE', payload: { id, field, value } });\n  }, []);\n\n  const setNewVehicle = useCallback((vehicle: { name: string; length: string; width: string; height: string }) => {\n    dispatch({ type: 'SET_NEW_VEHICLE', payload: vehicle });\n  }, []);\n\n  const setSavingState = useCallback((isSaving: boolean) => {\n    dispatch({ type: 'SET_SAVING_STATE', payload: isSaving });\n  }, []);\n\n  const setUnsavedChanges = useCallback((hasChanges: boolean) => {\n    dispatch({ type: 'SET_UNSAVED_CHANGES', payload: hasChanges });\n  }, []);\n\n  const setSaveStatus = useCallback((status: 'idle' | 'saving' | 'success' | 'error') => {\n    dispatch({ type: 'SET_SAVE_STATUS', payload: status });\n  }, []);\n\n  const setUpdatingData = useCallback((isUpdating: boolean) => {\n    dispatch({ type: 'SET_UPDATING_DATA', payload: isUpdating });\n  }, []);\n\n  const setUpdateStatus = useCallback((status: 'idle' | 'updating' | 'success' | 'error') => {\n    dispatch({ type: 'SET_UPDATE_STATUS', payload: status });\n  }, []);\n\n  const setLastUpdateTime = useCallback((time: string | null) => {\n    dispatch({ type: 'SET_LAST_UPDATE_TIME', payload: time });\n  }, []);\n\n  const resetDiagnosticResults = useCallback(() => {\n    dispatch({ type: 'RESET_DIAGNOSTIC_RESULTS' });\n  }, []);\n\n  const initializeVehicleTypes = useCallback((vehicleTypes: VehicleType[], lastUpdateTime: string | null) => {\n    dispatch({ type: 'INITIALIZE_VEHICLE_TYPES', payload: { vehicleTypes, lastUpdateTime } });\n  }, []);\n\n  return {\n    state,\n    actions: {\n      setTestingState,\n      setFullTesting,\n      setDiagnosticResult,\n      setFullTestResults,\n      setTestProgress,\n      setVehicleTypes,\n      addVehicleType,\n      removeVehicleType,\n      updateVehicleType,\n      setNewVehicle,\n      setSavingState,\n      setUnsavedChanges,\n      setSaveStatus,\n      setUpdatingData,\n      setUpdateStatus,\n      setLastUpdateTime,\n      resetDiagnosticResults,\n      initializeVehicleTypes,\n    },\n  };\n}"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "filepath": "/home/user/project/hooks/useDiagnosticState.ts",
      "exists": false
    },
    "title": "hooks/useDiagnosticState.ts",
    "time": {
      "start": 1759243642917,
      "end": 1759243642919
    }
  }
}