{
  "id": "prt_a96a9f111001xSQBhqHatgDVgF",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "messageID": "msg_a96a9ec090011tV68a15D2DAOg",
  "type": "tool",
  "callID": "call_14737249",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "app/page.tsx",
      "offset": 3400
    },
    "output": "<file>\n03401|         apiUrl\n03402|       };\n03403|     }\n03404|   };\n03405| \n03406|   // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n03407|   const calculateNordWheel = async (): Promise<CalculationResult> => {\n03408|     const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n03409|     \n03410|     try {\n03411|       // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03412|       validateMultipleCargos(form.cargos);\n03413|       \n03414|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03415|       const totalVolume = form.cargos.reduce((sum, cargo) => \n03416|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n03417|       );\n03418| \n03419|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03420|       const maxLength = Math.max(...form.cargos.map(c => c.length));\n03421|       const maxWidth = Math.max(...form.cargos.map(c => c.width));\n03422|       const maxHeight = Math.max(...form.cargos.map(c => c.height));\n03423|       \n03424|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç (>2–º –ø–æ –ª—é–±–æ–º—É –∏–∑–º–µ—Ä–µ–Ω–∏—é)\n03425|       const isOversized = maxLength > 200 || maxWidth > 200 || maxHeight > 200 || totalWeight > 1000;\n03426|       \n03427|       // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03428|       console.log('üåê Nord Wheel: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n03429|       console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n03430|       console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);\n03431|       console.log(`   - –û–±—â–∏–π –æ–±—ä–µ–º: ${totalVolume.toFixed(3)} –º¬≥`);\n03432|       \n03433|       form.cargos.forEach((cargo, index) => {\n03434|         console.log(`   üì¶ –ú–µ—Å—Ç–æ ${index + 1}:`);\n03435|         console.log(`     - –ì–∞–±–∞—Ä–∏—Ç—ã: ${cargo.length}√ó${cargo.width}√ó${cargo.height} —Å–º`);\n03436|         console.log(`     - –í–µ—Å: ${cargo.weight} –∫–≥`);\n03437|         console.log(`     - –û–±—ä–µ–º: ${((cargo.length * cargo.width * cargo.height) / 1000000).toFixed(3)} –º¬≥`);\n03438|       });\n03439|       \n03440|       if (form.cargos.length > 1) {\n03441|         console.log(`   üìê –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${maxLength}√ó${maxWidth}√ó${maxHeight} —Å–º`);\n03442|         console.log(`   üöõ –ù–µ–≥–∞–±–∞—Ä–∏—Ç: ${isOversized ? '–î–ê' : '–ù–ï–¢'}`);\n03443|       }\n03444| \n03445|       // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω—ã –≥–∞–±–∞—Ä–∏—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —É–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç–∞\n03446|       const params = new URLSearchParams({\n03447|         from: '91', // –ú–æ—Å–∫–≤–∞ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n03448|         to: '92', // –°–ü–± (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n03449|         pickup: form.fromAddressDelivery ? '1' : '0',\n03450|         deliver: form.toAddressDelivery ? '1' : '0',\n03451|         weight: totalWeight.toString(),\n03452|         volume: totalVolume.toString(),\n03453|         oversized: isOversized ? '1' : '0', // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç–∞\n03454|         package: form.needPackaging ? '1' : '0',\n03455|         packageCount: form.cargos.length.toString(),\n03456|         insurance: form.needInsurance ? '1' : '0',\n03457|         sum: form.declaredValue.toString(),\n03458|         documentsReturn: '0',\n03459|         fragile: '1',\n03460|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –ì–∞–±–∞—Ä–∏—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã\n03461|       const params = new URLSearchParams({\n03462|         from: '91', // –ú–æ—Å–∫–≤–∞ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n03463|         to: '92', // –°–ü–± (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n03464|         pickup: form.fromAddressDelivery ? '1' : '0',\n03465|         deliver: form.toAddressDelivery ? '1' : '0',\n03466|         weight: totalWeight.toString(),\n03467|         volume: totalVolume.toString(),\n03468|         oversized: isOversized ? '1' : '0', // üîß –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç–∞\n03469|         package: form.needPackaging ? '1' : '0',\n03470|         packageCount: form.cargos.length.toString(),\n03471|         insurance: form.needInsurance ? '1' : '0',\n03472|         sum: form.declaredValue.toString(),\n03473|         documentsReturn: '0',\n03474|         fragile: '1',\n03475|         // üîß –î–û–ë–ê–í–õ–ï–ù–û: –ì–∞–±–∞—Ä–∏—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã\n03476|         length: (maxLength / 100).toString(),      // –≤ –º–µ—Ç—Ä–∞—Ö\n03477|         width: (maxWidth / 100).toString(),        // –≤ –º–µ—Ç—Ä–∞—Ö\n03478|         height: (maxHeight / 100).toString(),      // –≤ –º–µ—Ç—Ä–∞—Ö\n03479|         // üîß –î–û–ë–ê–í–õ–ï–ù–û: –§–ª–∞–≥ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03480|         multiplePackages: form.cargos.length > 1 ? '1' : '0',\n03481|         // üîß –î–û–ë–ê–í–õ–ï–ù–û: API –∫–ª—é—á NordWheel\n03482|         api_key: '5|WYpV9f788Y2ASobpv3xy6N5qxtIUaKhxFF4yWETOfc398950'\n03483|       });\n03484| \n03485|   const calculateCdek = async (): Promise<CalculationResult> => {\n03486|     const apiUrl = '/api/cdek';\n03487|     \n03488|     try {\n03489|       validateMultipleCargos(form.cargos);\n03490|       \n03491|       const packages = form.cargos.map(cargo => ({\n03492|         height: cargo.height,\n03493|         length: cargo.length,\n03494|         width: cargo.width,\n03495|         weight: cargo.weight * 1000\n03496|       }));\n03497| \n03498|       const requestData: any = {\n03499|         from_city: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n03500|         to_city: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n03501|         packages: packages\n03502|       };\n03503| \n03504|       if (form.needInsurance && form.declaredValue > 0) {\n03505|         requestData.services = [{\n03506|           code: 'INSURANCE',\n03507|           parameter: form.declaredValue\n03508|         }];\n03509|         console.log('üì¶ CDEK: –¥–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ', form.declaredValue);\n03510|       }\n03511| \n03512|       console.log('üì¶ CDEK –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03513|       console.log('üì¶ CDEK –º–∞—Ä—à—Ä—É—Ç:', {\n03514|         fromAddressDelivery: form.fromAddressDelivery,\n03515|         fromLavsiteWarehouse: form.fromLavsiteWarehouse,\n03516|         toAddressDelivery: form.toAddressDelivery\n03517|       });\n03518| \n03519|        const result = await enhancedApiRequest(\n03520|          apiUrl,\n03521|          {\n03522|            method: 'POST',\n03523|            headers: {\n03524|              'Content-Type': 'application/json',\n03525|            },\n03526|            body: JSON.stringify(requestData)\n03527|          },\n03528|          { operation: 'calculate', company: '–°–î–≠–ö' }\n03529|        );\n03530| \n03531|        if (result && typeof result === 'object' && 'success' in result && !result.success) {\n03532|          console.error('‚ùå –°–î–≠–ö API –æ—à–∏–±–∫–∞:', result.error);\n03533|          return {\n03534|            company: '–°–î–≠–ö',\n03535|            price: 0,\n03536|            days: 0,\n03537|            error: result.error.userMessage || result.error.message,\n03538|            requestData,\n03539|            responseData: null,\n03540|            apiUrl\n03541|          };\n03542|        }\n03543| \n03544|        const response = result as Response;\n03545|        const data = await response.json();\n03546|        console.log('üì¶ CDEK –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω, —Ç–∞—Ä–∏—Ñ–æ–≤:', data.tariff_codes?.length || 0);\n03547| \n03548|       if (response.ok && data.tariff_codes && data.tariff_codes.length > 0) {\n03549|         const isFromDoor = form.fromAddressDelivery || form.fromLavsiteWarehouse;\n03550|         const isToDoor = form.toAddressDelivery;\n03551|         \n03552|         let deliveryMode: number;\n03553|         let deliveryModeText: string;\n03554|         \n03555|         if (isFromDoor && isToDoor) {\n03556|           deliveryMode = 1;\n03557|           deliveryModeText = '–¥–≤–µ—Ä—å-–¥–≤–µ—Ä—å';\n03558|         } else if (isFromDoor && !isToDoor) {\n03559|           deliveryMode = 2;\n03560|           deliveryModeText = '–¥–≤–µ—Ä—å-—Å–∫–ª–∞–¥';\n03561|         } else if (!isFromDoor && isToDoor) {\n03562|           deliveryMode = 3;\n03563|           deliveryModeText = '—Å–∫–ª–∞–¥-–¥–≤–µ—Ä—å';\n03564|         } else {\n03565|           deliveryMode = 4;\n03566|           deliveryModeText = '—Å–∫–ª–∞–¥-—Å–∫–ª–∞–¥';\n03567|         }\n03568| \n03569|         console.log(`üì¶ CDEK –≤—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º –¥–æ—Å—Ç–∞–≤–∫–∏: ${deliveryMode} (${deliveryModeText})`);\n03570| \n03571|         const filteredTariffs = data.tariff_codes.filter((t: any) => t.delivery_mode === deliveryMode);\n03572|         \n03573|         console.log(`üì¶ CDEK –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è —Ä–µ–∂–∏–º–∞ ${deliveryModeText}:`, filteredTariffs.length);\n03574| \n03575|         if (filteredTariffs.length === 0) {\n03576|           return {\n03577|             company: '–°–î–≠–ö',\n03578|             price: 0,\n03579|             days: 0,\n03580|             error: `–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∞ ${deliveryModeText}`,\n03581|             requestData,\n03582|             responseData: data,\n03583|             apiUrl\n03584|           };\n03585|         }\n03586| \n03587|         const bestTariff = filteredTariffs.reduce((min: any, tariff: any) => \n03588|           (tariff.delivery_sum < min.delivery_sum) ? tariff : min\n03589|         );\n03590| \n03591|         console.log(`üì¶ CDEK –ª—É—á—à–∏–π —Ç–∞—Ä–∏—Ñ: ${bestTariff.tariff_name} - ${bestTariff.delivery_sum}‚ÇΩ`);\n03592| \n03593|         const detailsRequest: any = {\n03594|           ...requestData,\n03595|           tariff_code: bestTariff.tariff_code,\n03596|           get_details: true\n03597|         };\n03598| \n03599|         console.log('üì¶ CDEK: –∑–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏...');\n03600| \n03601|           const detailsResult = await enhancedApiRequest(\n03602|             apiUrl,\n03603|             {\n03604|               method: 'POST',\n03605|               headers: {\n03606|                 'Content-Type': 'application/json',\n03607|               },\n03608|               body: JSON.stringify(detailsRequest)\n03609|             },\n03610|             { operation: 'tariff_details', company: '–°–î–≠–ö' }\n03611|           );\n03612| \n03613|           let tariffDetails: any = null;\n03614|           if (detailsResult && typeof detailsResult === 'object' && 'success' in detailsResult && detailsResult.success) {\n03615|             const detailsResponse = detailsResult as Response;\n03616|             if (detailsResponse.ok) {\n03617|               const detailsData = await detailsResponse.json();\n03618|               tariffDetails = detailsData.tariff_details;\n03619|               console.log('üì¶ –°–î–≠–ö –¥–µ—Ç–∞–ª–∏ —Ç–∞—Ä–∏—Ñ–∞:', tariffDetails);\n03620|             }\n03621|           }\n03622| \n03623|         const finalPrice = tariffDetails?.total_sum || bestTariff.delivery_sum;\n03624|         \n03625|         return {\n03626|           company: '–°–î–≠–ö',\n03627|           price: Math.round(finalPrice),\n03628|           days: bestTariff.period_max || 0,\n03629|           details: {\n03630|             tariff_name: bestTariff.tariff_name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n03631|             tariff_code: bestTariff.tariff_code,\n03632|             delivery_mode: deliveryModeText,\n03633|             period_min: bestTariff.period_min,\n03634|             period_max: bestTariff.period_max,\n03635|             calendar_min: bestTariff.calendar_min,\n03636|             calendar_max: bestTariff.calendar_max,\n03637|             all_tariffs: filteredTariffs,\n03638|             services: tariffDetails?.services || [],\n03639|             delivery_sum: tariffDetails?.delivery_sum || bestTariff.delivery_sum,\n03640|             total_sum: finalPrice,\n03641|             weight_calc: tariffDetails?.weight_calc\n03642|           },\n03643|           requestData,\n03644|           responseData: data,\n03645|           apiUrl\n03646|         };\n03647|       } else {\n03648|         return {\n03649|           company: '–°–î–≠–ö',\n03650|           price: 0,\n03651|           days: 0,\n03652|           error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –°–î–≠–ö',\n03653|           requestData,\n03654|           responseData: data,\n03655|           apiUrl\n03656|         };\n03657|       }\n03658|     } catch (error: any) {\n03659|       console.error('üì¶ –°–î–≠–ö –æ—à–∏–±–∫–∞:', error);\n03660|       return {\n03661|         company: '–°–î–≠–ö',\n03662|         price: 0,\n03663|         days: 0,\n03664|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03665|         apiUrl\n03666|       };\n03667|     }\n03668|   };\n03669| \n03670|   const calculateKit = async (): Promise<CalculationResult> => {\n03671|     const apiUrl = '/api/kit';\n03672|     \n03673|     try {\n03674|       validateMultipleCargos(form.cargos);\n03675|       \n03676|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03677| \n03678|       const requestData = {\n03679|         from_city: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n03680|         to_city: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n03681|         declared_price: form.declaredValue || 10000,\n03682|         service: ['S089']\n03683|       };\n03684| \n03685|       console.log('üöõ –ö–ò–¢ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03686| \n03687|        const result = await enhancedApiRequest(\n03688|          apiUrl,\n03689|          {\n03690|            method: 'POST',\n03691|            headers: {\n03692|              'Content-Type': 'application/json',\n03693|            },\n03694|            body: JSON.stringify(requestData)\n03695|          },\n03696|          { operation: 'calculate', company: '–ö–ò–¢' }\n03697|        );\n03698| \n03699|        if (result && typeof result === 'object' && 'success' in result && !result.success) {\n03700|          console.error('‚ùå –ö–ò–¢ API –æ—à–∏–±–∫–∞:', result.error);\n03701|          return {\n03702|            company: '–ö–ò–¢',\n03703|            price: 0,\n03704|            days: 0,\n03705|            error: result.error.userMessage || result.error.message,\n03706|            requestData,\n03707|            responseData: null,\n03708|            apiUrl\n03709|          };\n03710|        }\n03711| \n03712|        const response = result as Response;\n03713|        const data = await response.json();\n03714|        console.log('üöõ –ö–ò–¢ –æ—Ç–≤–µ—Ç:', data);\n03715| \n03716|       if (response.ok && Array.isArray(data) && data.length > 0) {\n03717|         const rubData = data.find((item: any) => {\n03718|           const tariffData: any = Object.values(item)[0];\n03719|           return tariffData?.currency_code === 'RUB';\n03720|         });\n03721|         \n03722|         if (rubData) {\n03723|           const tariffKey = Object.keys(rubData)[0];\n03724|           const tariffData: any = rubData[tariffKey];\n03725|           \n03726|           console.log('üöõ –ö–ò–¢ –≤—ã–±—Ä–∞–Ω —Ç–∞—Ä–∏—Ñ:', tariffKey, tariffData);\n03727| \n03728|           return {\n03729|             company: '–ö–ò–¢',\n03730|             price: Math.round(tariffData.cost || 0),\n03731|             days: tariffData.time || 0,\n03732|             details: {\n03733|               tariff_name: tariffData.name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n03734|               tariff_type: tariffKey,\n03735|               services: tariffData.detail || [],\n03736|               currency: tariffData.currency_code\n03737|             },\n03738|             requestData,\n03739|             responseData: data,\n03740|             apiUrl\n03741|           };\n03742|         }\n03743|       }\n03744| \n03745|       return {\n03746|         company: '–ö–ò–¢',\n03747|         price: 0,\n03748|         days: 0,\n03749|         error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –ö–ò–¢',\n03750|         requestData,\n03751|         responseData: data,\n03752|         apiUrl\n03753|       };\n03754|     } catch (error: any) {\n03755|       console.error('üöõ –ö–ò–¢ –æ—à–∏–±–∫–∞:', error);\n03756|       return {\n03757|         company: '–ö–ò–¢',\n03758|         price: 0,\n03759|         days: 0,\n03760|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03761|         apiUrl\n03762|       };\n03763|     }\n03764|   };\n03765| \n03766|   const handleCalculate = async () => {\n03767|     setCalculating(true);\n03768|     setCalculations([]);\n03769|     \n03770|     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ, –±–µ–∑ –¥–µ–±–∞—É–Ω—Å–∞)\n03771|     saveFormData({\n03772|       cargos: form.cargos,\n03773|       fromCity: form.fromCity,\n03774|       toCity: form.toCity,\n03775|       fromAddress: form.fromAddress,\n03776|       toAddress: form.toAddress,\n03777|       declaredValue: form.declaredValue,\n03778|       needPackaging: form.needPackaging,\n03779|       needLoading: form.needLoading,\n03780|       needCarry: form.needCarry,\n03781|       floor: form.floor,\n03782|       hasFreightLift: form.hasFreightLift,\n03783|       needInsurance: form.needInsurance,\n03784|       fromTerminal: form.fromTerminal,\n03785|       toTerminal: form.toTerminal,\n03786|       fromAddressDelivery: form.fromAddressDelivery,\n03787|       toAddressDelivery: form.toAddressDelivery,\n03788|       selectedProducts: form.selectedProducts,\n03789|     });\n03790|     \n03791|     try {\n03792|       // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—á–µ—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π\n03793|       const calculationFunctions: Promise<CalculationResult>[] = [];\n03794|       \n03795|       if (enabledCompanies.dellin) {\n03796|         calculationFunctions.push(calculateDellin());\n03797|       }\n03798|       if (enabledCompanies.pek) {\n03799|         calculationFunctions.push(calculatePEK());\n03800|       }\n03801|       if (enabledCompanies.nordwheel) {\n03802|         calculationFunctions.push(calculateNordWheel());\n03803|       }\n03804|       if (enabledCompanies.railcontinent) {\n03805|         calculationFunctions.push(calculateRailContinent());\n03806|       }\n03807|       if (enabledCompanies.vozovoz) {\n03808|         calculationFunctions.push(calculateVozovoz());\n03809|       }\n03810|       if (enabledCompanies.cdek) {\n03811|         calculationFunctions.push(calculateCdek());\n03812|       }\n03813|       if (enabledCompanies.kit) {\n03814|         calculationFunctions.push(calculateKit());\n03815|       }\n03816|       \n03817|       // –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞\n03818|       if (calculationFunctions.length === 0) {\n03819|         setCalculations([]);\n03820|         return;\n03821|       }\n03822|       \n03823|       const results = await Promise.all(calculationFunctions);\n03824|       \n03825|       // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–µ–Ω–µ\n03826|       const sortedResults = results\n03827|         .filter(result => !result.error)\n03828|         .sort((a, b) => a.price - b.price)\n03829|         .concat(results.filter(result => result.error));\n03830|       \n03831|       setCalculations(sortedResults);\n03832|     } catch (error) {\n03833|       console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ:', error);\n03834|     } finally {\n03835|       setCalculating(false);\n03836|     }\n03837|   };\n03838| \n03839|   const exportToPDF = () => {\n03840|     if (typeof window !== 'undefined') {\n03841|       // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –ø–µ—Ä–µ–¥ –ø–µ—á–∞—Ç—å—é\n03842|       const allExpanded = calculations.reduce((acc, calc) => {\n03843|         acc[calc.company] = true;\n03844|         return acc;\n03845|       }, {} as { [key: string]: boolean });\n03846|       \n03847|       setExpandedDetails(allExpanded);\n03848|       \n03849|       // –î–∞–µ–º –≤—Ä–µ–º—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM\n03850|       setTimeout(() => {\n03851|         window.print();\n03852|       }, 100);\n03853|     }\n03854|   };\n03855| \n03856|   const toggleDetails = (company: string) => {\n03857|     setExpandedDetails(prev => ({\n03858|       ...prev,\n03859|       [company]: !prev[company]\n03860|     }));\n03861|   };\n03862| \n03863|   const toggleDebugInfo = (company: string) => {\n03864|     setExpandedDebugInfo(prev => ({\n03865|       ...prev,\n03866|       [company]: !prev[company]\n03867|     }));\n03868|   };\n03869| \n03870|   // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—á–µ—Ç–∞\n03871|   const handleReset = () => {\n03872|     if (typeof window !== 'undefined') {\n03873|       // –û—á–∏—â–∞–µ–º localStorage\n03874|       localStorage.removeItem('deliveryForm');\n03875|       \n03876|       // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–æ—Ä–º—ã –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É\n03877|       setForm(initialFormState);\n03878|       \n03879|       // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n03880|       setCalculations([]);\n03881|       setExpandedDetails({});\n03882|       setExpandedDebugInfo({});\n03883|       setSuggestions([]);\n03884|       setShowSuggestions(false);\n03885|       setActiveField('');\n03886|       \n03887|       console.log('–§–æ—Ä–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é');\n03888|     }\n03889|   };\n03890| \n03891|   // –ü–∞—Ä—Å–µ—Ä –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è —á–∏—Ç–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞\n03892|   const parseCalculationDetails = (calc: CalculationResult) => {\n03893|     console.log('üîç parseCalculationDetails –ø–æ–ª—É—á–∏–ª calc:', calc?.company || 'undefined');\n03894|     console.log('üîç calc.details:', calc?.details ? '—Å—É—â–µ—Å—Ç–≤—É–µ—Ç' : 'undefined/null');\n03895|     console.log('üîç typeof calc.details:', typeof calc?.details);\n03896|     \n03897|     const details: { service: string; description: string; price: number }[] = [];\n03898|     \n03899|     try {\n03900|       if (calc.company === '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏' && calc.details) {\n03901|         console.log('üîç –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–µ—Ç–∞–ª–µ–π –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π...');\n03902|       // –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ (—É–∂–µ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –±–∞–∑–æ–≤—ã–µ —É—Å–ª—É–≥–∏ –∏ —É–ø–∞–∫–æ–≤–∫—É)\n03903|       let basePrice = calc.details?.price || calc.price || 0;\n03904|       \n03905|       // –†–∞–∑–±–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ\n03906|       let intercityPrice = 0;\n03907|       let derivalPrice = 0;\n03908|       let arrivalPrice = 0;\n03909|       let packagingPrice = 0;\n03910|       // packagingPremiums –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è - –Ω–∞–¥–±–∞–≤–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ pkg.price\n03911|       let insurancePrice = 0;\n03912|       \n03913|       // –ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞\n03914|       if (calc.details?.intercity?.price) {\n03915|         intercityPrice = calc.details.intercity.price;\n03916|         details.push({\n03917|           service: '–ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞',\n03918|           description: `${form.fromCity} - ${form.toCity}`,\n03919|           price: intercityPrice\n03920|         });\n03921|       }\n03922|       \n03923|       // –ó–∞–±–æ—Ä –≥—Ä—É–∑–∞\n03924|       if (calc.details?.derival?.price) {\n03925|         derivalPrice = calc.details.derival.price;\n03926|         details.push({\n03927|           service: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n03928|           description: '–û—Ç –∞–¥—Ä–µ—Å–∞',\n03929|           price: derivalPrice\n03930|         });\n03931|       }\n03932|       \n03933|       // –î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞\n03934|       if (calc.details?.arrival?.price) {\n03935|         arrivalPrice = calc.details.arrival.price;\n03936|         details.push({\n03937|           service: '–û—Ç–≤–æ–∑ –≥—Ä—É–∑–∞',\n03938|           description: '–î–æ –∞–¥—Ä–µ—Å–∞',\n03939|           price: arrivalPrice\n03940|         });\n03941|       }\n03942|       \n03943|       // –£–ø–∞–∫–æ–≤–∫–∞ (–Ω–∞–¥–±–∞–≤–∫–∏ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ pkg.price, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏)\n03944|       if (form.needPackaging && calc.details?.packages) {\n03945|         Object.entries(calc.details?.packages || {}).forEach(([key, pkg]: [string, any]) => {\n03946|           if (pkg.price && pkg.price > 0) {\n03947|             // –í—ã—á–∏—Å–ª—è–µ–º –±–∞–∑–æ–≤—É—é —Ü–µ–Ω—É —É–ø–∞–∫–æ–≤–∫–∏ (–±–µ–∑ –Ω–∞–¥–±–∞–≤–æ–∫) –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\n03948|             let basePkgPrice = pkg.price;\n03949|             let totalPremiums = 0;\n03950|             \n03951|             if (pkg.premiumDetails && Array.isArray(pkg.premiumDetails)) {\n03952|               totalPremiums = pkg.premiumDetails.reduce((sum: number, premium: any) => \n03953|                 sum + (premium.value || 0), 0);\n03954|               basePkgPrice = pkg.price - totalPremiums;\n03955|             }\n03956|             \n03957|             packagingPrice += pkg.price; // –í –æ–±—â—É—é —Å—É–º–º—É –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é —Ü–µ–Ω—É\n03958|             \n03959|             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—É—é —É–ø–∞–∫–æ–≤–∫—É\n03960|             details.push({\n03961|               service: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n03962|               description: '–£–ø–∞–∫–æ–≤–∞—Ç—å –≤ –∫–æ–º–ø–ª–µ–∫—Å ¬´–æ–±—Ä–µ—à—ë—Ç–∫–∞ + –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è¬ª',\n03963|               price: basePkgPrice\n03964|             });\n03965|             \n03966|             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–¥–±–∞–≤–∫–∏ –æ—Ç–¥–µ–ª—å–Ω–æ (–¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –æ–±—â–µ–π —Å—É–º–º–µ)\n03967|             if (pkg.premiumDetails && Array.isArray(pkg.premiumDetails)) {\n03968|               pkg.premiumDetails.forEach((premium: any) => {\n03969|                 if (premium.value && premium.value > 0) {\n03970|                   details.push({\n03971|                     service: '–ù–∞–¥–±–∞–≤–∫–∞ –∫ —É–ø–∞–∫–æ–≤–∫–µ',\n03972|                     description: premium.name || '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–¥–±–∞–≤–∫–∞',\n03973|                     price: premium.value\n03974|                   });\n03975|                 }\n03976|               });\n03977|             }\n03978|           }\n03979|         });\n03980|       }\n03981|       \n03982|       // –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ\n03983|       if (form.needInsurance && calc.details?.insurance) {\n03984|         insurancePrice = calc.details.insurance;\n03985|         details.push({\n03986|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n03987|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n03988|           price: insurancePrice\n03989|         });\n03990|       }\n03991|       \n03992|       // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n03993|       details.push({\n03994|         service: '–î–æ–ø.—É—Å–ª—É–≥–∏',\n03995|         description: '–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –≥—Ä—É–∑–∞',\n03996|         price: 15\n03997|       });\n03998|       \n03999|       // –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É —Å—É–º–º–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é, –¥–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞—Ç–æ–∫\n04000|       const calculatedSum = intercityPrice + derivalPrice + arrivalPrice + packagingPrice + insurancePrice + 15;\n04001|       const remainder = basePrice - calculatedSum;\n04002|       \n04003|       if (Math.abs(remainder) > 1) { // –ï—Å–ª–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –±–æ–ª—å—à–µ 1 —Ä—É–±–ª—è\n04004|         details.push({\n04005|           service: remainder > 0 ? '–ü—Ä–æ—á–∏–µ —É—Å–ª—É–≥–∏' : '–°–∫–∏–¥–∫–∞',\n04006|           description: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–±–æ—Ä—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏',\n04007|           price: remainder\n04008|         });\n04009|       }\n04010|     } else if (calc.company === 'Nord Wheel' && calc.details) {\n04011|       // –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –¥–ª—è Nord Wheel —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º\n04012|       if (calc.details.totalCost) {\n04013|         details.push({\n04014|           service: '–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏',\n04015|           description: '',\n04016|           price: calc.details.totalCost\n04017|         });\n04018|       }\n04019|       if (calc.details.deliveryCost) {\n04020|         details.push({\n04021|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n04022|           description: '',\n04023|           price: calc.details.deliveryCost\n04024|         });\n04025|       }\n04026|       if (calc.details.terminalCost) {\n04027|         details.push({\n04028|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –º–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n04029|           description: '',\n04030|           price: calc.details.terminalCost\n04031|         });\n04032|       }\n04033|       if (calc.details.pickupCost) {\n04034|         details.push({\n04035|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–±–æ—Ä–∞',\n04036|           description: '',\n04037|           price: calc.details.pickupCost\n04038|         });\n04039|       }\n04040|       if (calc.details.deliveryToDoorCost) {\n04041|         details.push({\n04042|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ –¥–≤–µ—Ä–∏',\n04043|           description: '',\n04044|           price: calc.details.deliveryToDoorCost\n04045|         });\n04046|       }\n04047|       if (calc.details.additionalServices && calc.details.additionalServices > 0) {\n04048|         details.push({\n04049|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ø.—É—Å–ª—É–≥',\n04050|           description: '',\n04051|           price: calc.details.additionalServices\n04052|         });\n04053|       }\n04054| \n04055|     } else if (calc.company === '–ü–≠–ö' && calc.details?.services) {\n04056|       // –î–ª—è –ü–≠–ö –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ API\n04057|       calc.details.services.forEach((service: any) => {\n04058|         if (service.price > 0) {\n04059|           details.push({\n04060|             service: service.name || '–£—Å–ª—É–≥–∞ –ü–≠–ö',\n04061|             description: service.description || '',\n04062|             price: service.price\n04063|           });\n04064|         }\n04065|       });\n04066|     } else if (calc.company === '–°–î–≠–ö' && calc.details) {\n04067|       const cdekServiceNames: Record<string, string> = {\n04068|         'INSURANCE': '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n04069|         'HEAVY_CARGO': '–¢—è–∂–µ–ª–æ–≤–µ—Å–Ω—ã–π –≥—Ä—É–∑',\n04070|         'DELIVERY_TO_DOOR': '–î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ –¥–≤–µ—Ä–∏',\n04071|         'PICKUP_FROM_SENDER': '–ó–∞–±–æ—Ä –æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è',\n04072|         'PACKAGE': '–£–ø–∞–∫–æ–≤–∫–∞',\n04073|         'TRYING_ON': '–ü—Ä–∏–º–µ—Ä–∫–∞ –Ω–∞ –¥–æ–º—É',\n04074|         'PART_DELIVERY': '–ß–∞—Å—Ç–∏—á–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞'\n04075|       };\n04076| \n04077|       if (calc.details.services && calc.details.services.length > 0) {\n04078|         calc.details.services.forEach((service: any) => {\n04079|           const serviceName = cdekServiceNames[service.code] || service.code || '–£—Å–ª—É–≥–∞ –°–î–≠–ö';\n04080|           const servicePrice = service.total_sum || service.sum || 0;\n04081|           \n04082|           if (servicePrice > 0) {\n04083|             details.push({\n04084|               service: serviceName,\n04085|               description: service.code === 'HEAVY_CARGO' \n04086|                 ? `–°–±–æ—Ä –∑–∞ –≥–∞–±–∞—Ä–∏—Ç–Ω—ã–π –≥—Ä—É–∑ (—Ä–∞—Å—á–µ—Ç–Ω—ã–π –≤–µ—Å: ${(calc.details.weight_calc / 1000).toFixed(0)} –∫–≥)`\n04087|                 : service.code === 'INSURANCE'\n04088|                 ? `–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${form.declaredValue?.toLocaleString() || 0} ‚ÇΩ`\n04089|                 : '',\n04090|               price: servicePrice\n04091|             });\n04092|           }\n04093|         });\n04094|         \n04095|         if (calc.details.delivery_sum && calc.details.total_sum) {\n04096|           details.push({\n04097|             service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04098|             description: '',\n04099|             price: 0\n04100|           });\n04101|           details.push({\n04102|             service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏',\n04103|             description: calc.details.tariff_name || '–ü–µ—Ä–µ–≤–æ–∑–∫–∞',\n04104|             price: Math.round(calc.details.delivery_sum)\n04105|           });\n04106|           \n04107|           const additionalSum = calc.details.services.reduce((sum: number, s: any) => \n04108|             sum + (s.total_sum || s.sum || 0), 0\n04109|           );\n04110|           \n04111|           if (additionalSum > 0) {\n04112|             details.push({\n04113|               service: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏',\n04114|               description: '–î–æ–ø. —Å–±–æ—Ä—ã',\n04115|               price: Math.round(additionalSum)\n04116|             });\n04117|           }\n04118|           \n04119|           details.push({\n04120|             service: '–ò–¢–û–ì–û',\n04121|             description: '–ö –æ–ø–ª–∞—Ç–µ',\n04122|             price: Math.round(calc.details.total_sum)\n04123|           });\n04124|         }\n04125|       } else {\n04126|         details.push({\n04127|           service: '–¢–∞—Ä–∏—Ñ',\n04128|           description: calc.details.tariff_name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n04129|           price: calc.price\n04130|         });\n04131|         \n04132|         if (calc.details.delivery_mode) {\n04133|           details.push({\n04134|             service: '–†–µ–∂–∏–º –¥–æ—Å—Ç–∞–≤–∫–∏',\n04135|             description: calc.details.delivery_mode,\n04136|             price: 0\n04137|           });\n04138|         }\n04139|       }\n04140|       \n04141|       if (calc.details.period_min && calc.details.period_max) {\n04142|         details.push({\n04143|           service: '–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏',\n04144|           description: `${calc.details.period_min}-${calc.details.period_max} –¥–Ω–µ–π`,\n04145|           price: 0\n04146|         });\n04147|       }\n04148|       \n04149|       if (calc.details.weight_calc) {\n04150|         details.push({\n04151|           service: '–†–∞—Å—á–µ—Ç–Ω—ã–π –≤–µ—Å',\n04152|           description: `${calc.details.weight_calc} –∫–≥`,\n04153|           price: 0\n04154|         });\n04155|       }\n04156|     } else if (calc.company === '–í–æ–∑–æ–≤–æ–∑' && calc.details?.service) {\n04157|       // ‚úÖ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –í–æ–∑–æ–≤–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ API –æ—Ç–≤–µ—Ç–∞\n04158|       const basePrice = calc.details.basePrice || 0;\n04159|       const finalPrice = calc.details.price || calc.price || 0;\n04160|       const totalDiscount = basePrice - finalPrice;\n04161|       \n04162|       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é —É—Å–ª—É–≥—É —Å –±–∞–∑–æ–≤–æ–π —Ü–µ–Ω–æ–π –∏ —Å–∫–∏–¥–∫–æ–π\n04163|       calc.details.service.forEach((service: any) => {\n04164|         const serviceDiscount = (service.basePrice || 0) - (service.price || 0);\n04165|         \n04166|         // –û—Å–Ω–æ–≤–Ω–∞—è —É—Å–ª—É–≥–∞\n04167|         details.push({\n04168|           service: service.name || '–£—Å–ª—É–≥–∞ –í–æ–∑–æ–≤–æ–∑',\n04169|           description: '',\n04170|           price: service.price || 0\n04171|         });\n04172|         \n04173|         // –°–∫–∏–¥–∫–∞ –Ω–∞ —É—Å–ª—É–≥—É (–µ—Å–ª–∏ –µ—Å—Ç—å)\n04174|         if (serviceDiscount > 0) {\n04175|           details.push({\n04176|             service: `–°–∫–∏–¥–∫–∞ –Ω–∞ ${service.name?.toLowerCase() || '—É—Å–ª—É–≥—É'}`,\n04177|             description: `${(service.basePrice || 0).toLocaleString()} - ${(service.price || 0).toLocaleString()}`,\n04178|             price: -serviceDiscount\n04179|           });\n04180|         }\n04181|       });\n04182|       \n04183|       // –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –æ–±—â–∏–º–∏ —Å–∫–∏–¥–∫–∞–º–∏\n04184|       if (totalDiscount > 0) {\n04185|         details.push({\n04186|           service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04187|           description: '',\n04188|           price: 0\n04189|         });\n04190|         details.push({\n04191|           service: '–ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å',\n04192|           description: '–î–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–¥–æ–∫',\n04193|           price: basePrice\n04194|         });\n04195|         details.push({\n04196|           service: '–û–±—â–∏–µ —Å–∫–∏–¥–∫–∏',\n04197|           description: `–≠–∫–æ–Ω–æ–º–∏—è ${totalDiscount.toLocaleString()} ‚ÇΩ`,\n04198|           price: -totalDiscount\n04199|         });\n04200|         details.push({\n04201|           service: '–ò–¢–û–ì–û',\n04202|           description: '–ö –æ–ø–ª–∞—Ç–µ',\n04203|           price: finalPrice\n04204|         });\n04205|       }\n04206|     } else if (calc.company === '–ö–ò–¢' && calc.details?.services) {\n04207|       calc.details.services.forEach((service: any) => {\n04208|         details.push({\n04209|           service: service.name || '–£—Å–ª—É–≥–∞ –ö–ò–¢',\n04210|           description: service.code || '',\n04211|           price: service.price || 0\n04212|         });\n04213|       });\n04214|       \n04215|       if (calc.details.tariff_name) {\n04216|         details.push({\n04217|           service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04218|           description: '',\n04219|           price: 0\n04220|         });\n04221|         details.push({\n04222|           service: '–¢–∞—Ä–∏—Ñ',\n04223|           description: calc.details.tariff_name,\n04224|           price: 0\n04225|         });\n04226|         details.push({\n04227|           service: '–ò–¢–û–ì–û',\n04228|           description: calc.details.currency || 'RUB',\n04229|           price: calc.price\n04230|         });\n04231|       }\n04232|     } else {\n04233|       // –î–ª—è –¥—Ä—É–≥–∏—Ö –¢–ö - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n04234|       details.push({\n04235|         service: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n04236|         description: `${form.fromCity} - ${form.toCity}`,\n04237|         price: calc.price\n04238|       });\n04239|       \n04240|       if (form.needInsurance && form.declaredValue > 0) {\n04241|         details.push({\n04242|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n04243|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n04244|           price: Math.round(form.declaredValue * 0.02)\n04245|         });\n04246|       }\n04247|       \n04248|       if (form.needPackaging) {\n04249|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n04250|         details.push({\n04251|           service: '–£–ø–∞–∫–æ–≤–∫–∞',\n04252|           description: '',\n04253|           price: Math.round(totalWeight * 30)\n04254|         });\n04255|       }\n04256|     }\n04257|     \n04258|     return details;\n04259|   } catch (globalError) {\n04260|     console.error('‚ùå –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –û–®–ò–ë–ö–ê –≤ parseCalculationDetails:', globalError);\n04261|     console.error('‚ùå –°—Ç–µ–∫ –æ—à–∏–±–∫–∏:', globalError instanceof Error ? globalError.stack : '–ù–µ—Ç —Å—Ç–µ–∫–∞');\n04262|     console.log('‚ùå calc object:', calc);\n04263|     // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ\n04264|     return [{\n04265|       service: '–î–æ—Å—Ç–∞–≤–∫–∞',\n04266|       description: '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞',\n04267|       price: calc?.price || 0\n04268|     }];\n04269|   }\n04270| };\n04271| \n04272|   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏)\n04273|   if (!isLoaded) {\n04274|     return (\n04275|       <div className=\"min-h-screen bg-gray-900 text-white p-4 relative flex items-center justify-center\">\n04276|         <div className=\"text-center\">\n04277|           <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mx-auto mb-4\"></div>\n04278|           <p className=\"text-blue-400\">–ó–∞–≥—Ä—É–∑–∫–∞...</p>\n04279|         </div>\n04280|       </div>\n04281|     );\n04282|   }\n04283| \n04284|   return (\n04285|     <div className=\"min-h-screen bg-gray-900 text-white p-4 relative\">\n04286|       <div className=\"max-w-7xl mx-auto\">\n04287|         <div className=\"flex items-center justify-between mb-3\">\n04288|           <h1 className=\"text-xl font-bold text-blue-400\">\n04289|             –ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞ –õ–∞–≤—Å–∏—Ç\n04290|           </h1>\n04291|           \n04292|           {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */}\n04293|           <div className=\"flex items-center gap-4\">\n04294|             {isFormChanged ? (\n04295|               <div className=\"flex items-center gap-2 text-yellow-400 text-sm\">\n04296|                 <div className=\"w-2 h-2 bg-yellow-400 rounded-full animate-pulse\"></div>\n04297|                 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...\n04298|               </div>\n04299|             ) : lastSaveTime ? (\n04300|               <div className=\"flex items-center gap-2 text-green-400 text-sm\">\n04301|                 <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n04302|                 –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ {lastSaveTime.toLocaleTimeString()}\n04303|               </div>\n04304|             ) : hasStoredFormData() ? (\n04305|               <div className=\"flex items-center gap-2 text-blue-400 text-sm\">\n04306|                 <div className=\"w-2 h-2 bg-blue-400 rounded-full\"></div>\n04307|                 –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã\n04308|               </div>\n04309|             ) : null}\n04310|             \n04311|             {/* –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö */}\n04312|             {hasStoredFormData() && (\n04313|               <Button\n04314|                 onClick={() => {\n04315|                   if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã?')) {\n04316|                     clearFormData();\n04317|                     setForm(initialFormState);\n04318|                     setLastSaveTime(null);\n04319|                     setIsFormChanged(false);\n04320|                   }\n04321|                 }}\n04322|                 variant=\"outline\"\n04323|                 size=\"sm\"\n04324|                 className=\"border-red-500 text-red-400 hover:bg-red-900/20\"\n04325|               >\n04326|                 <Trash2 className=\"h-3 w-3 mr-1\" />\n04327|                 –û—á–∏—Å—Ç–∏—Ç—å\n04328|               </Button>\n04329|             )}\n04330|           </div>\n04331|         </div>\n04332|         \n04333|         {/* –ö–Ω–æ–ø–∫–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ */}\n04334|         <div className=\"flex justify-end gap-2 mb-4\">\n04335|           <Button \n04336|             onClick={() => window.open('/diagnostic?tab=api', '_blank')}\n04337|             variant=\"outline\" \n04338|             className=\"border-green-500 text-green-400 hover:bg-green-900/20\"\n04339|           >\n04340|             <Settings className=\"h-4 w-4 mr-2\" />\n04341|             –í—Å–µ API\n04342|           </Button>\n04343|           <Button \n04344|             onClick={() => window.open('/diagnostic?tab=docs', '_blank')}\n04345|             variant=\"outline\" \n04346|             className=\"border-purple-500 text-purple-400 hover:bg-purple-900/20\"\n04347|           >\n04348|             <Package2 className=\"h-4 w-4 mr-2\" />\n04349|             –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è\n04350|           </Button>\n04351|           <Button \n04352|             onClick={() => window.open('/diagnostic', '_blank')}\n04353|             variant=\"outline\" \n04354|             className=\"border-blue-500 text-blue-400 hover:bg-blue-900/20\"\n04355|           >\n04356|             <Settings className=\"h-4 w-4 mr-2\" />\n04357|             –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\n04358|           </Button>\n04359|         </div>\n04360|         \n04361|         <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3 h-[85vh]\">\n04362|           {/* –õ–µ–≤–∞—è —á–∞—Å—Ç—å - —Ñ–æ—Ä–º–∞ */}\n04363|           <div className=\"space-y-2 overflow-y-auto pr-2\">\n04364|             {/* –ö–∞—Ç–∞–ª–æ–≥ –º–µ–±–µ–ª–∏ */}\n04365|             <Card className=\"bg-gray-800 border-gray-700\">\n04366|               <CardHeader className=\"pb-2\">\n04367|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04368|                   <Package2 className=\"h-3 w-3\" />\n04369|                   –ö–∞—Ç–∞–ª–æ–≥ –º–µ–±–µ–ª–∏\n04370|                 </CardTitle>\n04371|               </CardHeader>\n04372|               <CardContent className=\"space-y-2\">\n04373|                 {/* –ü–æ–∏—Å–∫ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ */}\n04374|                 <ProductSearch \n04375|                   onProductAdd={handleProductAdd}\n04376|                   disabled={calculating}\n04377|                 />\n04378|                 \n04379|                 {/* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ */}\n04380|                 <ProductManager\n04381|                   products={form.selectedProducts}\n04382|                   onQuantityChange={handleProductQuantityChange}\n04383|                   onProductRemove={handleProductRemove}\n04384|                   disabled={calculating}\n04385|                 />\n04386|               </CardContent>\n04387|             </Card>\n04388| \n04389|             {/* –ì—Ä—É–∑—ã */}\n04390|             <Card className=\"bg-gray-800 border-gray-700\">\n04391|               <CardHeader className=\"pb-2\">\n04392|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04393|                   <Truck className=\"h-3 w-3\" />\n04394|                   –ì—Ä—É–∑—ã\n04395|                 </CardTitle>\n04396|               </CardHeader>\n04397|               <CardContent className=\"space-y-2\">\n04398|                 {groupCargosForDisplay(form.cargos).map((group, groupIndex) => (\n04399|                    <div key={`group_${groupIndex}`} className=\"border border-gray-600 rounded p-2\">\n04400|                     <div className=\"flex justify-between items-center mb-2\">\n04401|                       <h4 className=\"text-sm font-medium text-white\">\n04402|                         {group.isEmpty ? (\n04403|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1}`\n04404|                         ) : group.quantity === 1 ? (\n04405|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1}`\n04406|                         ) : (\n04407|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1} - ${group.quantity} –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –º–µ—Å—Ç–∞`\n04408|                         )}\n04409|                       </h4>\n04410|                       {form.cargos.length > 1 && group.quantity === 1 && (\n04411|                         <Button\n04412|                           variant=\"destructive\"\n04413|                           size=\"sm\"\n04414|                           onClick={() => removeCargo(form.cargos[group.indices[0]].id)}\n04415|                           className=\"h-6 text-xs\"\n04416|                         >\n04417|                           –£–¥–∞–ª–∏—Ç—å\n04418|                         </Button>\n04419|                       )}\n04420|                       {group.quantity > 1 && (\n04421|                         <Badge variant=\"secondary\" className=\"text-xs\">\n04422|                           {group.quantity} —à—Ç.\n04423|                         </Badge>\n04424|                       )}\n04425|                     </div>\n04426|                     \n04427|                     {group.isEmpty || group.quantity === 1 ? (\n04428|                       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞ –¥–ª—è –ø—É—Å—Ç—ã—Ö –≥—Ä—É–∑–æ–≤ –∏–ª–∏ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö\n04429|                       <div className=\"grid grid-cols-2 gap-2\">\n04430|                         <div>\n04431|                           <Label className=\"text-white text-xs\">–î–ª–∏–Ω–∞ (—Å–º)</Label>\n04432|                           <Input\n04433|                             type=\"number\"\n04434|                             value={form.cargos[group.indices[0]].length || ''}\n04435|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'length', Number(e.target.value))}\n04436|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04437|                           />\n04438|                         </div>\n04439|                         <div>\n04440|                           <Label className=\"text-white text-xs\">–®–∏—Ä–∏–Ω–∞ (—Å–º)</Label>\n04441|                           <Input\n04442|                             type=\"number\"\n04443|                             value={form.cargos[group.indices[0]].width || ''}\n04444|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'width', Number(e.target.value))}\n04445|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04446|                           />\n04447|                         </div>\n04448|                         <div>\n04449|                           <Label className=\"text-white text-xs\">–í—ã—Å–æ—Ç–∞ (—Å–º)</Label>\n04450|                           <Input\n04451|                             type=\"number\"\n04452|                             value={form.cargos[group.indices[0]].height || ''}\n04453|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'height', Number(e.target.value))}\n04454|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04455|                           />\n04456|                         </div>\n04457|                         <div>\n04458|                           <Label className=\"text-white text-xs\">–í–µ—Å (–∫–≥)</Label>\n04459|                           <Input\n04460|                             type=\"number\"\n04461|                             value={form.cargos[group.indices[0]].weight || ''}\n04462|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'weight', Number(e.target.value))}\n04463|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04464|                           />\n04465|                         </div>\n04466|                       </div>\n04467|                     ) : (\n04468|                       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –≥—Ä—É–ø–ø\n04469|                       <div className=\"grid grid-cols-2 gap-2 text-sm text-gray-300\">\n04470|                         <div>–î–ª–∏–Ω–∞: {group.length} —Å–º</div>\n04471|                         <div>–®–∏—Ä–∏–Ω–∞: {group.width} —Å–º</div>\n04472|                         <div>–í—ã—Å–æ—Ç–∞: {group.height} —Å–º</div>\n04473|                         <div>–í–µ—Å: {group.weight} –∫–≥</div>\n04474|                         <div className=\"col-span-2 text-xs text-blue-300 mt-1\">\n04475|                           –û–±—â–∏–π –≤–µ—Å: {(group.weight * group.quantity).toFixed(1)} –∫–≥, \n04476|                           –æ–±—ä–µ–º: {((group.length * group.width * group.height * group.quantity) / 1000000).toFixed(3)} –º¬≥\n04477|                         </div>\n04478|                       </div>\n04479|                     )}\n04480|                   </div>\n04481|                 ))}\n04482|                  <Button onClick={addCargo} className=\"w-full h-7 text-xs\" variant=\"outline\">\n04483|                   <Plus className=\"h-3 w-3 mr-1\" />\n04484|                   –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑\n04485|                 </Button>\n04486|               </CardContent>\n04487|             </Card>\n04488| \n04489|             {/* –ú–∞—Ä—à—Ä—É—Ç */}\n04490|             <Card className=\"bg-gray-800 border-gray-700\">\n04491|               <CardHeader className=\"pb-2\">\n04492|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04493|                   <Map className=\"h-3 w-3\" />\n04494|                   –ú–∞—Ä—à—Ä—É—Ç\n04495|                 </CardTitle>\n04496|               </CardHeader>\n04497|               <CardContent className=\"space-y-2\">\n04498|                 {/* –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */}\n04499|                 <div className=\"space-y-2\">\n04500|                   <Label className=\"text-sm font-medium text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</Label>\n04501|                   <div className=\"flex gap-3 flex-wrap\">\n04502|                     <label className=\"flex items-center space-x-1\">\n04503|                       <input\n04504|                         type=\"radio\"\n04505|                         name=\"fromDelivery\"\n04506|                         checked={form.fromTerminal}\n04507|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: true, fromAddressDelivery: false, fromLavsiteWarehouse: false }))}\n04508|                       />\n04509|                       <span className=\"text-white text-xs\">–û—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n04510|                     </label>\n04511|                     <label className=\"flex items-center space-x-1\">\n04512|                       <input\n04513|                         type=\"radio\"\n04514|                         name=\"fromDelivery\"\n04515|                         checked={form.fromAddressDelivery && !form.fromLavsiteWarehouse}\n04516|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: false, fromAddressDelivery: true, fromLavsiteWarehouse: false }))}\n04517|                       />\n04518|                       <span className=\"text-white text-xs\">–û—Ç –∞–¥—Ä–µ—Å–∞</span>\n04519|                     </label>\n04520|                     <label className=\"flex items-center space-x-1\">\n04521|                       <Checkbox\n04522|                         id=\"lavsiteWarehouse\"\n04523|                         checked={form.fromLavsiteWarehouse}\n04524|                         onCheckedChange={handleLavsiteWarehouseChange}\n04525|                       />\n04526|                       <span className=\"text-white text-xs cursor-pointer\">–°–æ —Å–∫–ª–∞–¥–∞ –õ–∞–≤—Å–∏—Ç</span>\n04527|                     </label>\n04528|                   </div>\n04529|                   \n04530|                   <div>\n04531|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n04532|                     <Input\n04533|                       value={form.fromCity}\n04534|                       onChange={(e) => !form.fromLavsiteWarehouse && handleAddressChange('fromCity', e.target.value, e.target)}\n04535|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n04536|                       disabled={form.fromLavsiteWarehouse}\n04537|                       className={`bg-gray-700 border-gray-600 h-7 text-white text-xs ${form.fromLavsiteWarehouse ? 'opacity-50 cursor-not-allowed' : ''}`}\n04538|                     />\n04539|                   </div>\n04540|                   \n04541|                   {form.fromAddressDelivery && (\n04542|                     <div>\n04543|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n04544|                       <Input\n04545|                         value={form.fromAddress}\n04546|                         onChange={(e) => !form.fromLavsiteWarehouse && handleAddressChange('fromAddress', e.target.value, e.target)}\n04547|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n04548|                         disabled={form.fromLavsiteWarehouse}\n04549|                         className={`bg-gray-700 border-gray-600 h-7 text-white text-xs ${form.fromLavsiteWarehouse ? 'opacity-50 cursor-not-allowed' : ''}`}\n04550|                       />\n04551|                     </div>\n04552|                   )}\n04553|                 </div>\n04554| \n04555|                 {/* –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ */}\n04556|                 <div className=\"space-y-2\">\n04557|                   <Label className=\"text-sm font-medium text-white\">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</Label>\n04558|                   <div className=\"flex gap-3 flex-wrap\">\n04559|                     <label className=\"flex items-center space-x-1\">\n04560|                       <input\n04561|                         type=\"radio\"\n04562|                         name=\"toDelivery\"\n04563|                         checked={form.toTerminal}\n04564|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: true, toAddressDelivery: false }))}\n04565|                       />\n04566|                       <span className=\"text-white text-xs\">–î–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n04567|                     </label>\n04568|                     <label className=\"flex items-center space-x-1\">\n04569|                       <input\n04570|                         type=\"radio\"\n04571|                         name=\"toDelivery\"\n04572|                         checked={form.toAddressDelivery}\n04573|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: false, toAddressDelivery: true }))}\n04574|                       />\n04575|                       <span className=\"text-white text-xs\">–î–æ –∞–¥—Ä–µ—Å–∞</span>\n04576|                     </label>\n04577|                   </div>\n04578|                   \n04579|                   <div>\n04580|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</Label>\n04581|                     <Input\n04582|                       value={form.toCity}\n04583|                       onChange={(e) => handleAddressChange('toCity', e.target.value, e.target)}\n04584|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n04585|                       className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04586|                     />\n04587|                   </div>\n04588|                   \n04589|                   {form.toAddressDelivery && (\n04590|                     <div>\n04591|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</Label>\n04592|                       <Input\n04593|                         value={form.toAddress}\n04594|                         onChange={(e) => handleAddressChange('toAddress', e.target.value, e.target)}\n04595|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n04596|                         className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04597|                       />\n04598|                     </div>\n04599|                   )}\n04600|                 </div>\n04601| \n04602|                 <div>\n04603|                   <Label className=\"text-white text-xs\">–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)</Label>\n04604|                   <Input\n04605|                     type=\"number\"\n04606|                     value={form.declaredValue || ''}\n04607|                     onChange={(e) => setForm(prev => ({ ...prev, declaredValue: Number(e.target.value) }))}\n04608|                     className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04609|                   />\n04610|                 </div>\n04611|                 \n04612|                 <div className=\"space-y-2\">\n04613|                   <div className=\"flex items-center space-x-2\">\n04614|                     <Checkbox\n04615|                       id=\"packaging\"\n04616|                       checked={form.needPackaging}\n04617|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needPackaging: checked as boolean }))}\n04618|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04619|                     />\n04620|                     <Label htmlFor=\"packaging\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø–∞–∫–æ–≤–∫–∞</Label>\n04621|                   </div>\n04622|                   \n04623|                   <div className=\"flex items-center space-x-2\">\n04624|                     <Checkbox\n04625|                       id=\"insurance\"\n04626|                       checked={form.needInsurance}\n04627|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needInsurance: checked as boolean }))}\n04628|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04629|                     />\n04630|                     <Label htmlFor=\"insurance\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</Label>\n04631|                   </div>\n04632|                   \n04633|                   <div className=\"flex items-center space-x-2\">\n04634|                     <Checkbox\n04635|                       id=\"loading\"\n04636|                       checked={form.needLoading}\n04637|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needLoading: checked as boolean }))}\n04638|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04639|                     />\n04640|                     <Label htmlFor=\"loading\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≥—Ä—É–∑–∫–∞/—Ä–∞–∑–≥—Ä—É–∑–∫–∞</Label>\n04641|                   </div>\n04642|                   \n04643|                   <div className=\"flex items-center space-x-2\">\n04644|                     <Checkbox\n04645|                       id=\"carry\"\n04646|                       checked={form.needCarry}\n04647|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needCarry: checked as boolean }))}\n04648|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04649|                     />\n04650|                     <Label htmlFor=\"carry\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—ä–µ–º</Label>\n04651|                   </div>\n04652|                   \n04653|                   {form.needCarry && (\n04654|                     <div className=\"ml-6 space-y-2 border-l-2 border-gray-600 pl-3\">\n04655|                       <div>\n04656|                         <Label className=\"text-white text-xs\">–≠—Ç–∞–∂</Label>\n04657|                         <Input\n04658|                           type=\"number\"\n04659|                           value={form.floor}\n04660|                           onChange={(e) => setForm(prev => ({ ...prev, floor: Number(e.target.value) }))}\n04661|                           className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04662|                         />\n04663|                       </div>\n04664|                       <div className=\"flex items-center space-x-2\">\n04665|                         <Checkbox\n04666|                           id=\"freightLift\"\n04667|                           checked={form.hasFreightLift}\n04668|                           onCheckedChange={(checked) => setForm(prev => ({ ...prev, hasFreightLift: checked as boolean }))}\n04669|                         />\n04670|                         <Label htmlFor=\"freightLift\" className=\"text-white text-xs\">–ù–∞–ª–∏—á–∏–µ –≥—Ä—É–∑–æ–≤–æ–≥–æ –ª–∏—Ñ—Ç–∞</Label>\n04671|                       </div>\n04672|                     </div>\n04673|                   )}\n04674|                 </div>\n04675|                 \n04676|                 <div className=\"space-y-2\">\n04677|                   <Button \n04678|                     onClick={handleCalculate} \n04679|                     className=\"w-full bg-blue-600 hover:bg-blue-700 h-7 text-xs\" \n04680|                     disabled={calculating}\n04681|                   >\n04682|                     {calculating ? '–†–∞—Å—á–µ—Ç...' : '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å'}\n04683|                   </Button>\n04684|                   \n04685|                   <Button \n04686|                     onClick={handleReset} \n04687|                     variant=\"outline\" \n04688|                     className=\"w-full h-7 text-xs text-black border-gray-600 hover:bg-gray-700 hover:text-white\" \n04689|                     disabled={calculating}\n04690|                   >\n04691|                     –°–±—Ä–æ—Å–∏—Ç—å —Ä–∞—Å—á–µ—Ç\n04692|                   </Button>\n04693|                 </div>\n04694|               </CardContent>\n04695|             </Card>\n04696|           </div>\n04697| \n04698|           {/* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã */}\n04699|           <div className=\"space-y-2 overflow-y-auto\">\n04700|             {calculations.length > 0 && (\n04701|                  <div className=\"space-y-2\">\n04702|                 <div className=\"flex justify-between items-center\">\n04703|                   <h2 className=\"text-lg font-bold text-blue-400\">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>\n04704|                   <Button \n04705|                     onClick={exportToPDF} \n04706|                     variant=\"outline\" \n04707|                     size=\"sm\" \n04708|                     className=\"h-7 text-xs border-blue-500 text-blue-400 hover:bg-blue-900/20 print:hidden\"\n04709|                   >\n04710|                     –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF\n04711|                   </Button>\n04712|                 </div>\n04713|                 \n04714|                 {calculations.map((calc, index) => (\n04715|                    <Card key={index} className=\"bg-gray-800 border-gray-700 text-xs\">\n04716|                      <CardHeader className=\"pb-1\">\n04717|                       <div className=\"flex justify-between items-center\">\n04718|                          <CardTitle className=\"text-white flex items-center gap-2 text-xs\">\n04719|                            <Building2 className=\"h-3 w-3\" />\n04720|                           {calc.company}\n04721|                         </CardTitle>\n04722|                         {calc.error ? (\n04723|                           <Badge variant=\"destructive\" className=\"text-xs\">–û—à–∏–±–∫–∞</Badge>\n04724|                         ) : (\n04725|                           <Badge variant=\"default\" className=\"bg-green-600 text-xs\">\n04726|                             {calc.price.toLocaleString()} ‚ÇΩ\n04727|                           </Badge>\n04728|                         )}\n04729|                       </div>\n04730|                     </CardHeader>\n04731|                     <CardContent className=\"pt-0\">\n04732|                       <div className=\"space-y-2\">\n04733|                         {calc.error ? (\n04734|                           <div className=\"space-y-2\">\n04735|                             <Alert className=\"border-red-600\">\n04736|                               <AlertDescription className=\"text-white text-xs\">{calc.error}</AlertDescription>\n04737|                             </Alert>\n04738|                             {calc.price > 0 && (\n04739|                               <>\n04740|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n04741|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ä–æ–∫:</strong> {calc.days} –¥–Ω–µ–π</p>\n04742|                               </>\n04743|                             )}\n04744|                           </div>\n04745|                         ) : (\n04746|                           <>\n04747|                             <p className=\"text-white text-xs\"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n04748|                             <p className=\"text-white text-xs\"><strong>–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {calc.days} –¥–Ω–µ–π</p>\n04749|                           </>\n04750|                         )}\n04751|                         \n04752|                         <div className=\"flex gap-2 mt-2\">\n04753|                           {!calc.error && (\n04754|                             <Button\n04755|                               variant=\"outline\"\n04756|                               size=\"sm\"\n04757|                               onClick={() => toggleDetails(calc.company)}\n04758|                               className=\"h-6 text-xs\"\n04759|                             >\n04760|                               {expandedDetails[calc.company] ? '–°–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ' : '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ'}\n04761|                             </Button>\n04762|                           )}\n04763|                           <Button\n04764|                             variant=\"outline\"\n04765|                             size=\"sm\"\n04766|                             onClick={() => toggleDebugInfo(calc.company)}\n04767|                             className=\"h-6 text-xs\"\n04768|                           >\n04769|                             {expandedDebugInfo[calc.company] ? '–°–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–∫—É' : '–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}\n04770|                           </Button>\n04771|                         </div>\n04772|                         \n04773|                         {/* –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ */}\n04774|                         {!calc.error && (\n04775|                           <Collapsible open={expandedDetails[calc.company]}>\n04776|                             <CollapsibleContent className=\"mt-2\">\n04777|                               <div className=\"bg-gray-900 p-3 rounded text-xs\">\n04778|                                 <h4 className=\"font-bold mb-2 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞:</h4>\n04779|                                 {(() => {\n04780|                                   const details = parseCalculationDetails(calc);\n04781|                                   const totalPrice = details.reduce((sum, detail) => sum + detail.price, 0);\n04782|                                   \n04783|                                   return (\n04784|                                     <div className=\"space-y-1\">\n04785|                                       {details.map((detail, idx) => (\n04786|                                         <div key={idx} className=\"flex justify-between text-white\">\n04787|                                           <div>\n04788|                                             <div className=\"font-medium\">{detail.service}</div>\n04789|                                             {detail.description && (\n04790|                                               <div className=\"text-gray-400 text-xs\">{detail.description}</div>\n04791|                                             )}\n04792|                                           </div>\n04793|                                           <div className=\"font-medium\">{detail.price.toLocaleString()} ‚ÇΩ</div>\n04794|                                         </div>\n04795|                                       ))}\n04796|                                     </div>\n04797|                                   );\n04798|                                 })()}\n04799|                               </div>\n04800|                             </CollapsibleContent>\n04801|                           </Collapsible>\n04802|                         )}\n04803|                         \n04804|                         {/* –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è - –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ */}\n04805|                         <Collapsible open={expandedDebugInfo[calc.company]}>\n04806|                           <CollapsibleContent className=\"mt-2\">\n04807|                             <div className=\"bg-gray-900 p-3 rounded text-xs\">\n04808|                               <h4 className=\"font-bold mb-2 text-white\">–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>\n04809|                               \n04810|                               {calc.apiUrl && (\n04811|                                 <div className=\"mb-3\">\n04812|                                   <h5 className=\"font-bold mb-1 text-white\">–ó–∞–ø—Ä–æ—Å –∫ API:</h5>\n04813|                                   <p className=\"text-gray-300 break-all text-xs\">URL: {calc.apiUrl}</p>\n04814|                                 </div>\n04815|                               )}\n04816|                               \n04817|                               {calc.sessionId && (\n04818|                                 <div className=\"mb-3\">\n04819|                                   <h5 className=\"font-bold mb-1 text-white\">Session ID:</h5>\n04820|                                   <p className=\"text-gray-300 text-xs\">{calc.sessionId}</p>\n04821|                                 </div>\n04822|                               )}\n04823|                               \n04824|                               {calc.requestData && (\n04825|                                 <div className=\"mb-3\">\n04826|                                   <h5 className=\"font-bold mb-1 text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:</h5>\n04827|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04828|                                     {JSON.stringify(calc.requestData, null, 2)}\n04829|                                   </pre>\n04830|                                 </div>\n04831|                               )}\n04832|                               \n04833|                               {calc.responseData && (\n04834|                                 <div className=\"mb-3\">\n04835|                                   <h5 className=\"font-bold mb-1 text-white\">–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:</h5>\n04836|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04837|                                     {JSON.stringify(calc.responseData, null, 2)}\n04838|                                   </pre>\n04839|                                 </div>\n04840|                               )}\n04841|                               \n04842|                               {calc.details && (\n04843|                                 <div className=\"mb-3\">\n04844|                                   <h5 className=\"font-bold mb-1 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ (JSON):</h5>\n04845|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04846|                                     {JSON.stringify(calc.details, null, 2)}\n04847|                                   </pre>\n04848|                                 </div>\n04849|                               )}\n04850|                               \n04851|                               {calc.error && (\n04852|                                 <div className=\"mb-3\">\n04853|                                   <h5 className=\"font-bold mb-1 text-red-400\">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ:</h5>\n04854|                                   <p className=\"text-red-300 text-xs\">{calc.error}</p>\n04855|                                 </div>\n04856|                               )}\n04857|                             </div>\n04858|                           </CollapsibleContent>\n04859|                         </Collapsible>\n04860|                       </div>\n04861|                     </CardContent>\n04862|                   </Card>\n04863|                 ))}\n04864|               </div>\n04865|             )}\n04866| \n04867|             {/* –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –¢–ö - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º—ã–π */}\n04868|             <Card className=\"bg-gray-800 border-gray-700\">\n04869|               <CardHeader className=\"pb-2\">\n04870|                 <CardTitle className=\"text-white text-sm\">\n04871|                   –ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ ({COMPANIES_BASE.length})\n04872|                 </CardTitle>\n04873|               </CardHeader>\n04874|               <CardContent>\n04875|                 <div className=\"grid grid-cols-2 gap-2\">\n04876|                   {COMPANIES_BASE.map((company, index) => {\n04877|                     const isConnected = apiStatus[company.apiKey as keyof typeof apiStatus] === '–ø–æ–¥–∫–ª—é—á–µ–Ω–æ';\n04878|                     const statusText = apiStatus[company.apiKey as keyof typeof apiStatus];\n04879|                     const isEnabled = enabledCompanies[company.apiKey];\n04880|                     \n04881|                     // –û—Ç–ª–∞–¥–∫–∞ –¥–ª—è –ø–µ—Ä–≤—ã—Ö 3 –∫–æ–º–ø–∞–Ω–∏–π\n04882|                     if (index < 3) {\n04883|                       console.log(`üîç –ö–æ–º–ø–∞–Ω–∏—è ${index}: ${company.name}, apiKey: ${company.apiKey}, isEnabled: ${isEnabled}, statusText: ${statusText}`);\n04884|                     }\n04885|                     \n04886|                     return (\n04887|                       <div key={index} className=\"flex items-center justify-between p-1.5 bg-gray-700 rounded\">\n04888|                         <div className=\"flex items-center gap-2\">\n04889|                           <span className=\"text-lg\">{company.logo}</span>\n04890|                           <div>\n04891|                             <p className=\"font-medium text-white text-[10px] leading-tight\">{company.name}</p>\n04892|                             <Badge \n04893|                               variant={isConnected ? \"default\" : \"destructive\"} \n04894|                               className=\"text-[9px] py-0 px-1\"\n04895|                             >\n04896|                               {isConnected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∞' : statusText === '–ø—Ä–æ–≤–µ—Ä–∫–∞...' ? '–ü—Ä–æ–≤–µ—Ä–∫–∞...' : '–û—à–∏–±–∫–∞'}\n04897|                             </Badge>\n04898|                           </div>\n04899|                         </div>\n04900|                         <div className=\"flex items-center gap-2\">\n04901|                           <span className=\"text-[9px] text-gray-300\">\n04902|                             {isEnabled ? '–í–∫–ª' : '–í—ã–∫–ª'}\n04903|                           </span>\n04904|                           <Switch\n04905|                             checked={isEnabled}\n04906|                             onCheckedChange={(checked) => {\n04907|                               setEnabledCompanies(prev => ({\n04908|                                 ...prev,\n04909|                                 [company.apiKey]: checked\n04910|                               }));\n04911|                             }}\n04912|                             disabled={!isConnected}\n04913|                           />\n04914|                         </div>\n04915|                       </div>\n04916|                     );\n04917|                   })}\n04918|                 </div>\n04919|               </CardContent>\n04920|             </Card>\n04921| \n04922|             {/* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫—É–∑–æ–≤–∞ */}\n04923|             {calculations.length > 0 && (\n04924|               <TruckVisualization \n04925|                 cargos={form.cargos.map(cargo => ({\n04926|                   id: cargo.id,\n04927|                   length: cargo.length * 10, // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n04928|                   width: cargo.width * 10,   // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n04929|                   height: cargo.height * 10, // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n04930|                   weight: cargo.weight,\n04931|                   productName: form.selectedProducts?.find(p => \n04932|                     p.cargoIndexes.includes(form.cargos.indexOf(cargo))\n04933|                   )?.product.name\n04934|                 }))}\n04935|                 isVisible={true}\n04936|               />\n04937|             )}\n04938|           </div>\n04939|         </div>\n04940|       </div>\n04941| \n04942|       {/* –ê–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∏ */}\n04943|       {showSuggestions && suggestions.length > 0 && (\n04944|         <div \n04945|           className=\"fixed z-50 bg-gray-800 border border-gray-700 rounded-md shadow-lg max-w-sm w-full max-h-60 overflow-y-auto\"\n04946|           style={{\n04947|             top: suggestionPosition.top,\n04948|             left: suggestionPosition.left\n04949|           }}\n04950|         >\n04951|           <div className=\"p-1\">\n04952|             {suggestions.map((suggestion, index) => (\n04953|               <div\n04954|                 key={index}\n04955|                 className=\"p-2 hover:bg-gray-700 cursor-pointer text-xs text-white rounded transition-colors\"\n04956|                 onClick={() => selectSuggestion(suggestion)}\n04957|               >\n04958|                 {suggestion.value}\n04959|               </div>\n04960|             ))}\n04961|           </div>\n04962|         </div>\n04963|       )}\n04964|     </div>\n04965|   );\n04966| }\n</file>",
    "title": "app/page.tsx",
    "metadata": {
      "preview": "        apiUrl\n      };\n    }\n  };\n\n  // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n  const calculateNordWheel = async (): Promise<CalculationResult> => {\n    const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n    \n    try {\n      // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      validateMultipleCargos(form.cargos);\n      \n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n\n      // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      const maxLength = Math.max(...form.cargos.map(c => c.length));"
    },
    "time": {
      "start": 1763464311058,
      "end": 1763464311062
    }
  }
}