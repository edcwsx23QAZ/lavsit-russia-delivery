{
  "id": "prt_980078513001T4Pq8cjokC6Ncm",
  "messageID": "msg_980041eb60015ujAJIGISfR72H",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_01FNsiTERbWkknEJci5t5akM",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx",
      "offset": 588,
      "limit": 100
    },
    "output": "<file>\n00589|           error: `Город не найден в базе ПЭК. Проверьте: ${!fromCityId ? form.fromCity : ''} ${!toCityId ? form.toCity : ''}`.trim(),\n00590|           apiUrl\n00591|         };\n00592|       }\n00593| \n00594|       // Формируем грузы согласно API документации\n00595|       const cargos = form.cargos.map(cargo => ({\n00596|         width: cargo.width / 100, // переводим в метры\n00597|         length: cargo.length / 100,\n00598|         height: cargo.height / 100,\n00599|         volume: (cargo.width * cargo.length * cargo.height) / 1000000, // объем в м3\n00600|         weight: cargo.weight,\n00601|         isOversized: (cargo.width > 240 || cargo.length > 1200 || cargo.height > 270 || cargo.weight > 1500) ? 1 : 0\n00602|       }));\n00603| \n00604|       // Формируем запрос согласно официальной документации API\n00605|       const requestData = {\n00606|         senderCityId: fromCityId,\n00607|         receiverCityId: toCityId,\n00608|         places: cargos,\n00609|         isPickup: form.fromAddressDelivery ? 1 : 0,\n00610|         isDelivery: form.toAddressDelivery ? 1 : 0,\n00611|         pickupOptions: {\n00612|           hasHydroBoardLoading: form.needLoading ? 1 : 0,\n00613|           hasManipulatorLoading: 0\n00614|         },\n00615|         deliveryOptions: {\n00616|           hasHydroBoardLoading: form.needLoading ? 1 : 0,\n00617|           hasManipulatorLoading: 0\n00618|         },\n00619|         ...(form.needInsurance && form.declaredValue > 0 ? {\n00620|           insuranceValue: form.declaredValue\n00621|         } : {}),\n00622|         packageType: form.needPackaging ? 'soft' : null\n00623|       };\n00624| \n00625|       console.log('ПЭК запрос:', requestData);\n00626| \n00627|       const response = await fetch(apiUrl, {\n00628|         method: 'POST',\n00629|         headers: {\n00630|           'Content-Type': 'application/json',\n00631|           'Authorization': 'Bearer C04C5BF2AE367BDCBDC71E7DA520A69B167D1984'\n00632|         },\n00633|         body: JSON.stringify(requestData)\n00634|       });\n00635| \n00636|       const data = await response.json();\n00637|       console.log('ПЭК ответ:', data);\n00638| \n00639|       if (response.ok && data.success) {\n00640|         let totalPrice = 0;\n00641|         let services: { name: string; description: string; price: number }[] = [];\n00642|         \n00643|         // Основная стоимость доставки\n00644|         if (data.data?.totalCost) {\n00645|           totalPrice = data.data.totalCost;\n00646|           \n00647|           // Разбивка по услугам если доступна\n00648|           if (data.data.services) {\n00649|             data.data.services.forEach((service: any) => {\n00650|               services.push({\n00651|                 name: service.name || 'Услуга ПЭК',\n00652|                 description: service.description || '',\n00653|                 price: service.cost || 0\n00654|               });\n00655|             });\n00656|           } else {\n00657|             // Основная услуга\n00658|             services.push({\n00659|               name: 'Доставка груза',\n00660|               description: `${form.fromCity} - ${form.toCity}`,\n00661|               price: totalPrice\n00662|             });\n00663|           }\n00664|         }\n00665|         \n00666|         // Забор груза\n00667|         if (data.data?.pickupCost && form.fromAddressDelivery) {\n00668|           services.push({\n00669|             name: 'Забор груза',\n00670|             description: 'От адреса отправителя',\n00671|             price: data.data.pickupCost\n00672|           });\n00673|         }\n00674|         \n00675|         // Доставка до адреса\n00676|         if (data.data?.deliveryCost && form.toAddressDelivery) {\n00677|           services.push({\n00678|             name: 'Доставка груза',\n00679|             description: 'До адреса получателя',\n00680|             price: data.data.deliveryCost\n00681|           });\n00682|         }\n00683| \n00684|         // Срок доставки\n00685|         const deliveryDays = data.data?.deliveryDays || 3;\n00686| \n00687|         return {\n00688|           company: 'ПЭК',\n\n(File has more lines. Use 'offset' parameter to read beyond line 688)\n</file>",
    "metadata": {
      "preview": "          error: `Город не найден в базе ПЭК. Проверьте: ${!fromCityId ? form.fromCity : ''} ${!toCityId ? form.toCity : ''}`.trim(),\n          apiUrl\n        };\n      }\n\n      // Формируем грузы согласно API документации\n      const cargos = form.cargos.map(cargo => ({\n        width: cargo.width / 100, // переводим в метры\n        length: cargo.length / 100,\n        height: cargo.height / 100,\n        volume: (cargo.width * cargo.length * cargo.height) / 1000000, // объем в м3\n        weight: cargo.weight,\n        isOversized: (cargo.width > 240 || cargo.length > 1200 || cargo.height > 270 || cargo.weight > 1500) ? 1 : 0\n      }));\n\n      // Формируем запрос согласно официальной документации API\n      const requestData = {\n        senderCityId: fromCityId,\n        receiverCityId: toCityId,\n        places: cargos,"
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1758789601058,
      "end": 1758789601061
    }
  }
}