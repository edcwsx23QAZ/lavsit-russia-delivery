{
  "id": "prt_a6d33fe44001071I2kqv1LkVaB",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "messageID": "msg_a6d33ef14002a0S38LGTPGYhlM",
  "type": "tool",
  "callID": "toolu_01UPHU1qf5WjtKbKdqWXu5CK",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "app/page.tsx",
      "limit": 150,
      "offset": 3275
    },
    "output": "<file>\n03276| \n03277|        const result = await enhancedApiRequest(\n03278|          apiUrl,\n03279|          {\n03280|            method: 'POST',\n03281|            headers: {\n03282|              'Content-Type': 'application/json',\n03283|            },\n03284|            body: JSON.stringify(requestData)\n03285|          },\n03286|          { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n03287|        );\n03288| \n03289|        if (result && typeof result === 'object' && 'success' in result && !result.success) {\n03290|          console.error('‚ùå –í–æ–∑–æ–≤–æ–∑ API –æ—à–∏–±–∫–∞:', result.error);\n03291|          return {\n03292|            company: '–í–æ–∑–æ–≤–æ–∑',\n03293|            price: 0,\n03294|            days: 0,\n03295|            error: result.error.userMessage || result.error.message,\n03296|            requestData,\n03297|            responseData: null,\n03298|            apiUrl\n03299|          };\n03300|        }\n03301| \n03302|        const response = result as Response;\n03303|        const data = await response.json();\n03304|        console.log('üöö –í–æ–∑–æ–≤–æ–∑ –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n03305| \n03306|       if (response.ok && data.response) {\n03307|         const responseData = data.response;\n03308|         \n03309|         console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:', responseData);\n03310|         \n03311|         // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n03312|         const services: { name: string; description: string; price: number }[] = [];\n03313|         let totalPrice = responseData.price || responseData.basePrice || 0;\n03314|         \n03315|         // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API\n03316|         if (responseData.service && Array.isArray(responseData.service)) {\n03317|           console.log('üöö –í–æ–∑–æ–≤–æ–∑ –Ω–∞–π–¥–µ–Ω –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥:', responseData.service.length);\n03318|           \n03319|           responseData.service.forEach((service: any, index: number) => {\n03320|             console.log(`üöö –£—Å–ª—É–≥–∞ [${index}]:`, service);\n03321|             if (service.price > 0) {\n03322|               services.push({\n03323|                 name: service.name || '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞',\n03324|                 description: service.description || '',\n03325|                 price: service.price\n03326|               });\n03327|             }\n03328|           });\n03329|         } else {\n03330|           console.log('üöö –í–æ–∑–æ–≤–æ–∑: –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—É—Å—Ç');\n03331|           \n03332|           // –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤–∞ —É—Å–ª—É–≥ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n03333|           if (responseData.basePrice && responseData.basePrice > 0) {\n03334|             services.push({\n03335|               name: '–ë–∞–∑–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞',\n03336|               description: `${form.fromCity} - ${form.toCity}`,\n03337|               price: responseData.basePrice\n03338|             });\n03339|           }\n03340|           \n03341|           // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë –æ—Ç–¥–µ–ª—å–Ω–æ\n03342|           if (responseData.price !== responseData.basePrice && responseData.price > 0) {\n03343|             const discount = (responseData.basePrice || 0) - responseData.price;\n03344|             if (discount > 0) {\n03345|               services.push({\n03346|                 name: '–°–∫–∏–¥–∫–∞',\n03347|                 description: '–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —Å–∫–∏–¥–∫–∞',\n03348|                 price: -discount\n03349|               });\n03350|             }\n03351|           }\n03352|         }\n03353|         \n03354|         // –ï—Å–ª–∏ –Ω–∏–∫–∞–∫–∏—Ö —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n03355|         if (services.length === 0 && totalPrice > 0) {\n03356|           services.push({\n03357|             name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n03358|             description: `${form.fromCity} - ${form.toCity}`,\n03359|             price: totalPrice\n03360|           });\n03361|         }\n03362| \n03363|         console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', totalPrice);\n03364|         console.log('üöö –í–æ–∑–æ–≤–æ–∑ —É—Å–ª—É–≥–∏:', services);\n03365| \n03366|         return {\n03367|           company: '–í–æ–∑–æ–≤–æ–∑',\n03368|           price: Math.round(totalPrice),\n03369|           days: responseData.deliveryTime?.to || responseData.deliveryTime?.from || 3,\n03370|           details: {\n03371|             note: `–î–æ—Å—Ç–∞–≤–∫–∞ ${form.fromCity} - ${form.toCity}`,\n03372|             services,\n03373|             basePrice: responseData.basePrice,\n03374|             finalPrice: responseData.price,\n03375|             deliveryTime: responseData.deliveryTime,\n03376|             weight: totalWeight,\n03377|             volume: totalVolume\n03378|           },\n03379|           requestData,\n03380|           responseData: data,\n03381|           apiUrl\n03382|         };\n03383|       } else {\n03384|         return {\n03385|           company: '–í–æ–∑–æ–≤–æ–∑',\n03386|           price: 0,\n03387|           days: 0,\n03388|           error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –í–æ–∑–æ–≤–æ–∑',\n03389|           requestData,\n03390|           responseData: data,\n03391|           apiUrl\n03392|         };\n03393|       }\n03394|     } catch (error: any) {\n03395|       console.error('üöö –í–æ–∑–æ–≤–æ–∑ –æ—à–∏–±–∫–∞:', error);\n03396|       return {\n03397|         company: '–í–æ–∑–æ–≤–æ–∑',\n03398|         price: 0,\n03399|         days: 0,\n03400|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03401|         apiUrl\n03402|       };\n03403|     }\n03404|   };\n03405| \n03406|   // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n03407|   const calculateNordWheel = async (): Promise<CalculationResult> => {\n03408|     const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n03409|     \n03410|     try {\n03411|       // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03412|       validateMultipleCargos(form.cargos);\n03413|       \n03414|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03415|       const totalVolume = form.cargos.reduce((sum, cargo) => \n03416|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n03417|       );\n03418| \n03419|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03420|       const maxLength = Math.max(...form.cargos.map(c => c.length));\n03421|       const maxWidth = Math.max(...form.cargos.map(c => c.width));\n03422|       const maxHeight = Math.max(...form.cargos.map(c => c.height));\n03423|       \n03424|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–µ–≥–∞–±–∞—Ä–∏—Ç (>2–º –ø–æ –ª—é–±–æ–º—É –∏–∑–º–µ—Ä–µ–Ω–∏—é)\n03425|       const isOversized = maxLength > 200 || maxWidth > 200 || maxHeight > 200 || totalWeight > 1000;\n\n(File has more lines. Use 'offset' parameter to read beyond line 3425)\n</file>",
    "title": "app/page.tsx",
    "metadata": {
      "preview": "\n       const result = await enhancedApiRequest(\n         apiUrl,\n         {\n           method: 'POST',\n           headers: {\n             'Content-Type': 'application/json',\n           },\n           body: JSON.stringify(requestData)\n         },\n         { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n       );\n\n       if (result && typeof result === 'object' && 'success' in result && !result.success) {\n         console.error('‚ùå –í–æ–∑–æ–≤–æ–∑ API –æ—à–∏–±–∫–∞:', result.error);\n         return {\n           company: '–í–æ–∑–æ–≤–æ–∑',\n           price: 0,\n           days: 0,\n           error: result.error.userMessage || result.error.message,"
    },
    "time": {
      "start": 1762768716390,
      "end": 1762768716396
    }
  }
}