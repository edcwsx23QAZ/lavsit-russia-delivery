{
  "id": "prt_acc1d8a14001kSux5kHz9T7V7n",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_acc1d6be0002EO9K3f0j52JaOn",
  "type": "tool",
  "callID": "call_5fa1d76fbf6049c5b30b6aa0",
  "tool": "edit",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/api/vozovoz-parser-stable/route.ts",
      "oldString": "        serviceKeywords.forEach(keyword => {\n          try {\n            const elements = document.querySelectorAll('*');\n            for (const element of elements) {\n              const text = element.textContent || '';\n              if (text.includes(keyword) && text.includes('‚ÇΩ')) {\n                const priceMatch = text.match(/(\\d[\\s\\d]*\\d+)\\s*‚ÇΩ/);\n                if (priceMatch) {\n                  const price = parseInt(priceMatch[1].replace(/\\s/g, ''));\n                  const name = text.replace(priceMatch[0], '').trim();\n                  \n                  if (name && price > 0) {\n                    result.services.push({ name, price });\n                    console.log('–ù–∞–π–¥–µ–Ω–∞ —É—Å–ª—É–≥–∞:', name, price);\n                    break;\n                  }\n                }\n              }\n            }\n          } catch (e) {\n            continue;\n          }\n        });",
      "newString": "        serviceKeywords.forEach(keyword => {\n          try {\n            const elements = document.querySelectorAll('*');\n            for (const element of elements) {\n              const text = element.textContent || '';\n              if (text.includes(keyword) && text.includes('‚ÇΩ')) {\n                const priceMatch = text.match(/(\\d[\\s\\d]*\\d+)\\s*‚ÇΩ/);\n                if (priceMatch) {\n                  const price = parseInt(priceMatch[1].replace(/\\s/g, ''));\n                  const name = text.replace(priceMatch[0], '').trim();\n                  \n                  if (name && price > 0) {\n                    result.services.push({ name, price });\n                    console.log('–ù–∞–π–¥–µ–Ω–∞ —É—Å–ª—É–≥–∞:', name, price);\n                    break;\n                  }\n                }\n              }\n            }\n          } catch (e) {\n            // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º\n          }\n        });"
    },
    "output": "",
    "title": "app/api/vozovoz-parser-stable/route.ts",
    "metadata": {
      "diagnostics": {},
      "diff": "Index: /home/user/project/app/api/vozovoz-parser-stable/route.ts\n===================================================================\n--- /home/user/project/app/api/vozovoz-parser-stable/route.ts\n+++ /home/user/project/app/api/vozovoz-parser-stable/route.ts\n@@ -525,9 +525,9 @@\n         }\n       }\n     }\n   } catch (e) {\n-    continue;\n+    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º\n   }\n });\n \n // –ü–æ–∏—Å–∫ —Å—Ä–æ–∫–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏\n",
      "filediff": {
        "file": "/home/user/project/app/api/vozovoz-parser-stable/route.ts",
        "before": "import { NextRequest, NextResponse } from 'next/server';\nimport puppeteer from 'puppeteer';\n\ninterface VozovozParserParams {\n  fromCity: string;\n  toCity: string;\n  fromAddressDelivery: boolean;\n  toAddressDelivery: boolean;\n  fromAddress?: string;\n  toAddress?: string;\n  length: number;\n  width: number;\n  height: number;\n  weight: number;\n  needInsurance: boolean;\n  declaredValue?: number;\n  needPackaging: boolean;\n  needLoading: boolean;\n  hasFreightElevator: boolean;\n  floor: number;\n}\n\ninterface ParsedResult {\n  totalCost: number;\n  services: ServiceItem[];\n  deliveryTime?: string;\n  warnings?: string[];\n  parseTime?: number;\n}\n\ninterface ServiceItem {\n  name: string;\n  basePrice?: number;\n  price: number;\n  discount?: number;\n}\n\n// –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫\nasync function parseVozovozWebsiteStable(params: VozovozParserParams): Promise<ParsedResult> {\n  const startTime = Date.now();\n  let browser;\n  \n  try {\n    console.log('üï∑Ô∏è –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ Vozovoz...');\n    \n    // –°—Ç–∞–±–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞\n    browser = await puppeteer.launch({\n      headless: true,\n      args: [\n        '--no-sandbox',\n        '--disable-setuid-sandbox',\n        '--disable-dev-shm-usage',\n        '--disable-accelerated-2d-canvas',\n        '--no-first-run',\n        '--disable-gpu',\n        '--disable-extensions',\n        '--disable-default-apps',\n        '--disable-background-timer-throttling',\n        '--disable-backgrounding-occluded-windows',\n        '--disable-renderer-backgrounding',\n        '--disable-features=TranslateUI',\n        '--disable-ipc-flooding-protection',\n        '--memory-pressure-off',\n        '--max_old_space_size=4096'\n      ],\n      defaultViewport: {\n        width: 1280,\n        height: 800\n      }\n    });\n\n    const page = await browser.newPage();\n    \n    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ user-agent\n    await page.setUserAgent('Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36');\n\n    console.log('üìç –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–∞–π—Ç Vozovoz...');\n    \n    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫\n    try {\n      await page.goto('https://vozovoz.ru/', { \n        waitUntil: 'domcontentloaded',\n        timeout: 20000 \n      });\n    } catch (error) {\n      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:', error);\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∞–π—Ç Vozovoz');\n    }\n\n    console.log('‚úÖ –°–∞–π—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã\n    const pageAccessible = await page.evaluate(() => {\n      return document.body && document.body.innerHTML.length > 0;\n    });\n\n    if (!pageAccessible) {\n      throw new Error('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');\n    }\n\n    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤\n    await new Promise(resolve => setTimeout(resolve, 2000));\n\n    // –ü–æ–∏—Å–∫ –∏ –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –≤—Ö–æ–¥–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏\n    console.log('üîç –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞...');\n    \n    let loginClicked = false;\n    const loginSelectors = [\n      'a[href*=\"login\"]',\n      'button:contains(\"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç\")',\n      '.login-button',\n      '[data-testid=\"login-button\"]',\n      'a:contains(\"–í–æ–π—Ç–∏\")'\n    ];\n\n    for (const selector of loginSelectors) {\n      try {\n        await page.waitForSelector(selector, { timeout: 3000 });\n        await page.click(selector);\n        loginClicked = true;\n        console.log(`‚úÖ –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–∞–π–¥–µ–Ω–∞: ${selector}`);\n        break;\n      } catch (e) {\n        continue;\n      }\n    }\n\n    if (!loginClicked) {\n      // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –ø–æ —Ç–µ–∫—Å—Ç—É\n      loginClicked = await page.evaluate(() => {\n        const buttons = Array.from(document.querySelectorAll('a, button'));\n        const loginBtn = buttons.find(btn => {\n          const text = btn.textContent?.toLowerCase() || '';\n          return text.includes('–ª–∏—á–Ω—ã–π') || text.includes('–∫–∞–±–∏–Ω–µ—Ç') || text.includes('–≤–æ–π—Ç–∏');\n        });\n        \n        if (loginBtn) {\n          (loginBtn as HTMLElement).click();\n          return true;\n        }\n        return false;\n      });\n    }\n\n    if (!loginClicked) {\n      throw new Error('–ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–∞–∂–∞—Ç–∞');\n    \n    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    const authFormExists = await page.evaluate(() => {\n      const inputs = document.querySelectorAll('input[type=\"tel\"], input[type=\"password\"], input[name*=\"phone\"], input[name*=\"login\"]');\n      return inputs.length > 0;\n    });\n\n    if (!authFormExists) {\n      throw new Error('–§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    // –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    console.log('üîê –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...');\n    \n    const authDataEntered = await page.evaluate(() => {\n      try {\n        // –í–≤–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n        const phoneInputs = Array.from(document.querySelectorAll('input[type=\"tel\"], input[name*=\"phone\"], input[placeholder*=\"—Ç–µ–ª–µ—Ñ–æ–Ω\"]'));\n        if (phoneInputs.length > 0) {\n          const phoneInput = phoneInputs[0] as HTMLInputElement;\n          phoneInput.focus();\n          phoneInput.value = '79015199496';\n          phoneInput.dispatchEvent(new Event('input', { bubbles: true }));\n          phoneInput.dispatchEvent(new Event('change', { bubbles: true }));\n        }\n\n        // –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è\n        const passwordInputs = Array.from(document.querySelectorAll('input[type=\"password\"]'));\n        if (passwordInputs.length > 0) {\n          const passwordInput = passwordInputs[0] as HTMLInputElement;\n          passwordInput.focus();\n          passwordInput.value = 'LAv$it_2o21';\n          passwordInput.dispatchEvent(new Event('input', { bubbles: true }));\n          passwordInput.dispatchEvent(new Event('change', { bubbles: true }));\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö:', error);\n        return false;\n      }\n    });\n\n    if (!authDataEntered) {\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 1000));\n\n    // –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞\n    console.log('üîΩ –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞...');\n    \n    const loginSubmitted = await page.evaluate(() => {\n      try {\n        const buttons = Array.from(document.querySelectorAll('button[type=\"submit\"], button:not([disabled])'));\n        const submitBtn = buttons.find(btn => {\n          const text = btn.textContent?.toLowerCase() || '';\n          return text.includes('–≤–æ–π—Ç–∏') || text.includes('–¥–∞–ª–µ–µ') || text.includes('–≤—Ö–æ–¥');\n        });\n        \n        if (submitBtn) {\n          (submitBtn as HTMLElement).click();\n          return true;\n        }\n        return false;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏:', error);\n        return false;\n      }\n    });\n\n    if (!loginSubmitted) {\n      throw new Error('–ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã');\n    \n    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    await new Promise(resolve => setTimeout(resolve, 5000));\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    const authSuccess = await page.evaluate(() => {\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã (–Ω–µ—Ç —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞)\n      const loginInputs = document.querySelectorAll('input[type=\"password\"]');\n      return loginInputs.length === 0;\n    });\n\n    if (!authSuccess) {\n      throw new Error('–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å');\n    }\n\n    // –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞\n    console.log('üìã –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞...');\n    \n    let orderClicked = false;\n    const orderSelectors = [\n      'a[href*=\"order\"]',\n      'button:contains(\"–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑\")',\n      '.order-button',\n      '[data-testid=\"create-order\"]'\n    ];\n\n    for (const selector of orderSelectors) {\n      try {\n        await page.waitForSelector(selector, { timeout: 3000 });\n        await page.click(selector);\n        orderClicked = true;\n        console.log(`‚úÖ –ö–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞ –Ω–∞–π–¥–µ–Ω–∞: ${selector}`);\n        break;\n      } catch (e) {\n        continue;\n      }\n    }\n\n    if (!orderClicked) {\n      // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –ø–æ —Ç–µ–∫—Å—Ç—É\n      orderClicked = await page.evaluate(() => {\n        const links = Array.from(document.querySelectorAll('a, button'));\n        const orderLink = links.find(link => {\n          const text = link.textContent?.toLowerCase() || '';\n          return text.includes('–æ—Ñ–æ—Ä–º–∏—Ç—å') || text.includes('–∑–∞–∫–∞–∑') || text.includes('—Ä–∞—Å—á–µ—Ç');\n        });\n        \n        if (orderLink) {\n          (orderLink as HTMLElement).click();\n          return true;\n        }\n        return false;\n      });\n    }\n\n    if (!orderClicked) {\n      throw new Error('–ö–Ω–æ–ø–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    console.log('‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞');\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–æ—Ä–º—ã —Ä–∞—Å—á–µ—Ç–∞\n    const calcFormExists = await page.evaluate(() => {\n      const inputs = document.querySelectorAll('input[placeholder*=\"–æ—Ç–ø—Ä–∞–≤\"], input[placeholder*=\"–û—Ç–ø—Ä–∞–≤–∫–∞\"], input[placeholder*=\"–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\"]');\n      return inputs.length > 0;\n    });\n\n    if (!calcFormExists) {\n      throw new Error('–§–æ—Ä–º–∞ —Ä–∞—Å—á–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã —Ä–∞—Å—á–µ—Ç–∞\n    console.log('üìù –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã —Ä–∞—Å—á–µ—Ç–∞...');\n    \n    const formFilled = await page.evaluate((params) => {\n      try {\n        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n        const fromInputs = Array.from(document.querySelectorAll('input[placeholder*=\"–æ—Ç–ø—Ä–∞–≤\"], input[name*=\"from\"], input[placeholder*=\"–û—Ç–ø—Ä–∞–≤–∫–∞\"]'));\n        if (fromInputs.length > 0) {\n          const fromInput = fromInputs[0] as HTMLInputElement;\n          fromInput.focus();\n          fromInput.value = '';\n          fromInput.value = params.fromCity;\n          fromInput.dispatchEvent(new Event('input', { bubbles: true }));\n          fromInput.dispatchEvent(new Event('change', { bubbles: true }));\n          \n          // –≠–º—É–ª–∏—Ä—É–µ–º –≤—ã–±–æ—Ä –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞\n          fromInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'ArrowDown' }));\n          fromInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter' }));\n        }\n\n        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è\n        const toInputs = Array.from(document.querySelectorAll('input[placeholder*=\"–ø—Ä–∏–±—ã—Ç\"], input[name*=\"to\"], input[placeholder*=\"–ü—Ä–∏–±—ã—Ç–∏–µ\"]'));\n        if (toInputs.length > 0) {\n          const toInput = toInputs[0] as HTMLInputElement;\n          toInput.focus();\n          toInput.value = '';\n          toInput.value = params.toCity;\n          toInput.dispatchEvent(new Event('input', { bubbles: true }));\n          toInput.dispatchEvent(new Event('change', { bubbles: true }));\n          \n          // –≠–º—É–ª–∏—Ä—É–µ–º –≤—ã–±–æ—Ä –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞\n          toInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'ArrowDown' }));\n          toInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter' }));\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã:', error);\n        return false;\n      }\n    }, params);\n\n    if (!formFilled) {\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–æ—Å—Ç–∞–≤–∫–∏\n    console.log('üöö –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–æ—Å—Ç–∞–≤–∫–∏...');\n    \n    const deliveryTypeSelected = await page.evaluate((params) => {\n      try {\n        // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n        if (!params.fromAddressDelivery) {\n          const terminalLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n            const text = el.textContent?.toLowerCase() || '';\n            return text.includes('—Ç–µ—Ä–º–∏–Ω–∞–ª') && (text.includes('–æ—Ç–ø—Ä–∞–≤') || text.includes('–æ—Ç–¥–µ–ª–µ–Ω–∏–µ'));\n          });\n          if (terminalLabels.length > 0) {\n            (terminalLabels[0] as HTMLElement).click();\n          }\n        }\n\n        // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è\n        if (params.toAddressDelivery) {\n          const addressLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n            const text = el.textContent?.toLowerCase() || '';\n            return text.includes('–∞–¥—Ä–µ—Å') && (text.includes('–¥–æ—Å—Ç–∞–≤') || text.includes('–Ω–∞–∑–Ω–∞—á'));\n          });\n          if (addressLabels.length > 0) {\n            (addressLabels[0] as HTMLElement).click();\n          }\n        } else {\n          const terminalLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n            const text = el.textContent?.toLowerCase() || '';\n            return text.includes('—Ç–µ—Ä–º–∏–Ω–∞–ª') && (text.includes('–¥–æ—Å—Ç–∞–≤') || text.includes('–Ω–∞–∑–Ω–∞—á'));\n          });\n          if (terminalLabels.length > 0) {\n            (terminalLabels[0] as HTMLElement).click();\n          }\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:', error);\n        return false;\n      }\n    }, params);\n\n    if (!deliveryTypeSelected) {\n      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º...');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 2000));\n\n    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ\n    if (params.toAddressDelivery && params.toAddress) {\n      await page.evaluate((address) => {\n        const addressInputs = Array.from(document.querySelectorAll('input[placeholder*=\"–∞–¥—Ä–µ—Å\"], input[name*=\"address\"]'));\n        if (addressInputs.length > 0) {\n          const addressInput = addressInputs[0] as HTMLInputElement;\n          addressInput.focus();\n          addressInput.value = address;\n          addressInput.dispatchEvent(new Event('input', { bubbles: true }));\n        }\n      }, params.toAddress);\n    }\n\n    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥—Ä—É–∑–∞\n    console.log('üì¶ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥—Ä—É–∑–∞...');\n    \n    const cargoParamsFilled = await page.evaluate((params) => {\n      try {\n        // –í—ã–±–æ—Ä \"–ú–µ—Å—Ç–∞\"\n        const placesLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n          const text = el.textContent?.toLowerCase() || '';\n          return text.includes('–º–µ—Å—Ç–∞') || text.includes('–º–µ—Å—Ç');\n        });\n        if (placesLabels.length > 0) {\n          (placesLabels[0] as HTMLElement).click();\n        }\n\n        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–∞–±–∞—Ä–∏—Ç–æ–≤\n        const dimensionInputs = {\n          length: Array.from(document.querySelectorAll('input[name*=\"length\"], input[placeholder*=\"–¥–ª–∏–Ω\"]')),\n          width: Array.from(document.querySelectorAll('input[name*=\"width\"], input[placeholder*=\"—à–∏—Ä–∏–Ω\"]')),\n          height: Array.from(document.querySelectorAll('input[name*=\"height\"], input[placeholder*=\"–≤—ã—Å–æ—Ç\"]')),\n          weight: Array.from(document.querySelectorAll('input[name*=\"weight\"], input[placeholder*=\"–≤–µ—Å\"]'))\n        };\n\n        if (dimensionInputs.length > 0) {\n          Object.entries(dimensionInputs).forEach(([key, inputs]) => {\n            if (inputs.length > 0) {\n              const input = inputs[0] as HTMLInputElement;\n              input.focus();\n              input.value = params[key].toString();\n              input.dispatchEvent(new Event('input', { bubbles: true }));\n            }\n          });\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥—Ä—É–∑–∞:', error);\n        return false;\n      }\n    }, params);\n\n    if (!cargoParamsFilled) {\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n    console.log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—á–µ—Ç–∞...');\n    await new Promise(resolve => setTimeout(resolve, 8000));\n\n    // –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n    console.log('üìä –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...');\n    \n    const results = await page.evaluate(() => {\n      try {\n        const result: any = {\n          totalCost: 0,\n          services: [],\n          deliveryTime: null,\n          warnings: []\n        };\n\n        // –ü–æ–∏—Å–∫ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n        const totalSelectors = [\n          '*:contains(\"–ò—Ç–æ–≥–æ:\")',\n          '*:contains(\"–í—Å–µ–≥–æ:\")',\n          '*:contains(\"–°—Ç–æ–∏–º–æ—Å—Ç—å\")',\n          '.total-cost',\n          '.price-total'\n        ];\n\n        for (const selector of totalSelectors) {\n          try {\n            const elements = document.querySelectorAll(selector);\n            for (const element of elements) {\n              const text = element.textContent || '';\n              const priceMatch = text.match(/(\\d[\\s\\d]*\\d+)\\s*‚ÇΩ/);\n              if (priceMatch) {\n                result.totalCost = parseInt(priceMatch[1].replace(/\\s/g, ''));\n                console.log('–ù–∞–π–¥–µ–Ω–∞ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', result.totalCost);\n                break;\n              }\n            }\n            if (result.totalCost > 0) break;\n          } catch (e) {\n            continue;\n          }\n        }\n\n        // –ü–æ–∏—Å–∫ —É—Å–ª—É–≥\n        const serviceKeywords = [\n          '–ü–ª–∞—Ç–Ω—ã–π –≤—ä–µ–∑–¥',\n          '–ü–µ—Ä–µ–≤–æ–∑–∫–∞ –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏',\n          '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n          '–°–∫–ª–∞–¥—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞',\n          '–û—Ç–≤–æ–∑ –≥—Ä—É–∑–∞',\n          '–°–∫–∏–¥–∫–∞'\n        ];\n\n        serviceKeywords.forEach(keyword => {\n          try {\n            const elements = document.querySelectorAll('*');\n            for (const element of elements) {\n              const text = element.textContent || '';\n              if (text.includes(keyword) && text.includes('‚ÇΩ')) {\n                const priceMatch = text.match(/(\\d[\\s\\d]*\\d+)\\s*‚ÇΩ/);\n                if (priceMatch) {\n                  const price = parseInt(priceMatch[1].replace(/\\s/g, ''));\n                  const name = text.replace(priceMatch[0], '').trim();\n                  \n                  if (name && price > 0) {\n                    result.services.push({ name, price });\n                    console.log('–ù–∞–π–¥–µ–Ω–∞ —É—Å–ª—É–≥–∞:', name, price);\n                    break;\n                  }\n                }\n              }\n            }\n          } catch (e) {\n            continue;\n          }\n        });\n\n        // –ü–æ–∏—Å–∫ —Å—Ä–æ–∫–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏\n        const timeElements = document.querySelectorAll('*');\n        for (const element of timeElements) {\n          const text = element.textContent || '';\n          if (text.includes('–¥–Ω–µ–π') || text.includes('–¥–Ω—è') || text.includes('–¥–µ–Ω—å')) {\n            result.deliveryTime = text.trim();\n            console.log('–ù–∞–π–¥–µ–Ω—ã —Å—Ä–æ–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏:', result.deliveryTime);\n            break;\n          }\n        }\n\n        return result;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞:', error);\n        return {\n          totalCost: 0,\n          services: [],\n          deliveryTime: null,\n          warnings: ['–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: ' + error.message]\n        };\n      }\n    });\n\n    const parseTime = ((Date.now() - startTime) / 1000).toFixed(1);\n\n    console.log('‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω');\n    console.log('üí∞ –ù–∞–π–¥–µ–Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å:', results.totalCost);\n    console.log('üì¶ –ù–∞–π–¥–µ–Ω–æ —É—Å–ª—É–≥:', results.services.length);\n\n    return {\n      totalCost: results.totalCost,\n      services: results.services,\n      deliveryTime: results.deliveryTime,\n      warnings: results.warnings,\n      parseTime: parseFloat(parseTime)\n    };\n\n  } catch (error: any) {\n    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ Vozovoz:', error);\n    throw new Error(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞: ${error.message}`);\n  } finally {\n    if (browser) {\n      await browser.close();\n      console.log('üîí –ë—Ä–∞—É–∑–µ—Ä –∑–∞–∫—Ä—ã—Ç');\n    }\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    \n    console.log('üï∑Ô∏è –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ Vozovoz —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:', JSON.stringify(body, null, 2));\n\n    // –í–∞–ª–∏–¥–∞—Ü–∏—è\n    const requiredFields = ['fromCity', 'toCity', 'length', 'width', 'height', 'weight'];\n    for (const field of requiredFields) {\n      if (!body[field]) {\n        return NextResponse.json({\n          error: `–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ: ${field}`\n        }, { status: 400 });\n      }\n    }\n\n    console.log('üöÄ –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞...');\n    \n    // –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞\n    const result = await parseVozovozWebsiteStable(body as VozovozParserParams);\n\n    console.log('‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É —É—Å–ø–µ—à–Ω–æ');\n    console.log('üí∞ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', result.totalCost);\n\n    return NextResponse.json(result);\n\n  } catch (error: any) {\n    console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞:', error);\n    \n    return NextResponse.json({\n      error: error.message || '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞',\n      details: error.stack\n    }, { status: 500 });\n  }\n}",
        "after": "import { NextRequest, NextResponse } from 'next/server';\nimport puppeteer from 'puppeteer';\n\ninterface VozovozParserParams {\n  fromCity: string;\n  toCity: string;\n  fromAddressDelivery: boolean;\n  toAddressDelivery: boolean;\n  fromAddress?: string;\n  toAddress?: string;\n  length: number;\n  width: number;\n  height: number;\n  weight: number;\n  needInsurance: boolean;\n  declaredValue?: number;\n  needPackaging: boolean;\n  needLoading: boolean;\n  hasFreightElevator: boolean;\n  floor: number;\n}\n\ninterface ParsedResult {\n  totalCost: number;\n  services: ServiceItem[];\n  deliveryTime?: string;\n  warnings?: string[];\n  parseTime?: number;\n}\n\ninterface ServiceItem {\n  name: string;\n  basePrice?: number;\n  price: number;\n  discount?: number;\n}\n\n// –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫\nasync function parseVozovozWebsiteStable(params: VozovozParserParams): Promise<ParsedResult> {\n  const startTime = Date.now();\n  let browser;\n  \n  try {\n    console.log('üï∑Ô∏è –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ Vozovoz...');\n    \n    // –°—Ç–∞–±–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞\n    browser = await puppeteer.launch({\n      headless: true,\n      args: [\n        '--no-sandbox',\n        '--disable-setuid-sandbox',\n        '--disable-dev-shm-usage',\n        '--disable-accelerated-2d-canvas',\n        '--no-first-run',\n        '--disable-gpu',\n        '--disable-extensions',\n        '--disable-default-apps',\n        '--disable-background-timer-throttling',\n        '--disable-backgrounding-occluded-windows',\n        '--disable-renderer-backgrounding',\n        '--disable-features=TranslateUI',\n        '--disable-ipc-flooding-protection',\n        '--memory-pressure-off',\n        '--max_old_space_size=4096'\n      ],\n      defaultViewport: {\n        width: 1280,\n        height: 800\n      }\n    });\n\n    const page = await browser.newPage();\n    \n    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ user-agent\n    await page.setUserAgent('Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36');\n\n    console.log('üìç –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–∞–π—Ç Vozovoz...');\n    \n    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫\n    try {\n      await page.goto('https://vozovoz.ru/', { \n        waitUntil: 'domcontentloaded',\n        timeout: 20000 \n      });\n    } catch (error) {\n      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:', error);\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∞–π—Ç Vozovoz');\n    }\n\n    console.log('‚úÖ –°–∞–π—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã\n    const pageAccessible = await page.evaluate(() => {\n      return document.body && document.body.innerHTML.length > 0;\n    });\n\n    if (!pageAccessible) {\n      throw new Error('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');\n    }\n\n    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤\n    await new Promise(resolve => setTimeout(resolve, 2000));\n\n    // –ü–æ–∏—Å–∫ –∏ –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –≤—Ö–æ–¥–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏\n    console.log('üîç –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞...');\n    \n    let loginClicked = false;\n    const loginSelectors = [\n      'a[href*=\"login\"]',\n      'button:contains(\"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç\")',\n      '.login-button',\n      '[data-testid=\"login-button\"]',\n      'a:contains(\"–í–æ–π—Ç–∏\")'\n    ];\n\n    for (const selector of loginSelectors) {\n      try {\n        await page.waitForSelector(selector, { timeout: 3000 });\n        await page.click(selector);\n        loginClicked = true;\n        console.log(`‚úÖ –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–∞–π–¥–µ–Ω–∞: ${selector}`);\n        break;\n      } catch (e) {\n        continue;\n      }\n    }\n\n    if (!loginClicked) {\n      // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –ø–æ —Ç–µ–∫—Å—Ç—É\n      loginClicked = await page.evaluate(() => {\n        const buttons = Array.from(document.querySelectorAll('a, button'));\n        const loginBtn = buttons.find(btn => {\n          const text = btn.textContent?.toLowerCase() || '';\n          return text.includes('–ª–∏—á–Ω—ã–π') || text.includes('–∫–∞–±–∏–Ω–µ—Ç') || text.includes('–≤–æ–π—Ç–∏');\n        });\n        \n        if (loginBtn) {\n          (loginBtn as HTMLElement).click();\n          return true;\n        }\n        return false;\n      });\n    }\n\n    if (!loginClicked) {\n      throw new Error('–ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–∞–∂–∞—Ç–∞');\n    \n    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    const authFormExists = await page.evaluate(() => {\n      const inputs = document.querySelectorAll('input[type=\"tel\"], input[type=\"password\"], input[name*=\"phone\"], input[name*=\"login\"]');\n      return inputs.length > 0;\n    });\n\n    if (!authFormExists) {\n      throw new Error('–§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    // –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    console.log('üîê –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...');\n    \n    const authDataEntered = await page.evaluate(() => {\n      try {\n        // –í–≤–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n        const phoneInputs = Array.from(document.querySelectorAll('input[type=\"tel\"], input[name*=\"phone\"], input[placeholder*=\"—Ç–µ–ª–µ—Ñ–æ–Ω\"]'));\n        if (phoneInputs.length > 0) {\n          const phoneInput = phoneInputs[0] as HTMLInputElement;\n          phoneInput.focus();\n          phoneInput.value = '79015199496';\n          phoneInput.dispatchEvent(new Event('input', { bubbles: true }));\n          phoneInput.dispatchEvent(new Event('change', { bubbles: true }));\n        }\n\n        // –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è\n        const passwordInputs = Array.from(document.querySelectorAll('input[type=\"password\"]'));\n        if (passwordInputs.length > 0) {\n          const passwordInput = passwordInputs[0] as HTMLInputElement;\n          passwordInput.focus();\n          passwordInput.value = 'LAv$it_2o21';\n          passwordInput.dispatchEvent(new Event('input', { bubbles: true }));\n          passwordInput.dispatchEvent(new Event('change', { bubbles: true }));\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö:', error);\n        return false;\n      }\n    });\n\n    if (!authDataEntered) {\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 1000));\n\n    // –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞\n    console.log('üîΩ –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—Ö–æ–¥–∞...');\n    \n    const loginSubmitted = await page.evaluate(() => {\n      try {\n        const buttons = Array.from(document.querySelectorAll('button[type=\"submit\"], button:not([disabled])'));\n        const submitBtn = buttons.find(btn => {\n          const text = btn.textContent?.toLowerCase() || '';\n          return text.includes('–≤–æ–π—Ç–∏') || text.includes('–¥–∞–ª–µ–µ') || text.includes('–≤—Ö–æ–¥');\n        });\n        \n        if (submitBtn) {\n          (submitBtn as HTMLElement).click();\n          return true;\n        }\n        return false;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏:', error);\n        return false;\n      }\n    });\n\n    if (!loginSubmitted) {\n      throw new Error('–ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã');\n    \n    // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    await new Promise(resolve => setTimeout(resolve, 5000));\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n    const authSuccess = await page.evaluate(() => {\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã (–Ω–µ—Ç —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞)\n      const loginInputs = document.querySelectorAll('input[type=\"password\"]');\n      return loginInputs.length === 0;\n    });\n\n    if (!authSuccess) {\n      throw new Error('–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å');\n    }\n\n    // –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞\n    console.log('üìã –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞...');\n    \n    let orderClicked = false;\n    const orderSelectors = [\n      'a[href*=\"order\"]',\n      'button:contains(\"–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑\")',\n      '.order-button',\n      '[data-testid=\"create-order\"]'\n    ];\n\n    for (const selector of orderSelectors) {\n      try {\n        await page.waitForSelector(selector, { timeout: 3000 });\n        await page.click(selector);\n        orderClicked = true;\n        console.log(`‚úÖ –ö–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞ –Ω–∞–π–¥–µ–Ω–∞: ${selector}`);\n        break;\n      } catch (e) {\n        continue;\n      }\n    }\n\n    if (!orderClicked) {\n      // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –ø–æ —Ç–µ–∫—Å—Ç—É\n      orderClicked = await page.evaluate(() => {\n        const links = Array.from(document.querySelectorAll('a, button'));\n        const orderLink = links.find(link => {\n          const text = link.textContent?.toLowerCase() || '';\n          return text.includes('–æ—Ñ–æ—Ä–º–∏—Ç—å') || text.includes('–∑–∞–∫–∞–∑') || text.includes('—Ä–∞—Å—á–µ—Ç');\n        });\n        \n        if (orderLink) {\n          (orderLink as HTMLElement).click();\n          return true;\n        }\n        return false;\n      });\n    }\n\n    if (!orderClicked) {\n      throw new Error('–ö–Ω–æ–ø–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    console.log('‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞');\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–æ—Ä–º—ã —Ä–∞—Å—á–µ—Ç–∞\n    const calcFormExists = await page.evaluate(() => {\n      const inputs = document.querySelectorAll('input[placeholder*=\"–æ—Ç–ø—Ä–∞–≤\"], input[placeholder*=\"–û—Ç–ø—Ä–∞–≤–∫–∞\"], input[placeholder*=\"–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\"]');\n      return inputs.length > 0;\n    });\n\n    if (!calcFormExists) {\n      throw new Error('–§–æ—Ä–º–∞ —Ä–∞—Å—á–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');\n    }\n\n    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã —Ä–∞—Å—á–µ—Ç–∞\n    console.log('üìù –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã —Ä–∞—Å—á–µ—Ç–∞...');\n    \n    const formFilled = await page.evaluate((params) => {\n      try {\n        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n        const fromInputs = Array.from(document.querySelectorAll('input[placeholder*=\"–æ—Ç–ø—Ä–∞–≤\"], input[name*=\"from\"], input[placeholder*=\"–û—Ç–ø—Ä–∞–≤–∫–∞\"]'));\n        if (fromInputs.length > 0) {\n          const fromInput = fromInputs[0] as HTMLInputElement;\n          fromInput.focus();\n          fromInput.value = '';\n          fromInput.value = params.fromCity;\n          fromInput.dispatchEvent(new Event('input', { bubbles: true }));\n          fromInput.dispatchEvent(new Event('change', { bubbles: true }));\n          \n          // –≠–º—É–ª–∏—Ä—É–µ–º –≤—ã–±–æ—Ä –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞\n          fromInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'ArrowDown' }));\n          fromInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter' }));\n        }\n\n        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è\n        const toInputs = Array.from(document.querySelectorAll('input[placeholder*=\"–ø—Ä–∏–±—ã—Ç\"], input[name*=\"to\"], input[placeholder*=\"–ü—Ä–∏–±—ã—Ç–∏–µ\"]'));\n        if (toInputs.length > 0) {\n          const toInput = toInputs[0] as HTMLInputElement;\n          toInput.focus();\n          toInput.value = '';\n          toInput.value = params.toCity;\n          toInput.dispatchEvent(new Event('input', { bubbles: true }));\n          toInput.dispatchEvent(new Event('change', { bubbles: true }));\n          \n          // –≠–º—É–ª–∏—Ä—É–µ–º –≤—ã–±–æ—Ä –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞\n          toInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'ArrowDown' }));\n          toInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter' }));\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã:', error);\n        return false;\n      }\n    }, params);\n\n    if (!formFilled) {\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–æ—Å—Ç–∞–≤–∫–∏\n    console.log('üöö –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–æ—Å—Ç–∞–≤–∫–∏...');\n    \n    const deliveryTypeSelected = await page.evaluate((params) => {\n      try {\n        // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n        if (!params.fromAddressDelivery) {\n          const terminalLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n            const text = el.textContent?.toLowerCase() || '';\n            return text.includes('—Ç–µ—Ä–º–∏–Ω–∞–ª') && (text.includes('–æ—Ç–ø—Ä–∞–≤') || text.includes('–æ—Ç–¥–µ–ª–µ–Ω–∏–µ'));\n          });\n          if (terminalLabels.length > 0) {\n            (terminalLabels[0] as HTMLElement).click();\n          }\n        }\n\n        // –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è\n        if (params.toAddressDelivery) {\n          const addressLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n            const text = el.textContent?.toLowerCase() || '';\n            return text.includes('–∞–¥—Ä–µ—Å') && (text.includes('–¥–æ—Å—Ç–∞–≤') || text.includes('–Ω–∞–∑–Ω–∞—á'));\n          });\n          if (addressLabels.length > 0) {\n            (addressLabels[0] as HTMLElement).click();\n          }\n        } else {\n          const terminalLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n            const text = el.textContent?.toLowerCase() || '';\n            return text.includes('—Ç–µ—Ä–º–∏–Ω–∞–ª') && (text.includes('–¥–æ—Å—Ç–∞–≤') || text.includes('–Ω–∞–∑–Ω–∞—á'));\n          });\n          if (terminalLabels.length > 0) {\n            (terminalLabels[0] as HTMLElement).click();\n          }\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:', error);\n        return false;\n      }\n    }, params);\n\n    if (!deliveryTypeSelected) {\n      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º...');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 2000));\n\n    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ\n    if (params.toAddressDelivery && params.toAddress) {\n      await page.evaluate((address) => {\n        const addressInputs = Array.from(document.querySelectorAll('input[placeholder*=\"–∞–¥—Ä–µ—Å\"], input[name*=\"address\"]'));\n        if (addressInputs.length > 0) {\n          const addressInput = addressInputs[0] as HTMLInputElement;\n          addressInput.focus();\n          addressInput.value = address;\n          addressInput.dispatchEvent(new Event('input', { bubbles: true }));\n        }\n      }, params.toAddress);\n    }\n\n    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥—Ä—É–∑–∞\n    console.log('üì¶ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥—Ä—É–∑–∞...');\n    \n    const cargoParamsFilled = await page.evaluate((params) => {\n      try {\n        // –í—ã–±–æ—Ä \"–ú–µ—Å—Ç–∞\"\n        const placesLabels = Array.from(document.querySelectorAll('label, span, div')).filter(el => {\n          const text = el.textContent?.toLowerCase() || '';\n          return text.includes('–º–µ—Å—Ç–∞') || text.includes('–º–µ—Å—Ç');\n        });\n        if (placesLabels.length > 0) {\n          (placesLabels[0] as HTMLElement).click();\n        }\n\n        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–∞–±–∞—Ä–∏—Ç–æ–≤\n        const dimensionInputs = {\n          length: Array.from(document.querySelectorAll('input[name*=\"length\"], input[placeholder*=\"–¥–ª–∏–Ω\"]')),\n          width: Array.from(document.querySelectorAll('input[name*=\"width\"], input[placeholder*=\"—à–∏—Ä–∏–Ω\"]')),\n          height: Array.from(document.querySelectorAll('input[name*=\"height\"], input[placeholder*=\"–≤—ã—Å–æ—Ç\"]')),\n          weight: Array.from(document.querySelectorAll('input[name*=\"weight\"], input[placeholder*=\"–≤–µ—Å\"]'))\n        };\n\n        if (dimensionInputs.length > 0) {\n          Object.entries(dimensionInputs).forEach(([key, inputs]) => {\n            if (inputs.length > 0) {\n              const input = inputs[0] as HTMLInputElement;\n              input.focus();\n              input.value = params[key].toString();\n              input.dispatchEvent(new Event('input', { bubbles: true }));\n            }\n          });\n        }\n\n        return true;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥—Ä—É–∑–∞:', error);\n        return false;\n      }\n    }, params);\n\n    if (!cargoParamsFilled) {\n      throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞');\n    }\n\n    await new Promise(resolve => setTimeout(resolve, 3000));\n\n    // –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n    console.log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—á–µ—Ç–∞...');\n    await new Promise(resolve => setTimeout(resolve, 8000));\n\n    // –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n    console.log('üìä –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...');\n    \n    const results = await page.evaluate(() => {\n      try {\n        const result: any = {\n          totalCost: 0,\n          services: [],\n          deliveryTime: null,\n          warnings: []\n        };\n\n        // –ü–æ–∏—Å–∫ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n        const totalSelectors = [\n          '*:contains(\"–ò—Ç–æ–≥–æ:\")',\n          '*:contains(\"–í—Å–µ–≥–æ:\")',\n          '*:contains(\"–°—Ç–æ–∏–º–æ—Å—Ç—å\")',\n          '.total-cost',\n          '.price-total'\n        ];\n\n        for (const selector of totalSelectors) {\n          try {\n            const elements = document.querySelectorAll(selector);\n            for (const element of elements) {\n              const text = element.textContent || '';\n              const priceMatch = text.match(/(\\d[\\s\\d]*\\d+)\\s*‚ÇΩ/);\n              if (priceMatch) {\n                result.totalCost = parseInt(priceMatch[1].replace(/\\s/g, ''));\n                console.log('–ù–∞–π–¥–µ–Ω–∞ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', result.totalCost);\n                break;\n              }\n            }\n            if (result.totalCost > 0) break;\n          } catch (e) {\n            continue;\n          }\n        }\n\n        // –ü–æ–∏—Å–∫ —É—Å–ª—É–≥\n        const serviceKeywords = [\n          '–ü–ª–∞—Ç–Ω—ã–π –≤—ä–µ–∑–¥',\n          '–ü–µ—Ä–µ–≤–æ–∑–∫–∞ –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏',\n          '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n          '–°–∫–ª–∞–¥—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞',\n          '–û—Ç–≤–æ–∑ –≥—Ä—É–∑–∞',\n          '–°–∫–∏–¥–∫–∞'\n        ];\n\n        serviceKeywords.forEach(keyword => {\n          try {\n            const elements = document.querySelectorAll('*');\n            for (const element of elements) {\n              const text = element.textContent || '';\n              if (text.includes(keyword) && text.includes('‚ÇΩ')) {\n                const priceMatch = text.match(/(\\d[\\s\\d]*\\d+)\\s*‚ÇΩ/);\n                if (priceMatch) {\n                  const price = parseInt(priceMatch[1].replace(/\\s/g, ''));\n                  const name = text.replace(priceMatch[0], '').trim();\n                  \n                  if (name && price > 0) {\n                    result.services.push({ name, price });\n                    console.log('–ù–∞–π–¥–µ–Ω–∞ —É—Å–ª—É–≥–∞:', name, price);\n                    break;\n                  }\n                }\n              }\n            }\n          } catch (e) {\n            // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º\n          }\n        });\n\n        // –ü–æ–∏—Å–∫ —Å—Ä–æ–∫–æ–≤ –¥–æ—Å—Ç–∞–≤–∫–∏\n        const timeElements = document.querySelectorAll('*');\n        for (const element of timeElements) {\n          const text = element.textContent || '';\n          if (text.includes('–¥–Ω–µ–π') || text.includes('–¥–Ω—è') || text.includes('–¥–µ–Ω—å')) {\n            result.deliveryTime = text.trim();\n            console.log('–ù–∞–π–¥–µ–Ω—ã —Å—Ä–æ–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏:', result.deliveryTime);\n            break;\n          }\n        }\n\n        return result;\n      } catch (error) {\n        console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞:', error);\n        return {\n          totalCost: 0,\n          services: [],\n          deliveryTime: null,\n          warnings: ['–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: ' + error.message]\n        };\n      }\n    });\n\n    const parseTime = ((Date.now() - startTime) / 1000).toFixed(1);\n\n    console.log('‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω');\n    console.log('üí∞ –ù–∞–π–¥–µ–Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å:', results.totalCost);\n    console.log('üì¶ –ù–∞–π–¥–µ–Ω–æ —É—Å–ª—É–≥:', results.services.length);\n\n    return {\n      totalCost: results.totalCost,\n      services: results.services,\n      deliveryTime: results.deliveryTime,\n      warnings: results.warnings,\n      parseTime: parseFloat(parseTime)\n    };\n\n  } catch (error: any) {\n    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ Vozovoz:', error);\n    throw new Error(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞: ${error.message}`);\n  } finally {\n    if (browser) {\n      await browser.close();\n      console.log('üîí –ë—Ä–∞—É–∑–µ—Ä –∑–∞–∫—Ä—ã—Ç');\n    }\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    \n    console.log('üï∑Ô∏è –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ Vozovoz —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:', JSON.stringify(body, null, 2));\n\n    // –í–∞–ª–∏–¥–∞—Ü–∏—è\n    const requiredFields = ['fromCity', 'toCity', 'length', 'width', 'height', 'weight'];\n    for (const field of requiredFields) {\n      if (!body[field]) {\n        return NextResponse.json({\n          error: `–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ: ${field}`\n        }, { status: 400 });\n      }\n    }\n\n    console.log('üöÄ –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞...');\n    \n    // –ó–∞–ø—É—Å–∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞\n    const result = await parseVozovozWebsiteStable(body as VozovozParserParams);\n\n    console.log('‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É —É—Å–ø–µ—à–Ω–æ');\n    console.log('üí∞ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', result.totalCost);\n\n    return NextResponse.json(result);\n\n  } catch (error: any) {\n    console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞:', error);\n    \n    return NextResponse.json({\n      error: error.message || '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞',\n      details: error.stack\n    }, { status: 500 });\n  }\n}",
        "additions": 1,
        "deletions": 1
      }
    },
    "time": {
      "start": 1764361079318,
      "end": 1764361079325
    }
  }
}