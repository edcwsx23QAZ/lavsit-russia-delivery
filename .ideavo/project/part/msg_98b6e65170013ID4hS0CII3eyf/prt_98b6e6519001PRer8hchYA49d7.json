{
  "id": "prt_98b6e6519001PRer8hchYA49d7",
  "type": "text",
  "text": "Появилась ошибка у Деловых Линий, которой ранее не было. Исправь ее\n\nТакже все еще не работает ПЭК. Проверь что сейчас может быть не так. Полный лог ниже:\n\nМетод /branches/findzonebyaddress/ — поиск тарифных зон и филиалов по строке адреса\nДоступ\nЗарегистрированные пользователи\nКомментарии\nМетод по строке адреса выводит филиал, к которому относится указанный адрес, наименование тарифной зоны, ID склада основного отделения филиала. Составляющие части адреса возвращаются в виде массива: страна, регион, населенный пункт, улица, дом.\nЕсли возвращается пустой ответ - значит зона адреса не обслуживается ПЭК.\nФормат запроса\n{\n    \"address\": \"Ростовская обл, Азовский р-н, поселок Койсуг\" // Адрес [string]\n}\nФормат ответа\n{\n    \"zoneId\": \"52ce7ec0-ab5f-11e8-80ca-00155d444127\", // Идентификатор зоны [String]\n    \"zoneName\": \"Батайск город\", // Наименование зоны [String]\n    \"branchUID\": \"614cdae3-7070-11e8-80c9-00155d668927\", // Идентификатор филиала [String]\n    \"bitrixId\": \"2729346\", // Код филиала [String]. В актуальной версии протокола не используется\n    \"branchCode\": \"БТ\", // Код филиала [String]\n    \"branchTitle\": \"Батайск\", // Название филиала [String]\n    \"mainWarehouseId\": \"a5ab5545-7076-11e8-80c9-00155d668927\", // ID склада основного отделения филиала [String]\n    \"warehousePoint\": { // Координаты «Основного отделения филиала компании», к которому относится адрес\n        \"latitude\": 47.12786575851295, // Координата широты [double]\n        \"longitude\": 39.85232042817180 // Координата долготы [double]\n    },\n    \"GeoData\": {\n        \"precision\": \"exact\", // критерий точности распознавания координат адреса [String]. Возможные значения: \n                              // \"exact\" - точно; \"bad\" - заявка по такому адресу не будет принята, \n                              // \"near\" - поняли адрес приблизительно (до улицы, соседнего дома и т.п.), \n                              // заявка будет принята, но потребуется уточнение адреса при оформлении груза.\n        \"kind\": \"locality\", // название компоненты адреса, до которой определен адрес в ответе. Пример значений: \"house\", \"street\", \"locality\" (город, село и т.п.), \"province\" (часть региона), \"country\"\n        \"Address\": {\n            \"country_code\": \"RU\", // код страны, к которой относится адрес (выводится только если определен точный адрес)\n            \"formatted\": \"Россия, Ростовская область, Азовский район, посёлок Койсуг\", // полное представление найденного адреса\n            \"Components\": [ // массив составляющих частей адреса: страна, регион, населенный пункт, улица, дом\n                {\n                    \"kind\": \"country\",\n                    \"name\": \"Россия\"\n                },\n                {\n                    \"kind\": \"province\",\n                    \"name\": \"Южный федеральный округ\"\n                },\n                {\n                    \"kind\": \"province\",\n                    \"name\": \"Ростовская область\"\n                },\n                {\n                    \"kind\": \"area\",\n                    \"name\": \"Азовский район\"\n                },\n                {\n                    \"kind\": \"locality\",\n                    \"name\": \"посёлок Койсуг\"\n                }\n            ]\n        }\n    }\n}\n}\nМетод /branches/checkpickupdate/ — определение доступности дат забора груза\nДоступ\nЗарегистрированные пользователи\nКомментарии\nМетод позволяет определить только возможность забора груза в указанную дату и выводит массив доступных дат до и после указанной даты.\nЕсли необходимо проверить, действует ли льготный тариф на забор по запрошенному адресу в указанную дату, рекомендуем использовать метод /calculator/checkdeliverydate/.\nФормат запроса\n{\n    \"address\": \"Вологда\", // Адрес забора [String]\n    \"planPickupDate\": \"2022-08-20\" // Плановая дата забора [\"String\"]\n}\nФормат ответа\n{\n    \"AddressAvailable\": true, // Забор с адреса возможен [Boolean]\n    \"PickupDateAvailable\": true, // Забор на указанную дату возможен [Boolean]\n    \"AvailablePickupDatesBefore\": [ // Массив доступных дат до указанной [Array]\n        \"2022-08-17\", // Доступая дата [String]\n        \"2022-08-18\",\n        \"2022-08-19\"\n    ],\n    \"AvailablePickupDatesAfter\": [ // Массив доступных дат после указанной [Array]\n        \"2022-08-22\", // Доступная дата [String]\n        \"2022-08-23\",\n        \"2022-08-24\"\n        ]\n}\nМетод /branches/suggestaddressofintakeordelivery/ — запрос поисковых подсказок адресов забора/доставки груза\nДоступ\nЗарегистрированные пользователи\nКомментарии\nМетод позволяет в ИТ системе реализовать быстрый подбор адреса забора/ доставки по аналогии с тем, как это сделано на сайте pecom.ru при подаче заявки. На вход дается строка с частью адреса, в ответе выводятся наиболее похожие варианты. При этом перечень вариантов содержит только адреса зоны доставки/ забора ПЭК. В некоторых случаях отсутствие вариантов адресов может говорить только о том, что адреса еще нет в базе, но забор/ доставка по адресу возможны, если есть забор/ доставка на соседние улицы/ дома.\nНе используйте данный метод для проверки доступности адреса, т.к. есть ограничения по числу запросов для всех пользователей в сутки.\nДля проверки доступности адреса Забора и Доставки используйте метод /BRANCHES/FINDZONEBYADDRESS/. Правильность адреса можно смотреть в ответе метода /FINDZONEBYADDRESS/ в блоке GeoData. Address. formatted\nФормат запроса\n{\n    \"address\": \"Койсуг\" // Часть адреса для получения вариантов наиболее похожих доступных адресов забора и доставки [string]\n}\nФормат ответа\n{\n    \"response\": {\n        \"GeoObjectCollection\": {\n            \"metaDataProperty\": {\n                \"GeocoderResponseMetaData\": {\n                    \"request\": \"Койсуг\", // часть адреса, по котормоу подбирались варианты\n                    \"results\": \"10\",\n                    \"found\": \"6\" // количество найденных вариантов адресов по стркое запроса\n                }\n            },\n            \"featureMember\": [ // массив предлагаемых вариантов вариантов адресов, подобранных по запросу\n                {\n                    \"GeoObject\": {\n                        \"metaDataProperty\": {\n                            \"GeocoderMetaData\": {\n                                \"precision\": \"other\",\n                                \"text\": \"Россия, Ростовская область, Азовский район, посёлок Койсуг\", // Полный адрес, предлагаемый как вариант искомого по запросу\n                                \"kind\": \"locality\",\n                                \"Address\": {\n                                    \"country_code\": \"RU\",\n                                    \"formatted\": \"Россия, Ростовская область, Азовский район, посёлок Койсуг\",\n                                    \"Components\": [\n                                        {\n                                            \"kind\": \"country\",\n                                            \"name\": \"Россия\"\n                                        },\n                                        {\n                                            \"kind\": \"province\",\n                                            \"name\": \"Южный федеральный округ\"\n                                        },\n                                        {\n                                            \"kind\": \"province\",\n                                            \"name\": \"Ростовская область\"\n                                        },\n                                        {\n                                            \"kind\": \"area\",\n                                            \"name\": \"Азовский район\"\n                                        },\n                                        {\n                                            \"kind\": \"locality\",\n                                            \"name\": \"посёлок Койсуг\"\n                                        }\n                                    ]\n                                },\n                                \"AddressDetails\": {\n                                    \"Country\": {\n                                        \"AddressLine\": \"Россия, Ростовская область, Азовский район, посёлок Койсуг\",\n                                        \"CountryNameCode\": \"RU\",\n                                        \"CountryName\": \"Россия\",\n                                        \"AdministrativeArea\": {\n                                            \"AdministrativeAreaName\": \"Ростовская область\",\n                                            \"SubAdministrativeArea\": {\n                                                \"SubAdministrativeAreaName\": \"Азовский район\",\n                                                \"Locality\": {\n                                                    \"LocalityName\": \"посёлок Койсуг\"\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        },\n                        \"name\": \"посёлок Койсуг\",\n                        \"description\": \"Азовский район, Ростовская область, Россия\",\n                        \"boundedBy\": {\n                            \"Envelope\": {\n                                \"lowerCorner\": \"39.657835 47.105628\",\n                                \"upperCorner\": \"39.678784 47.129095\"\n                            }\n                        },\n                        \"Point\": {\n                            \"pos\": \"39.668004 47.116158\" // координаты центральной точки, найденного объекта\n                        }\n                    }\n                },\n                ...\n            ]\n        }\n    }\n}\nФормат ответа с ошибкой\n{ \n    \"hasError\": true, // Признак ошибок при вызове метода [Boolean] \n    \"errorMessage\": \"Превышено общее для всех пользователей число запросов метода в сутки. Обратитесь в поддержку ПЭК: admin-extintegration@pecom.ru\" // Текст ошибки [String]\n}\nМетод /branches/nearestdepartments/ — подбор ближайших к адресу отделений для приема/выдачи грузов\nДоступ\nЗарегистрированные пользователи\nКомментарии\nМетод предназначен для организации подбора ближайших к клиенту (адресу клиента) отделений для приема/выдачи грузов, которые подойдут для конкретного груза. Или подбора отделений в конкретном городе.\nФормат запроса\n\n{\n    \"address\": \"Россия, Самара\", // Если переданы координаты в реквизите «coordinates», то указанный здесь адрес игнорируется [string]\n    \"coordinates\": // Координаты. Необязательно, если передан параметр «address»\n    {\n        \"latitude\": \"55.717426\", // Координата широты [string]\n        \"longitude\": \"37.757728\" // Координата долготы [string]\n    },\n    \"weight\": null, // Вес груза, для которого необходимо подобрать подходящее отделение [double]. Необязательно\n    \"volume\": null, // Общий объем груза, для которого нужно подобрать отделение [double]. Необязательно\n    \"maxDimension\": null, // Максимальный габарит груза, для которого нужно подобрать отделение [double]. Необязательно\n    \"maxWeightPerPlace\": null, // Самое тяжелое место из всех грузомест груза [double]. Необязательно\n    \"departmentOperation\": 3, // 2 – есть приемка грузов, 3 – есть выдача грузов [int]. Обязательно.\n    \"type\":  3,  // Идентификатор продукта/тарифа ПЭК, с которым должно работать отделение [Number]. Обязательно.\n                 // Полный список доступных в API продуктов/тарифов можно получить методом /typesOfDelivery/all/\n    \"searchRadius\": 50, // Километры [int]. На каком расстоянии по прямой от точки переданных\n                        // координат или адреса до предлагаемых Отделений/Складов. Обязательно.\n    \"limit\": 5 // Сколько подходящих отделений возвращать в каждом массиве [int]. Обязательно.\n}\nФормат ответа\n{\n    \"freeDepartments\": // Массив с собственными отделениями ПЭК, подходящие в выборку [Array]\n    [ \n        {\n            \"warehouseId\": \"85974fc8-d0b8-11e5-9833-00155d668909\", // ID склада, используется в методах расчета стоимости и подачи заявок [string]\n            \"departmentType\": \"Отделение компании\", // Тип отделения. На текущий момент может быть 3 варианта: «Отделение компании», \n                                                    // \"Основное отделение филиала компании\", «ПВЗ» \n                                                    // (этот тип только в массиве paidDepartments) [string]\n            \"departmentTypeId\": 0, // ID типа отделения [Number]. Обозначения: //0 - Отделение компании, 1 - ПВЗ, 4 - Основное отделение компании в филиале\n            \"branchId\": \"64adbe2b-a185-11dc-a911-000a5e19ccb4\", // ID филиала, к которому относится отделение (организационная привязка).      \n            \"branchName\": \"Самара\", // Наименование филиала, к которому относится отделение (используется для передачи значения City в методах API) [string]\n            \"divisionName\": \"Самара Запад\", // Наименование отделения [string]\n            \"isActive\": true, // не используется. В ответе метода всегда только Активные отделения. [Boolean]\n            \"address\": \"Самарская область, г. Самара, ул. Верхне-Карьерная, д. 3В\", // Адрес отделения [string]\n            \"coordinates\": { // Координаты отделения                     \n                \"latitude\": 53.181565, [double]\n                \"longitude\": 50.174304 [double]\n            },\n            \"timeZone\": \"04:00:00\", // Временная зона, к которой относится отделение [string]\n            \"townBitrixId\": 481, // Идентификатор города, к которому относится отделение. Используется в методе CalculatePrice [int]\n            \"email\": \"samara@pecom.ru\", // Электронный адрес отделения [string]\n            \"phone\": \"8(846) 201-60-33\", // Телефон отделения [string]\n            \"priority\": 70, // Внутренний приоритет отделения (в рамках данного метода не важен). Отделения с наивысшим приоритетом ПЭК предлагает по умолчанию клиентам. [int]\n            \"maxWeight\": 0.0, // Ограничение на общий вес груза, который может обрабатывать отделение. 0 – ограничений нет. [double]\n            \"maxVolume\": 0.0, // Ограничение на общий объем груза, который может обрабатывать отделение. 0 – ограничений нет. [double]\n            \"maxDimension\": 0.0, // Ограничение на максимальный габарит груза \n                                 // (наибольший размер из длины, ширины и высоты из всех мест), \n                                 // который может обрабатывать отделение. 0 – ограничений нет. [double]\n            \"maxWeightOnePlace\": 0.0, // Ограничение на максимальный вес одного места груза, который может обрабатывать отделение. 0 – ограничений нет. [double]\n            \"maxCount\": 0, // Ограничение на количество мест груза, которое может обрабатывать отделение. 0 – ограничений нет. [int]\n            \"scheduleShortWorkDays\": [ // Сокращенный режим работы [Array]\n                 {\n                     \"date\": \"2023-11-03T00:00:00\", //Дата сокращённого дня\n                     \"workTime\":{ //Время работы сокращённого дня\n                          \"periodTimeFrom\": \"09:00:00\", // Начало рабочего дня [String]\n                          \"periodTimeTo\": \"17:00:00\", // Конец рабочего дня [String]\n                          },\n                     \"breakTime\": null // Обеденный перерыв [String]\n                 },       \n            ],\n            \"scheduleHolidayDays\": // Праздничные и выходные дни отделения вне графика его работы [Array]\n            [ \n                \"2022-06-12T00:00:00\",\n                \"2022-06-13T00:00:00\",\n                \"2022-11-04T00:00:00\"\n            ]\n        },\n        ...\n    ],\n    \"paidDepartments\": // Массив с ПВЗ (структура элемента массива такая же как для собственных отделений) [Array]\n    [ \n        { \n            ...\n        },\n        ...\n    ]\n}\nМетод /branches/country/ — список стран, в которых присутствуют отделения ПЭК\nДоступ\nЗарегистрированные пользователи\nКомментарии\nВыводится перечень стран, в которых присутствуют отделения ПЭК. Обращаем Ваше внимание, что перед началом интеграции процессов по перевозке между разными странами и внутри стран (кроме РФ) необходимо уточнить ограничения и правила перевозки между интересующими направлениям у Вашего менеджера ПЭК!\nФормат запроса\n// Пустой объект или пустой json\n{\n}\nФормат ответа\n[ // Список стран, в которых присутствует ПЭК [Array]\n    { // Информация о стране [Object]\n        \"codeByClassifier\": \"051\", // Код страны по общероссийскому классификатору [String]\n        \"name\": \"АРМЕНИЯ\", // Наименование страны [String]\n        \"shortName\": \"AM\" // Краткое наименование страны [String]\n    },\n    {\n        \"codeByClassifier\": \"112\",\n        \"name\": \"БЕЛАРУСЬ\",\n        \"shortName\": \"BY\"\n    },\n    ...\n]\nМетод /branches/checknocalcservices/ — проверка возможности предоставления услуг, не проверяемых в методе расчета стоимости\nДоступ\nЗарегистрированные пользователи\nКомментарии\nМетод на текущий момент позволяет проверить только услуги Наложенный платеж: GUID = 739293fd-edc7-495d-9e56-6f61ad39bb8c и Выдача по СМС (упрощенная выдача): GUID = ffb40421-4761-11e8-80c9-00155d668927 по конкретному направлению перевозки.\nОбращаем ваше внимание, что метод проверяет доступность услуг только по географии. Для проверки возможности использования данных услуг конкретными отправителями и их условия необходимо использовать метод /connecteddiscountsservicesagreements/.\nНа вход данного метода ожидается ID филиалов отправления и назначения, которые можно получить из метода расчета стоимости или из методов получения географии, при этом для отделений филиал необходимо брать из организационной структуры.\nФормат запроса\n{  \n    \"branchSenderId\":\"b473ce9f-dd68-44ea-a4b2-4cb63b6e970d\",   // ID филиала отправления груза, см.комментарии к методу\n    \"branchReceiverId\":\"3211d5f7-9916-11ec-80d0-00155d66894c\"  // ID филиала назначения груза, см. комментарии к методу\n} \nФормат ответа\n[\n    {\n        \"specialCondition\": {\n            \"UID\": \"739293fd-edc7-495d-9e56-6f61ad39bb8c\", // Соглашение о Наложенном платеже UID [String]. Если есть в ответе, значит услуга \"наложенный платеж\" может оказываться для указанного направления. Но необходимо проверить еще ее подключение для конкретного контрагента. \n            \"Title\": \"Наложенный платеж\" // Наименование услуги [String]\n        }\n    },\n    {\n        \"specialCondition\": {\n            \"UID\": \"ffb40421-4761-11e8-80c9-00155d668927\", // Выдача по СМС для физ.лиц (упрощенная выдача) UID [String]. Если есть в ответе, то услуга \"Выдача по СМС\" может быть заказана по выбранному направлению, с ограничением по объявленной стоимости (уточняйте актуальные ограничения на сайте ПЭК).\n            \"Title\": \"Упрощенная выдача\"\n        }\n    }\n]\nМетод /branches/countrytypeidentitydocument/ — возвращает допустимые документы, удостоверяющие личность, для страны отправления/получения\nДоступ\nЗарегистрированные пользователи\nФормат запроса\n{\n    \"codeByClassifier\": \"643\" // Код страны по общероссийскому классификатору [String].\n                              // Можно получить методом /branches/country/\n} \nФормат ответа\n{\n    \"result\": [\n        {\n            \"guid\": \"b87bc99c-c4c2-11e7-80c9-00155d668927\", // Уникальный идентификатор типа документа [String]\n            \"name\": \"Без предоставления документа\",         // Наименование документа [String]\n            \"mask\": {\n                \"series\": null,\n                \"number\": null\n            }\n        },\n        {\n            \"guid\": \"229fbe79-34a4-11e6-b11a-00155d668909\",\n            \"name\": \"Паспорт гражданина РФ\",\n            \"mask\": {\n                \"series\": null,\n                \"number\": null\n            }\n        },\n        ...\n    ]\n}\nМетод /branches/departmentslimit/ — ограничения весо-габаритных характеристик груза для тарифа/ продукта «Express Автоперевозка».\nДоступ\nЗарегистрированные пользователи\nКомментарии\nМетод возвращает максимально-допустимые значения ВГХ груза для тарифа \"Express Автоперевозка\" между указанными филиалами или складами. Результат возвращается в виде структуры.\nМетод не проверяет наличие маршрута перевозки между филиалами.\nЕсли возвращается пустой ответ - значит для тарифа \"Express Автоперевозка\" нет возможности перевозить груз между указанными филиалами (складами).\nИдентификаторы филиалов и складов отправителя/ получателя можно получить методом /branches/nearestdepartments/ (в ответе метода freeDepartments.branchId и freeDepartments.warehouseId)\nФормат запроса\n{\n    \"senderBranchId\": \"b473ce9f-dd68-44ea-a4b2-4cb63b6e970d\",//Идентификатор филиала отправителя [String]. Обязателен\n                     //Можно получить методом /branches/nearestdepartments/ по адресу забора freeDepartments.branchId\n    \"recipientBranchId\": \"64adbe2c-a185-11dc-a911-000a5e19ccb4\",//Идентификатор филиала получателя [String]. Обязателен\n                        //Можно получить методом  /branches/nearestdepartments/ по адресу доставки freeDepartments.branchId\n    \"senderWarehouseId\": \"a678333f-2a2a-11e9-80ce-00155d713b38\",//Идентификатор склада отправителя [String]. Не обязателен\n                        //Можно получить методом  /branches/nearestdepartments/ по адресу забора freeDepartments.warehouseId\n    \"recipientWarehouseId\": \"77968d17-65bc-11e9-80cd-00155d4a0436\", //Идентификатор склада получателя [String]. Не обязателен\n                           //Можно получить методом  /branches/nearestdepartments/ по адресу доставки freeDepartments.warehouseId\n    \"type\": 5 // Идентификатор продукта/тарифа Express Автоперевозка [Number]. Обязателен\n}\nФормат ответа\n{\n    \"senderBranchId\": \"b473ce9f-dd68-44ea-a4b2-4cb63b6e970d\", //Идентификатор филиала отправителя [String].\n    \"recipientBranchId\": \"64adbe2c-a185-11dc-a911-000a5e19ccb4\", //Идентификатор филиала получателя [String].\n    \"senderWarehouseId\": \"a678333f-2a2a-11e9-80ce-00155d713b38\", //Идентификатор склада отправителя [String]. Выводится, если был передан в запросе\n    \"recipientWarehouseId\": \"77968d17-65bc-11e9-80cd-00155d4a0436\", //Идентификатор склада получателя [String]. Выводится, если был передан в запросе\n    \"type\": 5, // Идентификатор продукта/тарифа Express Автоперевозка [Number].\n    \"wdcLimits\": { //Лимиты ВГХ\n        \"weight\": 2500.000, //Максимальный вес, грузоместа\n        \"totalWeight\": 2500.000, //Максимальный общий вес груза\n        \"height\": 2.45, //Максимальная высота грузоместа\n        \"length\": 3.000, //Максимальная длина грузоместа\n        \"maxLength\": 3.000, //Максимальный габарит грузоместа\n        \"volume\": 8.92, //Максимальный объем грузоместа\n        \"width\": 2.42 //Максимальная ширина грузоместа\n    }\n}",
  "messageID": "msg_98b6e65170013ID4hS0CII3eyf",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14"
}