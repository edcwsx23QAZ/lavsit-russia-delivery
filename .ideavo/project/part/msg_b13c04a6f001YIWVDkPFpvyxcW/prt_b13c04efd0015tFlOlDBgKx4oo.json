{
  "id": "prt_b13c04efd0015tFlOlDBgKx4oo",
  "sessionID": "ses_4ec3ff722ffeBPzPNwp55I8TOz",
  "messageID": "msg_b13c04a6f001YIWVDkPFpvyxcW",
  "type": "tool",
  "callID": "call_78710873",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "app/vozovoz-parser/page.tsx",
      "limit": 200
    },
    "output": "<file>\n00001| \"use client\";\n00002| \n00003| import { useState } from 'react';\n00004| import { Button } from '@/components/ui/button';\n00005| import { Input } from '@/components/ui/input';\n00006| import { Label } from '@/components/ui/label';\n00007| import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n00008| import { Checkbox } from '@/components/ui/checkbox';\n00009| import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\n00010| import { Loader2, Play, GitCompare } from 'lucide-react';\n00011| import CalculationDetails from '@/components/CalculationDetails';\n00012| \n00013| interface VozovozParserParams {\n00014|   fromCity: string;\n00015|   toCity: string;\n00016|   fromAddressDelivery: boolean;\n00017|   toAddressDelivery: boolean;\n00018|   fromAddress?: string;\n00019|   toAddress?: string;\n00020|   length: number;\n00021|   width: number;\n00022|   height: number;\n00023|   weight: number;\n00024|   needInsurance: boolean;\n00025|   declaredValue?: number;\n00026|   needPackaging: boolean;\n00027|   needLoading: boolean;\n00028|   hasFreightElevator: boolean;\n00029|   floor: number;\n00030| }\n00031| \n00032| interface ParsedResult {\n00033|   totalCost: number;\n00034|   services: ServiceItem[];\n00035|   deliveryTime?: string;\n00036|   warnings?: string[];\n00037|   parseTime?: number;\n00038| }\n00039| \n00040| interface ServiceItem {\n00041|   name: string;\n00042|   basePrice?: number;\n00043|   price: number;\n00044|   discount?: number;\n00045| }\n00046| \n00047| interface ApiResult {\n00048|   price: number;\n00049|   days: number;\n00050|   details?: any;\n00051|   error?: string;\n00052| }\n00053| \n00054| export default function VozovozParserPage() {\n00055|   const [params, setParams] = useState<VozovozParserParams>({\n00056|     fromCity: 'Москва',\n00057|     toCity: 'Санкт-Петербург',\n00058|     fromAddressDelivery: false,\n00059|     toAddressDelivery: true,\n00060|     fromAddress: '',\n00061|     toAddress: 'Невский проспект д.132',\n00062|     length: 200,\n00063|     width: 100,\n00064|     height: 100,\n00065|     weight: 100,\n00066|     needInsurance: false,\n00067|     declaredValue: 0,\n00068|     needPackaging: false,\n00069|     needLoading: false,\n00070|     hasFreightElevator: false,\n00071|     floor: 1\n00072|   });\n00073| \n00074|   const [parserResult, setParserResult] = useState<ParsedResult | null>(null);\n00075|   const [apiResult, setApiResult] = useState<ApiResult | null>(null);\n00076|   const [isParserLoading, setIsParserLoading] = useState(false);\n00077|   const [isApiLoading, setIsApiLoading] = useState(false);\n00078|   const [error, setError] = useState<string | null>(null);\n00079| \n00080|   const handleParamChange = (key: keyof VozovozParserParams, value: any) => {\n00081|     setParams(prev => ({ ...prev, [key]: value }));\n00082|   };\n00083| \n00084|   const runParser = async () => {\n00085|     setIsParserLoading(true);\n00086|     setError(null);\n00087|     setParserResult(null);\n00088| \n00089|     try {\n00090|       const response = await fetch('/api/vozovoz-parser-hybrid', {\n00091|         method: 'POST',\n00092|         headers: {\n00093|           'Content-Type': 'application/json',\n00094|         },\n00095|         body: JSON.stringify(params),\n00096|       });\n00097| \n00098|       if (!response.ok) {\n00099|         throw new Error(`Ошибка HTTP: ${response.status}`);\n00100|       }\n00101| \n00102|       const result = await response.json();\n00103|       \n00104|       if (result.error) {\n00105|         throw new Error(result.error);\n00106|       }\n00107| \n00108|       setParserResult(result);\n00109|     } catch (err: any) {\n00110|       setError(err.message || 'Ошибка при выполнении парсера');\n00111|     } finally {\n00112|       setIsParserLoading(false);\n00113|     }\n00114|   };\n00115| \n00116|   const runApiComparison = async () => {\n00117|     setIsApiLoading(true);\n00118|     setApiResult(null);\n00119| \n00120|     try {\n00121|       // Формируем запрос для API аналогично основному приложению\n00122|       const maxDimensions = {\n00123|         length: params.length / 1000, // переводим мм в м\n00124|         width: params.width / 1000,\n00125|         height: params.height / 1000,\n00126|         weight: params.weight\n00127|       };\n00128| \n00129|       const totalVolume = (params.length * params.width * params.height) / 1000000000; // м³\n00130|       const totalWeight = params.weight;\n00131| \n00132|       const requestData = {\n00133|         object: \"price\",\n00134|         action: \"get\",\n00135|         params: {\n00136|           cargo: {\n00137|             dimension: {\n00138|               max: maxDimensions,\n00139|               quantity: 1,\n00140|               volume: totalVolume,\n00141|               weight: totalWeight\n00142|             },\n00143|             ...(params.needInsurance && (params.declaredValue || 0) > 0 ? {\n00144|               insurance: params.declaredValue || 0,\n00145|               insuranceNdv: false\n00146|             } : {\n00147|               insuranceNdv: true\n00148|             }),\n00149|             ...(params.needPackaging ? {\n00150|               wrapping: {\n00151|                 \"hardPackageVolume\": totalVolume\n00152|               }\n00153|             } : {})\n00154|           },\n00155|           gateway: {\n00156|             dispatch: {\n00157|               point: {\n00158|                 location: params.fromCity,\n00159|                 ...(params.fromAddressDelivery ? {\n00160|                   address: params.fromAddress || \"адрес отправления\"\n00161|                 } : {\n00162|                   terminal: \"default\"\n00163|                 })\n00164|               }\n00165|             },\n00166|             destination: {\n00167|               point: {\n00168|                 location: params.toCity,\n00169|                 ...(params.toAddressDelivery ? {\n00170|                   address: params.toAddress || \"адрес получения\"\n00171|                 } : {\n00172|                   terminal: \"default\"\n00173|                 })\n00174|               }\n00175|             }\n00176|           }\n00177|         }\n00178|       };\n00179| \n00180|       const response = await fetch('/api/vozovoz', {\n00181|         method: 'POST',\n00182|         headers: {\n00183|           'Content-Type': 'application/json',\n00184|         },\n00185|         body: JSON.stringify(requestData),\n00186|       });\n00187| \n00188|       if (!response.ok) {\n00189|         throw new Error(`Ошибка API: ${response.status}`);\n00190|       }\n00191| \n00192|       const result = await response.json();\n00193|       \n00194|       if (result.error) {\n00195|         throw new Error(result.error);\n00196|       }\n00197| \n00198|       setApiResult({\n00199|         price: result.response?.price || 0,\n00200|         days: result.response?.deliveryTime?.to || 1,\n\n(File has more lines. Use 'offset' parameter to read beyond line 200)\n</file>",
    "title": "app/vozovoz-parser/page.tsx",
    "metadata": {
      "preview": "\"use client\";\n\nimport { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Loader2, Play, GitCompare } from 'lucide-react';\nimport CalculationDetails from '@/components/CalculationDetails';\n\ninterface VozovozParserParams {\n  fromCity: string;\n  toCity: string;\n  fromAddressDelivery: boolean;\n  toAddressDelivery: boolean;\n  fromAddress?: string;\n  toAddress?: string;\n  length: number;"
    },
    "time": {
      "start": 1765562928898,
      "end": 1765562928906
    }
  }
}