{
  "id": "prt_9857f4d39001aF8jnGPhNdsFYG",
  "messageID": "msg_9857f3d49001BwANom5dXc5VOH",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_01Xx5RCBwKGfvKnY6DPJB7hi",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx"
    },
    "output": "<file>\n00001| 'use client';\n00002| \n00003| import React, { useState, useEffect, useCallback } from 'react';\n00004| import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n00005| import { Button } from '@/components/ui/button';\n00006| import { Input } from '@/components/ui/input';\n00007| import { Label } from '@/components/ui/label';\n00008| import { Checkbox } from '@/components/ui/checkbox';\n00009| import { Plus, Truck, Building2, Map } from 'lucide-react';\n00010| import { Alert, AlertDescription } from '@/components/ui/alert';\n00011| import { Badge } from '@/components/ui/badge';\n00012| import { Separator } from '@/components/ui/separator';\n00013| import { Collapsible, CollapsibleContent } from '@/components/ui/collapsible';\n00014| \n00015| interface Cargo {\n00016|   id: string;\n00017|   length: number;\n00018|   width: number;\n00019|   height: number;\n00020|   weight: number;\n00021| }\n00022| \n00023| interface DeliveryForm {\n00024|   cargos: Cargo[];\n00025|   fromCity: string;\n00026|   toCity: string;\n00027|   fromAddress: string;\n00028|   toAddress: string;\n00029|   declaredValue: number;\n00030|   needPackaging: boolean;\n00031|   needLoading: boolean;\n00032|   needCarry: boolean;\n00033|   floor: number;\n00034|   hasFreightLift: boolean;\n00035|   needInsurance: boolean;\n00036|   fromTerminal: boolean;\n00037|   toTerminal: boolean;\n00038|   fromAddressDelivery: boolean;\n00039|   toAddressDelivery: boolean;\n00040| }\n00041| \n00042| interface CalculationResult {\n00043|   company: string;\n00044|   price: number;\n00045|   days: number;\n00046|   details?: any;\n00047|   error?: string;\n00048|   requestData?: any;\n00049|   responseData?: any;\n00050|   apiUrl?: string;\n00051|   sessionId?: string;\n00052| }\n00053| \n00054| interface AddressSuggestion {\n00055|   value: string;\n00056|   unrestricted_value: string;\n00057|   data: {\n00058|     city?: string;\n00059|     street?: string;\n00060|     house?: string;\n00061|   };\n00062| }\n00063| \n00064| const COMPANIES = [\n00065|   { name: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏', logo: 'üì¶', connected: true },\n00066|   { name: '–ü–≠–ö', logo: 'üöõ', connected: true },\n00067|   { name: 'Nord Wheel', logo: 'üåê', connected: true },\n00068|   { name: 'Rail Continent', logo: 'üöÇ', connected: true }\n00069| ];\n00070| \n00071| export default function Home() {\n00072|   const [form, setForm] = useState<DeliveryForm>({\n00073|     cargos: [{ id: '1', length: 0, width: 0, height: 0, weight: 0 }],\n00074|     fromCity: '',\n00075|     toCity: '',\n00076|     fromAddress: '',\n00077|     toAddress: '',\n00078|     declaredValue: 0,\n00079|     needPackaging: false,\n00080|     needLoading: false,\n00081|     needCarry: false,\n00082|     floor: 1,\n00083|     hasFreightLift: false,\n00084|     needInsurance: false,\n00085|     fromTerminal: true,\n00086|     toTerminal: true,\n00087|     fromAddressDelivery: false,\n00088|     toAddressDelivery: false\n00089|   });\n00090| \n00091|   const [suggestions, setSuggestions] = useState<AddressSuggestion[]>([]);\n00092|   const [showSuggestions, setShowSuggestions] = useState(false);\n00093|   const [activeField, setActiveField] = useState('');\n00094|   const [calculations, setCalculations] = useState<CalculationResult[]>([]);\n00095|   const [calculating, setCalculating] = useState(false);\n00096|   const [expandedDetails, setExpandedDetails] = useState<{ [key: string]: boolean }>({});\n00097|   const [expandedDebugInfo, setExpandedDebugInfo] = useState<{ [key: string]: boolean }>({});\n00098|   const [suggestionPosition, setSuggestionPosition] = useState({ top: 0, left: 0 });\n00099| \n00100|   // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ)\n00101|   useEffect(() => {\n00102|     // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ\n00103|     if (typeof window !== 'undefined') {\n00104|       try {\n00105|         const saved = localStorage.getItem('deliveryForm');\n00106|         if (saved) {\n00107|           const savedForm = JSON.parse(saved);\n00108|           // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≥—Ä—É–∑\n00109|           if (!savedForm.cargos || savedForm.cargos.length === 0) {\n00110|             savedForm.cargos = [{ id: '1', length: 0, width: 0, height: 0, weight: 0 }];\n00111|           }\n00112|           setForm(savedForm);\n00113|         }\n00114|       } catch (error) {\n00115|         console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:', error);\n00116|         // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é\n00117|         setForm(prev => ({\n00118|           ...prev,\n00119|           cargos: prev.cargos.length > 0 ? prev.cargos : [{ id: '1', length: 0, width: 0, height: 0, weight: 0 }]\n00120|         }));\n00121|       }\n00122|     }\n00123|   }, []);\n00124| \n00125|   // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ (—Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ)\n00126|   useEffect(() => {\n00127|     if (typeof window !== 'undefined') {\n00128|       try {\n00129|         localStorage.setItem('deliveryForm', JSON.stringify(form));\n00130|       } catch (error) {\n00131|         console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);\n00132|       }\n00133|     }\n00134|   }, [form]);\n00135| \n00136|   // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –ø—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n00137|   useEffect(() => {\n00138|     if (form.declaredValue > 0) {\n00139|       setForm(prev => ({ ...prev, needInsurance: true }));\n00140|     }\n00141|   }, [form.declaredValue]);\n00142| \n00143|   const searchAddresses = useCallback(async (query: string, field: string, element?: HTMLInputElement) => {\n00144|     if (query.length < 3) {\n00145|       setSuggestions([]);\n00146|       setShowSuggestions(false);\n00147|       return;\n00148|     }\n00149| \n00150|     setActiveField(field);\n00151|     \n00152|     // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–æ–∫\n00153|     if (element) {\n00154|       const rect = element.getBoundingClientRect();\n00155|       setSuggestionPosition({\n00156|         top: rect.bottom + window.scrollY,\n00157|         left: rect.left + window.scrollX\n00158|       });\n00159|     }\n00160|     \n00161|     try {\n00162|       const response = await fetch('https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address', {\n00163|         method: 'POST',\n00164|         headers: {\n00165|           'Content-Type': 'application/json',\n00166|           'Accept': 'application/json',\n00167|           'Authorization': 'Token eb87bbb3789bb43ed465f796892ea951f9e91008'\n00168|         },\n00169|         body: JSON.stringify({\n00170|           query: query,\n00171|           count: 10,\n00172|           // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª–µ–π –≥–æ—Ä–æ–¥–æ–≤ - —Ç–æ–ª—å–∫–æ –≥–æ—Ä–æ–¥–∞\n00173|           ...(field === 'fromCity' || field === 'toCity' ? {\n00174|             restrict_value: true,\n00175|             locations: [{\n00176|               country: '–†–æ—Å—Å–∏—è'\n00177|             }],\n00178|             from_bound: { value: 'city' },\n00179|             to_bound: { value: 'city' }\n00180|           } : {})\n00181|         })\n00182|       });\n00183| \n00184|       if (response.ok) {\n00185|         const data = await response.json();\n00186|         setSuggestions(data.suggestions || []);\n00187|         setShowSuggestions(true);\n00188|       }\n00189|     } catch (error) {\n00190|       console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Å–∫–∞–∑–æ–∫:', error);\n00191|     }\n00192|   }, []);\n00193| \n00194|   const debounceTimer = React.useRef<NodeJS.Timeout>();\n00195|   const handleAddressChange = (field: string, value: string, element?: HTMLInputElement) => {\n00196|     setForm(prev => ({ ...prev, [field]: value }));\n00197|     \n00198|     clearTimeout(debounceTimer.current);\n00199|     debounceTimer.current = setTimeout(() => {\n00200|       searchAddresses(value, field, element);\n00201|     }, 50);\n00202|   };\n00203| \n00204|   const selectSuggestion = (suggestion: AddressSuggestion) => {\n00205|     setForm(prev => ({ ...prev, [activeField]: suggestion.value }));\n00206|     setShowSuggestions(false);\n00207|     setSuggestions([]);\n00208|   };\n00209| \n00210|   const addCargo = () => {\n00211|     const newId = (form.cargos.length + 1).toString();\n00212|     setForm(prev => ({\n00213|       ...prev,\n00214|       cargos: [...prev.cargos, { id: newId, length: 0, width: 0, height: 0, weight: 0 }]\n00215|     }));\n00216|   };\n00217| \n00218|   const updateCargo = (id: string, field: string, value: number) => {\n00219|     setForm(prev => ({\n00220|       ...prev,\n00221|       cargos: prev.cargos.map(cargo => \n00222|         cargo.id === id ? { ...cargo, [field]: value } : cargo\n00223|       )\n00224|     }));\n00225|   };\n00226| \n00227|   const removeCargo = (id: string) => {\n00228|     if (form.cargos.length > 1) {\n00229|       setForm(prev => ({\n00230|         ...prev,\n00231|         cargos: prev.cargos.filter(cargo => cargo.id !== id)\n00232|       }));\n00233|     }\n00234|   };\n00235| \n00236|   // –ü–æ–ª—É—á–µ–Ω–∏–µ sessionID –¥–ª—è –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π\n00237|   const getDellinSessionId = async (): Promise<string | null> => {\n00238|     try {\n00239|       const authResponse = await fetch('https://api.dellin.ru/v3/auth/login.json', {\n00240|         method: 'POST',\n00241|         headers: {\n00242|           'Content-Type': 'application/json'\n00243|         },\n00244|         body: JSON.stringify({\n00245|           appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n00246|           login: 'service@lavsit.ru',\n00247|           password: 'edcwsx123QAZ'\n00248|         })\n00249|       });\n00250| \n00251|       const authData = await authResponse.json();\n00252|       console.log('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:', authData);\n00253|       \n00254|       if (authResponse.ok && authData.data?.sessionID) {\n00255|         return authData.data.sessionID;\n00256|       } else {\n00257|         console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏:', authData);\n00258|         return null;\n00259|       }\n00260|     } catch (error) {\n00261|       console.error('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏:', error);\n00262|     }\n00263|     return null;\n00264|   };\n00265| \n00266|   // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –¥–ª—è –≥–æ—Ä–æ–¥–∞\n00267|   const getDellinTerminal = async (citySearch: string): Promise<string | null> => {\n00268|     try {\n00269|       const response = await fetch('https://api.dellin.ru/v3/public/terminals.json', {\n00270|         method: 'POST',\n00271|         headers: {\n00272|           'Content-Type': 'application/json'\n00273|         },\n00274|         body: JSON.stringify({\n00275|           appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B'\n00276|         })\n00277|       });\n00278| \n00279|       const data = await response.json();\n00280|       console.log('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª—ã:', data);\n00281|       \n00282|       if (response.ok && data.terminals) {\n00283|         // –ò—â–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –≥–æ—Ä–æ–¥–µ\n00284|         const normalizedCity = citySearch.toLowerCase().trim();\n00285|         const terminal = data.terminals.find((t: any) => \n00286|           t.city?.toLowerCase().includes(normalizedCity) ||\n00287|           normalizedCity.includes(t.city?.toLowerCase())\n00288|         );\n00289|         \n00290|         return terminal?.id || data.terminals[0]?.id || null;\n00291|       }\n00292|       \n00293|       return null;\n00294|     } catch (error) {\n00295|       console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏:', error);\n00296|       return null;\n00297|     }\n00298|   };\n00299| \n00300|   // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É–ø–∞–∫–æ–≤–æ–∫ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏\n00301|   const getDellinPackages = async (fromPoint: string, toPoint: string, cargo: any): Promise<string | null> => {\n00302|     try {\n00303|       // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –∫–æ–¥—ã –≥–æ—Ä–æ–¥–æ–≤\n00304|       // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –∏—Ö –∏–∑ API –≥–æ—Ä–æ–¥–æ–≤/—Ç–µ—Ä–º–∏–Ω–∞–ª–æ–≤\n00305|       const cityCodeMap: { [key: string]: string } = {\n00306|         '–º–æ—Å–∫–≤–∞': '7700000000000000000000000',\n00307|         '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': '7800000000000000000000000',\n00308|         '—Å–ø–±': '7800000000000000000000000',\n00309|         '–ø–µ—Ç–µ—Ä–±—É—Ä–≥': '7800000000000000000000000',\n00310|         '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '6600000000000000000000000',\n00311|         '–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫': '5400000000000000000000000',\n00312|         '–Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥': '5200000000000000000000000',\n00313|         '—Å–∞–º–∞—Ä–∞': '6300000000000000000000000',\n00314|         '–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä': '2300000000000000000000000',\n00315|         '—Ä–æ—Å—Ç–æ–≤-–Ω–∞-–¥–æ–Ω—É': '6100000000000000000000000',\n00316|         '–∫–∞–∑–∞–Ω—å': '1600000000000000000000000'\n00317|       };\n00318| \n00319|       const fromCode = cityCodeMap[fromPoint.toLowerCase().trim()] || fromPoint;\n00320|       const toCode = cityCodeMap[toPoint.toLowerCase().trim()] || toPoint;\n00321| \n00322|       const requestBody = {\n00323|         appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n00324|         arrivalPoint: toCode,\n00325|         derivalPoint: fromCode,\n00326|         length: cargo.length / 100, // –≤ –º–µ—Ç—Ä–∞—Ö\n00327|         width: cargo.width / 100,\n00328|         height: cargo.height / 100,\n00329|         weight: cargo.weight,\n00330|         quantity: 1\n00331|       };\n00332| \n00333|       console.log('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å —É–ø–∞–∫–æ–≤–æ–∫:', requestBody);\n00334| \n00335|       const response = await fetch('https://api.dellin.ru/v1/public/packages_available.json', {\n00336|         method: 'POST',\n00337|         headers: {\n00338|           'Content-Type': 'application/json'\n00339|         },\n00340|         body: JSON.stringify(requestBody)\n00341|       });\n00342| \n00343|       const data = await response.json();\n00344|       console.log('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —É–ø–∞–∫–æ–≤–∫–∏:', data);\n00345|       \n00346|       if (response.ok && data.packages && data.packages.length > 0) {\n00347|         // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–∞–∫–µ—Ç –±–µ–∑ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–µ–π\n00348|         const compatiblePackage = data.packages.find((pkg: any) => \n00349|           !pkg.incompatible_uids || pkg.incompatible_uids.length === 0\n00350|         );\n00351|         return compatiblePackage?.uid || data.packages[0].uid;\n00352|       }\n00353|       \n00354|       return null;\n00355|     } catch (error) {\n00356|       console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —É–ø–∞–∫–æ–≤–æ–∫ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏:', error);\n00357|       return null;\n00358|     }\n00359|   };\n00360| \n00361|   // –†–∞—Å—á–µ—Ç –¥–ª—è –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π —á–µ—Ä–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π API v2/calculator.json\n00362|   const calculateDellin = async (): Promise<CalculationResult> => {\n00363|     const apiUrl = 'https://api.dellin.ru/v2/calculator.json';\n00364|     \n00365|     try {\n00366|       const sessionID = await getDellinSessionId();\n00367|       \n00368|       if (!sessionID) {\n00369|         return {\n00370|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00371|           price: 0,\n00372|           days: 0,\n00373|           error: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å sessionID',\n00374|           apiUrl,\n00375|           requestData: null,\n00376|           responseData: null\n00377|         };\n00378|       }\n00379| \n00380|       // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –∏ –æ–±—ä–µ–º—ã\n00381|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00382|       const totalVolume = form.cargos.reduce((sum, cargo) => \n00383|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n00384|       );\n00385|       const maxLength = Math.max(...form.cargos.map(c => c.length)) / 100; // –≤ –º–µ—Ç—Ä–∞—Ö\n00386|       const maxWidth = Math.max(...form.cargos.map(c => c.width)) / 100;\n00387|       const maxHeight = Math.max(...form.cargos.map(c => c.height)) / 100;\n00388| \n00389|       // –ü–æ–ª—É—á–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—ã –¥–ª—è –≥–æ—Ä–æ–¥–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)\n00390|       const fromTerminalId = !form.fromAddressDelivery ? await getDellinTerminal(form.fromCity) : null;\n00391|       const toTerminalId = !form.toAddressDelivery ? await getDellinTerminal(form.toCity) : null;\n00392| \n00393|       // –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —É–ø–∞–∫–æ–≤–∫–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —É–ø–∞–∫–æ–≤–∫–∞)\n00394|       let packageUid: string | null = null;\n00395|       if (form.needPackaging && form.cargos.length > 0) {\n00396|         // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∞–º–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –≥—Ä—É–∑–∞\n00397|         const biggestCargo = form.cargos.reduce((max, cargo) => \n00398|           cargo.weight > max.weight ? cargo : max\n00399|         );\n00400|         \n00401|         packageUid = await getDellinPackages(form.fromCity, form.toCity, biggestCargo);\n00402|         console.log('–ü–æ–ª—É—á–µ–Ω packageUid:', packageUid);\n00403|       }\n00404| \n00405|       // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –∑–∞–≤—Ç—Ä–∞\n00406|       const tomorrow = new Date();\n00407|       tomorrow.setDate(tomorrow.getDate() + 1);\n00408|       const produceDate = tomorrow.toISOString().split('T')[0];\n00409| \n00410|       // –§–æ—Ä–º–∏—Ä—É–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏\n00411|       const requestData = {\n00412|         appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n00413|         sessionID: sessionID,\n00414|         delivery: {\n00415|           deliveryType: {\n00416|             type: 'auto'  // –í—Å–µ–≥–¥–∞ \"auto\" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n00417|           },\n00418|           derival: {\n00419|             produceDate: produceDate,  // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –¥–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\n00420|             variant: form.fromAddressDelivery ? 'address' : 'terminal',\n00421|             ...(form.fromAddressDelivery ? {\n00422|               address: {\n00423|                 search: form.fromAddress || form.fromCity\n00424|               }\n00425|             } : {\n00426|               terminalID: fromTerminalId\n00427|             }),\n00428|             time: {\n00429|               worktimeStart: '10:00',\n00430|               worktimeEnd: '18:00',\n00431|               breakStart: '13:00',\n00432|               breakEnd: '14:00',\n00433|               exactTime: false\n00434|             }\n00435|             // handling –≤ derival –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏\n00436|           },\n00437|           arrival: {\n00438|             variant: form.toAddressDelivery ? 'address' : 'terminal',\n00439|             ...(form.toAddressDelivery ? {\n00440|               address: {\n00441|                 search: form.toAddress || form.toCity\n00442|               }\n00443|             } : {\n00444|               terminalID: toTerminalId\n00445|             }),\n00446|             time: {\n00447|               worktimeStart: '10:00',\n00448|               worktimeEnd: '18:00',\n00449|               breakStart: '13:00',\n00450|               breakEnd: '14:00',\n00451|               exactTime: false\n00452|             },\n00453|             // handling –≤ arrival –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—ä–µ–º\n00454|             ...(form.needCarry ? {\n00455|               handling: {\n00456|                 freightLift: form.hasFreightLift, // true —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –≥–∞–ª–æ—á–∫–∞ \"–Ω–∞–ª–∏—á–∏–µ –≥—Ä—É–∑–æ–≤–æ–≥–æ –ª–∏—Ñ—Ç–∞\"\n00457|                 toFloor: form.floor, // —ç—Ç–∞–∂ –∏–∑ —Ñ–æ—Ä–º—ã\n00458|                 carry: 0\n00459|               }\n00460|             } : {})\n00461|           },\n00462|           ...(form.needPackaging && packageUid ? {\n00463|             packages: [{\n00464|               uid: packageUid,  // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π uid —É–ø–∞–∫–æ–≤–∫–∏ –∏–∑ API\n00465|               count: 1\n00466|             }]\n00467|           } : {})\n00468|         },\n00469|         cargo: {\n00470|           quantity: form.cargos.length,\n00471|           length: maxLength,\n00472|           width: maxWidth,\n00473|           height: maxHeight,\n00474|           weight: totalWeight,\n00475|           totalVolume: totalVolume,\n00476|           totalWeight: totalWeight,\n00477|           oversizedWeight: 0,\n00478|           oversizedVolume: 0,\n00479|           hazardClass: 0,  // –í—Å–µ–≥–¥–∞ 0 –µ—Å–ª–∏ –Ω–µ—Ç –æ–ø–∞—Å–Ω—ã—Ö –≥—Ä—É–∑–æ–≤\n00480|           ...(form.needInsurance && form.declaredValue > 0 ? {\n00481|             insurance: {\n00482|               statedValue: form.declaredValue,\n00483|               term: true  // –í—Å–µ–≥–¥–∞ true –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è\n00484|             }\n00485|           } : {})\n00486|         },\n00487|         payment: {\n00488|           type: 'noncash',  // –í—Å–µ–≥–¥–∞ \"noncash\"\n00489|           paymentCitySearch: {\n00490|             search: form.fromCity  // –ì–æ—Ä–æ–¥ –æ–ø–ª–∞—Ç—ã\n00491|           }\n00492|         }\n00493|       };\n00494| \n00495|       console.log('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n00496| \n00497|       const response = await fetch(apiUrl, {\n00498|         method: 'POST',\n00499|         headers: {\n00500|           'Content-Type': 'application/json',\n00501|           'Accept': 'application/json'\n00502|         },\n00503|         body: JSON.stringify(requestData)\n00504|       });\n00505| \n00506|       const data = await response.json();\n00507|       console.log('–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏ –æ—Ç–≤–µ—Ç:', data);\n00508| \n00509|       if (response.ok && data.data && data.metadata?.status === 200) {\n00510|         let totalPrice = data.data.price || 0;\n00511|         \n00512|         // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å\n00513|         if (data.data.insurance) {\n00514|           totalPrice += data.data.insurance;\n00515|         }\n00516|         \n00517|         // –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏ —É–ø–∞–∫–æ–≤–∫–∏ –µ—Å–ª–∏ –µ—Å—Ç—å\n00518|         if (data.data.packages && form.needPackaging) {\n00519|           Object.values(data.data.packages).forEach((pkg: any) => {\n00520|             if (pkg.price) totalPrice += pkg.price;\n00521|           });\n00522|         }\n00523| \n00524|         return {\n00525|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00526|           price: Math.round(totalPrice),\n00527|           days: data.data.deliveryTerm || 0,\n00528|           details: data.data,\n00529|           requestData,\n00530|           responseData: data,\n00531|           apiUrl,\n00532|           sessionId: sessionID\n00533|         };\n00534|       } else {\n00535|         const errorMessage = data.metadata?.detail || \n00536|                            data.metadata?.message || \n00537|                            data.errors?.[0]?.detail || \n00538|                            (data.metadata?.status !== 200 ? `HTTP ${data.metadata?.status}` : '') ||\n00539|                            '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏';\n00540|         return {\n00541|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00542|           price: 0,\n00543|           days: 0,\n00544|           error: errorMessage,\n00545|           requestData,\n00546|           responseData: data,\n00547|           apiUrl,\n00548|           sessionId: sessionID\n00549|         };\n00550|       }\n00551|     } catch (error: any) {\n00552|       return {\n00553|         company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00554|         price: 0,\n00555|         days: 0,\n00556|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n00557|         requestData: null,\n00558|         responseData: null,\n00559|         apiUrl\n00560|       };\n00561|     }\n00562|   };\n00563| \n00564|   // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n00565|   const calculateNordWheel = async (): Promise<CalculationResult> => {\n00566|     const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n00567|     \n00568|     try {\n00569|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00570|       const totalVolume = form.cargos.reduce((sum, cargo) => \n00571|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n00572|       );\n00573| \n00574|       const params = new URLSearchParams({\n00575|         from: '91', // –ú–æ—Å–∫–≤–∞ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n00576|         to: '92', // –°–ü–± (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n00577|         pickup: form.fromAddressDelivery ? '1' : '0',\n00578|         deliver: form.toAddressDelivery ? '1' : '0',\n00579|         weight: totalWeight.toString(),\n00580|         volume: totalVolume.toString(),\n00581|         oversized: '0',\n00582|         package: form.needPackaging ? '1' : '0',\n00583|         packageCount: form.cargos.length.toString(),\n00584|         insurance: form.needInsurance ? '1' : '0',\n00585|         sum: form.declaredValue.toString(),\n00586|         documentsReturn: '0',\n00587|         fragile: '1'\n00588|       });\n00589| \n00590|       const requestData = Object.fromEntries(params);\n00591|       const fullUrl = `${apiUrl}?${params.toString()}`;\n00592| \n00593|       const response = await fetch(fullUrl);\n00594|       const data = await response.json();\n00595| \n00596|       if (response.ok && data.status === 'success' && data.data) {\n00597|         return {\n00598|           company: 'Nord Wheel',\n00599|           price: data.data.total || 0,\n00600|           days: data.data.days || 0,\n00601|           details: {\n00602|             ...data.data,\n00603|             totalCost: data.data.total,\n00604|             deliveryCost: data.data.door,\n00605|             terminalCost: data.data.terminal,\n00606|             pickupCost: data.data.pick,\n00607|             deliveryToDoorCost: data.data.deliver,\n00608|             additionalServices: (data.data.total || 0) - (data.data.door || 0)\n00609|           },\n00610|           requestData,\n00611|           responseData: data,\n00612|           apiUrl: fullUrl\n00613|         };\n00614|       } else {\n00615|         return {\n00616|           company: 'Nord Wheel',\n00617|           price: 0,\n00618|           days: 0,\n00619|           error: '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ Nord Wheel',\n00620|           requestData,\n00621|           responseData: data,\n00622|           apiUrl: fullUrl\n00623|         };\n00624|       }\n00625|     } catch (error: any) {\n00626|       return {\n00627|         company: 'Nord Wheel',\n00628|         price: 0,\n00629|         days: 0,\n00630|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n00631|         apiUrl\n00632|       };\n00633|     }\n00634|   };\n00635| \n00636|   // –ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ—Ä–æ–¥–æ–≤ –ü–≠–ö —Å –ø—É–±–ª–∏—á–Ω–æ–≥–æ API\n00637|   const loadPekCities = async (): Promise<{ [key: string]: string }> => {\n00638|     try {\n00639|       const response = await fetch('https://pecom.ru/ru/calc/towns.php');\n00640|       const data = await response.json();\n00641|       \n00642|       const cities: { [key: string]: string } = {};\n00643|       \n00644|       // –ü–∞—Ä—Å–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É: {'—Ä–µ–≥–∏–æ–Ω1': {id1: '–ì–æ—Ä–æ–¥1', id2: '–ì–æ—Ä–æ–¥2'}, ...}\n00645|       Object.values(data).forEach((region: any) => {\n00646|         if (typeof region === 'object') {\n00647|           Object.entries(region).forEach(([cityId, cityName]) => {\n00648|             if (typeof cityName === 'string') {\n00649|               const normalizedName = cityName.toLowerCase()\n00650|                 .replace(/—ë/g, '–µ')\n00651|                 .replace(/[\\s\\-\\.–≥\\.]+/g, '')\n00652|                 .replace(/–æ–±–ª–∞—Å—Ç—å|–æ–±–ª|–∫—Ä–∞–π|—Ä–µ—Å–ø—É–±–ª–∏–∫–∞|—Ä–µ—Å–ø|–∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥|–∞–æ/g, '');\n00653|               cities[normalizedName] = cityId;\n00654|             }\n00655|           });\n00656|         }\n00657|       });\n00658|       \n00659|       return cities;\n00660|     } catch (error) {\n00661|       console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ—Ä–æ–¥–∞ –ü–≠–ö —Å API, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É:', error);\n00662|       \n00663|       // –§–æ–ª–ª–±—ç–∫ - –ª–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –≥–æ—Ä–æ–¥–æ–≤ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ ID\n00664|       return {\n00665|         '–º–æ—Å–∫–≤–∞': '-457',\n00666|         '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': '64883', \n00667|         '—Å–ø–±': '64883',\n00668|         '–ø–µ—Ç–µ—Ä–±—É—Ä–≥': '64883',\n00669|         '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '65479',\n00670|         '–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫': '65951',\n00671|         '–Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥': '65806',\n00672|         '—Å–∞–º–∞—Ä–∞': '66358',\n00673|         '–æ–º—Å–∫': '66044',\n00674|         '–∫–∞–∑–∞–Ω—å': '65652',\n00675|         '—Ä–æ—Å—Ç–æ–≤-–Ω–∞-–¥–æ–Ω—É': '66302',\n00676|         '—Ä–æ—Å—Ç–æ–≤': '66302',\n00677|         '—á–µ–ª—è–±–∏–Ω—Å–∫': '66821',\n00678|         '—É—Ñ–∞': '66695',\n00679|         '–≤–æ–ª–≥–æ–≥—Ä–∞–¥': '65341',\n00680|         '–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä': '65704',\n00681|         '–≤–æ—Ä–æ–Ω–µ–∂': '65369',\n00682|         '–ø–µ—Ä–º—å': '66159',\n00683|         '—Å–∞—Ä–∞—Ç–æ–≤': '66372',\n00684|         '—Ç–æ–ª—å—è—Ç—Ç–∏': '66601',\n00685|         '–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫': '65724',\n00686|         '–∏–∂–µ–≤—Å–∫': '65613',\n00687|         '–±–∞—Ä–Ω–∞—É–ª': '65169',\n00688|         '—É–ª—å—è–Ω–æ–≤—Å–∫': '66661',\n00689|         '–∏—Ä–∫—É—Ç—Å–∫': '65625',\n00690|         '—Ö–∞–±–∞—Ä–æ–≤—Å–∫': '66756',\n00691|         '–≤–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫': '65313',\n00692|         '—è—Ä–æ—Å–ª–∞–≤–ª—å': '66937',\n00693|         '—Ç—é–º–µ–Ω—å': '66651',\n00694|         '–∫–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥': '65640',\n00695|         '–∫–æ—Å—Ç—Ä–æ–º–∞': '65697'\n00696|       };\n00697|     }\n00698|   };\n00699| \n00700|   // –ü–æ–ª—É—á–µ–Ω–∏–µ ID –≥–æ—Ä–æ–¥–∞ –ü–≠–ö\n00701|   const findPekCityId = async (cityName: string): Promise<string | null> => {\n00702|     try {\n00703|       const pekCities = await loadPekCities();\n00704|       \n00705|       const normalizedSearchCity = cityName.toLowerCase().trim()\n00706|         .replace(/—ë/g, '–µ')\n00707|         .replace(/[\\s\\-\\.–≥\\.]+/g, '')\n00708|         .replace(/–æ–±–ª–∞—Å—Ç—å|–æ–±–ª|–∫—Ä–∞–π|—Ä–µ—Å–ø—É–±–ª–∏–∫–∞|—Ä–µ—Å–ø|–∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥|–∞–æ/g, '');\n00709| \n00710|       console.log(`–ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞ –ü–≠–ö: \"${cityName}\" -> \"${normalizedSearchCity}\"`);\n00711| \n00712|       // –ü—Ä—è–º–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ\n00713|       if (pekCities[normalizedSearchCity]) {\n00714|         console.log(`–ù–∞–π–¥–µ–Ω –ø—Ä—è–º–æ–π ID –¥–ª—è \"${normalizedSearchCity}\": ${pekCities[normalizedSearchCity]}`);\n00715|         return pekCities[normalizedSearchCity];\n00716|       }\n00717| \n00718|       // –ü–æ–∏—Å–∫ –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é\n00719|       for (const [cityKey, cityId] of Object.entries(pekCities)) {\n00720|         if (normalizedSearchCity.includes(cityKey) || \n00721|             cityKey.includes(normalizedSearchCity)) {\n00722|           console.log(`–ù–∞–π–¥–µ–Ω —á–∞—Å—Ç–∏—á–Ω—ã–π ID –¥–ª—è \"${normalizedSearchCity}\" —á–µ—Ä–µ–∑ \"${cityKey}\": ${cityId}`);\n00723|           return cityId;\n00724|         }\n00725|       }\n00726| \n00727|       console.log(`–ì–æ—Ä–æ–¥ –ü–≠–ö \"${cityName}\" –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ`);\n00728|       return null;\n00729|     } catch (error) {\n00730|       console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –≥–æ—Ä–æ–¥–∞ –ü–≠–ö:', error);\n00731|       return null;\n00732|     }\n00733|   };\n00734| \n00735|   // –ü–æ–ª—É—á–µ–Ω–∏–µ ID —Å–∫–ª–∞–¥–∞ –ü–≠–ö –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ API\n00736|   const findPekWarehouseId = async (address: string): Promise<string | null> => {\n00737|     try {\n00738|       // –ò—Å–ø–æ–ª—å–∑—É–µ–º API –ü–≠–ö –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ø–æ –∞–¥—Ä–µ—Å—É\n00739|       const response = await fetch('https://api.pecom.ru/v1/branches/findzonebyaddress', {\n00740|         method: 'POST',\n00741|         headers: {\n00742|           'Content-Type': 'application/json',\n00743|           'Authorization': 'Basic ' + btoa('C04C5BF2AE367BDCBDC71E7DA520A69B167D1984:')\n00744|         },\n00745|         body: JSON.stringify({\n00746|           address: address\n00747|         })\n00748|       });\n00749| \n00750|       if (response.ok) {\n00751|         const data = await response.json();\n00752|         return data.mainWarehouseId || null;\n00753|       }\n00754|       \n00755|       // –§–æ–ª–ª–±—ç–∫ –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤\n00756|       const fallbackWarehouses: { [key: string]: string } = {\n00757|         '–º–æ—Å–∫–≤–∞': 'dc6c746d-812d-11e4-bbfc-001999d8b3c5',\n00758|         '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': 'b436c978-086d-11e6-b6ca-00155d668909',\n00759|         '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': '550e8400-e29b-41d4-a716-446655440000'\n00760|       };\n00761|       \n00762|       const normalizedCity = address.toLowerCase().trim()\n00763|         .replace(/—ë/g, '–µ')\n00764|         .replace(/[\\s\\-\\.]+/g, '');\n00765|       \n00766|       for (const [city, warehouseId] of Object.entries(fallbackWarehouses)) {\n00767|         const normalizedCityKey = city.replace(/[\\s\\-\\.]+/g, '');\n00768|         if (normalizedCity.includes(normalizedCityKey) || normalizedCityKey.includes(normalizedCity)) {\n00769|           return warehouseId;\n00770|         }\n00771|       }\n00772|       \n00773|       return null;\n00774|     } catch (error) {\n00775|       console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞ –ü–≠–ö:', error);\n00776|       return null;\n00777|     }\n00778|   };\n00779| \n00780|   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API\n00781|   const calculatePEK = async (): Promise<CalculationResult> => {\n00782|     const apiUrl = 'http://calc.pecom.ru/bitrix/components/pecom/calc/ajax.php';\n00783|     \n00784|     try {\n00785|       // –ü–æ–ª—É—á–∞–µ–º ID –≥–æ—Ä–æ–¥–æ–≤\n00786|       const fromCityId = await findPekCityId(form.fromCity);\n00787|       const toCityId = await findPekCityId(form.toCity);\n00788|       \n00789|       if (!fromCityId || !toCityId) {\n00790|         return {\n00791|           company: '–ü–≠–ö',\n00792|           price: 0,\n00793|           days: 0,\n00794|           error: `–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –ü–≠–ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: ${!fromCityId ? form.fromCity : ''} ${!toCityId ? form.toCity : ''}`.trim(),\n00795|           apiUrl,\n00796|           requestData: { fromCity: form.fromCity, toCity: form.toCity, fromCityId, toCityId },\n00797|           responseData: null\n00798|         };\n00799|       }\n00800| \n00801|       // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –ø—É–±–ª–∏—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n00802|       const params = new URLSearchParams();\n00803|       \n00804|       // –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä—É–∑—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Ñ–æ—Ä–º–∞—Ç—É: –®–∏—Ä–∏–Ω–∞ (–º), –î–ª–∏–Ω–∞ (–º), –í—ã—Å–æ—Ç–∞ (–º), –û–±—ä–µ–º (–º3), –í–µ—Å (–∫–≥), –ù–µ–≥–∞–±–∞—Ä–∏—Ç (0/1), –ó–¢–£ (0/1)\n00805|       form.cargos.forEach((cargo, index) => {\n00806|         const width = cargo.width / 100; // –ø–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–µ—Ç—Ä—ã\n00807|         const length = cargo.length / 100;\n00808|         const height = cargo.height / 100;\n00809|         const volume = width * length * height;\n00810|         const weight = cargo.weight;\n00811|         const isOversized = (width > 2.4 || length > 12 || height > 2.7 || weight > 1500) ? 1 : 0;\n00812|         const needZTU = form.needPackaging ? 1 : 0;\n00813|         \n00814|         params.append(`places[${index}][]`, width.toString());\n00815|         params.append(`places[${index}][]`, length.toString());\n00816|         params.append(`places[${index}][]`, height.toString());\n00817|         params.append(`places[${index}][]`, volume.toString());\n00818|         params.append(`places[${index}][]`, weight.toString());\n00819|         params.append(`places[${index}][]`, isOversized.toString());\n00820|         params.append(`places[${index}][]`, needZTU.toString());\n00821|       });\n00822|       \n00823|       // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–±–æ—Ä–∞\n00824|       params.append('take[town]', fromCityId.toString());\n00825|       params.append('take[tent]', '0'); // —Ä–∞—Å—Ç–µ–Ω—Ç—Ä–æ–≤–∫–∞\n00826|       params.append('take[gidro]', form.needLoading ? '1' : '0'); // –≥–∏–¥—Ä–æ–ª–∏—Ñ—Ç\n00827|       params.append('take[manip]', '0'); // –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä\n00828|       params.append('take[speed]', '0'); // —Å—Ä–æ—á–Ω—ã–π –∑–∞–±–æ—Ä\n00829|       params.append('take[moscow]', '0'); // –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –ú–æ—Å–∫–≤–µ\n00830|       \n00831|       // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ—Å—Ç–∞–≤–∫–∏\n00832|       params.append('deliver[town]', toCityId.toString());\n00833|       params.append('deliver[tent]', '0');\n00834|       params.append('deliver[gidro]', form.needLoading ? '1' : '0');\n00835|       params.append('deliver[manip]', '0');\n00836|       params.append('deliver[speed]', '0');\n00837|       params.append('deliver[moscow]', '0');\n00838|       \n00839|       // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n00840|       params.append('plombir', '0'); // –ø–ª–æ–º–±—ã\n00841|       params.append('strah', form.needInsurance ? form.declaredValue.toString() : '0'); // —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞\n00842|       params.append('ashan', '0'); // –¥–æ—Å—Ç–∞–≤–∫–∞ –≤ –ê—à–∞–Ω\n00843|       params.append('night', '0'); // –Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è\n00844|       params.append('pal', '0'); // –∑–∞–ø–∞–ª–ª–µ—á–∏–≤–∞–Ω–∏–µ\n00845|       params.append('pallets', '0'); // –ø–∞–ª–ª–µ—Ç–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞\n00846| \n00847|       const fullUrl = `${apiUrl}?${params.toString()}`;\n00848|       const requestData = Object.fromEntries(params);\n00849| \n00850|       console.log('–ü–≠–ö –∑–∞–ø—Ä–æ—Å URL:', fullUrl);\n00851|       console.log('–ü–≠–ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', requestData);\n00852| \n00853|       // –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ API (–±–µ–∑ –ø—Ä–æ–∫—Å–∏, —Ç–∞–∫ –∫–∞–∫ HTTPS —Å–∞–π—Ç –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å HTTP –∑–∞–ø—Ä–æ—Å—ã)\n00854|       const response = await fetch(fullUrl);\n00855|       const data = await response.json();\n00856|       \n00857|       console.log('–ü–≠–ö –æ—Ç–≤–µ—Ç:', data);\n00858| \n00859|       if (response.ok && data.success) {\n00860|         let totalPrice = 0;\n00861|         let services: { name: string; description: string; price: number }[] = [];\n00862|         \n00863|         // –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏\n00864|         if (data.data?.totalCost) {\n00865|           totalPrice = data.data.totalCost;\n00866|           \n00867|           // –†–∞–∑–±–∏–≤–∫–∞ –ø–æ —É—Å–ª—É–≥–∞–º –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞\n00868|           if (data.data.services) {\n00869|             data.data.services.forEach((service: any) => {\n00870|               services.push({\n00871|                 name: service.name || '–£—Å–ª—É–≥–∞ –ü–≠–ö',\n00872|                 description: service.description || '',\n00873|                 price: service.cost || 0\n00874|               });\n00875|             });\n00876|           } else {\n00877|             // –û—Å–Ω–æ–≤–Ω–∞—è —É—Å–ª—É–≥–∞\n00878|             services.push({\n00879|               name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n00880|               description: `${form.fromCity} - ${form.toCity}`,\n00881|               price: totalPrice\n00882|             });\n00883|           }\n00884|         }\n00885|         \n00886|         // –ó–∞–±–æ—Ä –≥—Ä—É–∑–∞\n00887|         if (data.data?.pickupCost && form.fromAddressDelivery) {\n00888|           services.push({\n00889|             name: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n00890|             description: '–û—Ç –∞–¥—Ä–µ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è',\n00891|             price: data.data.pickupCost\n00892|           });\n00893|         }\n00894|         \n00895|         // –î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ –∞–¥—Ä–µ—Å–∞\n00896|         if (data.data?.deliveryCost && form.toAddressDelivery) {\n00897|           services.push({\n00898|             name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n00899|             description: '–î–æ –∞–¥—Ä–µ—Å–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è',\n00900|             price: data.data.deliveryCost\n00901|           });\n00902|         }\n00903| \n00904|         // –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏\n00905|         const deliveryDays = data.data?.deliveryDays || 3;\n00906| \n00907|         return {\n00908|           company: '–ü–≠–ö',\n00909|           price: Math.round(totalPrice),\n00910|           days: deliveryDays,\n00911|           details: {\n00912|             services,\n00913|             totalCost: data.data?.totalCost,\n00914|             pickupCost: data.data?.pickupCost,\n00915|             deliveryCost: data.data?.deliveryCost,\n00916|             deliveryDays: data.data?.deliveryDays,\n00917|             fromCityId,\n00918|             toCityId,\n00919|             rawData: data.data\n00920|           },\n00921|           requestData,\n00922|           responseData: data,\n00923|           apiUrl\n00924|         };\n00925|       } else {\n00926|         // –§–æ–ª–ª–±—ç–∫ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–∞–≥–ª—É—à–∫—É –µ—Å–ª–∏ API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç\n00927|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00928|         let basePrice = totalWeight * 15; // 15 —Ä—É–± –∑–∞ –∫–≥ –±–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞\n00929|         \n00930|         if (form.fromAddressDelivery) basePrice += 500; // –∑–∞–±–æ—Ä\n00931|         if (form.toAddressDelivery) basePrice += 500; // –¥–æ—Å—Ç–∞–≤–∫–∞\n00932|         if (form.needInsurance) basePrice += form.declaredValue * 0.01; // —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞\n00933|         if (form.needPackaging) basePrice += totalWeight * 20; // —É–ø–∞–∫–æ–≤–∫–∞\n00934|         \n00935|         return {\n00936|           company: '–ü–≠–ö',\n00937|           price: Math.round(basePrice),\n00938|           days: 3,\n00939|           details: {\n00940|             note: '–†–∞—Å—á–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º (API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)',\n00941|             fromCityId,\n00942|             toCityId,\n00943|             services: [\n00944|               { name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞', description: `${form.fromCity} - ${form.toCity}`, price: basePrice }\n00945|             ]\n00946|           },\n00947|           requestData,\n00948|           responseData: data,\n00949|           apiUrl,\n00950|           error: data.message || data.error || 'API –ü–≠–ö –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç'\n00951|         };\n00952|       }\n00953|     } catch (error: any) {\n00954|       // –§–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è\n00955|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00956|       let basePrice = totalWeight * 15; // 15 —Ä—É–± –∑–∞ –∫–≥\n00957|       \n00958|       if (form.fromAddressDelivery) basePrice += 500;\n00959|       if (form.toAddressDelivery) basePrice += 500; \n00960|       if (form.needInsurance) basePrice += form.declaredValue * 0.01;\n00961|       if (form.needPackaging) basePrice += totalWeight * 20;\n00962|       \n00963|       return {\n00964|         company: '–ü–≠–ö',\n00965|         price: Math.round(basePrice),\n00966|         days: 3,\n00967|         details: {\n00968|           note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º (–æ—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å API)',\n00969|           services: [\n00970|             { name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞', description: `${form.fromCity} - ${form.toCity}`, price: basePrice }\n00971|           ]\n00972|         },\n00973|         requestData: null,\n00974|         responseData: null,\n00975|         apiUrl,\n00976|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç.`\n00977|       };\n00978|     }\n00979|   };\n00980| \n00981|   const calculateRailContinent = async (): Promise<CalculationResult> => {\n00982|     await new Promise(resolve => setTimeout(resolve, 1200));\n00983|     const basePrice = form.cargos.reduce((sum, cargo) => sum + cargo.weight * 12, 0);\n00984|     let totalPrice = basePrice;\n00985|     \n00986|     if (form.needInsurance) totalPrice += form.declaredValue * 0.025;\n00987|     if (form.needPackaging) totalPrice += basePrice * 0.08;\n00988|     \n00989|     return {\n00990|       company: 'Rail Continent',\n00991|       price: totalPrice,\n00992|       days: 5,\n00993|       apiUrl: 'https://www.railcontinent.ru/services/prochie-gruzoperevozki/forshop/api-manual/',\n00994|       details: { note: '–ó–∞–≥–ª—É—à–∫–∞ - API –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω' }\n00995|     };\n00996|   };\n00997| \n00998|   const handleCalculate = async () => {\n00999|     setCalculating(true);\n01000|     setCalculations([]);\n01001|     \n01002|     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞\n01003|     localStorage.setItem('deliveryForm', JSON.stringify(form));\n01004|     \n01005|     try {\n01006|       const results = await Promise.all([\n01007|         calculateDellin(),\n01008|         calculatePEK(),\n01009|         calculateNordWheel(),\n01010|         calculateRailContinent()\n01011|       ]);\n01012|       \n01013|       // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–µ–Ω–µ\n01014|       const sortedResults = results\n01015|         .filter(result => !result.error)\n01016|         .sort((a, b) => a.price - b.price)\n01017|         .concat(results.filter(result => result.error));\n01018|       \n01019|       setCalculations(sortedResults);\n01020|     } catch (error) {\n01021|       console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ:', error);\n01022|     } finally {\n01023|       setCalculating(false);\n01024|     }\n01025|   };\n01026| \n01027|   const exportToPDF = () => {\n01028|     if (typeof window !== 'undefined') {\n01029|       window.print();\n01030|     }\n01031|   };\n01032| \n01033|   const toggleDetails = (company: string) => {\n01034|     setExpandedDetails(prev => ({\n01035|       ...prev,\n01036|       [company]: !prev[company]\n01037|     }));\n01038|   };\n01039| \n01040|   const toggleDebugInfo = (company: string) => {\n01041|     setExpandedDebugInfo(prev => ({\n01042|       ...prev,\n01043|       [company]: !prev[company]\n01044|     }));\n01045|   };\n01046| \n01047|   // –ü–∞—Ä—Å–µ—Ä –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è —á–∏—Ç–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞\n01048|   const parseCalculationDetails = (calc: CalculationResult) => {\n01049|     const details: { service: string; description: string; price: number }[] = [];\n01050|     \n01051|     if (calc.company === '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏' && calc.details) {\n01052|       // –û—Å–Ω–æ–≤–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞\n01053|       if (calc.details.availableDeliveryTypes?.auto) {\n01054|         details.push({\n01055|           service: '–ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞',\n01056|           description: `${form.fromCity} - ${form.toCity}`,\n01057|           price: calc.details.availableDeliveryTypes.auto\n01058|         });\n01059|       }\n01060|       \n01061|       // –ó–∞–±–æ—Ä –≥—Ä—É–∑–∞\n01062|       if (!form.fromTerminal && calc.details.derival?.price) {\n01063|         details.push({\n01064|           service: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n01065|           description: '–û—Ç –∞–¥—Ä–µ—Å–∞',\n01066|           price: calc.details.derival.price\n01067|         });\n01068|       }\n01069|       \n01070|       // –î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞\n01071|       if (!form.toTerminal && calc.details.arrival?.price) {\n01072|         details.push({\n01073|           service: '–û—Ç–≤–æ–∑ –≥—Ä—É–∑–∞',\n01074|           description: '–î–æ –∞–¥—Ä–µ—Å–∞',\n01075|           price: calc.details.arrival.price\n01076|         });\n01077|       }\n01078|       \n01079|       // –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ - —Ç–æ–ª—å–∫–æ –∏–∑ API\n01080|       if (form.needInsurance && calc.details.insurance) {\n01081|         details.push({\n01082|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n01083|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n01084|           price: calc.details.insurance // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏–∑ API\n01085|         });\n01086|       }\n01087|       \n01088|       // –£–ø–∞–∫–æ–≤–∫–∞\n01089|       if (form.needPackaging) {\n01090|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n01091|         details.push({\n01092|           service: '–£—Å–ª—É–≥–∏ –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ',\n01093|           description: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n01094|           price: Math.round(totalWeight * 50)\n01095|         });\n01096|       }\n01097|       \n01098|       // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n01099|       details.push({\n01100|         service: '–î–æ–ø.—É—Å–ª—É–≥–∏',\n01101|         description: '–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –≥—Ä—É–∑–∞',\n01102|         price: 15\n01103|       });\n01104|     } else if (calc.company === 'Nord Wheel' && calc.details) {\n01105|       // –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –¥–ª—è Nord Wheel —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º\n01106|       if (calc.details.totalCost) {\n01107|         details.push({\n01108|           service: '–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏',\n01109|           description: '',\n01110|           price: calc.details.totalCost\n01111|         });\n01112|       }\n01113|       if (calc.details.deliveryCost) {\n01114|         details.push({\n01115|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n01116|           description: '',\n01117|           price: calc.details.deliveryCost\n01118|         });\n01119|       }\n01120|       if (calc.details.terminalCost) {\n01121|         details.push({\n01122|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –º–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n01123|           description: '',\n01124|           price: calc.details.terminalCost\n01125|         });\n01126|       }\n01127|       if (calc.details.pickupCost) {\n01128|         details.push({\n01129|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–±–æ—Ä–∞',\n01130|           description: '',\n01131|           price: calc.details.pickupCost\n01132|         });\n01133|       }\n01134|       if (calc.details.deliveryToDoorCost) {\n01135|         details.push({\n01136|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ –¥–≤–µ—Ä–∏',\n01137|           description: '',\n01138|           price: calc.details.deliveryToDoorCost\n01139|         });\n01140|       }\n01141|       if (calc.details.additionalServices && calc.details.additionalServices > 0) {\n01142|         details.push({\n01143|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ø.—É—Å–ª—É–≥',\n01144|           description: '',\n01145|           price: calc.details.additionalServices\n01146|         });\n01147|       }\n01148| \n01149|     } else if (calc.company === '–ü–≠–ö' && calc.details?.services) {\n01150|       // –î–ª—è –ü–≠–ö –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ API\n01151|       calc.details.services.forEach((service: any) => {\n01152|         if (service.price > 0) {\n01153|           details.push({\n01154|             service: service.name || '–£—Å–ª—É–≥–∞ –ü–≠–ö',\n01155|             description: service.description || '',\n01156|             price: service.price\n01157|           });\n01158|         }\n01159|       });\n01160|     } else {\n01161|       // –î–ª—è –¥—Ä—É–≥–∏—Ö –¢–ö - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n01162|       details.push({\n01163|         service: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n01164|         description: `${form.fromCity} - ${form.toCity}`,\n01165|         price: calc.price\n01166|       });\n01167|       \n01168|       if (form.needInsurance && form.declaredValue > 0) {\n01169|         details.push({\n01170|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n01171|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n01172|           price: Math.round(form.declaredValue * 0.02)\n01173|         });\n01174|       }\n01175|       \n01176|       if (form.needPackaging) {\n01177|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n01178|         details.push({\n01179|           service: '–£–ø–∞–∫–æ–≤–∫–∞',\n01180|           description: '',\n01181|           price: Math.round(totalWeight * 30)\n01182|         });\n01183|       }\n01184|     }\n01185|     \n01186|     return details;\n01187|   };\n01188| \n01189|   return (\n01190|     <div className=\"min-h-screen bg-gray-900 text-white p-4 relative\">\n01191|       <div className=\"max-w-7xl mx-auto\">\n01192|         <h1 className=\"text-2xl font-bold text-center mb-6 text-blue-400\">\n01193|           –ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞ –õ–∞–≤—Å–∏—Ç\n01194|         </h1>\n01195|         \n01196|         <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 h-[90vh]\">\n01197|           {/* –õ–µ–≤–∞—è —á–∞—Å—Ç—å - —Ñ–æ—Ä–º–∞ */}\n01198|           <div className=\"space-y-3 overflow-y-auto pr-2\">\n01199|             {/* –ì—Ä—É–∑—ã */}\n01200|             <Card className=\"bg-gray-800 border-gray-700\">\n01201|               <CardHeader className=\"pb-3\">\n01202|                 <CardTitle className=\"text-white flex items-center gap-2 text-lg\">\n01203|                   <Truck className=\"h-4 w-4\" />\n01204|                   –ì—Ä—É–∑—ã\n01205|                 </CardTitle>\n01206|               </CardHeader>\n01207|               <CardContent className=\"space-y-3\">\n01208|                 {form.cargos.map((cargo, index) => (\n01209|                   <div key={cargo.id} className=\"border border-gray-600 rounded p-3\">\n01210|                     <div className=\"flex justify-between items-center mb-2\">\n01211|                       <h4 className=\"text-sm font-medium text-white\">–ì—Ä—É–∑ ‚Ññ{index + 1}</h4>\n01212|                       {form.cargos.length > 1 && (\n01213|                         <Button\n01214|                           variant=\"destructive\"\n01215|                           size=\"sm\"\n01216|                           onClick={() => removeCargo(cargo.id)}\n01217|                           className=\"h-6 text-xs\"\n01218|                         >\n01219|                           –£–¥–∞–ª–∏—Ç—å\n01220|                         </Button>\n01221|                       )}\n01222|                     </div>\n01223|                     <div className=\"grid grid-cols-2 gap-2\">\n01224|                       <div>\n01225|                         <Label className=\"text-white text-xs\">–î–ª–∏–Ω–∞ (—Å–º)</Label>\n01226|                         <Input\n01227|                           type=\"number\"\n01228|                           value={cargo.length || ''}\n01229|                           onChange={(e) => updateCargo(cargo.id, 'length', Number(e.target.value))}\n01230|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01231|                         />\n01232|                       </div>\n01233|                       <div>\n01234|                         <Label className=\"text-white text-xs\">–®–∏—Ä–∏–Ω–∞ (—Å–º)</Label>\n01235|                         <Input\n01236|                           type=\"number\"\n01237|                           value={cargo.width || ''}\n01238|                           onChange={(e) => updateCargo(cargo.id, 'width', Number(e.target.value))}\n01239|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01240|                         />\n01241|                       </div>\n01242|                       <div>\n01243|                         <Label className=\"text-white text-xs\">–í—ã—Å–æ—Ç–∞ (—Å–º)</Label>\n01244|                         <Input\n01245|                           type=\"number\"\n01246|                           value={cargo.height || ''}\n01247|                           onChange={(e) => updateCargo(cargo.id, 'height', Number(e.target.value))}\n01248|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01249|                         />\n01250|                       </div>\n01251|                       <div>\n01252|                         <Label className=\"text-white text-xs\">–í–µ—Å (–∫–≥)</Label>\n01253|                         <Input\n01254|                           type=\"number\"\n01255|                           value={cargo.weight || ''}\n01256|                           onChange={(e) => updateCargo(cargo.id, 'weight', Number(e.target.value))}\n01257|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01258|                         />\n01259|                       </div>\n01260|                     </div>\n01261|                   </div>\n01262|                 ))}\n01263|                 <Button onClick={addCargo} className=\"w-full h-8\" variant=\"outline\">\n01264|                   <Plus className=\"h-3 w-3 mr-1\" />\n01265|                   –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑\n01266|                 </Button>\n01267|               </CardContent>\n01268|             </Card>\n01269| \n01270|             {/* –ú–∞—Ä—à—Ä—É—Ç */}\n01271|             <Card className=\"bg-gray-800 border-gray-700\">\n01272|               <CardHeader className=\"pb-3\">\n01273|                 <CardTitle className=\"text-white flex items-center gap-2 text-lg\">\n01274|                   <Map className=\"h-4 w-4\" />\n01275|                   –ú–∞—Ä—à—Ä—É—Ç\n01276|                 </CardTitle>\n01277|               </CardHeader>\n01278|               <CardContent className=\"space-y-3\">\n01279|                 {/* –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */}\n01280|                 <div className=\"space-y-2\">\n01281|                   <Label className=\"text-sm font-medium text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</Label>\n01282|                   <div className=\"flex gap-3\">\n01283|                     <label className=\"flex items-center space-x-1\">\n01284|                       <input\n01285|                         type=\"radio\"\n01286|                         name=\"fromDelivery\"\n01287|                         checked={form.fromTerminal}\n01288|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: true, fromAddressDelivery: false }))}\n01289|                       />\n01290|                       <span className=\"text-white text-xs\">–û—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n01291|                     </label>\n01292|                     <label className=\"flex items-center space-x-1\">\n01293|                       <input\n01294|                         type=\"radio\"\n01295|                         name=\"fromDelivery\"\n01296|                         checked={form.fromAddressDelivery}\n01297|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: false, fromAddressDelivery: true }))}\n01298|                       />\n01299|                       <span className=\"text-white text-xs\">–û—Ç –∞–¥—Ä–µ—Å–∞</span>\n01300|                     </label>\n01301|                   </div>\n01302|                   \n01303|                   <div>\n01304|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n01305|                     <Input\n01306|                       value={form.fromCity}\n01307|                       onChange={(e) => handleAddressChange('fromCity', e.target.value, e.target)}\n01308|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n01309|                       className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01310|                     />\n01311|                   </div>\n01312|                   \n01313|                   {form.fromAddressDelivery && (\n01314|                     <div>\n01315|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n01316|                       <Input\n01317|                         value={form.fromAddress}\n01318|                         onChange={(e) => handleAddressChange('fromAddress', e.target.value, e.target)}\n01319|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n01320|                         className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01321|                       />\n01322|                     </div>\n01323|                   )}\n01324|                 </div>\n01325| \n01326|                 <Separator className=\"bg-gray-600\" />\n01327| \n01328|                 {/* –î–æ—Å—Ç–∞–≤–∫–∞ */}\n01329|                 <div className=\"space-y-2\">\n01330|                   <Label className=\"text-sm font-medium text-white\">–î–æ—Å—Ç–∞–≤–∫–∞</Label>\n01331|                   <div className=\"flex gap-3\">\n01332|                     <label className=\"flex items-center space-x-1\">\n01333|                       <input\n01334|                         type=\"radio\"\n01335|                         name=\"toDelivery\"\n01336|                         checked={form.toTerminal}\n01337|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: true, toAddressDelivery: false }))}\n01338|                       />\n01339|                       <span className=\"text-white text-xs\">–î–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n01340|                     </label>\n01341|                     <label className=\"flex items-center space-x-1\">\n01342|                       <input\n01343|                         type=\"radio\"\n01344|                         name=\"toDelivery\"\n01345|                         checked={form.toAddressDelivery}\n01346|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: false, toAddressDelivery: true }))}\n01347|                       />\n01348|                       <span className=\"text-white text-xs\">–î–æ –∞–¥—Ä–µ—Å–∞</span>\n01349|                     </label>\n01350|                   </div>\n01351|                   \n01352|                   <div>\n01353|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏</Label>\n01354|                     <Input\n01355|                       value={form.toCity}\n01356|                       onChange={(e) => handleAddressChange('toCity', e.target.value, e.target)}\n01357|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n01358|                       className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01359|                     />\n01360|                   </div>\n01361|                   \n01362|                   {form.toAddressDelivery && (\n01363|                     <div>\n01364|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</Label>\n01365|                       <Input\n01366|                         value={form.toAddress}\n01367|                         onChange={(e) => handleAddressChange('toAddress', e.target.value, e.target)}\n01368|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n01369|                         className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01370|                       />\n01371|                     </div>\n01372|                   )}\n01373|                 </div>\n01374|               </CardContent>\n01375|             </Card>\n01376| \n01377|             {/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã */}\n01378|             <Card className=\"bg-gray-800 border-gray-700\">\n01379|               <CardHeader className=\"pb-3\">\n01380|                 <CardTitle className=\"text-white text-lg\">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</CardTitle>\n01381|               </CardHeader>\n01382|               <CardContent className=\"space-y-3\">\n01383|                 <div>\n01384|                   <Label className=\"text-white text-xs\">–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)</Label>\n01385|                   <Input\n01386|                     type=\"number\"\n01387|                     value={form.declaredValue || ''}\n01388|                     onChange={(e) => setForm(prev => ({ ...prev, declaredValue: Number(e.target.value) }))}\n01389|                     className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01390|                   />\n01391|                 </div>\n01392|                 \n01393|                 <div className=\"space-y-2\">\n01394|                   <div className=\"flex items-center space-x-2\">\n01395|                     <Checkbox\n01396|                       id=\"packaging\"\n01397|                       checked={form.needPackaging}\n01398|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needPackaging: checked as boolean }))}\n01399|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n01400|                     />\n01401|                     <Label htmlFor=\"packaging\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø–∞–∫–æ–≤–∫–∞</Label>\n01402|                   </div>\n01403|                   \n01404|                   <div className=\"flex items-center space-x-2\">\n01405|                     <Checkbox\n01406|                       id=\"insurance\"\n01407|                       checked={form.needInsurance}\n01408|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needInsurance: checked as boolean }))}\n01409|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n01410|                     />\n01411|                     <Label htmlFor=\"insurance\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</Label>\n01412|                   </div>\n01413|                   \n01414|                   <div className=\"flex items-center space-x-2\">\n01415|                     <Checkbox\n01416|                       id=\"loading\"\n01417|                       checked={form.needLoading}\n01418|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needLoading: checked as boolean }))}\n01419|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n01420|                     />\n01421|                     <Label htmlFor=\"loading\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≥—Ä—É–∑–∫–∞/—Ä–∞–∑–≥—Ä—É–∑–∫–∞</Label>\n01422|                   </div>\n01423|                   \n01424|                   <div className=\"flex items-center space-x-2\">\n01425|                     <Checkbox\n01426|                       id=\"carry\"\n01427|                       checked={form.needCarry}\n01428|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needCarry: checked as boolean }))}\n01429|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n01430|                     />\n01431|                     <Label htmlFor=\"carry\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—ä–µ–º</Label>\n01432|                   </div>\n01433|                   \n01434|                   {form.needCarry && (\n01435|                     <div className=\"ml-6 space-y-2 border-l-2 border-gray-600 pl-3\">\n01436|                       <div>\n01437|                         <Label className=\"text-white text-xs\">–≠—Ç–∞–∂</Label>\n01438|                         <Input\n01439|                           type=\"number\"\n01440|                           value={form.floor}\n01441|                           onChange={(e) => setForm(prev => ({ ...prev, floor: Number(e.target.value) }))}\n01442|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01443|                         />\n01444|                       </div>\n01445|                       <div className=\"flex items-center space-x-2\">\n01446|                         <Checkbox\n01447|                           id=\"freightLift\"\n01448|                           checked={form.hasFreightLift}\n01449|                           onCheckedChange={(checked) => setForm(prev => ({ ...prev, hasFreightLift: checked as boolean }))}\n01450|                         />\n01451|                         <Label htmlFor=\"freightLift\" className=\"text-white text-xs\">–ù–∞–ª–∏—á–∏–µ –≥—Ä—É–∑–æ–≤–æ–≥–æ –ª–∏—Ñ—Ç–∞</Label>\n01452|                       </div>\n01453|                     </div>\n01454|                   )}\n01455|                 </div>\n01456|                 \n01457|                 <Button \n01458|                   onClick={handleCalculate} \n01459|                   className=\"w-full bg-blue-600 hover:bg-blue-700 h-8\" \n01460|                   disabled={calculating}\n01461|                 >\n01462|                   {calculating ? '–†–∞—Å—á–µ—Ç...' : '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å'}\n01463|                 </Button>\n01464|               </CardContent>\n01465|             </Card>\n01466|           </div>\n01467| \n01468|           {/* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã */}\n01469|           <div className=\"space-y-3 overflow-y-auto\">\n01470|             {calculations.length > 0 && (\n01471|               <div className=\"space-y-3\">\n01472|                 <div className=\"flex justify-between items-center\">\n01473|                   <h2 className=\"text-xl font-bold text-blue-400\">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>\n01474|                   <Button onClick={exportToPDF} variant=\"outline\" size=\"sm\" className=\"h-7 text-xs\">\n01475|                     –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF\n01476|                   </Button>\n01477|                 </div>\n01478|                 \n01479|                 {calculations.map((calc, index) => (\n01480|                   <Card key={index} className=\"bg-gray-800 border-gray-700\">\n01481|                     <CardHeader className=\"pb-2\">\n01482|                       <div className=\"flex justify-between items-center\">\n01483|                         <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n01484|                           <Building2 className=\"h-4 w-4\" />\n01485|                           {calc.company}\n01486|                         </CardTitle>\n01487|                         {calc.error ? (\n01488|                           <Badge variant=\"destructive\" className=\"text-xs\">–û—à–∏–±–∫–∞</Badge>\n01489|                         ) : (\n01490|                           <Badge variant=\"default\" className=\"bg-green-600 text-xs\">\n01491|                             {calc.price.toLocaleString()} ‚ÇΩ\n01492|                           </Badge>\n01493|                         )}\n01494|                       </div>\n01495|                     </CardHeader>\n01496|                     <CardContent className=\"pt-0\">\n01497|                       <div className=\"space-y-2\">\n01498|                         {calc.error ? (\n01499|                           <div className=\"space-y-2\">\n01500|                             <Alert className=\"border-red-600\">\n01501|                               <AlertDescription className=\"text-white text-xs\">{calc.error}</AlertDescription>\n01502|                             </Alert>\n01503|                             {calc.price > 0 && (\n01504|                               <>\n01505|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n01506|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ä–æ–∫:</strong> {calc.days} –¥–Ω–µ–π</p>\n01507|                               </>\n01508|                             )}\n01509|                           </div>\n01510|                         ) : (\n01511|                           <>\n01512|                             <p className=\"text-white text-xs\"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n01513|                             <p className=\"text-white text-xs\"><strong>–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {calc.days} –¥–Ω–µ–π</p>\n01514|                           </>\n01515|                         )}\n01516|                         \n01517|                         <div className=\"flex gap-2 mt-2\">\n01518|                           {!calc.error && (\n01519|                             <Button\n01520|                               variant=\"outline\"\n01521|                               size=\"sm\"\n01522|                               onClick={() => toggleDetails(calc.company)}\n01523|                               className=\"h-6 text-xs\"\n01524|                             >\n01525|                               {expandedDetails[calc.company] ? '–°–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ' : '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ'}\n01526|                             </Button>\n01527|                           )}\n01528|                           <Button\n01529|                             variant=\"outline\"\n01530|                             size=\"sm\"\n01531|                             onClick={() => toggleDebugInfo(calc.company)}\n01532|                             className=\"h-6 text-xs\"\n01533|                           >\n01534|                             {expandedDebugInfo[calc.company] ? '–°–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–∫—É' : '–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}\n01535|                           </Button>\n01536|                         </div>\n01537|                         \n01538|                         {/* –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ */}\n01539|                         {!calc.error && (\n01540|                           <Collapsible open={expandedDetails[calc.company]}>\n01541|                             <CollapsibleContent className=\"mt-2\">\n01542|                               <div className=\"bg-gray-900 p-3 rounded text-xs\">\n01543|                                 <h4 className=\"font-bold mb-2 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞:</h4>\n01544|                                 {(() => {\n01545|                                   const details = parseCalculationDetails(calc);\n01546|                                   const totalPrice = details.reduce((sum, detail) => sum + detail.price, 0);\n01547|                                   \n01548|                                   return (\n01549|                                     <div className=\"space-y-1\">\n01550|                                       {details.map((detail, idx) => (\n01551|                                         <div key={idx} className=\"flex justify-between text-white\">\n01552|                                           <div>\n01553|                                             <div className=\"font-medium\">{detail.service}</div>\n01554|                                             {detail.description && (\n01555|                                               <div className=\"text-gray-400 text-xs\">{detail.description}</div>\n01556|                                             )}\n01557|                                           </div>\n01558|                                           <div className=\"font-medium\">{detail.price.toLocaleString()} ‚ÇΩ</div>\n01559|                                         </div>\n01560|                                       ))}\n01561|                                     </div>\n01562|                                   );\n01563|                                 })()}\n01564|                               </div>\n01565|                             </CollapsibleContent>\n01566|                           </Collapsible>\n01567|                         )}\n01568|                         \n01569|                         {/* –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è - –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ */}\n01570|                         <Collapsible open={expandedDebugInfo[calc.company]}>\n01571|                           <CollapsibleContent className=\"mt-2\">\n01572|                             <div className=\"bg-gray-900 p-3 rounded text-xs\">\n01573|                               <h4 className=\"font-bold mb-2 text-white\">–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>\n01574|                               \n01575|                               {calc.apiUrl && (\n01576|                                 <div className=\"mb-3\">\n01577|                                   <h5 className=\"font-bold mb-1 text-white\">–ó–∞–ø—Ä–æ—Å –∫ API:</h5>\n01578|                                   <p className=\"text-gray-300 break-all text-xs\">URL: {calc.apiUrl}</p>\n01579|                                 </div>\n01580|                               )}\n01581|                               \n01582|                               {calc.sessionId && (\n01583|                                 <div className=\"mb-3\">\n01584|                                   <h5 className=\"font-bold mb-1 text-white\">Session ID:</h5>\n01585|                                   <p className=\"text-gray-300 text-xs\">{calc.sessionId}</p>\n01586|                                 </div>\n01587|                               )}\n01588|                               \n01589|                               {calc.requestData && (\n01590|                                 <div className=\"mb-3\">\n01591|                                   <h5 className=\"font-bold mb-1 text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:</h5>\n01592|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n01593|                                     {JSON.stringify(calc.requestData, null, 2)}\n01594|                                   </pre>\n01595|                                 </div>\n01596|                               )}\n01597|                               \n01598|                               {calc.responseData && (\n01599|                                 <div className=\"mb-3\">\n01600|                                   <h5 className=\"font-bold mb-1 text-white\">–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:</h5>\n01601|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n01602|                                     {JSON.stringify(calc.responseData, null, 2)}\n01603|                                   </pre>\n01604|                                 </div>\n01605|                               )}\n01606|                               \n01607|                               {calc.details && (\n01608|                                 <div className=\"mb-3\">\n01609|                                   <h5 className=\"font-bold mb-1 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ (JSON):</h5>\n01610|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n01611|                                     {JSON.stringify(calc.details, null, 2)}\n01612|                                   </pre>\n01613|                                 </div>\n01614|                               )}\n01615|                               \n01616|                               {calc.error && (\n01617|                                 <div className=\"mb-3\">\n01618|                                   <h5 className=\"font-bold mb-1 text-red-400\">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ:</h5>\n01619|                                   <p className=\"text-red-300 text-xs\">{calc.error}</p>\n01620|                                 </div>\n01621|                               )}\n01622|                             </div>\n01623|                           </CollapsibleContent>\n01624|                         </Collapsible>\n01625|                       </div>\n01626|                     </CardContent>\n01627|                   </Card>\n01628|                 ))}\n01629|               </div>\n01630|             )}\n01631|             \n01632|             {/* –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –¢–ö */}\n01633|             <Card className=\"bg-gray-800 border-gray-700\">\n01634|               <CardHeader className=\"pb-2\">\n01635|                 <CardTitle className=\"text-white text-sm\">–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏</CardTitle>\n01636|               </CardHeader>\n01637|               <CardContent>\n01638|                 <div className=\"grid grid-cols-2 gap-2\">\n01639|                   {COMPANIES.map((company, index) => (\n01640|                     <div key={index} className=\"flex items-center gap-2 p-2 bg-gray-700 rounded\">\n01641|                       <span className=\"text-lg\">{company.logo}</span>\n01642|                       <div>\n01643|                         <p className=\"font-medium text-white text-xs\">{company.name}</p>\n01644|                         <Badge variant={company.connected ? \"default\" : \"destructive\"} className=\"text-xs\">\n01645|                           {company.connected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∞' : '–û—Ç–∫–ª—é—á–µ–Ω–∞'}\n01646|                         </Badge>\n01647|                       </div>\n01648|                     </div>\n01649|                   ))}\n01650|                 </div>\n01651|               </CardContent>\n01652|             </Card>\n01653|           </div>\n01654|         </div>\n01655|       </div>\n01656| \n01657|       {/* –ê–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∏ */}\n01658|       {showSuggestions && suggestions.length > 0 && (\n01659|         <div \n01660|           className=\"fixed z-50 bg-gray-800 border border-gray-700 rounded-md shadow-lg max-w-sm w-full max-h-60 overflow-y-auto\"\n01661|           style={{\n01662|             top: suggestionPosition.top,\n01663|             left: suggestionPosition.left\n01664|           }}\n01665|         >\n01666|           <div className=\"p-1\">\n01667|             {suggestions.map((suggestion, index) => (\n01668|               <div\n01669|                 key={index}\n01670|                 className=\"p-2 hover:bg-gray-700 cursor-pointer text-xs text-white rounded transition-colors\"\n01671|                 onClick={() => selectSuggestion(suggestion)}\n01672|               >\n01673|                 {suggestion.value}\n01674|               </div>\n01675|             ))}\n01676|           </div>\n01677|         </div>\n01678|       )}\n01679|     </div>\n01680|   );\n01681| }\n</file>",
    "metadata": {
      "preview": "'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Plus, Truck, Building2, Map } from 'lucide-react';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { Collapsible, CollapsibleContent } from '@/components/ui/collapsible';\n\ninterface Cargo {\n  id: string;\n  length: number;\n  width: number;\n  height: number;\n  weight: number;"
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1758881336800,
      "end": 1758881336805
    }
  }
}