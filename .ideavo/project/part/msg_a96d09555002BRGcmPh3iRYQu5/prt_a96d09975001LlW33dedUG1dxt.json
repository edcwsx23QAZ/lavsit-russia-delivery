{
  "id": "prt_a96d09975001LlW33dedUG1dxt",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "messageID": "msg_a96d09555002BRGcmPh3iRYQu5",
  "type": "tool",
  "callID": "call_83294482",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "app/page.tsx",
      "offset": 3407
    },
    "output": "<file>\n03408|     const apiUrl = 'https://api.nordw.orog.ru/api/v1/calculate';\n03409|     \n03410|     try {\n03411|       // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03412|       validateMultipleCargos(form.cargos);\n03413|       \n03414|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03415|       const totalVolume = form.cargos.reduce((sum, cargo) => \n03416|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n03417|       );\n03418| \n03419|       // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03420|       const maxLength = Math.max(...form.cargos.map(c => c.length));\n03421|       const maxWidth = Math.max(...form.cargos.map(c => c.width));\n03422|       const maxHeight = Math.max(...form.cargos.map(c => c.height));\n03423|       \n03424|       // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n03425|       console.log('üåê Nord Wheel: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n03426|       console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n03427|       console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);\n03428|       console.log(`   - –û–±—â–∏–π –æ–±—ä–µ–º: ${totalVolume.toFixed(3)} –º¬≥`);\n03429|       \n03430|       form.cargos.forEach((cargo, index) => {\n03431|         console.log(`   üì¶ –ú–µ—Å—Ç–æ ${index + 1}:`);\n03432|         console.log(`     - –ì–∞–±–∞—Ä–∏—Ç—ã: ${cargo.length}√ó${cargo.width}√ó${cargo.height} —Å–º`);\n03433|         console.log(`     - –í–µ—Å: ${cargo.weight} –∫–≥`);\n03434|         console.log(`     - –û–±—ä–µ–º: ${((cargo.length * cargo.width * cargo.height) / 1000000).toFixed(3)} –º¬≥`);\n03435|       });\n03436| \n03437|       if (form.cargos.length > 1) {\n03438|         console.log(`   üìê –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã: ${maxLength}√ó${maxWidth}√ó${maxHeight} —Å–º`);\n03439|       }\n03440| \n03441|       // –§–ò–ê–° –∫–æ–¥—ã –≥–æ—Ä–æ–¥–æ–≤ (—Ç–µ—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ú–æ—Å–∫–≤—ã –∏ –°–ü–±)\n03442|       const cityFiasMap: { [key: string]: string } = {\n03443|         '–ú–æ—Å–∫–≤–∞': '0c5b2444-70a0-4932-980c-b4dc0d3f02b5',\n03444|         '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥': 'c2deb16a-0330-4f05-821f-1d09c93331e6',\n03445|         '–°–ü–±': 'c2deb16a-0330-4f05-821f-1d09c93331e6'\n03446|       };\n03447| \n03448|       const fromCityFias = cityFiasMap[form.fromCity] || '0c5b2444-70a0-4932-980c-b4dc0d3f02b5'; // –ú–æ—Å–∫–≤–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n03449|       const toCityFias = cityFiasMap[form.toCity] || 'c2deb16a-0330-4f05-821f-1d09c93331e6'; // –°–ü–± –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n03450| \n03451|       // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API\n03452|       const requestData = {\n03453|         dispatch: {\n03454|           location: {\n03455|             type: form.fromAddressDelivery ? 'address' : 'terminal',\n03456|             city_fias: fromCityFias\n03457|           }\n03458|         },\n03459|         destination: {\n03460|           location: {\n03461|             type: form.toAddressDelivery ? 'address' : 'terminal',\n03462|             city_fias: toCityFias\n03463|           }\n03464|         },\n03465|         cargo: {\n03466|           total_weight: totalWeight,\n03467|           total_volume: totalVolume,\n03468|           total_quantity: form.cargos.length\n03469|         },\n03470|         insurance: form.needInsurance ? form.declaredValue || 1000 : 0,\n03471|         insurance_refuse: !form.needInsurance,\n03472|         services: {\n03473|           is_package: form.needPackaging,\n03474|           is_documents_return: false, // –ü–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–µ\n03475|           is_fragile: false // –ü–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–µ\n03476|         },\n03477|         promocode: null\n03478|       };\n03479| \n03480|       console.log('üöõ Nord Wheel –Ω–æ–≤—ã–π API –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03481| \n03482|       const response = await fetch(apiUrl, {\n03483|         method: 'POST',\n03484|         headers: {\n03485|           'Content-Type': 'application/json',\n03486|         },\n03487|         body: JSON.stringify(requestData)\n03488|       });\n03489| \n03490|       if (!response.ok) {\n03491|         console.error('‚ùå Nord Wheel API –æ—à–∏–±–∫–∞:', response.status, response.statusText);\n03492|         return {\n03493|           company: 'Nord Wheel',\n03494|           price: 0,\n03495|           days: 0,\n03496|           error: `–û—à–∏–±–∫–∞ API: ${response.status} ${response.statusText}`,\n03497|           apiUrl,\n03498|           requestData\n03499|         };\n03500|       }\n03501| \n03502|       const data = await response.json();\n03503|       console.log('üöõ Nord Wheel –Ω–æ–≤—ã–π API –æ—Ç–≤–µ—Ç:', data);\n03504| \n03505|       if (data.auto && data.auto.total_price) {\n03506|         const autoData = data.auto;\n03507|         const price = autoData.total_price;\n03508|         \n03509|         // –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –¥–æ—Å—Ç–∞–≤–∫–∏\n03510|         let days = 0;\n03511|         if (autoData.delivery_date) {\n03512|           const deliveryDate = new Date(autoData.delivery_date);\n03513|           const today = new Date();\n03514|           const diffTime = deliveryDate.getTime() - today.getTime();\n03515|           days = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n03516|         }\n03517| \n03518|         // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–µ—Ç–∞–ª–∏ —É—Å–ª—É–≥\n03519|         const details: any = {};\n03520|         if (autoData.services && Array.isArray(autoData.services)) {\n03521|           autoData.services.forEach((service: any) => {\n03522|             if (service.name && service.amount) {\n03523|               details[service.name] = service.amount;\n03524|             }\n03525|           });\n03526|         }\n03527| \n03528|         return {\n03529|           company: 'Nord Wheel',\n03530|           price: Math.round(price),\n03531|           days: days,\n03532|           details: {\n03533|             totalCost: price,\n03534|             deliveryCost: details['–°—Ç–æ–∏–º–æ—Å—Ç—å –º–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–≤–æ–∑–∫–∏'] || 0,\n03535|             pickupCost: details['–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–±–æ—Ä–∞'] || 0,\n03536|             deliveryToDoorCost: details['–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ –¥–≤–µ—Ä–∏'] || 0,\n03537|             insuranceCost: details['–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞'] || 0,\n03538|             additionalServices: details['–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ø.—É—Å–ª—É–≥'] || 0,\n03539|             services: autoData.services || []\n03540|           },\n03541|           requestData,\n03542|           responseData: data,\n03543|           apiUrl\n03544|         };\n03545|       } else {\n03546|         return {\n03547|           company: 'Nord Wheel',\n03548|           price: 0,\n03549|           days: 0,\n03550|           error: data.message || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ Nord Wheel - –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–≤—Ç–æ –¥–æ—Å—Ç–∞–≤–∫–∏',\n03551|           requestData,\n03552|           responseData: data,\n03553|           apiUrl\n03554|         };\n03555|       }\n03556|     } catch (error: any) {\n03557|       console.error('üöõ Nord Wheel –æ—à–∏–±–∫–∞:', error);\n03558|       return {\n03559|         company: 'Nord Wheel',\n03560|         price: 0,\n03561|         days: 0,\n03562|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03563|         apiUrl\n03564|       };\n03565|     }\n03566|   };\n03567|     const calculateCdek = async (): Promise<CalculationResult> => {\n03568|     const apiUrl = '/api/cdek';\n03569|     \n03570|     try {\n03571|       validateMultipleCargos(form.cargos);\n03572|       \n03573|       const packages = form.cargos.map(cargo => ({\n03574|         height: cargo.height,\n03575|         length: cargo.length,\n03576|         width: cargo.width,\n03577|         weight: cargo.weight * 1000\n03578|       }));\n03579| \n03580|       const requestData: any = {\n03581|         from_city: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n03582|         to_city: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n03583|         packages: packages\n03584|       };\n03585| \n03586|       if (form.needInsurance && form.declaredValue > 0) {\n03587|         requestData.services = [{\n03588|           code: 'INSURANCE',\n03589|           parameter: form.declaredValue\n03590|         }];\n03591|         console.log('üì¶ CDEK: –¥–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ', form.declaredValue);\n03592|       }\n03593| \n03594|       console.log('üì¶ CDEK –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03595|       console.log('üì¶ CDEK –º–∞—Ä—à—Ä—É—Ç:', {\n03596|         fromAddressDelivery: form.fromAddressDelivery,\n03597|         fromLavsiteWarehouse: form.fromLavsiteWarehouse,\n03598|         toAddressDelivery: form.toAddressDelivery\n03599|       });\n03600| \n03601|        const result = await enhancedApiRequest(\n03602|          apiUrl,\n03603|          {\n03604|            method: 'POST',\n03605|            headers: {\n03606|              'Content-Type': 'application/json',\n03607|            },\n03608|            body: JSON.stringify(requestData)\n03609|          },\n03610|          { operation: 'calculate', company: '–°–î–≠–ö' }\n03611|        );\n03612| \n03613|        if (result && typeof result === 'object' && 'success' in result && !result.success) {\n03614|          console.error('‚ùå –°–î–≠–ö API –æ—à–∏–±–∫–∞:', result.error);\n03615|          return {\n03616|            company: '–°–î–≠–ö',\n03617|            price: 0,\n03618|            days: 0,\n03619|            error: result.error.userMessage || result.error.message,\n03620|            requestData,\n03621|            responseData: null,\n03622|            apiUrl\n03623|          };\n03624|        }\n03625| \n03626|        const response = result as Response;\n03627|        const data = await response.json();\n03628|        console.log('üì¶ CDEK –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω, —Ç–∞—Ä–∏—Ñ–æ–≤:', data.tariff_codes?.length || 0);\n03629| \n03630|       if (response.ok && data.tariff_codes && data.tariff_codes.length > 0) {\n03631|         const isFromDoor = form.fromAddressDelivery || form.fromLavsiteWarehouse;\n03632|         const isToDoor = form.toAddressDelivery;\n03633|         \n03634|         let deliveryMode: number;\n03635|         let deliveryModeText: string;\n03636|         \n03637|         if (isFromDoor && isToDoor) {\n03638|           deliveryMode = 1;\n03639|           deliveryModeText = '–¥–≤–µ—Ä—å-–¥–≤–µ—Ä—å';\n03640|         } else if (isFromDoor && !isToDoor) {\n03641|           deliveryMode = 2;\n03642|           deliveryModeText = '–¥–≤–µ—Ä—å-—Å–∫–ª–∞–¥';\n03643|         } else if (!isFromDoor && isToDoor) {\n03644|           deliveryMode = 3;\n03645|           deliveryModeText = '—Å–∫–ª–∞–¥-–¥–≤–µ—Ä—å';\n03646|         } else {\n03647|           deliveryMode = 4;\n03648|           deliveryModeText = '—Å–∫–ª–∞–¥-—Å–∫–ª–∞–¥';\n03649|         }\n03650| \n03651|         console.log(`üì¶ CDEK –≤—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º –¥–æ—Å—Ç–∞–≤–∫–∏: ${deliveryMode} (${deliveryModeText})`);\n03652| \n03653|         const filteredTariffs = data.tariff_codes.filter((t: any) => t.delivery_mode === deliveryMode);\n03654|         \n03655|         console.log(`üì¶ CDEK –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è —Ä–µ–∂–∏–º–∞ ${deliveryModeText}:`, filteredTariffs.length);\n03656| \n03657|         if (filteredTariffs.length === 0) {\n03658|           return {\n03659|             company: '–°–î–≠–ö',\n03660|             price: 0,\n03661|             days: 0,\n03662|             error: `–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∞ ${deliveryModeText}`,\n03663|             requestData,\n03664|             responseData: data,\n03665|             apiUrl\n03666|           };\n03667|         }\n03668| \n03669|         const bestTariff = filteredTariffs.reduce((min: any, tariff: any) => \n03670|           (tariff.delivery_sum < min.delivery_sum) ? tariff : min\n03671|         );\n03672| \n03673|         console.log(`üì¶ CDEK –ª—É—á—à–∏–π —Ç–∞—Ä–∏—Ñ: ${bestTariff.tariff_name} - ${bestTariff.delivery_sum}‚ÇΩ`);\n03674| \n03675|         const detailsRequest: any = {\n03676|           ...requestData,\n03677|           tariff_code: bestTariff.tariff_code,\n03678|           get_details: true\n03679|         };\n03680| \n03681|         console.log('üì¶ CDEK: –∑–∞–ø—Ä–æ—Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏...');\n03682| \n03683|           const detailsResult = await enhancedApiRequest(\n03684|             apiUrl,\n03685|             {\n03686|               method: 'POST',\n03687|               headers: {\n03688|                 'Content-Type': 'application/json',\n03689|               },\n03690|               body: JSON.stringify(detailsRequest)\n03691|             },\n03692|             { operation: 'tariff_details', company: '–°–î–≠–ö' }\n03693|           );\n03694| \n03695|           let tariffDetails: any = null;\n03696|           if (detailsResult && typeof detailsResult === 'object' && 'success' in detailsResult && detailsResult.success) {\n03697|             const detailsResponse = detailsResult as Response;\n03698|             if (detailsResponse.ok) {\n03699|               const detailsData = await detailsResponse.json();\n03700|               tariffDetails = detailsData.tariff_details;\n03701|               console.log('üì¶ –°–î–≠–ö –¥–µ—Ç–∞–ª–∏ —Ç–∞—Ä–∏—Ñ–∞:', tariffDetails);\n03702|             }\n03703|           }\n03704| \n03705|         const finalPrice = tariffDetails?.total_sum || bestTariff.delivery_sum;\n03706|         \n03707|         return {\n03708|           company: '–°–î–≠–ö',\n03709|           price: Math.round(finalPrice),\n03710|           days: bestTariff.period_max || 0,\n03711|           details: {\n03712|             tariff_name: bestTariff.tariff_name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n03713|             tariff_code: bestTariff.tariff_code,\n03714|             delivery_mode: deliveryModeText,\n03715|             period_min: bestTariff.period_min,\n03716|             period_max: bestTariff.period_max,\n03717|             calendar_min: bestTariff.calendar_min,\n03718|             calendar_max: bestTariff.calendar_max,\n03719|             all_tariffs: filteredTariffs,\n03720|             services: tariffDetails?.services || [],\n03721|             delivery_sum: tariffDetails?.delivery_sum || bestTariff.delivery_sum,\n03722|             total_sum: finalPrice,\n03723|             weight_calc: tariffDetails?.weight_calc\n03724|           },\n03725|           requestData,\n03726|           responseData: data,\n03727|           apiUrl\n03728|         };\n03729|       } else {\n03730|         return {\n03731|           company: '–°–î–≠–ö',\n03732|           price: 0,\n03733|           days: 0,\n03734|           error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –°–î–≠–ö',\n03735|           requestData,\n03736|           responseData: data,\n03737|           apiUrl\n03738|         };\n03739|       }\n03740|     } catch (error: any) {\n03741|       console.error('üì¶ –°–î–≠–ö –æ—à–∏–±–∫–∞:', error);\n03742|       return {\n03743|         company: '–°–î–≠–ö',\n03744|         price: 0,\n03745|         days: 0,\n03746|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03747|         apiUrl\n03748|       };\n03749|     }\n03750|   };\n03751| \n03752|   const calculateKit = async (): Promise<CalculationResult> => {\n03753|     const apiUrl = '/api/kit';\n03754|     \n03755|     try {\n03756|       validateMultipleCargos(form.cargos);\n03757|       \n03758|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n03759| \n03760|       const requestData = {\n03761|         from_city: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n03762|         to_city: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n03763|         declared_price: form.declaredValue || 10000,\n03764|         service: ['S089']\n03765|       };\n03766| \n03767|       console.log('üöõ –ö–ò–¢ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n03768| \n03769|        const result = await enhancedApiRequest(\n03770|          apiUrl,\n03771|          {\n03772|            method: 'POST',\n03773|            headers: {\n03774|              'Content-Type': 'application/json',\n03775|            },\n03776|            body: JSON.stringify(requestData)\n03777|          },\n03778|          { operation: 'calculate', company: '–ö–ò–¢' }\n03779|        );\n03780| \n03781|        if (result && typeof result === 'object' && 'success' in result && !result.success) {\n03782|          console.error('‚ùå –ö–ò–¢ API –æ—à–∏–±–∫–∞:', result.error);\n03783|          return {\n03784|            company: '–ö–ò–¢',\n03785|            price: 0,\n03786|            days: 0,\n03787|            error: result.error.userMessage || result.error.message,\n03788|            requestData,\n03789|            responseData: null,\n03790|            apiUrl\n03791|          };\n03792|        }\n03793| \n03794|        const response = result as Response;\n03795|        const data = await response.json();\n03796|        console.log('üöõ –ö–ò–¢ –æ—Ç–≤–µ—Ç:', data);\n03797| \n03798|       if (response.ok && Array.isArray(data) && data.length > 0) {\n03799|         const rubData = data.find((item: any) => {\n03800|           const tariffData: any = Object.values(item)[0];\n03801|           return tariffData?.currency_code === 'RUB';\n03802|         });\n03803|         \n03804|         if (rubData) {\n03805|           const tariffKey = Object.keys(rubData)[0];\n03806|           const tariffData: any = rubData[tariffKey];\n03807|           \n03808|           console.log('üöõ –ö–ò–¢ –≤—ã–±—Ä–∞–Ω —Ç–∞—Ä–∏—Ñ:', tariffKey, tariffData);\n03809| \n03810|           return {\n03811|             company: '–ö–ò–¢',\n03812|             price: Math.round(tariffData.cost || 0),\n03813|             days: tariffData.time || 0,\n03814|             details: {\n03815|               tariff_name: tariffData.name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n03816|               tariff_type: tariffKey,\n03817|               services: tariffData.detail || [],\n03818|               currency: tariffData.currency_code\n03819|             },\n03820|             requestData,\n03821|             responseData: data,\n03822|             apiUrl\n03823|           };\n03824|         }\n03825|       }\n03826| \n03827|       return {\n03828|         company: '–ö–ò–¢',\n03829|         price: 0,\n03830|         days: 0,\n03831|         error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –ö–ò–¢',\n03832|         requestData,\n03833|         responseData: data,\n03834|         apiUrl\n03835|       };\n03836|     } catch (error: any) {\n03837|       console.error('üöõ –ö–ò–¢ –æ—à–∏–±–∫–∞:', error);\n03838|       return {\n03839|         company: '–ö–ò–¢',\n03840|         price: 0,\n03841|         days: 0,\n03842|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n03843|         apiUrl\n03844|       };\n03845|     }\n03846|   };\n03847| \n03848|   const handleCalculate = async () => {\n03849|     setCalculating(true);\n03850|     setCalculations([]);\n03851|     \n03852|     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ, –±–µ–∑ –¥–µ–±–∞—É–Ω—Å–∞)\n03853|     saveFormData({\n03854|       cargos: form.cargos,\n03855|       fromCity: form.fromCity,\n03856|       toCity: form.toCity,\n03857|       fromAddress: form.fromAddress,\n03858|       toAddress: form.toAddress,\n03859|       declaredValue: form.declaredValue,\n03860|       needPackaging: form.needPackaging,\n03861|       needLoading: form.needLoading,\n03862|       needCarry: form.needCarry,\n03863|       floor: form.floor,\n03864|       hasFreightLift: form.hasFreightLift,\n03865|       needInsurance: form.needInsurance,\n03866|       fromTerminal: form.fromTerminal,\n03867|       toTerminal: form.toTerminal,\n03868|       fromAddressDelivery: form.fromAddressDelivery,\n03869|       toAddressDelivery: form.toAddressDelivery,\n03870|       selectedProducts: form.selectedProducts,\n03871|     });\n03872|     \n03873|     try {\n03874|       // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞—Å—á–µ—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π\n03875|       const calculationFunctions: Promise<CalculationResult>[] = [];\n03876|       \n03877|       if (enabledCompanies.dellin) {\n03878|         calculationFunctions.push(calculateDellin());\n03879|       }\n03880|       if (enabledCompanies.pek) {\n03881|         calculationFunctions.push(calculatePEK());\n03882|       }\n03883|       if (enabledCompanies.nordwheel) {\n03884|         calculationFunctions.push(calculateNordWheel());\n03885|       }\n03886|       if (enabledCompanies.railcontinent) {\n03887|         calculationFunctions.push(calculateRailContinent());\n03888|       }\n03889|       if (enabledCompanies.vozovoz) {\n03890|         calculationFunctions.push(calculateVozovoz());\n03891|       }\n03892|       if (enabledCompanies.cdek) {\n03893|         calculationFunctions.push(calculateCdek());\n03894|       }\n03895|       if (enabledCompanies.kit) {\n03896|         calculationFunctions.push(calculateKit());\n03897|       }\n03898|       \n03899|       // –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞\n03900|       if (calculationFunctions.length === 0) {\n03901|         setCalculations([]);\n03902|         return;\n03903|       }\n03904|       \n03905|       const results = await Promise.all(calculationFunctions);\n03906|       \n03907|       // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–µ–Ω–µ\n03908|       const sortedResults = results\n03909|         .filter(result => !result.error)\n03910|         .sort((a, b) => a.price - b.price)\n03911|         .concat(results.filter(result => result.error));\n03912|       \n03913|       setCalculations(sortedResults);\n03914|     } catch (error) {\n03915|       console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ:', error);\n03916|     } finally {\n03917|       setCalculating(false);\n03918|     }\n03919|   };\n03920| \n03921|   const exportToPDF = () => {\n03922|     if (typeof window !== 'undefined') {\n03923|       // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –ø–µ—Ä–µ–¥ –ø–µ—á–∞—Ç—å—é\n03924|       const allExpanded = calculations.reduce((acc, calc) => {\n03925|         acc[calc.company] = true;\n03926|         return acc;\n03927|       }, {} as { [key: string]: boolean });\n03928|       \n03929|       setExpandedDetails(allExpanded);\n03930|       \n03931|       // –î–∞–µ–º –≤—Ä–µ–º—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è DOM\n03932|       setTimeout(() => {\n03933|         window.print();\n03934|       }, 100);\n03935|     }\n03936|   };\n03937| \n03938|   const toggleDetails = (company: string) => {\n03939|     setExpandedDetails(prev => ({\n03940|       ...prev,\n03941|       [company]: !prev[company]\n03942|     }));\n03943|   };\n03944| \n03945|   const toggleDebugInfo = (company: string) => {\n03946|     setExpandedDebugInfo(prev => ({\n03947|       ...prev,\n03948|       [company]: !prev[company]\n03949|     }));\n03950|   };\n03951| \n03952|   // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—Å—á–µ—Ç–∞\n03953|   const handleReset = () => {\n03954|     if (typeof window !== 'undefined') {\n03955|       // –û—á–∏—â–∞–µ–º localStorage\n03956|       localStorage.removeItem('deliveryForm');\n03957|       \n03958|       // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–æ—Ä–º—ã –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É\n03959|       setForm(initialFormState);\n03960|       \n03961|       // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n03962|       setCalculations([]);\n03963|       setExpandedDetails({});\n03964|       setExpandedDebugInfo({});\n03965|       setSuggestions([]);\n03966|       setShowSuggestions(false);\n03967|       setActiveField('');\n03968|       \n03969|       console.log('–§–æ—Ä–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞ –∫ –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é');\n03970|     }\n03971|   };\n03972| \n03973|   // –ü–∞—Ä—Å–µ—Ä –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è —á–∏—Ç–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞\n03974|   const parseCalculationDetails = (calc: CalculationResult) => {\n03975|     console.log('üîç parseCalculationDetails –ø–æ–ª—É—á–∏–ª calc:', calc?.company || 'undefined');\n03976|     console.log('üîç calc.details:', calc?.details ? '—Å—É—â–µ—Å—Ç–≤—É–µ—Ç' : 'undefined/null');\n03977|     console.log('üîç typeof calc.details:', typeof calc?.details);\n03978|     \n03979|     const details: { service: string; description: string; price: number }[] = [];\n03980|     \n03981|     try {\n03982|       if (calc.company === '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏' && calc.details) {\n03983|         console.log('üîç –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–µ—Ç–∞–ª–µ–π –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π...');\n03984|       // –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ (—É–∂–µ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –±–∞–∑–æ–≤—ã–µ —É—Å–ª—É–≥–∏ –∏ —É–ø–∞–∫–æ–≤–∫—É)\n03985|       let basePrice = calc.details?.price || calc.price || 0;\n03986|       \n03987|       // –†–∞–∑–±–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ\n03988|       let intercityPrice = 0;\n03989|       let derivalPrice = 0;\n03990|       let arrivalPrice = 0;\n03991|       let packagingPrice = 0;\n03992|       // packagingPremiums –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è - –Ω–∞–¥–±–∞–≤–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ pkg.price\n03993|       let insurancePrice = 0;\n03994|       \n03995|       // –ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞\n03996|       if (calc.details?.intercity?.price) {\n03997|         intercityPrice = calc.details.intercity.price;\n03998|         details.push({\n03999|           service: '–ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞',\n04000|           description: `${form.fromCity} - ${form.toCity}`,\n04001|           price: intercityPrice\n04002|         });\n04003|       }\n04004|       \n04005|       // –ó–∞–±–æ—Ä –≥—Ä—É–∑–∞\n04006|       if (calc.details?.derival?.price) {\n04007|         derivalPrice = calc.details.derival.price;\n04008|         details.push({\n04009|           service: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n04010|           description: '–û—Ç –∞–¥—Ä–µ—Å–∞',\n04011|           price: derivalPrice\n04012|         });\n04013|       }\n04014|       \n04015|       // –î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞\n04016|       if (calc.details?.arrival?.price) {\n04017|         arrivalPrice = calc.details.arrival.price;\n04018|         details.push({\n04019|           service: '–û—Ç–≤–æ–∑ –≥—Ä—É–∑–∞',\n04020|           description: '–î–æ –∞–¥—Ä–µ—Å–∞',\n04021|           price: arrivalPrice\n04022|         });\n04023|       }\n04024|       \n04025|       // –£–ø–∞–∫–æ–≤–∫–∞ (–Ω–∞–¥–±–∞–≤–∫–∏ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ pkg.price, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏)\n04026|       if (form.needPackaging && calc.details?.packages) {\n04027|         Object.entries(calc.details?.packages || {}).forEach(([key, pkg]: [string, any]) => {\n04028|           if (pkg.price && pkg.price > 0) {\n04029|             // –í—ã—á–∏—Å–ª—è–µ–º –±–∞–∑–æ–≤—É—é —Ü–µ–Ω—É —É–ø–∞–∫–æ–≤–∫–∏ (–±–µ–∑ –Ω–∞–¥–±–∞–≤–æ–∫) –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\n04030|             let basePkgPrice = pkg.price;\n04031|             let totalPremiums = 0;\n04032|             \n04033|             if (pkg.premiumDetails && Array.isArray(pkg.premiumDetails)) {\n04034|               totalPremiums = pkg.premiumDetails.reduce((sum: number, premium: any) => \n04035|                 sum + (premium.value || 0), 0);\n04036|               basePkgPrice = pkg.price - totalPremiums;\n04037|             }\n04038|             \n04039|             packagingPrice += pkg.price; // –í –æ–±—â—É—é —Å—É–º–º—É –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—É—é —Ü–µ–Ω—É\n04040|             \n04041|             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–∑–æ–≤—É—é —É–ø–∞–∫–æ–≤–∫—É\n04042|             details.push({\n04043|               service: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n04044|               description: '–£–ø–∞–∫–æ–≤–∞—Ç—å –≤ –∫–æ–º–ø–ª–µ–∫—Å ¬´–æ–±—Ä–µ—à—ë—Ç–∫–∞ + –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è¬ª',\n04045|               price: basePkgPrice\n04046|             });\n04047|             \n04048|             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–¥–±–∞–≤–∫–∏ –æ—Ç–¥–µ–ª—å–Ω–æ (–¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –∫ –æ–±—â–µ–π —Å—É–º–º–µ)\n04049|             if (pkg.premiumDetails && Array.isArray(pkg.premiumDetails)) {\n04050|               pkg.premiumDetails.forEach((premium: any) => {\n04051|                 if (premium.value && premium.value > 0) {\n04052|                   details.push({\n04053|                     service: '–ù–∞–¥–±–∞–≤–∫–∞ –∫ —É–ø–∞–∫–æ–≤–∫–µ',\n04054|                     description: premium.name || '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞–¥–±–∞–≤–∫–∞',\n04055|                     price: premium.value\n04056|                   });\n04057|                 }\n04058|               });\n04059|             }\n04060|           }\n04061|         });\n04062|       }\n04063|       \n04064|       // –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ\n04065|       if (form.needInsurance && calc.details?.insurance) {\n04066|         insurancePrice = calc.details.insurance;\n04067|         details.push({\n04068|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n04069|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n04070|           price: insurancePrice\n04071|         });\n04072|       }\n04073|       \n04074|       // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n04075|       details.push({\n04076|         service: '–î–æ–ø.—É—Å–ª—É–≥–∏',\n04077|         description: '–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –≥—Ä—É–∑–∞',\n04078|         price: 15\n04079|       });\n04080|       \n04081|       // –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É —Å—É–º–º–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é, –¥–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞—Ç–æ–∫\n04082|       const calculatedSum = intercityPrice + derivalPrice + arrivalPrice + packagingPrice + insurancePrice + 15;\n04083|       const remainder = basePrice - calculatedSum;\n04084|       \n04085|       if (Math.abs(remainder) > 1) { // –ï—Å–ª–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –±–æ–ª—å—à–µ 1 —Ä—É–±–ª—è\n04086|         details.push({\n04087|           service: remainder > 0 ? '–ü—Ä–æ—á–∏–µ —É—Å–ª—É–≥–∏' : '–°–∫–∏–¥–∫–∞',\n04088|           description: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–±–æ—Ä—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏',\n04089|           price: remainder\n04090|         });\n04091|       }\n04092|     } else if (calc.company === 'Nord Wheel' && calc.details) {\n04093|       // –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –¥–ª—è Nord Wheel —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º\n04094|       if (calc.details.totalCost) {\n04095|         details.push({\n04096|           service: '–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏',\n04097|           description: '',\n04098|           price: calc.details.totalCost\n04099|         });\n04100|       }\n04101|       if (calc.details.deliveryCost) {\n04102|         details.push({\n04103|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n04104|           description: '',\n04105|           price: calc.details.deliveryCost\n04106|         });\n04107|       }\n04108|       if (calc.details.terminalCost) {\n04109|         details.push({\n04110|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –º–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–≤–æ–∑–∫–∏',\n04111|           description: '',\n04112|           price: calc.details.terminalCost\n04113|         });\n04114|       }\n04115|       if (calc.details.pickupCost) {\n04116|         details.push({\n04117|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–±–æ—Ä–∞',\n04118|           description: '',\n04119|           price: calc.details.pickupCost\n04120|         });\n04121|       }\n04122|       if (calc.details.deliveryToDoorCost) {\n04123|         details.push({\n04124|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ –¥–≤–µ—Ä–∏',\n04125|           description: '',\n04126|           price: calc.details.deliveryToDoorCost\n04127|         });\n04128|       }\n04129|       if (calc.details.additionalServices && calc.details.additionalServices > 0) {\n04130|         details.push({\n04131|           service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ø.—É—Å–ª—É–≥',\n04132|           description: '',\n04133|           price: calc.details.additionalServices\n04134|         });\n04135|       }\n04136| \n04137|     } else if (calc.company === '–ü–≠–ö' && calc.details?.services) {\n04138|       // –î–ª—è –ü–≠–ö –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ API\n04139|       calc.details.services.forEach((service: any) => {\n04140|         if (service.price > 0) {\n04141|           details.push({\n04142|             service: service.name || '–£—Å–ª—É–≥–∞ –ü–≠–ö',\n04143|             description: service.description || '',\n04144|             price: service.price\n04145|           });\n04146|         }\n04147|       });\n04148|     } else if (calc.company === '–°–î–≠–ö' && calc.details) {\n04149|       const cdekServiceNames: Record<string, string> = {\n04150|         'INSURANCE': '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n04151|         'HEAVY_CARGO': '–¢—è–∂–µ–ª–æ–≤–µ—Å–Ω—ã–π –≥—Ä—É–∑',\n04152|         'DELIVERY_TO_DOOR': '–î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ –¥–≤–µ—Ä–∏',\n04153|         'PICKUP_FROM_SENDER': '–ó–∞–±–æ—Ä –æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è',\n04154|         'PACKAGE': '–£–ø–∞–∫–æ–≤–∫–∞',\n04155|         'TRYING_ON': '–ü—Ä–∏–º–µ—Ä–∫–∞ –Ω–∞ –¥–æ–º—É',\n04156|         'PART_DELIVERY': '–ß–∞—Å—Ç–∏—á–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞'\n04157|       };\n04158| \n04159|       if (calc.details.services && calc.details.services.length > 0) {\n04160|         calc.details.services.forEach((service: any) => {\n04161|           const serviceName = cdekServiceNames[service.code] || service.code || '–£—Å–ª—É–≥–∞ –°–î–≠–ö';\n04162|           const servicePrice = service.total_sum || service.sum || 0;\n04163|           \n04164|           if (servicePrice > 0) {\n04165|             details.push({\n04166|               service: serviceName,\n04167|               description: service.code === 'HEAVY_CARGO' \n04168|                 ? `–°–±–æ—Ä –∑–∞ –≥–∞–±–∞—Ä–∏—Ç–Ω—ã–π –≥—Ä—É–∑ (—Ä–∞—Å—á–µ—Ç–Ω—ã–π –≤–µ—Å: ${(calc.details.weight_calc / 1000).toFixed(0)} –∫–≥)`\n04169|                 : service.code === 'INSURANCE'\n04170|                 ? `–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${form.declaredValue?.toLocaleString() || 0} ‚ÇΩ`\n04171|                 : '',\n04172|               price: servicePrice\n04173|             });\n04174|           }\n04175|         });\n04176|         \n04177|         if (calc.details.delivery_sum && calc.details.total_sum) {\n04178|           details.push({\n04179|             service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04180|             description: '',\n04181|             price: 0\n04182|           });\n04183|           details.push({\n04184|             service: '–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏',\n04185|             description: calc.details.tariff_name || '–ü–µ—Ä–µ–≤–æ–∑–∫–∞',\n04186|             price: Math.round(calc.details.delivery_sum)\n04187|           });\n04188|           \n04189|           const additionalSum = calc.details.services.reduce((sum: number, s: any) => \n04190|             sum + (s.total_sum || s.sum || 0), 0\n04191|           );\n04192|           \n04193|           if (additionalSum > 0) {\n04194|             details.push({\n04195|               service: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏',\n04196|               description: '–î–æ–ø. —Å–±–æ—Ä—ã',\n04197|               price: Math.round(additionalSum)\n04198|             });\n04199|           }\n04200|           \n04201|           details.push({\n04202|             service: '–ò–¢–û–ì–û',\n04203|             description: '–ö –æ–ø–ª–∞—Ç–µ',\n04204|             price: Math.round(calc.details.total_sum)\n04205|           });\n04206|         }\n04207|       } else {\n04208|         details.push({\n04209|           service: '–¢–∞—Ä–∏—Ñ',\n04210|           description: calc.details.tariff_name || '–ù–µ —É–∫–∞–∑–∞–Ω',\n04211|           price: calc.price\n04212|         });\n04213|         \n04214|         if (calc.details.delivery_mode) {\n04215|           details.push({\n04216|             service: '–†–µ–∂–∏–º –¥–æ—Å—Ç–∞–≤–∫–∏',\n04217|             description: calc.details.delivery_mode,\n04218|             price: 0\n04219|           });\n04220|         }\n04221|       }\n04222|       \n04223|       if (calc.details.period_min && calc.details.period_max) {\n04224|         details.push({\n04225|           service: '–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏',\n04226|           description: `${calc.details.period_min}-${calc.details.period_max} –¥–Ω–µ–π`,\n04227|           price: 0\n04228|         });\n04229|       }\n04230|       \n04231|       if (calc.details.weight_calc) {\n04232|         details.push({\n04233|           service: '–†–∞—Å—á–µ—Ç–Ω—ã–π –≤–µ—Å',\n04234|           description: `${calc.details.weight_calc} –∫–≥`,\n04235|           price: 0\n04236|         });\n04237|       }\n04238|     } else if (calc.company === '–í–æ–∑–æ–≤–æ–∑' && calc.details?.service) {\n04239|       // ‚úÖ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –í–æ–∑–æ–≤–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ API –æ—Ç–≤–µ—Ç–∞\n04240|       const basePrice = calc.details.basePrice || 0;\n04241|       const finalPrice = calc.details.price || calc.price || 0;\n04242|       const totalDiscount = basePrice - finalPrice;\n04243|       \n04244|       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é —É—Å–ª—É–≥—É —Å –±–∞–∑–æ–≤–æ–π —Ü–µ–Ω–æ–π –∏ —Å–∫–∏–¥–∫–æ–π\n04245|       calc.details.service.forEach((service: any) => {\n04246|         const serviceDiscount = (service.basePrice || 0) - (service.price || 0);\n04247|         \n04248|         // –û—Å–Ω–æ–≤–Ω–∞—è —É—Å–ª—É–≥–∞\n04249|         details.push({\n04250|           service: service.name || '–£—Å–ª—É–≥–∞ –í–æ–∑–æ–≤–æ–∑',\n04251|           description: '',\n04252|           price: service.price || 0\n04253|         });\n04254|         \n04255|         // –°–∫–∏–¥–∫–∞ –Ω–∞ —É—Å–ª—É–≥—É (–µ—Å–ª–∏ –µ—Å—Ç—å)\n04256|         if (serviceDiscount > 0) {\n04257|           details.push({\n04258|             service: `–°–∫–∏–¥–∫–∞ –Ω–∞ ${service.name?.toLowerCase() || '—É—Å–ª—É–≥—É'}`,\n04259|             description: `${(service.basePrice || 0).toLocaleString()} - ${(service.price || 0).toLocaleString()}`,\n04260|             price: -serviceDiscount\n04261|           });\n04262|         }\n04263|       });\n04264|       \n04265|       // –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –æ–±—â–∏–º–∏ —Å–∫–∏–¥–∫–∞–º–∏\n04266|       if (totalDiscount > 0) {\n04267|         details.push({\n04268|           service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04269|           description: '',\n04270|           price: 0\n04271|         });\n04272|         details.push({\n04273|           service: '–ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å',\n04274|           description: '–î–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–¥–æ–∫',\n04275|           price: basePrice\n04276|         });\n04277|         details.push({\n04278|           service: '–û–±—â–∏–µ —Å–∫–∏–¥–∫–∏',\n04279|           description: `–≠–∫–æ–Ω–æ–º–∏—è ${totalDiscount.toLocaleString()} ‚ÇΩ`,\n04280|           price: -totalDiscount\n04281|         });\n04282|         details.push({\n04283|           service: '–ò–¢–û–ì–û',\n04284|           description: '–ö –æ–ø–ª–∞—Ç–µ',\n04285|           price: finalPrice\n04286|         });\n04287|       }\n04288|     } else if (calc.company === '–ö–ò–¢' && calc.details?.services) {\n04289|       calc.details.services.forEach((service: any) => {\n04290|         details.push({\n04291|           service: service.name || '–£—Å–ª—É–≥–∞ –ö–ò–¢',\n04292|           description: service.code || '',\n04293|           price: service.price || 0\n04294|         });\n04295|       });\n04296|       \n04297|       if (calc.details.tariff_name) {\n04298|         details.push({\n04299|           service: '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ',\n04300|           description: '',\n04301|           price: 0\n04302|         });\n04303|         details.push({\n04304|           service: '–¢–∞—Ä–∏—Ñ',\n04305|           description: calc.details.tariff_name,\n04306|           price: 0\n04307|         });\n04308|         details.push({\n04309|           service: '–ò–¢–û–ì–û',\n04310|           description: calc.details.currency || 'RUB',\n04311|           price: calc.price\n04312|         });\n04313|       }\n04314|     } else {\n04315|       // –î–ª—è –¥—Ä—É–≥–∏—Ö –¢–ö - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n04316|       details.push({\n04317|         service: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n04318|         description: `${form.fromCity} - ${form.toCity}`,\n04319|         price: calc.price\n04320|       });\n04321|       \n04322|       if (form.needInsurance && form.declaredValue > 0) {\n04323|         details.push({\n04324|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n04325|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n04326|           price: Math.round(form.declaredValue * 0.02)\n04327|         });\n04328|       }\n04329|       \n04330|       if (form.needPackaging) {\n04331|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n04332|         details.push({\n04333|           service: '–£–ø–∞–∫–æ–≤–∫–∞',\n04334|           description: '',\n04335|           price: Math.round(totalWeight * 30)\n04336|         });\n04337|       }\n04338|     }\n04339|     \n04340|     return details;\n04341|   } catch (globalError) {\n04342|     console.error('‚ùå –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –û–®–ò–ë–ö–ê –≤ parseCalculationDetails:', globalError);\n04343|     console.error('‚ùå –°—Ç–µ–∫ –æ—à–∏–±–∫–∏:', globalError instanceof Error ? globalError.stack : '–ù–µ—Ç —Å—Ç–µ–∫–∞');\n04344|     console.log('‚ùå calc object:', calc);\n04345|     // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ\n04346|     return [{\n04347|       service: '–î–æ—Å—Ç–∞–≤–∫–∞',\n04348|       description: '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞',\n04349|       price: calc?.price || 0\n04350|     }];\n04351|   }\n04352| };\n04353| \n04354|   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏)\n04355|   if (!isLoaded) {\n04356|     return (\n04357|       <div className=\"min-h-screen bg-gray-900 text-white p-4 relative flex items-center justify-center\">\n04358|         <div className=\"text-center\">\n04359|           <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mx-auto mb-4\"></div>\n04360|           <p className=\"text-blue-400\">–ó–∞–≥—Ä—É–∑–∫–∞...</p>\n04361|         </div>\n04362|       </div>\n04363|     );\n04364|   }\n04365| \n04366|   return (\n04367|     <div className=\"min-h-screen bg-gray-900 text-white p-4 relative\">\n04368|       <div className=\"max-w-7xl mx-auto\">\n04369|         <div className=\"flex items-center justify-between mb-3\">\n04370|           <h1 className=\"text-xl font-bold text-blue-400\">\n04371|             –ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞ –õ–∞–≤—Å–∏—Ç\n04372|           </h1>\n04373|           \n04374|           {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */}\n04375|           <div className=\"flex items-center gap-4\">\n04376|             {isFormChanged ? (\n04377|               <div className=\"flex items-center gap-2 text-yellow-400 text-sm\">\n04378|                 <div className=\"w-2 h-2 bg-yellow-400 rounded-full animate-pulse\"></div>\n04379|                 –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...\n04380|               </div>\n04381|             ) : lastSaveTime ? (\n04382|               <div className=\"flex items-center gap-2 text-green-400 text-sm\">\n04383|                 <div className=\"w-2 h-2 bg-green-400 rounded-full\"></div>\n04384|                 –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ {lastSaveTime.toLocaleTimeString()}\n04385|               </div>\n04386|             ) : hasStoredFormData() ? (\n04387|               <div className=\"flex items-center gap-2 text-blue-400 text-sm\">\n04388|                 <div className=\"w-2 h-2 bg-blue-400 rounded-full\"></div>\n04389|                 –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã\n04390|               </div>\n04391|             ) : null}\n04392|             \n04393|             {/* –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö */}\n04394|             {hasStoredFormData() && (\n04395|               <Button\n04396|                 onClick={() => {\n04397|                   if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã?')) {\n04398|                     clearFormData();\n04399|                     setForm(initialFormState);\n04400|                     setLastSaveTime(null);\n04401|                     setIsFormChanged(false);\n04402|                   }\n04403|                 }}\n04404|                 variant=\"outline\"\n04405|                 size=\"sm\"\n04406|                 className=\"border-red-500 text-red-400 hover:bg-red-900/20\"\n04407|               >\n04408|                 <Trash2 className=\"h-3 w-3 mr-1\" />\n04409|                 –û—á–∏—Å—Ç–∏—Ç—å\n04410|               </Button>\n04411|             )}\n04412|           </div>\n04413|         </div>\n04414|         \n04415|         {/* –ö–Ω–æ–ø–∫–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ */}\n04416|         <div className=\"flex justify-end gap-2 mb-4\">\n04417|           <Button \n04418|             onClick={() => window.open('/diagnostic?tab=api', '_blank')}\n04419|             variant=\"outline\" \n04420|             className=\"border-green-500 text-green-400 hover:bg-green-900/20\"\n04421|           >\n04422|             <Settings className=\"h-4 w-4 mr-2\" />\n04423|             –í—Å–µ API\n04424|           </Button>\n04425|           <Button \n04426|             onClick={() => window.open('/diagnostic?tab=docs', '_blank')}\n04427|             variant=\"outline\" \n04428|             className=\"border-purple-500 text-purple-400 hover:bg-purple-900/20\"\n04429|           >\n04430|             <Package2 className=\"h-4 w-4 mr-2\" />\n04431|             –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è\n04432|           </Button>\n04433|           <Button \n04434|             onClick={() => window.open('/diagnostic', '_blank')}\n04435|             variant=\"outline\" \n04436|             className=\"border-blue-500 text-blue-400 hover:bg-blue-900/20\"\n04437|           >\n04438|             <Settings className=\"h-4 w-4 mr-2\" />\n04439|             –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\n04440|           </Button>\n04441|         </div>\n04442|         \n04443|         <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3 h-[85vh]\">\n04444|           {/* –õ–µ–≤–∞—è —á–∞—Å—Ç—å - —Ñ–æ—Ä–º–∞ */}\n04445|           <div className=\"space-y-2 overflow-y-auto pr-2\">\n04446|             {/* –ö–∞—Ç–∞–ª–æ–≥ –º–µ–±–µ–ª–∏ */}\n04447|             <Card className=\"bg-gray-800 border-gray-700\">\n04448|               <CardHeader className=\"pb-2\">\n04449|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04450|                   <Package2 className=\"h-3 w-3\" />\n04451|                   –ö–∞—Ç–∞–ª–æ–≥ –º–µ–±–µ–ª–∏\n04452|                 </CardTitle>\n04453|               </CardHeader>\n04454|               <CardContent className=\"space-y-2\">\n04455|                 {/* –ü–æ–∏—Å–∫ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ */}\n04456|                 <ProductSearch \n04457|                   onProductAdd={handleProductAdd}\n04458|                   disabled={calculating}\n04459|                 />\n04460|                 \n04461|                 {/* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ */}\n04462|                 <ProductManager\n04463|                   products={form.selectedProducts}\n04464|                   onQuantityChange={handleProductQuantityChange}\n04465|                   onProductRemove={handleProductRemove}\n04466|                   disabled={calculating}\n04467|                 />\n04468|               </CardContent>\n04469|             </Card>\n04470| \n04471|             {/* –ì—Ä—É–∑—ã */}\n04472|             <Card className=\"bg-gray-800 border-gray-700\">\n04473|               <CardHeader className=\"pb-2\">\n04474|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04475|                   <Truck className=\"h-3 w-3\" />\n04476|                   –ì—Ä—É–∑—ã\n04477|                 </CardTitle>\n04478|               </CardHeader>\n04479|               <CardContent className=\"space-y-2\">\n04480|                 {groupCargosForDisplay(form.cargos).map((group, groupIndex) => (\n04481|                    <div key={`group_${groupIndex}`} className=\"border border-gray-600 rounded p-2\">\n04482|                     <div className=\"flex justify-between items-center mb-2\">\n04483|                       <h4 className=\"text-sm font-medium text-white\">\n04484|                         {group.isEmpty ? (\n04485|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1}`\n04486|                         ) : group.quantity === 1 ? (\n04487|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1}`\n04488|                         ) : (\n04489|                           `–ì—Ä—É–∑ ‚Ññ${group.indices[0] + 1} - ${group.quantity} –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –º–µ—Å—Ç–∞`\n04490|                         )}\n04491|                       </h4>\n04492|                       {form.cargos.length > 1 && group.quantity === 1 && (\n04493|                         <Button\n04494|                           variant=\"destructive\"\n04495|                           size=\"sm\"\n04496|                           onClick={() => removeCargo(form.cargos[group.indices[0]].id)}\n04497|                           className=\"h-6 text-xs\"\n04498|                         >\n04499|                           –£–¥–∞–ª–∏—Ç—å\n04500|                         </Button>\n04501|                       )}\n04502|                       {group.quantity > 1 && (\n04503|                         <Badge variant=\"secondary\" className=\"text-xs\">\n04504|                           {group.quantity} —à—Ç.\n04505|                         </Badge>\n04506|                       )}\n04507|                     </div>\n04508|                     \n04509|                     {group.isEmpty || group.quantity === 1 ? (\n04510|                       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞ –¥–ª—è –ø—É—Å—Ç—ã—Ö –≥—Ä—É–∑–æ–≤ –∏–ª–∏ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö\n04511|                       <div className=\"grid grid-cols-2 gap-2\">\n04512|                         <div>\n04513|                           <Label className=\"text-white text-xs\">–î–ª–∏–Ω–∞ (—Å–º)</Label>\n04514|                           <Input\n04515|                             type=\"number\"\n04516|                             value={form.cargos[group.indices[0]].length || ''}\n04517|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'length', Number(e.target.value))}\n04518|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04519|                           />\n04520|                         </div>\n04521|                         <div>\n04522|                           <Label className=\"text-white text-xs\">–®–∏—Ä–∏–Ω–∞ (—Å–º)</Label>\n04523|                           <Input\n04524|                             type=\"number\"\n04525|                             value={form.cargos[group.indices[0]].width || ''}\n04526|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'width', Number(e.target.value))}\n04527|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04528|                           />\n04529|                         </div>\n04530|                         <div>\n04531|                           <Label className=\"text-white text-xs\">–í—ã—Å–æ—Ç–∞ (—Å–º)</Label>\n04532|                           <Input\n04533|                             type=\"number\"\n04534|                             value={form.cargos[group.indices[0]].height || ''}\n04535|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'height', Number(e.target.value))}\n04536|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04537|                           />\n04538|                         </div>\n04539|                         <div>\n04540|                           <Label className=\"text-white text-xs\">–í–µ—Å (–∫–≥)</Label>\n04541|                           <Input\n04542|                             type=\"number\"\n04543|                             value={form.cargos[group.indices[0]].weight || ''}\n04544|                             onChange={(e) => updateCargo(form.cargos[group.indices[0]].id, 'weight', Number(e.target.value))}\n04545|                             className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n04546|                           />\n04547|                         </div>\n04548|                       </div>\n04549|                     ) : (\n04550|                       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –≥—Ä—É–ø–ø\n04551|                       <div className=\"grid grid-cols-2 gap-2 text-sm text-gray-300\">\n04552|                         <div>–î–ª–∏–Ω–∞: {group.length} —Å–º</div>\n04553|                         <div>–®–∏—Ä–∏–Ω–∞: {group.width} —Å–º</div>\n04554|                         <div>–í—ã—Å–æ—Ç–∞: {group.height} —Å–º</div>\n04555|                         <div>–í–µ—Å: {group.weight} –∫–≥</div>\n04556|                         <div className=\"col-span-2 text-xs text-blue-300 mt-1\">\n04557|                           –û–±—â–∏–π –≤–µ—Å: {(group.weight * group.quantity).toFixed(1)} –∫–≥, \n04558|                           –æ–±—ä–µ–º: {((group.length * group.width * group.height * group.quantity) / 1000000).toFixed(3)} –º¬≥\n04559|                         </div>\n04560|                       </div>\n04561|                     )}\n04562|                   </div>\n04563|                 ))}\n04564|                  <Button onClick={addCargo} className=\"w-full h-7 text-xs\" variant=\"outline\">\n04565|                   <Plus className=\"h-3 w-3 mr-1\" />\n04566|                   –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑\n04567|                 </Button>\n04568|               </CardContent>\n04569|             </Card>\n04570| \n04571|             {/* –ú–∞—Ä—à—Ä—É—Ç */}\n04572|             <Card className=\"bg-gray-800 border-gray-700\">\n04573|               <CardHeader className=\"pb-2\">\n04574|                 <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n04575|                   <Map className=\"h-3 w-3\" />\n04576|                   –ú–∞—Ä—à—Ä—É—Ç\n04577|                 </CardTitle>\n04578|               </CardHeader>\n04579|               <CardContent className=\"space-y-2\">\n04580|                 {/* –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */}\n04581|                 <div className=\"space-y-2\">\n04582|                   <Label className=\"text-sm font-medium text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</Label>\n04583|                   <div className=\"flex gap-3 flex-wrap\">\n04584|                     <label className=\"flex items-center space-x-1\">\n04585|                       <input\n04586|                         type=\"radio\"\n04587|                         name=\"fromDelivery\"\n04588|                         checked={form.fromTerminal}\n04589|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: true, fromAddressDelivery: false, fromLavsiteWarehouse: false }))}\n04590|                       />\n04591|                       <span className=\"text-white text-xs\">–û—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n04592|                     </label>\n04593|                     <label className=\"flex items-center space-x-1\">\n04594|                       <input\n04595|                         type=\"radio\"\n04596|                         name=\"fromDelivery\"\n04597|                         checked={form.fromAddressDelivery && !form.fromLavsiteWarehouse}\n04598|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: false, fromAddressDelivery: true, fromLavsiteWarehouse: false }))}\n04599|                       />\n04600|                       <span className=\"text-white text-xs\">–û—Ç –∞–¥—Ä–µ—Å–∞</span>\n04601|                     </label>\n04602|                     <label className=\"flex items-center space-x-1\">\n04603|                       <Checkbox\n04604|                         id=\"lavsiteWarehouse\"\n04605|                         checked={form.fromLavsiteWarehouse}\n04606|                         onCheckedChange={handleLavsiteWarehouseChange}\n04607|                       />\n04608|                       <span className=\"text-white text-xs cursor-pointer\">–°–æ —Å–∫–ª–∞–¥–∞ –õ–∞–≤—Å–∏—Ç</span>\n04609|                     </label>\n04610|                   </div>\n04611|                   \n04612|                   <div>\n04613|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n04614|                     <Input\n04615|                       value={form.fromCity}\n04616|                       onChange={(e) => !form.fromLavsiteWarehouse && handleAddressChange('fromCity', e.target.value, e.target)}\n04617|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n04618|                       disabled={form.fromLavsiteWarehouse}\n04619|                       className={`bg-gray-700 border-gray-600 h-7 text-white text-xs ${form.fromLavsiteWarehouse ? 'opacity-50 cursor-not-allowed' : ''}`}\n04620|                     />\n04621|                   </div>\n04622|                   \n04623|                   {form.fromAddressDelivery && (\n04624|                     <div>\n04625|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n04626|                       <Input\n04627|                         value={form.fromAddress}\n04628|                         onChange={(e) => !form.fromLavsiteWarehouse && handleAddressChange('fromAddress', e.target.value, e.target)}\n04629|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n04630|                         disabled={form.fromLavsiteWarehouse}\n04631|                         className={`bg-gray-700 border-gray-600 h-7 text-white text-xs ${form.fromLavsiteWarehouse ? 'opacity-50 cursor-not-allowed' : ''}`}\n04632|                       />\n04633|                     </div>\n04634|                   )}\n04635|                 </div>\n04636| \n04637|                 {/* –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ */}\n04638|                 <div className=\"space-y-2\">\n04639|                   <Label className=\"text-sm font-medium text-white\">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</Label>\n04640|                   <div className=\"flex gap-3 flex-wrap\">\n04641|                     <label className=\"flex items-center space-x-1\">\n04642|                       <input\n04643|                         type=\"radio\"\n04644|                         name=\"toDelivery\"\n04645|                         checked={form.toTerminal}\n04646|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: true, toAddressDelivery: false }))}\n04647|                       />\n04648|                       <span className=\"text-white text-xs\">–î–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n04649|                     </label>\n04650|                     <label className=\"flex items-center space-x-1\">\n04651|                       <input\n04652|                         type=\"radio\"\n04653|                         name=\"toDelivery\"\n04654|                         checked={form.toAddressDelivery}\n04655|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: false, toAddressDelivery: true }))}\n04656|                       />\n04657|                       <span className=\"text-white text-xs\">–î–æ –∞–¥—Ä–µ—Å–∞</span>\n04658|                     </label>\n04659|                   </div>\n04660|                   \n04661|                   <div>\n04662|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</Label>\n04663|                     <Input\n04664|                       value={form.toCity}\n04665|                       onChange={(e) => handleAddressChange('toCity', e.target.value, e.target)}\n04666|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n04667|                       className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04668|                     />\n04669|                   </div>\n04670|                   \n04671|                   {form.toAddressDelivery && (\n04672|                     <div>\n04673|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</Label>\n04674|                       <Input\n04675|                         value={form.toAddress}\n04676|                         onChange={(e) => handleAddressChange('toAddress', e.target.value, e.target)}\n04677|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n04678|                         className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04679|                       />\n04680|                     </div>\n04681|                   )}\n04682|                 </div>\n04683| \n04684|                 <div>\n04685|                   <Label className=\"text-white text-xs\">–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)</Label>\n04686|                   <Input\n04687|                     type=\"number\"\n04688|                     value={form.declaredValue || ''}\n04689|                     onChange={(e) => setForm(prev => ({ ...prev, declaredValue: Number(e.target.value) }))}\n04690|                     className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04691|                   />\n04692|                 </div>\n04693|                 \n04694|                 <div className=\"space-y-2\">\n04695|                   <div className=\"flex items-center space-x-2\">\n04696|                     <Checkbox\n04697|                       id=\"packaging\"\n04698|                       checked={form.needPackaging}\n04699|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needPackaging: checked as boolean }))}\n04700|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04701|                     />\n04702|                     <Label htmlFor=\"packaging\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø–∞–∫–æ–≤–∫–∞</Label>\n04703|                   </div>\n04704|                   \n04705|                   <div className=\"flex items-center space-x-2\">\n04706|                     <Checkbox\n04707|                       id=\"insurance\"\n04708|                       checked={form.needInsurance}\n04709|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needInsurance: checked as boolean }))}\n04710|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04711|                     />\n04712|                     <Label htmlFor=\"insurance\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</Label>\n04713|                   </div>\n04714|                   \n04715|                   <div className=\"flex items-center space-x-2\">\n04716|                     <Checkbox\n04717|                       id=\"loading\"\n04718|                       checked={form.needLoading}\n04719|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needLoading: checked as boolean }))}\n04720|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04721|                     />\n04722|                     <Label htmlFor=\"loading\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≥—Ä—É–∑–∫–∞/—Ä–∞–∑–≥—Ä—É–∑–∫–∞</Label>\n04723|                   </div>\n04724|                   \n04725|                   <div className=\"flex items-center space-x-2\">\n04726|                     <Checkbox\n04727|                       id=\"carry\"\n04728|                       checked={form.needCarry}\n04729|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needCarry: checked as boolean }))}\n04730|                       className=\"border-white data-[state=checked]:bg-white data-[state=checked]:text-black\"\n04731|                     />\n04732|                     <Label htmlFor=\"carry\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—ä–µ–º</Label>\n04733|                   </div>\n04734|                   \n04735|                   {form.needCarry && (\n04736|                     <div className=\"ml-6 space-y-2 border-l-2 border-gray-600 pl-3\">\n04737|                       <div>\n04738|                         <Label className=\"text-white text-xs\">–≠—Ç–∞–∂</Label>\n04739|                         <Input\n04740|                           type=\"number\"\n04741|                           value={form.floor}\n04742|                           onChange={(e) => setForm(prev => ({ ...prev, floor: Number(e.target.value) }))}\n04743|                           className=\"bg-gray-700 border-gray-600 h-7 text-white text-xs\"\n04744|                         />\n04745|                       </div>\n04746|                       <div className=\"flex items-center space-x-2\">\n04747|                         <Checkbox\n04748|                           id=\"freightLift\"\n04749|                           checked={form.hasFreightLift}\n04750|                           onCheckedChange={(checked) => setForm(prev => ({ ...prev, hasFreightLift: checked as boolean }))}\n04751|                         />\n04752|                         <Label htmlFor=\"freightLift\" className=\"text-white text-xs\">–ù–∞–ª–∏—á–∏–µ –≥—Ä—É–∑–æ–≤–æ–≥–æ –ª–∏—Ñ—Ç–∞</Label>\n04753|                       </div>\n04754|                     </div>\n04755|                   )}\n04756|                 </div>\n04757|                 \n04758|                 <div className=\"space-y-2\">\n04759|                   <Button \n04760|                     onClick={handleCalculate} \n04761|                     className=\"w-full bg-blue-600 hover:bg-blue-700 h-7 text-xs\" \n04762|                     disabled={calculating}\n04763|                   >\n04764|                     {calculating ? '–†–∞—Å—á–µ—Ç...' : '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å'}\n04765|                   </Button>\n04766|                   \n04767|                   <Button \n04768|                     onClick={handleReset} \n04769|                     variant=\"outline\" \n04770|                     className=\"w-full h-7 text-xs text-black border-gray-600 hover:bg-gray-700 hover:text-white\" \n04771|                     disabled={calculating}\n04772|                   >\n04773|                     –°–±—Ä–æ—Å–∏—Ç—å —Ä–∞—Å—á–µ—Ç\n04774|                   </Button>\n04775|                 </div>\n04776|               </CardContent>\n04777|             </Card>\n04778|           </div>\n04779| \n04780|           {/* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã */}\n04781|           <div className=\"space-y-2 overflow-y-auto\">\n04782|             {calculations.length > 0 && (\n04783|                  <div className=\"space-y-2\">\n04784|                 <div className=\"flex justify-between items-center\">\n04785|                   <h2 className=\"text-lg font-bold text-blue-400\">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>\n04786|                   <Button \n04787|                     onClick={exportToPDF} \n04788|                     variant=\"outline\" \n04789|                     size=\"sm\" \n04790|                     className=\"h-7 text-xs border-blue-500 text-blue-400 hover:bg-blue-900/20 print:hidden\"\n04791|                   >\n04792|                     –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF\n04793|                   </Button>\n04794|                 </div>\n04795|                 \n04796|                 {calculations.map((calc, index) => (\n04797|                    <Card key={index} className=\"bg-gray-800 border-gray-700 text-xs\">\n04798|                      <CardHeader className=\"pb-1\">\n04799|                       <div className=\"flex justify-between items-center\">\n04800|                          <CardTitle className=\"text-white flex items-center gap-2 text-xs\">\n04801|                            <Building2 className=\"h-3 w-3\" />\n04802|                           {calc.company}\n04803|                         </CardTitle>\n04804|                         {calc.error ? (\n04805|                           <Badge variant=\"destructive\" className=\"text-xs\">–û—à–∏–±–∫–∞</Badge>\n04806|                         ) : (\n04807|                           <Badge variant=\"default\" className=\"bg-green-600 text-xs\">\n04808|                             {calc.price.toLocaleString()} ‚ÇΩ\n04809|                           </Badge>\n04810|                         )}\n04811|                       </div>\n04812|                     </CardHeader>\n04813|                     <CardContent className=\"pt-0\">\n04814|                       <div className=\"space-y-2\">\n04815|                         {calc.error ? (\n04816|                           <div className=\"space-y-2\">\n04817|                             <Alert className=\"border-red-600\">\n04818|                               <AlertDescription className=\"text-white text-xs\">{calc.error}</AlertDescription>\n04819|                             </Alert>\n04820|                             {calc.price > 0 && (\n04821|                               <>\n04822|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n04823|                                 <p className=\"text-white text-xs\"><strong>–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ä–æ–∫:</strong> {calc.days} –¥–Ω–µ–π</p>\n04824|                               </>\n04825|                             )}\n04826|                           </div>\n04827|                         ) : (\n04828|                           <>\n04829|                             <p className=\"text-white text-xs\"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n04830|                             <p className=\"text-white text-xs\"><strong>–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {calc.days} –¥–Ω–µ–π</p>\n04831|                           </>\n04832|                         )}\n04833|                         \n04834|                         <div className=\"flex gap-2 mt-2\">\n04835|                           {!calc.error && (\n04836|                             <Button\n04837|                               variant=\"outline\"\n04838|                               size=\"sm\"\n04839|                               onClick={() => toggleDetails(calc.company)}\n04840|                               className=\"h-6 text-xs\"\n04841|                             >\n04842|                               {expandedDetails[calc.company] ? '–°–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ' : '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ'}\n04843|                             </Button>\n04844|                           )}\n04845|                           <Button\n04846|                             variant=\"outline\"\n04847|                             size=\"sm\"\n04848|                             onClick={() => toggleDebugInfo(calc.company)}\n04849|                             className=\"h-6 text-xs\"\n04850|                           >\n04851|                             {expandedDebugInfo[calc.company] ? '–°–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–∫—É' : '–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}\n04852|                           </Button>\n04853|                         </div>\n04854|                         \n04855|                         {/* –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ */}\n04856|                         {!calc.error && (\n04857|                           <Collapsible open={expandedDetails[calc.company]}>\n04858|                             <CollapsibleContent className=\"mt-2\">\n04859|                               <div className=\"bg-gray-900 p-3 rounded text-xs\">\n04860|                                 <h4 className=\"font-bold mb-2 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞:</h4>\n04861|                                 {(() => {\n04862|                                   const details = parseCalculationDetails(calc);\n04863|                                   const totalPrice = details.reduce((sum, detail) => sum + detail.price, 0);\n04864|                                   \n04865|                                   return (\n04866|                                     <div className=\"space-y-1\">\n04867|                                       {details.map((detail, idx) => (\n04868|                                         <div key={idx} className=\"flex justify-between text-white\">\n04869|                                           <div>\n04870|                                             <div className=\"font-medium\">{detail.service}</div>\n04871|                                             {detail.description && (\n04872|                                               <div className=\"text-gray-400 text-xs\">{detail.description}</div>\n04873|                                             )}\n04874|                                           </div>\n04875|                                           <div className=\"font-medium\">{detail.price.toLocaleString()} ‚ÇΩ</div>\n04876|                                         </div>\n04877|                                       ))}\n04878|                                     </div>\n04879|                                   );\n04880|                                 })()}\n04881|                               </div>\n04882|                             </CollapsibleContent>\n04883|                           </Collapsible>\n04884|                         )}\n04885|                         \n04886|                         {/* –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è - –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ */}\n04887|                         <Collapsible open={expandedDebugInfo[calc.company]}>\n04888|                           <CollapsibleContent className=\"mt-2\">\n04889|                             <div className=\"bg-gray-900 p-3 rounded text-xs\">\n04890|                               <h4 className=\"font-bold mb-2 text-white\">–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>\n04891|                               \n04892|                               {calc.apiUrl && (\n04893|                                 <div className=\"mb-3\">\n04894|                                   <h5 className=\"font-bold mb-1 text-white\">–ó–∞–ø—Ä–æ—Å –∫ API:</h5>\n04895|                                   <p className=\"text-gray-300 break-all text-xs\">URL: {calc.apiUrl}</p>\n04896|                                 </div>\n04897|                               )}\n04898|                               \n04899|                               {calc.sessionId && (\n04900|                                 <div className=\"mb-3\">\n04901|                                   <h5 className=\"font-bold mb-1 text-white\">Session ID:</h5>\n04902|                                   <p className=\"text-gray-300 text-xs\">{calc.sessionId}</p>\n04903|                                 </div>\n04904|                               )}\n04905|                               \n04906|                               {calc.requestData && (\n04907|                                 <div className=\"mb-3\">\n04908|                                   <h5 className=\"font-bold mb-1 text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:</h5>\n04909|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04910|                                     {JSON.stringify(calc.requestData, null, 2)}\n04911|                                   </pre>\n04912|                                 </div>\n04913|                               )}\n04914|                               \n04915|                               {calc.responseData && (\n04916|                                 <div className=\"mb-3\">\n04917|                                   <h5 className=\"font-bold mb-1 text-white\">–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:</h5>\n04918|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04919|                                     {JSON.stringify(calc.responseData, null, 2)}\n04920|                                   </pre>\n04921|                                 </div>\n04922|                               )}\n04923|                               \n04924|                               {calc.details && (\n04925|                                 <div className=\"mb-3\">\n04926|                                   <h5 className=\"font-bold mb-1 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ (JSON):</h5>\n04927|                                   <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n04928|                                     {JSON.stringify(calc.details, null, 2)}\n04929|                                   </pre>\n04930|                                 </div>\n04931|                               )}\n04932|                               \n04933|                               {calc.error && (\n04934|                                 <div className=\"mb-3\">\n04935|                                   <h5 className=\"font-bold mb-1 text-red-400\">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ:</h5>\n04936|                                   <p className=\"text-red-300 text-xs\">{calc.error}</p>\n04937|                                 </div>\n04938|                               )}\n04939|                             </div>\n04940|                           </CollapsibleContent>\n04941|                         </Collapsible>\n04942|                       </div>\n04943|                     </CardContent>\n04944|                   </Card>\n04945|                 ))}\n04946|               </div>\n04947|             )}\n04948| \n04949|             {/* –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –¢–ö - –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º—ã–π */}\n04950|             <Card className=\"bg-gray-800 border-gray-700\">\n04951|               <CardHeader className=\"pb-2\">\n04952|                 <CardTitle className=\"text-white text-sm\">\n04953|                   –ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ ({COMPANIES_BASE.length})\n04954|                 </CardTitle>\n04955|               </CardHeader>\n04956|               <CardContent>\n04957|                 <div className=\"grid grid-cols-2 gap-2\">\n04958|                   {COMPANIES_BASE.map((company, index) => {\n04959|                     const isConnected = apiStatus[company.apiKey as keyof typeof apiStatus] === '–ø–æ–¥–∫–ª—é—á–µ–Ω–æ';\n04960|                     const statusText = apiStatus[company.apiKey as keyof typeof apiStatus];\n04961|                     const isEnabled = enabledCompanies[company.apiKey];\n04962|                     \n04963|                     // –û—Ç–ª–∞–¥–∫–∞ –¥–ª—è –ø–µ—Ä–≤—ã—Ö 3 –∫–æ–º–ø–∞–Ω–∏–π\n04964|                     if (index < 3) {\n04965|                       console.log(`üîç –ö–æ–º–ø–∞–Ω–∏—è ${index}: ${company.name}, apiKey: ${company.apiKey}, isEnabled: ${isEnabled}, statusText: ${statusText}`);\n04966|                     }\n04967|                     \n04968|                     return (\n04969|                       <div key={index} className=\"flex items-center justify-between p-1.5 bg-gray-700 rounded\">\n04970|                         <div className=\"flex items-center gap-2\">\n04971|                           <span className=\"text-lg\">{company.logo}</span>\n04972|                           <div>\n04973|                             <p className=\"font-medium text-white text-[10px] leading-tight\">{company.name}</p>\n04974|                             <Badge \n04975|                               variant={isConnected ? \"default\" : \"destructive\"} \n04976|                               className=\"text-[9px] py-0 px-1\"\n04977|                             >\n04978|                               {isConnected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∞' : statusText === '–ø—Ä–æ–≤–µ—Ä–∫–∞...' ? '–ü—Ä–æ–≤–µ—Ä–∫–∞...' : '–û—à–∏–±–∫–∞'}\n04979|                             </Badge>\n04980|                           </div>\n04981|                         </div>\n04982|                         <div className=\"flex items-center gap-2\">\n04983|                           <span className=\"text-[9px] text-gray-300\">\n04984|                             {isEnabled ? '–í–∫–ª' : '–í—ã–∫–ª'}\n04985|                           </span>\n04986|                           <Switch\n04987|                             checked={isEnabled}\n04988|                             onCheckedChange={(checked) => {\n04989|                               setEnabledCompanies(prev => ({\n04990|                                 ...prev,\n04991|                                 [company.apiKey]: checked\n04992|                               }));\n04993|                             }}\n04994|                             disabled={!isConnected}\n04995|                           />\n04996|                         </div>\n04997|                       </div>\n04998|                     );\n04999|                   })}\n05000|                 </div>\n05001|               </CardContent>\n05002|             </Card>\n05003| \n05004|             {/* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫—É–∑–æ–≤–∞ */}\n05005|             {calculations.length > 0 && (\n05006|               <TruckVisualization \n05007|                 cargos={form.cargos.map(cargo => ({\n05008|                   id: cargo.id,\n05009|                   length: cargo.length * 10, // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n05010|                   width: cargo.width * 10,   // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n05011|                   height: cargo.height * 10, // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å–º –≤ –º–º\n05012|                   weight: cargo.weight,\n05013|                   productName: form.selectedProducts?.find(p => \n05014|                     p.cargoIndexes.includes(form.cargos.indexOf(cargo))\n05015|                   )?.product.name\n05016|                 }))}\n05017|                 isVisible={true}\n05018|               />\n05019|             )}\n05020|           </div>\n05021|         </div>\n05022|       </div>\n05023| \n05024|       {/* –ê–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∏ */}\n05025|       {showSuggestions && suggestions.length > 0 && (\n05026|         <div \n05027|           className=\"fixed z-50 bg-gray-800 border border-gray-700 rounded-md shadow-lg max-w-sm w-full max-h-60 overflow-y-auto\"\n05028|           style={{\n05029|             top: suggestionPosition.top,\n05030|             left: suggestionPosition.left\n05031|           }}\n05032|         >\n05033|           <div className=\"p-1\">\n05034|             {suggestions.map((suggestion, index) => (\n05035|               <div\n05036|                 key={index}\n05037|                 className=\"p-2 hover:bg-gray-700 cursor-pointer text-xs text-white rounded transition-colors\"\n05038|                 onClick={() => selectSuggestion(suggestion)}\n05039|               >\n05040|                 {suggestion.value}\n05041|               </div>\n05042|             ))}\n05043|           </div>\n05044|         </div>\n05045|       )}\n05046|     </div>\n05047|   );\n05048| }\n</file>",
    "title": "app/page.tsx",
    "metadata": {
      "preview": "    const apiUrl = 'https://api.nordw.orog.ru/api/v1/calculate';\n    \n    try {\n      // üîß –í–∞–ª–∏–¥–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      validateMultipleCargos(form.cargos);\n      \n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n\n      // üîß –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç –≥–∞–±–∞—Ä–∏—Ç–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      const maxLength = Math.max(...form.cargos.map(c => c.length));\n      const maxWidth = Math.max(...form.cargos.map(c => c.width));\n      const maxHeight = Math.max(...form.cargos.map(c => c.height));\n      \n      // üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç\n      console.log('üåê Nord Wheel: –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤—ã—Ö –º–µ—Å—Ç:');\n      console.log(`   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç: ${form.cargos.length}`);\n      console.log(`   - –û–±—â–∏–π –≤–µ—Å: ${totalWeight} –∫–≥`);"
    },
    "time": {
      "start": 1763466844536,
      "end": 1763466844542,
      "compacted": 1763467112180
    }
  }
}