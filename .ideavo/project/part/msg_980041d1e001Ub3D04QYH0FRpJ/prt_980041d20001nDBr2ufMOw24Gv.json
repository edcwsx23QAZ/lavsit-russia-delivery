{
  "id": "prt_980041d20001nDBr2ufMOw24Gv",
  "type": "text",
  "text": "Добавь вкладку отладочная информация даже для ТК у которых выпадает ошибка.\n\nДля ПЭК:\n1) Используй ссылку для формирования запроса: Ссылка для формирования запроса на расчет: http://calc.pecom.ru/bitrix/components/pecom/calc/ajax.php. Параметры передаются через GET-запрос.\n2) Используй Ссылка для запроса списка городов: https://pecom.ru/ru/calc/towns.php\nИспользуй публичный API. Публичный API не требует регистрации в личном кабинете «ПЭК». Не нужно получать API-ключ и проходить авторизацию. Достаточно только передать все необходимые параметры (откуда, куда, параметры груза) через GET-запрос и получить стоимость.\n\nПолучение списка городов доставки\nСсылка для запроса списка городов: https://pecom.ru/ru/calc/towns.php. Формат возвращаемого результата:\n{\n         ‘название региона1’: {\n                   id Города1: ‘Название Города1’,\n                   id Города2: ‘Название Города2’,\n                   id Города3: ‘Название Города3’\n                   ...............\n          },\n          ‘название региона2’: {\n                   id Города1: ‘Название Города1’,\n                   id Города2: ‘Название Города2’,\n                   id Города3: ‘Название Города3’\n                   ...............\n          }\n          ...............\n}\n\nРасчет стоимости перевозки/доставки\nСсылка для формирования запроса на расчет: http://calc.pecom.ru/bitrix/components/pecom/calc/ajax.php. Параметры передаются через GET-запрос.\nПараметр\tОписание, пример использования\n\nplaces[0][]\nplaces[1][]\n... \tПараметры груза\n            \n\n\nplaces[0][]: 1\nplaces[0][]: 2\nplaces[0][]: 3\nplaces[0][]: 4\nplaces[0][]: 5\nplaces[0][]: 1\nplaces[0][]: 1\n\nпо очереди\n\nШирина (м), Длина (м), Высота (м), Объем (м3), Вес (кг), Признак негабаритности груза (0 - габарит, 1 - негабарит),\n\nПризнак необходима защитная транспортировочная упаковка (ЗТУ)  (0 - без ЗТУ, 1 - в ЗТУ).\n\n\nplaces[1][]: 3\nplaces[1][]: 3\nplaces[1][]: 3\nplaces[1][]: 3\nplaces[1][]: 3\nplaces[1][]: 1\nplaces[1][]: 1\n\nаналогично для следующего груза.\n           \ntake[town]: -457 \tID города забора \ntake[tent]: 1 \tтребуется растентровка при заборе \ntake[gidro]: 1 \tтребуется гидролифт при заборе \ntake[manip]: 1 \tтребуется манипулятор при заборе \ntake[speed]: 1 \tСрочный забор (только для Москвы) \ntake[moscow]: 1 \tБез въезда, МОЖД, ТТК, Садовое.\n            \n\n           значения соответственно: 0,1,2,3 \ndeliver[town]: 64883 \tID города доставки\ndeliver[tent]: 1 \tТребуется растентровка при доставке\ndeliver[gidro]: 1 \tТребуется гидролифт при доставке\ndeliver[manip]: 1 \tТребуется манипулятор при доставке\ndeliver[speed]: 0 \tСрочная доставка (только для Москвы) \ndeliver[moscow]: 0\tБез въезда, МОЖД, ТТК, Садовое.\n            \n\n           значения соответственно: 0,1,2,3 \nplombir: 12 \tКоличество пломб \nstrah: 33 \tВеличина страховки \nashan: 1 \tДоставка в Ашан \nnight: 1 \tЗабор в ночное время \npal: 3 \tТребуется запаллечивание груза (0 - не требуется, значение больше нуля - количество паллет)\npallets: 4 \tКол-во паллет для расчет услуги паллетной перевозки (только там, где эта услуга предоставляется)\n\n\nВозвращаемый результат\n{\n        ‘take’: [a,b,c],\n        ‘auto’: [a,b,c],\n        ‘alma_auto’: [a,b,c],\n        ‘avia’: [a,b,c],\n        ‘autonegabarit’: [a,b,c],\n        ‘ADD’: [a,b,c],\n        ‘ADD_1’: [a,b,c],\n        ‘ADD_2’: [a,b,c],\n        ‘ADD_3’: [a,b,c],\n        ‘ADD_4’: [a,b,c],\n        ‘deliver’: [a,b,c]\n        ‘periods: ‘Строка’,\n        'aperiods: ‘Строка’,\n        ‘error’: [‘err1’,’err2’]\n}\nгде\ntake - данные по забору\n\nauto - данные по автоперевозке без учета наценки за негабарит\nalma_auto - только, если филиал-отправитель или филиал-получатель город Алматы, перевозка идет через Екатеринбург,\nпри этом в auto передаются данные по автоперевозке от места отправки до Екатеринбурга, в alma_auto - от Ектеринбурга\n до места названчения\nautonegabarit - данные по автоперевозке с учетом наценки за негабарит, если указан \"Признак негабаритности\"\nхотя бы для одного из мест (иначе совпадает со значением auto)\n\n\navia - данные по авиаперевозке\n\nADD - дополнительные услуги (например, изготовление защитной транспортировочной упаковки)\nADD_1 - услуга пломбирования груза\nADD_2 - услуга запаллечивания груза\nADD_3 - услуга страхования груза\nADD_4 - услуга доставки в ночное время\n\ndeliver - данные по доставке\n\nperiods - сообщение о сроках и днях отправки груза при автоперевозке\naperiods - сообщение о сроках при авиаперевозке\n\na - Название услуги\nb - Пояснение к услуге\nc - Стоимость\n\nError - список ошибок выводимых пользователю.\n\nЕсли ключей auto или avia нет - значит услуга НЕ предоставляется\n\nОбщий результат\nАвтоперевозка:\ntake + auto + deliver + ADD + ADD_1 + ADD_2 + ADD_3 + ADD_4\n\nАвтоперевозка для Алматы:\ntake + auto + alma_auto + deliver + ADD + ADD_1 + ADD_2 + ADD_3 + ADD_4 \n\nАвиаперевозка:\ntake + avia + deliver + ADD + ADD_1 + ADD_2 + ADD_3 + ADD_4 \n\nпри наличии полей (auto или avia) соответственно.\n \nAPI Деловых Линий возвращает значение abc вместо расчета. \nИсправь\n       \nДля Деловых Линий:\nИспользуй Адрес метода: https://api.dellin.ru/v2/calculator.json \nПолучай Session id через логин/пароль\nЛогин service@lavsit.ru\nПароль edcwsx123QAZ\n\nСтруктура запроса \n{\n   \"appkey\":\"00000000-0000-0000-0000-000000000000\",\n   \"sessionID\":\"00000000-0000-0000-0000-000000000000\",\n   \"delivery\":{\n      \"deliveryType\":{\n         \"type\":\"express\"\n      },\n      \"arrival\":{\n         \"variant\":\"terminal\",\n         \"terminalID\":\"1\",\n         \"addressID\":238577,\n         \"address\":{\n            \"search\":\"59.924501, 30.241762\",\n            \"street\":\"7800000000008850000000000\",\n            \"house\":\"5\",\n            \"building\":\"1\",\n            \"structure\":\"лит.А\",\n            \"flat\":\"214а\"\n         },\n         \"city\":\"7800000000000000000000000\",\n         \"time\":{\n            \"worktimeStart\":\"9:30\",\n            \"worktimeEnd\":\"19:00\",\n            \"breakStart\":\"12:00\",\n            \"breakEnd\":\"13:00\",\n            \"exactTime\":false\n         },\n         \"handling\":{\n            \"freightLift\":true,\n            \"toFloor\":2,\n            \"carry\":50\n         },\n         \"requirements\":[\n            \"0x9951e0ff97188f6b4b1b153dfde3cfec\",\n            \"0x88f93a2c37f106d94ff9f7ada8efe886\"\n         ]\n      },\n      \"derival\":{\n         \"produceDate\":\"2019-11-08\",\n         \"variant\":\"address\",\n         \"terminalID\":\"1\",\n         \"addressID\":238577,\n         \"address\":{\n            \"search\":\"Москва, Юности, 5\",\n            \"street\":\"7700000000004650000000000\",\n            \"house\":\"5\",\n            \"building\":\"2\",\n            \"structure\":\"лит.Б\",\n            \"flat\":\"21\"\n         },\n         \"time\":{\n            \"worktimeEnd\":\"19:30\",\n            \"worktimeStart\":\"9:00\",\n            \"breakStart\":\"12:00\",\n            \"breakEnd\":\"13:00\",\n            \"exactTime\":false\n         },\n         \"handling\":{\n            \"freightLift\":true,\n            \"toFloor\":40,\n            \"carry\":243\n         },\n         \"requirements\":[\n            \"0x9951e0ff97188f6b4b1b153dfde3cfec\",\n            \"0x88f93a2c37f106d94ff9f7ada8efe886\"\n         ]\n      },\n      \"packages\":[\n         {\n            \"uid\":\"0xa6a7bd2bf950e67f4b2cf7cc3a97c111\",\n            \"count\":1\n         }\n      ],\n      \"accompanyingDocuments\":[\n         {\n            \"action\":\"send\"\n         },\n         {\n            \"action\":\"return\"\n         }\n      ]\n   },\n   \"members\":{\n      \"requester\":{\n         \"role\":\"sender\",\n         \"uid\":\"ae62f076-d602-4341-b691-45bf8dfe4a10\"\n      }\n   },\n   \"cargo\":{\n      \"quantity\":4,\n      \"length\":1,\n      \"width\":1,\n      \"height\":1,\n      \"weight\":12,\n      \"totalVolume\":1,\n      \"totalWeight\":12,\n      \"oversizedWeight\":0,\n      \"oversizedVolume\":0,\n      \"freightUID\":\"0x82e6000423b423b711da7d15445d42cb\",\n      \"hazardClass\":7.2,\n      \"insurance\":{\n         \"statedValue\":15477.34,\n         \"term\":false\n      }\n   },\n   \"payment\":{\n      \"type\":\"cash\",\n      \"promocode\":\"promo123\",\n      \"paymentCity\":\"7700000000000000000000000\",\n      \"paymentCitySearch\":{\n         \"search\":\"Москва\"\n      }\n   } \n}\n\nОписание параметров:\n\nПараметр: appkey Обязательный Тип string Описание Ключ приложения. Для получения ключа необходимо пройти регистрацию\nПараметр: sessionID Обязательный Тип string Ключ приложения. Для получения ключа необходимо пройти регистрациюID сессии, требуется для учета индивидуальных скидок. Для получения сессии необходимо воспользоваться сервисом \"Авторизация пользователя\"\nПараметр: delivery Не обязательный Тип objectID сессии, требуется для учета индивидуальных скидок. Для получения сессии необходимо воспользоваться сервисом \"Авторизация пользователя\"Информация о перевозке груза\nПараметр: delivery.deliveryType ОбязательныйТипDeliveryType Информация о перевозке грузаВид доставки для межтерминальной перевозки груза\nПараметр: delivery.arrival ОбязательныйТипDerivalArrival Вид доставки для межтерминальной перевозки грузаДанные по доставке груза до получателя\nПараметр: delivery.derival ОбязательныйТипDerivalArrival Данные по доставке груза до получателяДанные по доставке груза от отправителя\nПараметр: delivery.packages ОбязательныйТипarray of Packages Данные по доставке груза от отправителяДанные по упаковке. При отсутствии параметра расчёт производится без учёта услуги\nПараметр: delivery.accompanyingDocuments Не обязательный Тип array of AcDocДанные по упаковке. При отсутствии параметра расчёт производится без учёта услугиИнформация по сопроводительным документам\nПараметр: members Не обязательныйТипobject Информация по сопроводительным документам Участники перевозки\nПараметр: members.requester Не обязательный Тип Requester Участники перевозки Заказчик перевозки\nПараметр: cargo Не обязательный Тип Cargo Заказчик перевозки Информация о грузе\nПараметр: payment Обязательный Тип Payment Информация о грузе Оплата перевозки\n\n\nДля корректного описания всех параметров и корректной передачи данных по API Деловых Линий проведи deep research страницы https://dev.dellin.ru/api/calculation/calculator/#_header3\n\nТакже сразу проверь себя на ошибки, проведи deep research страницы https://dev.dellin.ru/api/errors/ проверь есть ли подобные ошибки сейчас и исправь",
  "messageID": "msg_980041d1e001Ub3D04QYH0FRpJ",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14"
}