{
  "id": "prt_acc3157a2001sBfZ7HnNv5hKtw",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_acc305263002pFSsY5FLNKT3B0",
  "type": "tool",
  "callID": "call_7ecba54e880549408df76d8c",
  "tool": "write",
  "state": {
    "status": "completed",
    "input": {
      "content": "\"use client\";\n\nimport { useState } from 'react';\nimport { ChevronDown, ChevronUp, Info, Calculator, AlertTriangle } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\n\ninterface CalculationDetails {\n  company: string;\n  price: number;\n  days: number;\n  details?: any;\n  requestData?: any;\n  responseData?: any;\n  apiUrl?: string;\n  parseTime?: number;\n  error?: string;\n}\n\ninterface ServiceItem {\n  name: string;\n  price: number;\n  basePrice?: number;\n  discount?: number;\n}\n\ninterface CalculationDetailsProps {\n  details: CalculationDetails;\n  isExpanded?: boolean;\n}\n\nexport default function CalculationDetails({ details, isExpanded = false }: CalculationDetailsProps) {\n  const [expanded, setExpanded] = useState(isExpanded);\n\n  const formatPrice = (price: number) => {\n    return price.toLocaleString('ru-RU') + ' ‚ÇΩ';\n  };\n\n  const formatDuration = (parseTime: number) => {\n    return parseTime ? `${parseTime} —Å–µ–∫` : '–ù/–î';\n  };\n\n  const getDiscountPercentage = (basePrice: number, price: number) => {\n    if (!basePrice || basePrice === 0) return 0;\n    return ((basePrice - price) / basePrice * 100).toFixed(1);\n  };\n\n  const getStatusColor = (company: string) => {\n    switch (company) {\n      case '–í–æ–∑–æ–≤–æ–∑': return 'text-blue-600';\n      case '–ü–∞—Ä—Å–µ—Ä Vozovoz': return 'text-green-600';\n      case 'API Vozovoz': return 'text-purple-600';\n      default: return 'text-gray-600';\n    }\n  };\n\n  const getStatusIcon = (company: string) => {\n    switch (company) {\n      case '–í–æ–∑–æ–≤–æ–∑': return <Calculator className=\"w-4 h-4\" />;\n      case '–ü–∞—Ä—Å–µ—Ä Vozovoz': return <Info className=\"w-4 h-4\" />;\n      case 'API Vozovoz': return <AlertTriangle className=\"w-4 h-4\" />;\n      default: return <Info className=\"w-4 h-4\" />;\n    }\n  };\n\n  return (\n    <Card className=\"bg-gray-800 border-gray-700\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            {getStatusIcon(details.company)}\n            <span className={getStatusColor(details.company)}>\n              {details.company}\n            </span>\n            {details.parseTime && (\n              <Badge variant=\"secondary\" className=\"text-xs\">\n                {formatDuration(details.parseTime)}\n              </Badge>\n            )}\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setExpanded(!expanded)}\n            className=\"text-gray-400 hover:text-gray-200\"\n          >\n            {expanded ? <ChevronUp className=\"w-4 h-4\" /> : <ChevronDown className=\"w-4 h-4\" />}\n          </Button>\n        </CardTitle>\n      </CardHeader>\n      \n      <CardContent className=\"space-y-4\">\n        {/* –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}\n        <div className=\"flex justify-between items-center\">\n          <span className=\"text-gray-300\">üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å:</span>\n          <span className=\"text-xl font-bold text-white\">\n            {formatPrice(details.price)}\n          </span>\n        </div>\n        \n        <div className=\"flex justify-between items-center\">\n          <span className=\"text-gray-300\">‚è∞ –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</span>\n          <span className=\"text-white\">\n            {details.days} {details.days === 1 ? '–¥–µ–Ω—å' : '–¥–Ω–µ–π'}\n          </span>\n        </div>\n\n        {details.error && (\n          <div className=\"bg-red-900 border border-red-700 rounded p-3\">\n            <div className=\"flex items-center gap-2 text-red-200\">\n              <AlertTriangle className=\"w-4 h-4\" />\n              <span>–û—à–∏–±–∫–∞: {details.error}</span>\n            </div>\n          </div>\n        )}\n\n        {/* –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —É—Å–ª—É–≥ */}\n        {expanded && details.details?.services && (\n          <div className=\"space-y-3\">\n            <h4 className=\"text-lg font-semibold text-white mb-3\">üì¶ –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —É—Å–ª—É–≥</h4>\n            \n            <div className=\"space-y-2\">\n              {details.details.services.map((service: ServiceItem, index: number) => (\n                <div key={index} className=\"flex justify-between items-center p-3 bg-gray-700 rounded-lg\">\n                  <div className=\"flex-1\">\n                    <div className=\"font-medium text-white\">\n                      {service.name}\n                    </div>\n                    {service.discount && (\n                      <div className=\"text-sm text-gray-400\">\n                        (—Å–∫–∏–¥–∫–∞ {service.discount} ‚ÇΩ)\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"text-right\">\n                    <div className=\"font-bold text-white\">\n                      {formatPrice(service.price)}\n                    </div>\n                    {service.basePrice && service.basePrice !== service.price && (\n                      <div className=\"text-sm text-gray-400 line-through\">\n                        {formatPrice(service.basePrice)}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* –ò—Ç–æ–≥–∏ –ø–æ —Å–∫–∏–¥–∫–∞–º */}\n            {details.details.services.some(s => s.discount) && (\n              <div className=\"bg-yellow-900 border border-yellow-700 rounded p-3\">\n                <div className=\"text-yellow-200\">\n                  <strong>üí∞ –ò—Ç–æ–≥–æ–≤–∞—è —ç–∫–æ–Ω–æ–º–∏—è:</strong>\n                  <div className=\"text-white mt-1\">\n                    {details.details.services\n                      .filter(s => s.discount)\n                      .reduce((total, s) => total + s.discount, 0)\n                      .toLocaleString('ru-RU')} ‚ÇΩ\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}\n        {expanded && (\n          <div className=\"space-y-3\">\n            <h4 className=\"text-lg font-semibold text-white mb-3\">üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n              <div>\n                <span className=\"text-gray-400\">API URL:</span>\n                <div className=\"text-white font-mono bg-gray-900 p-2 rounded\">\n                  {details.apiUrl || '–ù/–î'}\n                </div>\n              </div>\n              \n              <div>\n                <span className=\"text-gray-400\">–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</span>\n                <div className=\"text-white\">\n                  {formatDuration(details.parseTime)}\n                </div>\n              </div>\n            </div>\n\n            {details.requestData && (\n              <div>\n                <span className=\"text-gray-400\">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:</span>\n                <div className=\"text-white font-mono bg-gray-900 p-2 rounded text-xs max-h-32 overflow-y-auto\">\n                  <pre>{JSON.stringify(details.requestData, null, 2)}</pre>\n                </div>\n              </div>\n            )}\n\n            {details.responseData && (\n              <div>\n                <span className=\"text-gray-400\">–û—Ç–≤–µ—Ç API:</span>\n                <div className=\"text-white font-mono bg-gray-900 p-2 rounded text-xs max-h-32 overflow-y-auto\">\n                  <pre>{JSON.stringify(details.responseData, null, 2)}</pre>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}",
      "filePath": "/home/user/project/components/CalculationDetails.tsx"
    },
    "output": "",
    "title": "components/CalculationDetails.tsx",
    "metadata": {
      "diagnostics": {},
      "filepath": "/home/user/project/components/CalculationDetails.tsx",
      "exists": false
    },
    "time": {
      "start": 1764362377131,
      "end": 1764362377142
    }
  }
}