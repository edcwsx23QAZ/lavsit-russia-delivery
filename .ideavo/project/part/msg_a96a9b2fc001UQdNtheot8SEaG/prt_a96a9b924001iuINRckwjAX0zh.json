{
  "id": "prt_a96a9b924001iuINRckwjAX0zh",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "messageID": "msg_a96a9b2fc001UQdNtheot8SEaG",
  "type": "tool",
  "callID": "call_50656888",
  "tool": "read",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "components/diagnostic/ApiMasterTab.tsx",
      "offset": 1
    },
    "output": "<file>\n00002| \n00003| import React, { useState, useEffect, useCallback } from 'react';\n00004| import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n00005| import { Button } from '@/components/ui/button';\n00006| import { Badge } from '@/components/ui/badge';\n00007| import { Input } from '@/components/ui/input';\n00008| import { Label } from '@/components/ui/label';\n00009| import { Switch } from '@/components/ui/switch';\n00010| import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\n00011| import { Alert, AlertDescription } from '@/components/ui/alert';\n00012| import {\n00013|   Settings,\n00014|   Play,\n00015|   CheckCircle,\n00016|   XCircle,\n00017|   AlertTriangle,\n00018|   RefreshCw,\n00019|   Key,\n00020|   Globe,\n00021|   Truck,\n00022|   Database,\n00023|   ExternalLink\n00024| } from 'lucide-react';\n00025| import { apiRequestWithTimeout } from '@/lib/api-utils';\n00026| \n00027| interface ApiConfig {\n00028|   name: string;\n00029|   key: string;\n00030|   category: 'transport' | 'service' | 'internal';\n00031|   status: 'working' | 'error' | 'expired' | 'unknown';\n00032|   credentials: {\n00033|     [key: string]: string;\n00034|   };\n00035|   endpoints: string[];\n00036|   description: string;\n00037|   lastChecked?: Date;\n00038|   errorMessage?: string;\n00039| }\n00040| \n00041| const API_CONFIGS: ApiConfig[] = [\n00042|   {\n00043|     name: 'ПЭК',\n00044|     key: 'pek',\n00045|     category: 'transport',\n00046|     status: 'unknown',\n00047|     credentials: {\n00048|       login: process.env.PEK_LOGIN || '',\n00049|       apiKey: process.env.PEK_API_KEY || '624FC93CA677B23673BB476D4982294DC27E246F'\n00050|     },\n00051|     endpoints: ['/api/pek'],\n00052|     description: 'Транспортная компания ПЭК - доставка по России'\n00053|   },\n00054|   {\n00055|     name: 'Возовоз',\n00056|     key: 'vozovoz',\n00057|     category: 'transport',\n00058|     status: 'unknown',\n00059|     credentials: {\n00060|       token: 'sBDUaEmzVBO6syQWHvHxmjxJQiON2BZplQaqrU3N'\n00061|     },\n00062|     endpoints: ['/api/vozovoz'],\n00063|     description: 'Транспортная компания Возовоз - доставка сборных грузов'\n00064|   },\n00065|   {\n00066|     name: 'СДЭК',\n00067|     key: 'cdek',\n00068|     category: 'transport',\n00069|     status: 'unknown',\n00070|     credentials: {\n00071|       clientId: '3J5AvQWReEdW1o01PApvw6jHsnkNpqT1',\n00072|       clientSecret: 'T8iMvgShV0p9OfJiysSBpCCWcXtOO0Hy'\n00073|     },\n00074|     endpoints: ['/api/cdek'],\n00075|     description: 'Транспортная компания СДЭК - курьерская доставка'\n00076|   },\n00077|   {\n00078|     name: 'КИТ',\n00079|     key: 'kit',\n00080|     category: 'transport',\n00081|     status: 'unknown',\n00082|     credentials: {\n00083|       token: process.env.KIT_API_TOKEN || ''\n00084|     },\n00085|     endpoints: ['/api/kit'],\n00086|     description: 'Транспортная компания КИТ - доставка посылок'\n00087|   },\n00088|   {\n00089|     name: 'Деловые Линии',\n00090|     key: 'dellin',\n00091|     category: 'transport',\n00092|     status: 'unknown',\n00093|     credentials: {\n00094|       appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n00095|       login: 'service@lavsit.ru',\n00096|       password: 'edcwsx123QAZ'\n00097|     },\n00098|     endpoints: ['/api/dellin-packages'],\n00099|     description: 'Транспортная компания Деловые Линии'\n00100|   },\n00101|   {\n00102|     name: 'Nord Wheel',\n00103|     key: 'nordwheel',\n00104|     category: 'transport',\n00105|     status: 'unknown',\n00106|     credentials: {\n00107|       apiKey: '5|WYpV9f788Y2ASobpv3xy6N5qxtIUaKhxFF4yWETOfc398950'\n00108|     },\n00109|     endpoints: ['/api/test'],\n00110|     description: 'Транспортная компания Nord Wheel - международные перевозки'\n00111|   },\n00112|   {\n00113|     name: 'Rail Continent',\n00114|     key: 'railcontinent',\n00115|     category: 'transport',\n00116|     status: 'unknown',\n00117|     credentials: {},\n00118|     endpoints: ['/api/rail-continent'],\n00119|     description: 'Железнодорожная доставка Rail Continent'\n00120|   },\n00121|   {\n00122|     name: 'DaData',\n00123|     key: 'dadata',\n00124|     category: 'service',\n00125|     status: 'unknown',\n00126|     credentials: {\n00127|       apiKey: 'eb87bbb3789bb43ed465f796892ea951f9e91008'\n00128|     },\n00129|     endpoints: ['https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address'],\n00130|     description: 'Сервис подсказок адресов DaData'\n00131|   },\n00132|   {\n00133|     name: 'Google Sheets',\n00134|     key: 'sheets',\n00135|     category: 'internal',\n00136|     status: 'unknown',\n00137|     credentials: {},\n00138|     endpoints: ['https://docs.google.com/spreadsheets/d/1e0P91PfGKVIuSWDY0ceWkIE7jD-vzD_xrIesBeQno1Y'],\n00139|     description: 'База данных товаров в Google Sheets'\n00140|   }\n00141| ];\n00142| \n00143| const ApiMasterTab: React.FC = () => {\n00144|   const [apis, setApis] = useState<ApiConfig[]>(API_CONFIGS);\n00145|   const [testingAll, setTestingAll] = useState(false);\n00146|   const [editingApi, setEditingApi] = useState<string | null>(null);\n00147|   const [editCredentials, setEditCredentials] = useState<{ [key: string]: string }>({});\n00148| \n00149|   // Load saved API configurations\n00150|   useEffect(() => {\n00151|     try {\n00152|       const saved = localStorage.getItem('apiConfigurations');\n00153|       if (saved) {\n00154|         const savedConfigs = JSON.parse(saved);\n00155|         setApis(prev => prev.map(api => ({\n00156|           ...api,\n00157|           credentials: savedConfigs[api.key] || api.credentials,\n00158|           status: savedConfigs[api.key + '_status'] || api.status,\n00159|           lastChecked: savedConfigs[api.key + '_lastChecked'] ? new Date(savedConfigs[api.key + '_lastChecked']) : api.lastChecked\n00160|         })));\n00161|       }\n00162|     } catch (error) {\n00163|       console.error('Error loading API configurations:', error);\n00164|     }\n00165|   }, []);\n00166| \n00167|   const saveApiConfigurations = useCallback(() => {\n00168|     try {\n00169|       const configToSave: { [key: string]: any } = {};\n00170|       apis.forEach(api => {\n00171|         configToSave[api.key] = api.credentials;\n00172|         configToSave[api.key + '_status'] = api.status;\n00173|         configToSave[api.key + '_lastChecked'] = api.lastChecked?.toISOString();\n00174|       });\n00175|       localStorage.setItem('apiConfigurations', JSON.stringify(configToSave));\n00176|     } catch (error) {\n00177|       console.error('Error saving API configurations:', error);\n00178|     }\n00179|   }, [apis]);\n00180| \n00181|   const testApi = useCallback(async (api: ApiConfig) => {\n00182|     setApis(prev => prev.map(a =>\n00183|       a.key === api.key ? { ...a, status: 'unknown' as const } : a\n00184|     ));\n00185| \n00186|     try {\n00187|       let testResult = false;\n00188|       let errorMessage = '';\n00189| \n00190|       // Test based on API type\n00191|       switch (api.key) {\n00192|         case 'pek':\n00193|           const pekResponse = await apiRequestWithTimeout('/api/pek', {\n00194|             method: 'POST',\n00195|             headers: { 'Content-Type': 'application/json' },\n00196|             body: JSON.stringify({ method: 'test' })\n00197|           });\n00198|           testResult = pekResponse.ok;\n00199|           if (!pekResponse.ok) {\n00200|             const errorData = await pekResponse.text();\n00201|             errorMessage = errorData.includes('<!DOCTYPE') ? 'Неверные учетные данные' : errorData;\n00202|           }\n00203|           break;\n00204| \n00205|         case 'vozovoz':\n00206|           const vozResponse = await apiRequestWithTimeout('/api/vozovoz', {\n00207|             method: 'POST',\n00208|             headers: { 'Content-Type': 'application/json' },\n00209|             body: JSON.stringify({\n00210|               object: \"price\",\n00211|               action: \"get\",\n00212|               params: {\n00213|                 cargo: { dimension: { quantity: 1, volume: 0.1, weight: 10 } },\n00214|                 gateway: {\n00215|                   dispatch: { point: { location: \"Москва\", terminal: \"default\" } },\n00216|                   destination: { point: { location: \"СПб\", terminal: \"default\" } }\n00217|                 }\n00218|               }\n00219|             })\n00220|           });\n00221|           testResult = vozResponse.ok;\n00222|           if (!vozResponse.ok) {\n00223|             const errorData = await vozResponse.text();\n00224|             errorMessage = errorData.includes('<!DOCTYPE') ? 'Токен устарел' : 'Ошибка API';\n00225|           }\n00226|           break;\n00227| \n00228|         case 'cdek':\n00229|           const cdekResponse = await apiRequestWithTimeout('/api/cdek', {\n00230|             method: 'POST',\n00231|             headers: { 'Content-Type': 'application/json' },\n00232|             body: JSON.stringify({\n00233|               from_city: 'Москва',\n00234|               to_city: 'СПб',\n00235|               packages: [{ height: 10, length: 20, width: 10, weight: 1000 }]\n00236|             })\n00237|           });\n00238|           testResult = cdekResponse.ok;\n00239|           if (!cdekResponse.ok) {\n00240|             const errorData = await cdekResponse.text();\n00241|             errorMessage = errorData.includes('<!DOCTYPE') ? 'Учетные данные устарели' : 'Ошибка API';\n00242|           }\n00243|           break;\n00244| \n00245|         case 'kit':\n00246|           const kitResponse = await apiRequestWithTimeout('/api/kit', {\n00247|             method: 'POST',\n00248|             headers: { 'Content-Type': 'application/json' },\n00249|             body: JSON.stringify({\n00250|               from_city: 'Москва',\n00251|               to_city: 'СПб',\n00252|               declared_price: 10000\n00253|             })\n00254|           });\n00255|           testResult = kitResponse.ok;\n00256|           if (!kitResponse.ok) {\n00257|             const errorData = await kitResponse.json().catch(() => ({}));\n00258|             if (kitResponse.status === 500 && errorData.error?.includes('не настроен')) {\n00259|               errorMessage = 'Токен API не настроен';\n00260|             } else if (kitResponse.status === 400 && errorData.error?.includes('Не удалось определить коды городов')) {\n00261|               errorMessage = 'Ошибка определения городов - проверьте токен';\n00262|             } else {\n00263|               errorMessage = errorData.error || 'Ошибка API';\n00264|             }\n00265|           }\n00266|           break;\n00267| \n00268|         case 'dellin':\n00269|           const dellinResponse = await apiRequestWithTimeout('/api/dellin-packages', {\n00270|             method: 'POST',\n00271|             headers: { 'Content-Type': 'application/json' },\n00272|             body: JSON.stringify({ method: 'test' })\n00273|           });\n00274|           testResult = dellinResponse.ok;\n00275|           break;\n00276| \n00277|         case 'railcontinent':\n00278|           const railResponse = await apiRequestWithTimeout('/api/rail-continent', {\n00279|             method: 'POST',\n00280|             headers: { 'Content-Type': 'application/json' },\n00281|             body: JSON.stringify({ method: 'test' })\n00282|           });\n00283|           testResult = railResponse.ok;\n00284|           break;\n00285| \n00286|         case 'nordwheel':\n00287|           const nordwheelResponse = await apiRequestWithTimeout('/api/test', {\n00288|             method: 'POST',\n00289|             headers: { 'Content-Type': 'application/json' },\n00290|             body: JSON.stringify({ service: 'nordwheel' })\n00291|           });\n00292|           testResult = nordwheelResponse.ok;\n00293|           if (!nordwheelResponse.ok) {\n00294|             const errorData = await nordwheelResponse.json().catch(() => ({}));\n00295|             errorMessage = errorData.error || 'Ошибка API NordWheel';\n00296|           }\n00297|           break;\n00298| \n00299|         case 'dadata':\n00300|           const dadataResponse = await fetch('https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address', {\n00301|             method: 'POST',\n00302|             headers: {\n00303|               'Content-Type': 'application/json',\n00304|               'Authorization': `Token ${api.credentials.apiKey}`\n00305|             },\n00306|             body: JSON.stringify({ query: 'Москва', count: 1 })\n00307|           });\n00308|           testResult = dadataResponse.ok;\n00309|           break;\n00310| \n00311|         default:\n00312|           testResult = true; // For internal APIs, assume working\n00313|       }\n00314| \n00315|       setApis(prev => prev.map(a =>\n00316|         a.key === api.key ? {\n00317|           ...a,\n00318|           status: testResult ? 'working' : 'error',\n00319|           lastChecked: new Date(),\n00320|           errorMessage: testResult ? undefined : errorMessage\n00321|         } : a\n00322|       ));\n00323| \n00324|     } catch (error) {\n00325|       setApis(prev => prev.map(a =>\n00326|         a.key === api.key ? {\n00327|           ...a,\n00328|           status: 'error',\n00329|           lastChecked: new Date(),\n00330|           errorMessage: 'Сетевая ошибка'\n00331|         } : a\n00332|       ));\n00333|     }\n00334|   }, []);\n00335| \n00336|   const testAllApis = useCallback(async () => {\n00337|     setTestingAll(true);\n00338|     for (const api of apis) {\n00339|       await testApi(api);\n00340|       await new Promise(resolve => setTimeout(resolve, 500)); // Delay between tests\n00341|     }\n00342|     setTestingAll(false);\n00343|     saveApiConfigurations();\n00344|   }, [apis, testApi, saveApiConfigurations]);\n00345| \n00346|   const startEditing = useCallback((apiKey: string) => {\n00347|     const api = apis.find(a => a.key === apiKey);\n00348|     if (api) {\n00349|       setEditingApi(apiKey);\n00350|       setEditCredentials({ ...api.credentials });\n00351|     }\n00352|   }, [apis]);\n00353| \n00354|   const saveCredentials = useCallback(() => {\n00355|     if (editingApi) {\n00356|       setApis(prev => prev.map(a =>\n00357|         a.key === editingApi ? { ...a, credentials: { ...editCredentials } } : a\n00358|       ));\n00359|       setEditingApi(null);\n00360|       saveApiConfigurations();\n00361|     }\n00362|   }, [editingApi, editCredentials, saveApiConfigurations]);\n00363| \n00364|   const getStatusIcon = (status: string) => {\n00365|     switch (status) {\n00366|       case 'working': return <CheckCircle className=\"h-4 w-4 text-green-500\" />;\n00367|       case 'error': return <XCircle className=\"h-4 w-4 text-red-500\" />;\n00368|       case 'expired': return <AlertTriangle className=\"h-4 w-4 text-yellow-500\" />;\n00369|       default: return <RefreshCw className=\"h-4 w-4 text-gray-500\" />;\n00370|     }\n00371|   };\n00372| \n00373|   const getStatusText = (status: string) => {\n00374|     switch (status) {\n00375|       case 'working': return 'Работает';\n00376|       case 'error': return 'Ошибка';\n00377|       case 'expired': return 'Устарел';\n00378|       default: return 'Неизвестно';\n00379|     }\n00380|   };\n00381| \n00382|   const getCategoryIcon = (category: string) => {\n00383|     switch (category) {\n00384|       case 'transport': return <Truck className=\"h-4 w-4\" />;\n00385|       case 'service': return <Globe className=\"h-4 w-4\" />;\n00386|       case 'internal': return <Database className=\"h-4 w-4\" />;\n00387|       default: return <Settings className=\"h-4 w-4\" />;\n00388|     }\n00389|   };\n00390| \n00391|   const transportApis = apis.filter(api => api.category === 'transport');\n00392|   const serviceApis = apis.filter(api => api.category === 'service');\n00393|   const internalApis = apis.filter(api => api.category === 'internal');\n00394| \n00395|   return (\n00396|     <div className=\"space-y-6\">\n00397|       <div className=\"flex justify-between items-center\">\n00398|         <div>\n00399|           <h2 className=\"text-2xl font-bold text-white mb-2\">Все API</h2>\n00400|           <p className=\"text-gray-400\">Централизованное управление всеми API приложения</p>\n00401|         </div>\n00402|         <Button\n00403|           onClick={testAllApis}\n00404|           disabled={testingAll}\n00405|           className=\"bg-blue-600 hover:bg-blue-700\"\n00406|         >\n00407|           {testingAll ? (\n00408|             <>\n00409|               <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n00410|               Тестирование...\n00411|             </>\n00412|           ) : (\n00413|             <>\n00414|               <Play className=\"h-4 w-4 mr-2\" />\n00415|               Протестировать все\n00416|             </>\n00417|           )}\n00418|         </Button>\n00419|       </div>\n00420| \n00421|       <Tabs defaultValue=\"transport\" className=\"w-full\">\n00422|         <TabsList className=\"grid w-full grid-cols-3 bg-gray-800 border-gray-700\">\n00423|           <TabsTrigger value=\"transport\" className=\"text-white\">\n00424|             <Truck className=\"h-4 w-4 mr-2\" />\n00425|             Транспорт ({transportApis.length})\n00426|           </TabsTrigger>\n00427|           <TabsTrigger value=\"service\" className=\"text-white\">\n00428|             <Globe className=\"h-4 w-4 mr-2\" />\n00429|             Сервисы ({serviceApis.length})\n00430|           </TabsTrigger>\n00431|           <TabsTrigger value=\"internal\" className=\"text-white\">\n00432|             <Database className=\"h-4 w-4 mr-2\" />\n00433|             Внутренние ({internalApis.length})\n00434|           </TabsTrigger>\n00435|         </TabsList>\n00436| \n00437|         <TabsContent value=\"transport\" className=\"mt-6\">\n00438|           <div className=\"grid gap-4\">\n00439|             {transportApis.map((api) => (\n00440|               <Card key={api.key} className=\"bg-gray-800 border-gray-700\">\n00441|                 <CardHeader className=\"pb-3\">\n00442|                   <div className=\"flex items-center justify-between\">\n00443|                     <div className=\"flex items-center gap-3\">\n00444|                       {getCategoryIcon(api.category)}\n00445|                       <div>\n00446|                         <CardTitle className=\"text-white text-lg\">{api.name}</CardTitle>\n00447|                         <p className=\"text-gray-400 text-sm\">{api.description}</p>\n00448|                       </div>\n00449|                     </div>\n00450|                     <div className=\"flex items-center gap-2\">\n00451|                       {getStatusIcon(api.status)}\n00452|                       <Badge variant={api.status === 'working' ? 'default' : 'destructive'}>\n00453|                         {getStatusText(api.status)}\n00454|                       </Badge>\n00455|                     </div>\n00456|                   </div>\n00457|                 </CardHeader>\n00458|                 <CardContent>\n00459|                   <div className=\"space-y-4\">\n00460|                     {api.errorMessage && (\n00461|                       <Alert className=\"border-red-500 bg-red-900/20\">\n00462|                         <AlertTriangle className=\"h-4 w-4\" />\n00463|                         <AlertDescription className=\"text-red-400\">\n00464|                           {api.errorMessage}\n00465|                         </AlertDescription>\n00466|                       </Alert>\n00467|                     )}\n00468| \n00469|                     <div className=\"grid grid-cols-2 gap-4\">\n00470|                       <div>\n00471|                         <Label className=\"text-gray-300 text-sm\">Последняя проверка</Label>\n00472|                         <p className=\"text-white text-sm\">\n00473|                           {api.lastChecked ? api.lastChecked.toLocaleString('ru-RU') : 'Не проверялся'}\n00474|                         </p>\n00475|                       </div>\n00476|                       <div>\n00477|                         <Label className=\"text-gray-300 text-sm\">Эндпоинты</Label>\n00478|                         <div className=\"flex flex-wrap gap-1\">\n00479|                           {api.endpoints.map((endpoint, idx) => (\n00480|                             <Badge key={idx} variant=\"outline\" className=\"text-xs\">\n00481|                               {endpoint}\n00482|                             </Badge>\n00483|                           ))}\n00484|                         </div>\n00485|                       </div>\n00486|                     </div>\n00487| \n00488|                     <div className=\"flex gap-2\">\n00489|                       <Button\n00490|                         onClick={() => testApi(api)}\n00491|                         variant=\"outline\"\n00492|                         size=\"sm\"\n00493|                         className=\"border-blue-500 text-blue-400 hover:bg-blue-900/20\"\n00494|                       >\n00495|                         <Play className=\"h-3 w-3 mr-1\" />\n00496|                         Тест\n00497|                       </Button>\n00498|                       <Button\n00499|                         onClick={() => startEditing(api.key)}\n00500|                         variant=\"outline\"\n00501|                         size=\"sm\"\n00502|                         className=\"border-green-500 text-green-400 hover:bg-green-900/20\"\n00503|                       >\n00504|                         <Key className=\"h-3 w-3 mr-1\" />\n00505|                         Ключи\n00506|                       </Button>\n00507|                     </div>\n00508| \n00509|                     {editingApi === api.key && (\n00510|                       <Card className=\"bg-gray-700 border-gray-600 mt-4\">\n00511|                         <CardHeader className=\"pb-2\">\n00512|                           <CardTitle className=\"text-white text-sm\">Редактирование учетных данных</CardTitle>\n00513|                         </CardHeader>\n00514|                         <CardContent className=\"space-y-3\">\n00515|                           {Object.keys(api.credentials).map((key) => (\n00516|                             <div key={key}>\n00517|                               <Label className=\"text-gray-300 text-sm capitalize\">{key}</Label>\n00518|                               <Input\n00519|                                 type={key.includes('secret') || key.includes('password') ? 'password' : 'text'}\n00520|                                 value={editCredentials[key] || ''}\n00521|                                 onChange={(e) => setEditCredentials(prev => ({ ...prev, [key]: e.target.value }))}\n00522|                                 className=\"bg-gray-600 border-gray-500 text-white\"\n00523|                               />\n00524|                             </div>\n00525|                           ))}\n00526|                           <div className=\"flex gap-2\">\n00527|                             <Button onClick={saveCredentials} size=\"sm\" className=\"bg-green-600 hover:bg-green-700\">\n00528|                               Сохранить\n00529|                             </Button>\n00530|                             <Button onClick={() => setEditingApi(null)} variant=\"outline\" size=\"sm\">\n00531|                               Отмена\n00532|                             </Button>\n00533|                           </div>\n00534|                         </CardContent>\n00535|                       </Card>\n00536|                     )}\n00537|                   </div>\n00538|                 </CardContent>\n00539|               </Card>\n00540|             ))}\n00541|           </div>\n00542|         </TabsContent>\n00543| \n00544|         <TabsContent value=\"service\" className=\"mt-6\">\n00545|           <div className=\"grid gap-4\">\n00546|             {serviceApis.map((api) => (\n00547|               <Card key={api.key} className=\"bg-gray-800 border-gray-700\">\n00548|                 <CardHeader className=\"pb-3\">\n00549|                   <div className=\"flex items-center justify-between\">\n00550|                     <div className=\"flex items-center gap-3\">\n00551|                       {getCategoryIcon(api.category)}\n00552|                       <div>\n00553|                         <CardTitle className=\"text-white text-lg\">{api.name}</CardTitle>\n00554|                         <p className=\"text-gray-400 text-sm\">{api.description}</p>\n00555|                       </div>\n00556|                     </div>\n00557|                     <div className=\"flex items-center gap-2\">\n00558|                       {getStatusIcon(api.status)}\n00559|                       <Badge variant={api.status === 'working' ? 'default' : 'destructive'}>\n00560|                         {getStatusText(api.status)}\n00561|                       </Badge>\n00562|                     </div>\n00563|                   </div>\n00564|                 </CardHeader>\n00565|                 <CardContent>\n00566|                   <div className=\"space-y-4\">\n00567|                     {api.errorMessage && (\n00568|                       <Alert className=\"border-red-500 bg-red-900/20\">\n00569|                         <AlertTriangle className=\"h-4 w-4\" />\n00570|                         <AlertDescription className=\"text-red-400\">\n00571|                           {api.errorMessage}\n00572|                         </AlertDescription>\n00573|                       </Alert>\n00574|                     )}\n00575| \n00576|                     <div className=\"flex gap-2\">\n00577|                       <Button\n00578|                         onClick={() => testApi(api)}\n00579|                         variant=\"outline\"\n00580|                         size=\"sm\"\n00581|                         className=\"border-blue-500 text-blue-400 hover:bg-blue-900/20\"\n00582|                       >\n00583|                         <Play className=\"h-3 w-3 mr-1\" />\n00584|                         Тест\n00585|                       </Button>\n00586|                       <Button\n00587|                         onClick={() => startEditing(api.key)}\n00588|                         variant=\"outline\"\n00589|                         size=\"sm\"\n00590|                         className=\"border-green-500 text-green-400 hover:bg-green-900/20\"\n00591|                       >\n00592|                         <Key className=\"h-3 w-3 mr-1\" />\n00593|                         Ключи\n00594|                       </Button>\n00595|                     </div>\n00596|                   </div>\n00597|                 </CardContent>\n00598|               </Card>\n00599|             ))}\n00600|           </div>\n00601|         </TabsContent>\n00602| \n00603|         <TabsContent value=\"internal\" className=\"mt-6\">\n00604|           <div className=\"grid gap-4\">\n00605|             {internalApis.map((api) => (\n00606|               <Card key={api.key} className=\"bg-gray-800 border-gray-700\">\n00607|                 <CardHeader className=\"pb-3\">\n00608|                   <div className=\"flex items-center justify-between\">\n00609|                     <div className=\"flex items-center gap-3\">\n00610|                       {getCategoryIcon(api.category)}\n00611|                       <div>\n00612|                         <CardTitle className=\"text-white text-lg\">{api.name}</CardTitle>\n00613|                         <p className=\"text-gray-400 text-sm\">{api.description}</p>\n00614|                       </div>\n00615|                     </div>\n00616|                     <div className=\"flex items-center gap-2\">\n00617|                       {getStatusIcon(api.status)}\n00618|                       <Badge variant={api.status === 'working' ? 'default' : 'destructive'}>\n00619|                         {getStatusText(api.status)}\n00620|                       </Badge>\n00621|                       <Button\n00622|                         onClick={() => window.open(api.endpoints[0], '_blank')}\n00623|                         variant=\"outline\"\n00624|                         size=\"sm\"\n00625|                         className=\"border-purple-500 text-purple-400 hover:bg-purple-900/20\"\n00626|                       >\n00627|                         <ExternalLink className=\"h-3 w-3 mr-1\" />\n00628|                         Открыть\n00629|                       </Button>\n00630|                     </div>\n00631|                   </div>\n00632|                 </CardHeader>\n00633|               </Card>\n00634|             ))}\n00635|           </div>\n00636|         </TabsContent>\n00637|       </Tabs>\n00638|     </div>\n00639|   );\n00640| };\n00641| \n00642| export default ApiMasterTab;\n</file>",
    "title": "components/diagnostic/ApiMasterTab.tsx",
    "metadata": {
      "preview": "\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Settings,\n  Play,\n  CheckCircle,\n  XCircle,\n  AlertTriangle,\n  RefreshCw,\n  Key,\n  Globe,\n  Truck,"
    },
    "time": {
      "start": 1763464296742,
      "end": 1763464296744
    }
  }
}