{
  "id": "prt_98d02a4660010Pre68Y6W9oLpQ",
  "messageID": "msg_98d0240cd0018KglEDzM26KQlK",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_0166G7XZMJ2Atb91vUJvHzTp",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/api/pek/route.ts"
    },
    "output": "<file>\n00001| import { NextRequest, NextResponse } from 'next/server';\n00002| \n00003| export async function POST(request: NextRequest) {\n00004|   try {\n00005|     console.log('üîß –ü–≠–ö –ü—Ä–æ–∫—Å–∏: –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å (–ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)');\n00006|     \n00007|     const requestData = await request.json();\n00008|     console.log('üìù –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞:', JSON.stringify(requestData, null, 2));\n00009|     \n00010|     const { method, address, coordinates } = requestData;\n00011|     \n00012|     // –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ü–≠–ö\n00013|     const PEK_API_KEY = process.env.PEK_API_KEY || '624FC93CA677B23673BB476D4982294DC27E246F';\n00014|     const PEK_LOGIN = process.env.PEK_LOGIN || 'demo';\n00015|     \n00016|     // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ-—Ç–µ—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤\n00017|     if (method !== 'test' && (!process.env.PEK_LOGIN || !process.env.PEK_API_KEY)) {\n00018|       console.warn('‚ö†Ô∏è –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è PEK_LOGIN –∏ PEK_API_KEY');\n00019|       console.warn('‚ö†Ô∏è –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ /env-check –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏');\n00020|       \n00021|       return NextResponse.json({ \n00022|         error: '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ü–≠–ö',\n00023|         details: '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å PEK_LOGIN –∏ PEK_API_KEY –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è',\n00024|         suggestion: '–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ /env-check –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏',\n00025|         requiredVars: ['PEK_LOGIN', 'PEK_API_KEY'],\n00026|         currentEnv: {\n00027|           hasLogin: !!process.env.PEK_LOGIN,\n00028|           hasKey: !!process.env.PEK_API_KEY,\n00029|           loginPreview: process.env.PEK_LOGIN ? process.env.PEK_LOGIN.substring(0, 3) + '***' : '–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'\n00030|         }\n00031|       }, { status: 500 });\n00032|     }\n00033|     \n00034|     // –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –±–∞–∑–æ–≤—ã–π URL —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n00035|     const BASE_URL = 'https://kabinet.pecom.ru/api/v1';\n00036|     \n00037|     let urlPath = '';\n00038|     let body = {};\n00039|     \n00040|     switch (method) {\n00041|       case 'findzonebyaddress':\n00042|         urlPath = '/branches/findzonebyaddress/';\n00043|         console.log('üîç –ü–≠–ö API: findzonebyaddress –¥–ª—è –∞–¥—Ä–µ—Å–∞:', address);\n00044|         body = { address: address };\n00045|         break;\n00046|         \n00047|       case 'findzonebycoordinates':\n00048|         urlPath = '/branches/findzonebycoordinates/';\n00049|         \n00050|         // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç\n00051|         const lat = Number(coordinates.latitude);\n00052|         const lng = Number(coordinates.longitude);\n00053|         \n00054|         if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n00055|           return NextResponse.json({ \n00056|             error: '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã',\n00057|             details: `–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å: latitude –æ—Ç -90 –¥–æ 90, longitude –æ—Ç -180 –¥–æ 180`,\n00058|             received: { latitude: coordinates.latitude, longitude: coordinates.longitude },\n00059|             validated: { latitude: lat, longitude: lng }\n00060|           }, { status: 400 });\n00061|         }\n00062|         \n00063|         body = {\n00064|           longitude: lng,\n00065|           latitude: lat\n00066|         };\n00067|         break;\n00068|         \n00069|       case 'calculateprice':\n00070|         urlPath = '/calculator/calculateprice/';\n00071|         const { method: methodName, ...calculationData } = requestData;\n00072|         \n00073|         // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –∞–¥—Ä–µ—Å–∞—Ö –¥–æ—Å—Ç–∞–≤–∫–∏\n00074|         console.log('üß™ API –ü—Ä–æ–∫—Å–∏: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ calculateprice');\n00075|         \n00076|         if (calculationData.pickup?.coordinates) {\n00077|           console.log('üìç API –ü—Ä–æ–∫—Å–∏: pickup.coordinates =', calculationData.pickup.coordinates);\n00078|           const lat = Number(calculationData.pickup.coordinates.latitude);\n00079|           const lng = Number(calculationData.pickup.coordinates.longitude);\n00080|           \n00081|           console.log('üìç API –ü—Ä–æ–∫—Å–∏: pickup –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ: lat=' + lat + ', lng=' + lng);\n00082|           \n00083|           if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n00084|             console.warn('‚ö†Ô∏è API –ü—Ä–æ–∫—Å–∏: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã pickup:', calculationData.pickup.coordinates);\n00085|             console.warn('‚ö†Ô∏è API –ü—Ä–æ–∫—Å–∏: –£–¥–∞–ª—è–µ–º pickup.coordinates');\n00086|             delete calculationData.pickup.coordinates;\n00087|           } else {\n00088|             console.log('‚úÖ API –ü—Ä–æ–∫—Å–∏: pickup.coordinates –≤–∞–ª–∏–¥–Ω—ã');\n00089|             calculationData.pickup.coordinates = { latitude: lat, longitude: lng };\n00090|           }\n00091|         }\n00092|         \n00093|         if (calculationData.delivery?.coordinates) {\n00094|           console.log('üìç API –ü—Ä–æ–∫—Å–∏: delivery.coordinates =', calculationData.delivery.coordinates);\n00095|           const lat = Number(calculationData.delivery.coordinates.latitude);\n00096|           const lng = Number(calculationData.delivery.coordinates.longitude);\n00097|           \n00098|           console.log('üìç API –ü—Ä–æ–∫—Å–∏: delivery –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ: lat=' + lat + ', lng=' + lng);\n00099|           \n00100|           if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n00101|             console.warn('‚ö†Ô∏è API –ü—Ä–æ–∫—Å–∏: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã delivery:', calculationData.delivery.coordinates);\n00102|             console.warn('‚ö†Ô∏è API –ü—Ä–æ–∫—Å–∏: –£–¥–∞–ª—è–µ–º delivery.coordinates');\n00103|             delete calculationData.delivery.coordinates;\n00104|           } else {\n00105|             console.log('‚úÖ API –ü—Ä–æ–∫—Å–∏: delivery.coordinates –≤–∞–ª–∏–¥–Ω—ã');\n00106|             calculationData.delivery.coordinates = { latitude: lat, longitude: lng };\n00107|           }\n00108|         }\n00109|         \n00110|         // –ü–æ–∏—Å–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ –ª—é–±—ã—Ö –ø–æ–ª—è—Ö (–≥–ª—É–±–æ–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)\n00111|         const removeInvalidCoordinates = (obj: any, path = '') => {\n00112|           if (obj && typeof obj === 'object') {\n00113|             for (const [key, value] of Object.entries(obj)) {\n00114|               const currentPath = path ? `${path}.${key}` : key;\n00115|               \n00116|               if (key === 'coordinates' && value && typeof value === 'object') {\n00117|                 const coords = value as any;\n00118|                 if (coords.latitude !== undefined || coords.longitude !== undefined) {\n00119|                   const lat = Number(coords.latitude);\n00120|                   const lng = Number(coords.longitude);\n00121|                   \n00122|                   console.log(`üìç API –ü—Ä–æ–∫—Å–∏: –ù–∞–π–¥–µ–Ω—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ ${currentPath}:`, coords);\n00123|                   \n00124|                   if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n00125|                     console.warn(`‚ö†Ô∏è API –ü—Ä–æ–∫—Å–∏: –£–¥–∞–ª—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ ${currentPath}`);\n00126|                     delete obj[key];\n00127|                   } else {\n00128|                     console.log(`‚úÖ API –ü—Ä–æ–∫—Å–∏: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ ${currentPath} –≤–∞–ª–∏–¥–Ω—ã`);\n00129|                     obj[key] = { latitude: lat, longitude: lng };\n00130|                   }\n00131|                 }\n00132|               } else if (typeof value === 'object' && value !== null) {\n00133|                 removeInvalidCoordinates(value, currentPath);\n00134|               }\n00135|             }\n00136|           }\n00137|         };\n00138|         \n00139|         removeInvalidCoordinates(calculationData);\n00140|         \n00141|         console.log('üöÄ API –ü—Ä–æ–∫—Å–∏: –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ü–≠–ö:', JSON.stringify(calculationData, null, 2));\n00142|         body = calculationData;\n00143|         break;\n00144|         \n00145|       case 'nearestdepartments':\n00146|         urlPath = '/branches/nearestdepartments/';\n00147|         const { method: nearestMethod, ...departmentData } = requestData;\n00148|         body = departmentData;\n00149|         break;\n00150|         \n00151|       case 'test':\n00152|         console.log('üîß –¢–µ—Å—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥ –ø—Ä–æ–∫—Å–∏');\n00153|         return NextResponse.json({ \n00154|           status: 'OK', \n00155|           message: '–ü—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)',\n00156|           timestamp: new Date().toISOString(),\n00157|           receivedData: requestData,\n00158|           authMethod: 'Basic Auth',\n00159|           baseUrl: BASE_URL\n00160|         });\n00161|         \n00162|       default:\n00163|         console.log('‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –º–µ—Ç–æ–¥:', method);\n00164|         return NextResponse.json({ error: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –º–µ—Ç–æ–¥', method }, { status: 400 });\n00165|     }\n00166|     \n00167|     const fullUrl = BASE_URL + urlPath;\n00168|     \n00169|     // Basic Auth —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: base64(login:api_key)\n00170|     const credentials = Buffer.from(`${PEK_LOGIN}:${PEK_API_KEY}`).toString('base64');\n00171|     \n00172|     console.log('üåê –ó–∞–ø—Ä–æ—Å –∫ –ü–≠–ö API (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è):');\n00173|     console.log('URL:', fullUrl);\n00174|     console.log('Auth: Basic (–ª–æ–≥–∏–Ω + API –∫–ª—é—á)');\n00175|     console.log('EXACT BODY TO PEK:', JSON.stringify(body, null, 2));\n00176|     \n00177|     // –ü–æ–∏—Å–∫ –ª—é–±—ã—Ö —Å–ª–æ–≤ latitude/longitude –≤ JSON\n00178|     const bodyStr = JSON.stringify(body);\n00179|     if (bodyStr.includes('latitude') || bodyStr.includes('longitude')) {\n00180|       console.warn('üö® –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ö–û–û–†–î–ò–ù–ê–¢–´ –í –ó–ê–ü–†–û–°–ï –ö –ü–≠–ö!');\n00181|       console.warn('Full body string:', bodyStr);\n00182|     }\n00183|     \n00184|     try {\n00185|       const response = await fetch(fullUrl, {\n00186|         method: 'POST',\n00187|         headers: {\n00188|           // –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n00189|           'Content-Type': 'application/json;charset=utf-8',\n00190|           'Accept': 'application/json',\n00191|           // 'Accept-Encoding': 'gzip', // –£–±–∏—Ä–∞–µ–º –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏\n00192|           'Authorization': `Basic ${credentials}`,\n00193|         },\n00194|         body: JSON.stringify(body)\n00195|       });\n00196|       \n00197|       console.log('üì° –û—Ç–≤–µ—Ç –æ—Ç –ü–≠–ö API:');\n00198|       console.log('Status:', response.status, response.statusText);\n00199|       console.log('Headers:', Object.fromEntries(response.headers.entries()));\n00200|       \n00201|       if (!response.ok) {\n00202|         const errorText = await response.text();\n00203|         console.error('‚ùå –ü–≠–ö API –æ—à–∏–±–∫–∞:', response.status, response.statusText);\n00204|         console.error('‚ùå –û—Ç–≤–µ—Ç:', errorText.substring(0, 1000));\n00205|         \n00206|         // –î–µ—Ç–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n00207|         if (response.status === 404) {\n00208|           return NextResponse.json({ \n00209|             error: '–ú–µ—Ç–æ–¥ API –Ω–µ –Ω–∞–π–¥–µ–Ω',\n00210|             details: 'URL –º–µ—Ç–æ–¥–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',\n00211|             url: fullUrl,\n00212|             method: method,\n00213|             suggestion: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø—É—Ç–∏ –∫ –º–µ—Ç–æ–¥—É'\n00214|           }, { status: 404 });\n00215|         }\n00216|         \n00217|         if (response.status === 403) {\n00218|           return NextResponse.json({ \n00219|             error: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω',\n00220|             details: '–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ—Ç–æ–¥—É',\n00221|             suggestion: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞'\n00222|           }, { status: 403 });\n00223|         }\n00224|         \n00225|         if (response.status === 401) {\n00226|           return NextResponse.json({ \n00227|             error: '–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏',\n00228|             details: '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ API –∫–ª—é—á',\n00229|             suggestion: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ü–≠–ö'\n00230|           }, { status: 401 });\n00231|         }\n00232|         \n00233|         return NextResponse.json({ \n00234|           error: `–ü–≠–ö API –æ—à–∏–±–∫–∞: ${response.status} ${response.statusText}`,\n00235|           details: errorText,\n00236|           url: fullUrl,\n00237|           method,\n00238|           requestBody: body\n00239|         }, { status: response.status });\n00240|       }\n00241|       \n00242|       const responseText = await response.text();\n00243|       console.log('‚úÖ –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç –ü–≠–ö:', responseText.substring(0, 500));\n00244|       \n00245|       try {\n00246|         const data = JSON.parse(responseText);\n00247|         \n00248|         // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n00249|         if (data.error) {\n00250|           console.error('‚ùå –õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ü–≠–ö:', data.error);\n00251|           return NextResponse.json({ \n00252|             error: data.error.title || '–õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ API',\n00253|             details: data.error.message || '–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã',\n00254|             apiError: true,\n00255|             originalError: data.error\n00256|           }, { status: 400 });\n00257|         }\n00258|         \n00259|         return NextResponse.json(data);\n00260|       } catch (parseError) {\n00261|         console.error('‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', parseError);\n00262|         return NextResponse.json({ \n00263|           error: '–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞',\n00264|           details: responseText.substring(0, 1000)\n00265|         }, { status: 500 });\n00266|       }\n00267|       \n00268|     } catch (fetchError) {\n00269|       console.error('‚ùå –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞:', fetchError);\n00270|       return NextResponse.json({ \n00271|         error: '–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞',\n00272|         details: fetchError instanceof Error ? fetchError.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞',\n00273|         url: fullUrl\n00274|       }, { status: 503 });\n00275|     }\n00276|     \n00277|   } catch (error) {\n00278|     console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏ –ü–≠–ö API:', error);\n00279|     \n00280|     if (error instanceof Error) {\n00281|       console.error('Stack trace:', error.stack);\n00282|     }\n00283|     \n00284|     return NextResponse.json({ \n00285|       error: '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞',\n00286|       details: error instanceof Error ? error.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞',\n00287|       type: error instanceof Error ? error.name : 'Unknown',\n00288|       stack: error instanceof Error ? error.stack : undefined\n00289|     }, { status: 500 });\n00290|   }\n00291| }\n</file>",
    "metadata": {
      "preview": "import { NextRequest, NextResponse } from 'next/server';\n\nexport async function POST(request: NextRequest) {\n  try {\n    console.log('üîß –ü–≠–ö –ü—Ä–æ–∫—Å–∏: –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å (–ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)');\n    \n    const requestData = await request.json();\n    console.log('üìù –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞:', JSON.stringify(requestData, null, 2));\n    \n    const { method, address, coordinates } = requestData;\n    \n    // –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ü–≠–ö\n    const PEK_API_KEY = process.env.PEK_API_KEY || '624FC93CA677B23673BB476D4982294DC27E246F';\n    const PEK_LOGIN = process.env.PEK_LOGIN || 'demo';\n    \n    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ-—Ç–µ—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤\n    if (method !== 'test' && (!process.env.PEK_LOGIN || !process.env.PEK_API_KEY)) {\n      console.warn('‚ö†Ô∏è –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è PEK_LOGIN –∏ PEK_API_KEY');\n      console.warn('‚ö†Ô∏è –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ /env-check –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏');\n      "
    },
    "title": "app/api/pek/route.ts",
    "time": {
      "start": 1759007385031,
      "end": 1759007385033
    }
  }
}