{
  "id": "prt_a970dbed5001LBe2FeV6ckcyRa",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "messageID": "msg_a970d43eb001TM9uRn9hVBxo27",
  "type": "tool",
  "callID": "call_43901324",
  "tool": "edit",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "app/page.tsx",
      "newString": "  const calculateVozovoz = async (): Promise<CalculationResult> => {\n    const apiUrl = '/api/vozovoz';\n    \n    try {\n      // –í—ã—á–∏—Å–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞\n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n      \n      // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –í–æ–∑–æ–≤–æ–∑\n      const maxDimensions = form.cargos.reduce((max, cargo) => {\n        const length = cargo.length / 1000; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –º–º –≤ –º\n        const width = cargo.width / 1000;\n        const height = cargo.height / 1000;\n        const weight = cargo.weight;\n        \n        return {\n          length: Math.max(max.length, length),\n          width: Math.max(max.width, width),\n          height: Math.max(max.height, height),\n          weight: Math.max(max.weight, weight)\n        };\n      }, { length: 0, width: 0, height: 0, weight: 0 });\n      \n      console.log('üöö –í–æ–∑–æ–≤–æ–∑: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');\n      console.log('   - –û–±—â–∏–π –≤–µ—Å:', totalWeight, '–∫–≥');\n      console.log('   - –û–±—â–∏–π –æ–±—ä–µ–º:', totalVolume, '–º¬≥');\n      console.log('   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã:', maxDimensions);\n      console.log('   - –û—Ç–∫—É–¥–∞:', form.fromCity);\n      console.log('   - –ö—É–¥–∞:', form.toCity);\n      \n      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ç–∏–ø–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏\n      const createRequestData = (useAddressType: boolean) => ({\n        object: \"price\",\n        action: \"get\",\n        params: {\n          cargo: {\n            dimension: {\n              max: {                              // ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É max\n                length: maxDimensions.length,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n                width: maxDimensions.width,       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n                height: maxDimensions.height,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n                weight: maxDimensions.weight      // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –∫–≥\n              },\n              quantity: form.cargos.length,       // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç\n              volume: totalVolume,                // –û–±—â–∏–π –æ–±—ä–µ–º –≤ –º¬≥\n              weight: totalWeight                 // –û–±—â–∏–π –≤–µ—Å –≤ –∫–≥\n            },\n            ...(form.needInsurance && form.declaredValue > 0 ? {\n              insurance: form.declaredValue,      // ‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ\n              insuranceNdv: false                 // –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n            } : {\n              insuranceNdv: true                  // –í–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n            }),\n             ...(form.needPackaging ? {\n               wrapping: {\n                 \"hardPackageVolume\": totalVolume  // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ \"–ñ—ë—Å—Ç–∫–∞—è —É–ø–∞–∫–æ–≤–∫–∞\" –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n               }\n             } : {})\n          },\n          gateway: {\n            dispatch: {\n              point: {\n                location: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n                // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n                ...(useAddressType || form.fromAddressDelivery ? {\n                  address: form.fromAddress || \"–∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\"\n                } : {\n                  terminal: \"default\"\n                })\n              }\n            },\n            destination: {\n              point: {\n                location: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n                // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n                ...(useAddressType || form.toAddressDelivery ? {\n                  address: form.toAddress || \"–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω–∏—è\"\n                } : {\n                  terminal: \"default\"\n                })\n              }\n            }\n          }\n        }\n      });\n\n      // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º —Å terminal —Ç–∏–ø–æ–º (–µ—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω address delivery)\n      let useAddressType = false;\n      let requestData = createRequestData(useAddressType);\n      \n      console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n\n      let result = await enhancedApiRequest(\n        apiUrl,\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(requestData)\n        },\n        { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n      );\n\n      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∞ –æ —Ç–æ–º, —á—Ç–æ –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è terminal\n      if (result && typeof result === 'object' && 'success' in result && !result.success) {\n        const errorMessage = result.error?.userMessage || result.error?.message || '';\n        console.log('üöö –í–æ–∑–æ–≤–æ–∑: –ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å terminal –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É:', errorMessage);\n        \n        // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –≥–æ—Ä–æ–¥–æ–º/—Ç–µ—Ä–º–∏–Ω–∞–ª–æ–º, –ø—Ä–æ–±—É–µ–º —Å address —Ç–∏–ø–æ–º\n        if (errorMessage.toLowerCase().includes('–≥–æ—Ä–æ–¥') || \n            errorMessage.toLowerCase().includes('—Ç–µ—Ä–º–∏–Ω–∞–ª') || \n            errorMessage.toLowerCase().includes('city') ||\n            errorMessage.toLowerCase().includes('terminal')) {\n          \n          console.log('üöö –í–æ–∑–æ–≤–æ–∑: –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è terminal, –ø—Ä–æ–±—É–µ–º —Å address —Ç–∏–ø–æ–º...');\n          useAddressType = true;\n          requestData = createRequestData(useAddressType);\n          \n          console.log('üöö –í–æ–∑–æ–≤–æ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å address:', JSON.stringify(requestData, null, 2));\n          \n          result = await enhancedApiRequest(\n            apiUrl,\n            {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify(requestData)\n            },\n            { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n          );\n        }\n      }\n\n      if (result && typeof result === 'object' && 'success' in result && !result.success) {\n        console.error('‚ùå –í–æ–∑–æ–≤–æ–∑ API –æ—à–∏–±–∫–∞:', result.error);\n        return {\n          company: '–í–æ–∑–æ–≤–æ–∑',\n          price: 0,\n          days: 0,\n          error: result.error.userMessage || result.error.message,\n          requestData,\n          responseData: null,\n          apiUrl\n        };\n      }\n\n      const response = result as Response;\n      const data = await response.json();\n      console.log('üöö –í–æ–∑–æ–≤–æ–∑ –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n\n      if (response.ok && data.response) {\n        const responseData = data.response;\n        \n        console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:', responseData);\n        \n        // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n        const services: { name: string; description: string; price: number }[] = [];\n        let totalPrice = responseData.price || responseData.basePrice || 0;\n        \n        // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API\n        if (responseData.service && Array.isArray(responseData.service)) {\n          console.log('üöö –í–æ–∑–æ–≤–æ–∑ –Ω–∞–π–¥–µ–Ω –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥:', responseData.service.length);\n          \n          responseData.service.forEach((service: any, index: number) => {\n            console.log(`üöö –£—Å–ª—É–≥–∞ [${index}]:`, service);\n            if (service.price > 0) {\n              services.push({\n                name: service.name || '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞',\n                description: service.description || '',\n                price: service.price\n              });\n            }\n          });\n        } else {\n          console.log('üöö –í–æ–∑–æ–≤–æ–∑: –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—É—Å—Ç');\n          \n          // –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤–∞ —É—Å–ª—É–≥ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n          if (responseData.basePrice && responseData.basePrice > 0) {\n            services.push({\n              name: '–ë–∞–∑–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞',\n              description: `${form.fromCity} - ${form.toCity}`,\n              price: responseData.basePrice\n            });\n          }\n          \n          // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë –æ—Ç–¥–µ–ª—å–Ω–æ\n          if (responseData.price !== responseData.basePrice && responseData.price > 0) {\n            const discount = (responseData.basePrice || 0) - responseData.price;\n            if (discount > 0) {\n              services.push({\n                name: '–°–∫–∏–¥–∫–∞',\n                description: '–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —Å–∫–∏–¥–∫–∞',\n                price: -discount\n              });\n            }\n          }\n        }\n        \n        // –ï—Å–ª–∏ –Ω–∏–∫–∞–∫–∏—Ö —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n        if (services.length === 0 && totalPrice > 0) {\n          services.push({\n            name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n            description: `${form.fromCity} - ${form.toCity}`,\n            price: totalPrice\n          });\n        }\n\n        console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', totalPrice);\n        console.log('üöö –í–æ–∑–æ–≤–æ–∑ —É—Å–ª—É–≥–∏:', services);\n\n        return {\n          company: '–í–æ–∑–æ–≤–æ–∑',\n          price: Math.round(totalPrice),\n          days: responseData.deliveryTime?.to || responseData.deliveryTime?.from || 3,\n          details: {\n            note: `–î–æ—Å—Ç–∞–≤–∫–∞ ${form.fromCity} - ${form.toCity}`,\n            services,\n            basePrice: responseData.basePrice,\n            finalPrice: responseData.price,\n            deliveryTime: responseData.deliveryTime,\n            weight: totalWeight,\n            volume: totalVolume\n          },\n          requestData,\n          responseData: data,\n          apiUrl\n        };\n      } else {\n        return {\n          company: '–í–æ–∑–æ–≤–æ–∑',\n          price: 0,\n          days: 0,\n          error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –í–æ–∑–æ–≤–æ–∑',\n          requestData,\n          responseData: data,\n          apiUrl\n        };\n      }\n    } catch (error: any) {\n      console.error('üöö –í–æ–∑–æ–≤–æ–∑ –æ—à–∏–±–∫–∞:', error);\n      return {\n        company: '–í–æ–∑–æ–≤–æ–∑',\n        price: 0,\n        days: 0,\n        error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n        apiUrl\n      };\n    }\n  };",
      "oldString": "  const calculateVozovoz = async (): Promise<CalculationResult> => {\n    const apiUrl = '/api/vozovoz';\n    \n    try {\n      // –í—ã—á–∏—Å–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞\n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n      \n      // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –í–æ–∑–æ–≤–æ–∑\n      const maxDimensions = form.cargos.reduce((max, cargo) => {\n        const length = cargo.length / 1000; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –º–º –≤ –º\n        const width = cargo.width / 1000;\n        const height = cargo.height / 1000;\n        const weight = cargo.weight;\n        \n        return {\n          length: Math.max(max.length, length),\n          width: Math.max(max.width, width),\n          height: Math.max(max.height, height),\n          weight: Math.max(max.weight, weight)\n        };\n      }, { length: 0, width: 0, height: 0, weight: 0 });\n      \n      console.log('üöö –í–æ–∑–æ–≤–æ–∑: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');\n      console.log('   - –û–±—â–∏–π –≤–µ—Å:', totalWeight, '–∫–≥');\n      console.log('   - –û–±—â–∏–π –æ–±—ä–µ–º:', totalVolume, '–º¬≥');\n      console.log('   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã:', maxDimensions);\n      console.log('   - –û—Ç–∫—É–¥–∞:', form.fromCity);\n      console.log('   - –ö—É–¥–∞:', form.toCity);\n      \n        // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è API Vozovoz —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n        const requestData = {\n          object: \"price\",\n          action: \"get\",\n          params: {\n            cargo: {\n              dimension: {\n                max: {                              // ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É max\n                  length: maxDimensions.length,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n                  width: maxDimensions.width,       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n                  height: maxDimensions.height,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n                  weight: maxDimensions.weight      // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –∫–≥\n                },\n                quantity: form.cargos.length,       // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç\n                volume: totalVolume,                // –û–±—â–∏–π –æ–±—ä–µ–º –≤ –º¬≥\n                weight: totalWeight                 // –û–±—â–∏–π –≤–µ—Å –≤ –∫–≥\n              },\n              ...(form.needInsurance && form.declaredValue > 0 ? {\n                insurance: form.declaredValue,      // ‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ\n                insuranceNdv: false                 // –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n              } : {\n                insuranceNdv: true                  // –í–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n              }),\n               ...(form.needPackaging ? {\n                 wrapping: {\n                   \"hardPackageVolume\": totalVolume  // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ \"–ñ—ë—Å—Ç–∫–∞—è —É–ø–∞–∫–æ–≤–∫–∞\" –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n                 }\n               } : {})\n            },\n            gateway: {\n              dispatch: {\n                point: {\n                  location: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n                  // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n                  ...(form.fromAddressDelivery ? {\n                    address: form.fromAddress || \"–∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\"\n                  } : {\n                    terminal: \"default\"\n                  })\n                }\n              },\n              destination: {\n                point: {\n                  location: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n                  // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n                  ...(form.toAddressDelivery ? {\n                    address: form.toAddress || \"–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω–∏—è\"\n                  } : {\n                    terminal: \"default\"\n                  })\n                }\n              }\n            }\n          }\n        };\n\n      console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n\n        const result = await enhancedApiRequest(\n          apiUrl,\n          {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(requestData)\n          },\n          { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n        );\n\n        if (result && typeof result === 'object' && 'success' in result && !result.success) {\n          console.error('‚ùå –í–æ–∑–æ–≤–æ–∑ API –æ—à–∏–±–∫–∞:', result.error);\n          return {\n            company: '–í–æ–∑–æ–≤–æ–∑',\n            price: 0,\n            days: 0,\n            error: result.error.userMessage || result.error.message,\n            requestData,\n            responseData: null,\n            apiUrl\n          };\n        }\n\n        const response = result as Response;\n        const data = await response.json();\n        console.log('üöö –í–æ–∑–æ–≤–æ–∑ –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n\n      if (response.ok && data.response) {\n        const responseData = data.response;\n        \n        console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:', responseData);\n        \n        // ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n        const services: { name: string; description: string; price: number }[] = [];\n        let totalPrice = responseData.price || responseData.basePrice || 0;\n        \n        // ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API\n        if (responseData.service && Array.isArray(responseData.service)) {\n          console.log('üöö –í–æ–∑–æ–≤–æ–∑ –Ω–∞–π–¥–µ–Ω –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥:', responseData.service.length);\n          \n          responseData.service.forEach((service: any, index: number) => {\n            console.log(`üöö –£—Å–ª—É–≥–∞ [${index}]:`, service);\n            if (service.price > 0) {\n              services.push({\n                name: service.name || '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É—Å–ª—É–≥–∞',\n                description: service.description || '',\n                price: service.price\n              });\n            }\n          });\n        } else {\n          console.log('üöö –í–æ–∑–æ–≤–æ–∑: –º–∞—Å—Å–∏–≤ —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—É—Å—Ç');\n          \n          // –ï—Å–ª–∏ –º–∞—Å—Å–∏–≤–∞ —É—Å–ª—É–≥ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n          if (responseData.basePrice && responseData.basePrice > 0) {\n            services.push({\n              name: '–ë–∞–∑–æ–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞',\n              description: `${form.fromCity} - ${form.toCity}`,\n              price: responseData.basePrice\n            });\n          }\n          \n          // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∫–∏–¥–∫–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë –æ—Ç–¥–µ–ª—å–Ω–æ\n          if (responseData.price !== responseData.basePrice && responseData.price > 0) {\n            const discount = (responseData.basePrice || 0) - responseData.price;\n            if (discount > 0) {\n              services.push({\n                name: '–°–∫–∏–¥–∫–∞',\n                description: '–ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —Å–∫–∏–¥–∫–∞',\n                price: -discount\n              });\n            }\n          }\n        }\n        \n        // –ï—Å–ª–∏ –Ω–∏–∫–∞–∫–∏—Ö —É—Å–ª—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å\n        if (services.length === 0 && totalPrice > 0) {\n          services.push({\n            name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n            description: `${form.fromCity} - ${form.toCity}`,\n            price: totalPrice\n          });\n        }\n\n        console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å:', totalPrice);\n        console.log('üöö –í–æ–∑–æ–≤–æ–∑ —É—Å–ª—É–≥–∏:', services);\n\n        return {\n          company: '–í–æ–∑–æ–≤–æ–∑',\n          price: Math.round(totalPrice),\n          days: responseData.deliveryTime?.to || responseData.deliveryTime?.from || 3,\n          details: {\n            note: `–î–æ—Å—Ç–∞–≤–∫–∞ ${form.fromCity} - ${form.toCity}`,\n            services,\n            basePrice: responseData.basePrice,\n            finalPrice: responseData.price,\n            deliveryTime: responseData.deliveryTime,\n            weight: totalWeight,\n            volume: totalVolume\n          },\n          requestData,\n          responseData: data,\n          apiUrl\n        };\n      } else {\n        return {\n          company: '–í–æ–∑–æ–≤–æ–∑',\n          price: 0,\n          days: 0,\n          error: data.error || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –í–æ–∑–æ–≤–æ–∑',\n          requestData,\n          responseData: data,\n          apiUrl\n        };\n      }\n    } catch (error: any) {\n      console.error('üöö –í–æ–∑–æ–≤–æ–∑ –æ—à–∏–±–∫–∞:', error);\n      return {\n        company: '–í–æ–∑–æ–≤–æ–∑',\n        price: 0,\n        days: 0,\n        error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n        apiUrl\n      };\n    }\n  };"
    },
    "output": "",
    "title": "app/page.tsx",
    "metadata": {
      "diagnostics": {},
      "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -3215,95 +3215,130 @@\n console.log('   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –≥–∞–±–∞—Ä–∏—Ç—ã:', maxDimensions);\n console.log('   - –û—Ç–∫—É–¥–∞:', form.fromCity);\n console.log('   - –ö—É–¥–∞:', form.toCity);\n \n- // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è API Vozovoz —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n- const requestData = {\n-   object: \"price\",\n-   action: \"get\",\n-   params: {\n-     cargo: {\n-       dimension: {\n-         max: {                              // ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É max\n-           length: maxDimensions.length,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n-           width: maxDimensions.width,       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n-           height: maxDimensions.height,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n-           weight: maxDimensions.weight      // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –∫–≥\n-         },\n-         quantity: form.cargos.length,       // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç\n-         volume: totalVolume,                // –û–±—â–∏–π –æ–±—ä–µ–º –≤ –º¬≥\n-         weight: totalWeight                 // –û–±—â–∏–π –≤–µ—Å –≤ –∫–≥\n-       },\n-       ...(form.needInsurance && form.declaredValue > 0 ? {\n-         insurance: form.declaredValue,      // ‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ\n-         insuranceNdv: false                 // –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n-       } : {\n-         insuranceNdv: true                  // –í–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n-       }),\n-        ...(form.needPackaging ? {\n-          wrapping: {\n-            \"hardPackageVolume\": totalVolume  // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ \"–ñ—ë—Å—Ç–∫–∞—è —É–ø–∞–∫–æ–≤–∫–∞\" –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n-          }\n-        } : {})\n-     },\n-     gateway: {\n-       dispatch: {\n-         point: {\n-           location: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n-           // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n-           ...(form.fromAddressDelivery ? {\n-             address: form.fromAddress || \"–∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\"\n-           } : {\n-             terminal: \"default\"\n-           })\n+// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ç–∏–ø–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏\n+const createRequestData = (useAddressType: boolean) => ({\n+  object: \"price\",\n+  action: \"get\",\n+  params: {\n+    cargo: {\n+      dimension: {\n+        max: {                              // ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É max\n+          length: maxDimensions.length,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n+          width: maxDimensions.width,       // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n+          height: maxDimensions.height,     // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö\n+          weight: maxDimensions.weight      // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –≤ –∫–≥\n+        },\n+        quantity: form.cargos.length,       // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç\n+        volume: totalVolume,                // –û–±—â–∏–π –æ–±—ä–µ–º –≤ –º¬≥\n+        weight: totalWeight                 // –û–±—â–∏–π –≤–µ—Å –≤ –∫–≥\n+      },\n+      ...(form.needInsurance && form.declaredValue > 0 ? {\n+        insurance: form.declaredValue,      // ‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ\n+        insuranceNdv: false                 // –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n+      } : {\n+        insuranceNdv: true                  // –í–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n+      }),\n+       ...(form.needPackaging ? {\n+         wrapping: {\n+           \"hardPackageVolume\": totalVolume  // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ \"–ñ—ë—Å—Ç–∫–∞—è —É–ø–∞–∫–æ–≤–∫–∞\" –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n          }\n-       },\n-       destination: {\n-         point: {\n-           location: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n-           // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n-           ...(form.toAddressDelivery ? {\n-             address: form.toAddress || \"–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω–∏—è\"\n-           } : {\n-             terminal: \"default\"\n-           })\n-         }\n-       }\n-     }\n-   }\n- };\n+       } : {})\n+    },\n+    gateway: {\n+      dispatch: {\n+        point: {\n+          location: form.fromCity || '–ú–æ—Å–∫–≤–∞',\n+          // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n+          ...(useAddressType || form.fromAddressDelivery ? {\n+            address: form.fromAddress || \"–∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è\"\n+          } : {\n+            terminal: \"default\"\n+          })\n+        }\n+      },\n+      destination: {\n+        point: {\n+          location: form.toCity || '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n+          // ‚úÖ –ü–æ–ª—è address –∏ terminal –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏\n+          ...(useAddressType || form.toAddressDelivery ? {\n+            address: form.toAddress || \"–∞–¥—Ä–µ—Å –ø–æ–ª—É—á–µ–Ω–∏—è\"\n+          } : {\n+            terminal: \"default\"\n+          })\n+        }\n+      }\n+    }\n+  }\n+});\n \n+// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º —Å terminal —Ç–∏–ø–æ–º (–µ—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω address delivery)\n+let useAddressType = false;\n+let requestData = createRequestData(useAddressType);\n+\n console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n \n- const result = await enhancedApiRequest(\n-   apiUrl,\n-   {\n-     method: 'POST',\n-     headers: {\n-       'Content-Type': 'application/json',\n-     },\n-     body: JSON.stringify(requestData)\n-   },\n-   { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n- );\n+let result = await enhancedApiRequest(\n+  apiUrl,\n+  {\n+    method: 'POST',\n+    headers: {\n+      'Content-Type': 'application/json',\n+    },\n+    body: JSON.stringify(requestData)\n+  },\n+  { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n+);\n \n- if (result && typeof result === 'object' && 'success' in result && !result.success) {\n-   console.error('‚ùå –í–æ–∑–æ–≤–æ–∑ API –æ—à–∏–±–∫–∞:', result.error);\n-   return {\n-     company: '–í–æ–∑–æ–≤–æ–∑',\n-     price: 0,\n-     days: 0,\n-     error: result.error.userMessage || result.error.message,\n-     requestData,\n-     responseData: null,\n-     apiUrl\n-   };\n- }\n+// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∞ –æ —Ç–æ–º, —á—Ç–æ –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è terminal\n+if (result && typeof result === 'object' && 'success' in result && !result.success) {\n+  const errorMessage = result.error?.userMessage || result.error?.message || '';\n+  console.log('üöö –í–æ–∑–æ–≤–æ–∑: –ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å terminal –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É:', errorMessage);\n+  \n+  // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –≥–æ—Ä–æ–¥–æ–º/—Ç–µ—Ä–º–∏–Ω–∞–ª–æ–º, –ø—Ä–æ–±—É–µ–º —Å address —Ç–∏–ø–æ–º\n+  if (errorMessage.toLowerCase().includes('–≥–æ—Ä–æ–¥') || \n+      errorMessage.toLowerCase().includes('—Ç–µ—Ä–º–∏–Ω–∞–ª') || \n+      errorMessage.toLowerCase().includes('city') ||\n+      errorMessage.toLowerCase().includes('terminal')) {\n+    \n+    console.log('üöö –í–æ–∑–æ–≤–æ–∑: –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è terminal, –ø—Ä–æ–±—É–µ–º —Å address —Ç–∏–ø–æ–º...');\n+    useAddressType = true;\n+    requestData = createRequestData(useAddressType);\n+    \n+    console.log('üöö –í–æ–∑–æ–≤–æ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å address:', JSON.stringify(requestData, null, 2));\n+    \n+    result = await enhancedApiRequest(\n+      apiUrl,\n+      {\n+        method: 'POST',\n+        headers: {\n+          'Content-Type': 'application/json',\n+        },\n+        body: JSON.stringify(requestData)\n+      },\n+      { operation: 'calculate', company: '–í–æ–∑–æ–≤–æ–∑' }\n+    );\n+  }\n+}\n \n- const response = result as Response;\n- const data = await response.json();\n- console.log('üöö –í–æ–∑–æ–≤–æ–∑ –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n+if (result && typeof result === 'object' && 'success' in result && !result.success) {\n+  console.error('‚ùå –í–æ–∑–æ–≤–æ–∑ API –æ—à–∏–±–∫–∞:', result.error);\n+  return {\n+    company: '–í–æ–∑–æ–≤–æ–∑',\n+    price: 0,\n+    days: 0,\n+    error: result.error.userMessage || result.error.message,\n+    requestData,\n+    responseData: null,\n+    apiUrl\n+  };\n+}\n \n+const response = result as Response;\n+const data = await response.json();\n+console.log('üöö –í–æ–∑–æ–≤–æ–∑ –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n+\n if (response.ok && data.response) {\n   const responseData = data.response;\n   \n   console.log('üöö –í–æ–∑–æ–≤–æ–∑ –∞–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:', responseData);\n"
    },
    "time": {
      "start": 1763470851800,
      "end": 1763470851853
    }
  }
}