{
  "id": "prt_ab8841a55001W5R6Rg3ezQi16I",
  "sessionID": "ses_54b97e247ffenCZZa4jZiIWD0l",
  "messageID": "msg_ab88346e5001Ll7FHnTfaueEq7",
  "type": "tool",
  "callID": "call_0a064df6d2ec4a1f8c6d4024",
  "tool": "multiedit",
  "state": {
    "status": "completed",
    "input": {
      "edits": [
        {
          "newString": "      checkAPIStatus('nordwheel', async () => {\n        try {\n          // Use the same API endpoint and format as the main calculation function\n          const requestData = {\n            dispatch: {\n              location: {\n                type: 'terminal',\n                city_fias: '0c5b2444-70a0-4932-980c-b4dc0d3f02b5' // Moscow\n              }\n            },\n            destination: {\n              location: {\n                type: 'terminal',\n                city_fias: 'c2deb16a-0330-4f05-821f-1d09c93331e6' // St. Petersburg\n              }\n            },\n            cargo: {\n              total_weight: 10,\n              total_volume: 0.1,\n              total_quantity: 1\n            },\n            insurance: 50000,\n            insurance_refuse: false,\n            services: {\n              is_package: true,\n              is_documents_return: false,\n              is_fragile: false\n            },\n            promocode: null\n          };\n\n          const result = await enhancedApiRequest(\n            '/api/nordwheel',\n            {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify(requestData)\n            },\n            { operation: 'calculate', company: 'Nord Wheel' }\n          );\n\n          if (result && typeof result === 'object' && 'success' in result && !result.success) {\n            console.error('❌ Nord Wheel API ошибка:', result.error);\n            return { error: true };\n          }\n\n          const response = result as Response;\n          const data = await response.json();\n          \n          if (response.ok && (data.success || data.auto || data.avia)) {\n            return { success: true };\n          } else {\n            return { error: true };\n          }\n        } catch (error) {\n          return { error: true };\n        }\n      }),",
          "oldString": "      checkAPIStatus('nordwheel', async () => {\n        try {\n          const totalWeight = 10;\n          const totalVolume = 0.1;\n          \n          const params = new URLSearchParams({\n            from: '91',\n            to: '92',\n            pickup: '1',\n            deliver: '1',\n            weight: totalWeight.toString(),\n            volume: totalVolume.toString(),\n            oversized: '0',\n            package: '1',\n            packageCount: '1',\n            insurance: '1',\n            sum: '50000',\n            documentsReturn: '0',\n            fragile: '1'\n          });\n\n          const fullUrl = `https://nordw.ru/tools/api/calc/calculate/?${params.toString()}`;\n        const result = await enhancedApiRequest(\n          fullUrl,\n          {\n            method: 'GET'\n          },\n          { operation: 'calculate', company: 'Nord Wheel' }\n        );\n\n         if (result && typeof result === 'object' && 'success' in result && !result.success) {\n           console.error('❌ Nord Wheel API ошибка:', result.error);\n           return {\n             company: 'Nord Wheel',\n             price: 0,\n             days: 0,\n             error: result.error.userMessage || result.error.message,\n             requestData: params,\n             responseData: null,\n             apiUrl: fullUrl\n           };\n         }\n\n        const response = result as Response;\n        const data = await response.json();\n           \n          if (response.ok && data.status === 'success') {\n            return { success: true };\n          } else {\n            return { error: true };\n          }\n        } catch (error) {\n          return { error: true };\n        }\n      }),"
        }
      ],
      "filePath": "/home/user/project/app/page.tsx"
    },
    "output": "",
    "title": "app/page.tsx",
    "metadata": {
      "results": [
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -624,53 +624,58 @@\n }),\n \n checkAPIStatus('nordwheel', async () => {\n   try {\n-    const totalWeight = 10;\n-    const totalVolume = 0.1;\n-    \n-    const params = new URLSearchParams({\n-      from: '91',\n-      to: '92',\n-      pickup: '1',\n-      deliver: '1',\n-      weight: totalWeight.toString(),\n-      volume: totalVolume.toString(),\n-      oversized: '0',\n-      package: '1',\n-      packageCount: '1',\n-      insurance: '1',\n-      sum: '50000',\n-      documentsReturn: '0',\n-      fragile: '1'\n-    });\n+    // Use the same API endpoint and format as the main calculation function\n+    const requestData = {\n+      dispatch: {\n+        location: {\n+          type: 'terminal',\n+          city_fias: '0c5b2444-70a0-4932-980c-b4dc0d3f02b5' // Moscow\n+        }\n+      },\n+      destination: {\n+        location: {\n+          type: 'terminal',\n+          city_fias: 'c2deb16a-0330-4f05-821f-1d09c93331e6' // St. Petersburg\n+        }\n+      },\n+      cargo: {\n+        total_weight: 10,\n+        total_volume: 0.1,\n+        total_quantity: 1\n+      },\n+      insurance: 50000,\n+      insurance_refuse: false,\n+      services: {\n+        is_package: true,\n+        is_documents_return: false,\n+        is_fragile: false\n+      },\n+      promocode: null\n+    };\n \n-    const fullUrl = `https://nordw.ru/tools/api/calc/calculate/?${params.toString()}`;\n- const result = await enhancedApiRequest(\n-   fullUrl,\n-   {\n-     method: 'GET'\n-   },\n-   { operation: 'calculate', company: 'Nord Wheel' }\n- );\n+    const result = await enhancedApiRequest(\n+      '/api/nordwheel',\n+      {\n+        method: 'POST',\n+        headers: {\n+          'Content-Type': 'application/json'\n+        },\n+        body: JSON.stringify(requestData)\n+      },\n+      { operation: 'calculate', company: 'Nord Wheel' }\n+    );\n \n-  if (result && typeof result === 'object' && 'success' in result && !result.success) {\n-    console.error('❌ Nord Wheel API ошибка:', result.error);\n-    return {\n-      company: 'Nord Wheel',\n-      price: 0,\n-      days: 0,\n-      error: result.error.userMessage || result.error.message,\n-      requestData: params,\n-      responseData: null,\n-      apiUrl: fullUrl\n-    };\n-  }\n+    if (result && typeof result === 'object' && 'success' in result && !result.success) {\n+      console.error('❌ Nord Wheel API ошибка:', result.error);\n+      return { error: true };\n+    }\n \n- const response = result as Response;\n- const data = await response.json();\n+    const response = result as Response;\n+    const data = await response.json();\n     \n-    if (response.ok && data.status === 'success') {\n+    if (response.ok && (data.success || data.auto || data.avia)) {\n       return { success: true };\n     } else {\n       return { error: true };\n     }\n"
        }
      ]
    },
    "time": {
      "start": 1764032256602,
      "end": 1764032256651
    }
  }
}