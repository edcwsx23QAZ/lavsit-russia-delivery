{
  "id": "prt_986d41ad8001F35xfwyixCsLxM",
  "messageID": "msg_986d3bc96001LRXK8i33WwTAqy",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_01WMSizAf4niddnLaw1pTNTo",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx",
      "offset": 950,
      "limit": 100
    },
    "output": "<file>\n00951|       if (coords && coords.length === 2) {\n00952|         return {\n00953|           longitude: coords[0],\n00954|           latitude: coords[1]\n00955|         };\n00956|       }\n00957|       \n00958|       return null;\n00959|     } catch (error) {\n00960|       console.error('Ошибка получения координат Яндекс:', error);\n00961|       return null;\n00962|     }\n00963|   };\n00964| \n00965|   // Расчет для ПЭК через официальный API v1/calculateprice/\n00966|   const calculatePEK = async (): Promise<CalculationResult> => {\n00967|     const apiUrl = 'https://kabinet.pecom.ru/api/v1/calculateprice/';\n00968|     \n00969|     try {\n00970|       // Получаем информацию о зонах и складах по адресам\n00971|       const senderZone = await getPekZoneByAddress(form.fromAddress || `Россия, ${form.fromCity}`);\n00972|       const receiverZone = await getPekZoneByAddress(form.toAddress || `Россия, ${form.toCity}`);\n00973|       \n00974|       if (!senderZone || !receiverZone) {\n00975|         return {\n00976|           company: 'ПЭК',\n00977|           price: 0,\n00978|           days: 0,\n00979|           error: `Зона ПЭК не обслуживается. Проверьте адреса: ${!senderZone ? (form.fromAddress || form.fromCity) : ''} ${!receiverZone ? (form.toAddress || form.toCity) : ''}`.trim(),\n00980|           apiUrl,\n00981|           requestData: { fromAddress: form.fromAddress || form.fromCity, toAddress: form.toAddress || form.toCity },\n00982|           responseData: null\n00983|         };\n00984|       }\n00985| \n00986|       // Получаем ближайшие отделения если нужна адресная доставка\n00987|       let senderWarehouseId = senderZone.mainWarehouseId;\n00988|       let receiverWarehouseId = receiverZone.mainWarehouseId;\n00989|       \n00990|       if (form.fromAddressDelivery && senderZone.warehousePoint) {\n00991|         const senderDepartment = await getPekNearestDepartments(\n00992|           form.fromAddress || form.fromCity,\n00993|           {\n00994|             latitude: senderZone.warehousePoint.latitude.toString(),\n00995|             longitude: senderZone.warehousePoint.longitude.toString()\n00996|           }\n00997|         );\n00998|         if (senderDepartment) {\n00999|           senderWarehouseId = senderDepartment.warehouseId;\n01000|         }\n01001|       }\n01002|       \n01003|       if (form.toAddressDelivery && receiverZone.warehousePoint) {\n01004|         const receiverDepartment = await getPekNearestDepartments(\n01005|           form.toAddress || form.toCity,\n01006|           {\n01007|             latitude: receiverZone.warehousePoint.latitude.toString(),\n01008|             longitude: receiverZone.warehousePoint.longitude.toString()\n01009|           }\n01010|         );\n01011|         if (receiverDepartment) {\n01012|           receiverWarehouseId = receiverDepartment.warehouseId;\n01013|         }\n01014|       }\n01015| \n01016|       // Формируем дату завтра для забора\n01017|       const tomorrow = new Date();\n01018|       tomorrow.setDate(tomorrow.getDate() + 1);\n01019|       const plannedDateTime = tomorrow.toISOString().slice(0, 19); // 2025-09-28T14:00:00\n01020| \n01021|       // Формируем массив грузов\n01022|       const cargos = form.cargos.map(cargo => ({\n01023|         length: cargo.length / 100, // переводим см в метры\n01024|         width: cargo.width / 100,\n01025|         height: cargo.height / 100,\n01026|         volume: (cargo.length * cargo.width * cargo.height) / 1000000, // м3\n01027|         weight: cargo.weight,\n01028|         isHP: form.needPackaging, // защитная упаковка\n01029|         sealingPositionsCount: 0\n01030|       }));\n01031| \n01032|       // Формируем запрос к API ПЭК\n01033|       const requestData: any = {\n01034|         currencyCode: \"643\", // рубли\n01035|         types: [3], // только авто перевозка\n01036|         senderWarehouseId,\n01037|         receiverWarehouseId,\n01038|         isOpenCarSender: false,\n01039|         isOpenCarReceiver: false,\n01040|         isHyperMarket: false,\n01041|         plannedDateTime,\n01042|         isInsurance: form.needInsurance && form.declaredValue > 0,\n01043|         isInsurancePrice: form.needInsurance ? form.declaredValue : 0,\n01044|         isPickUp: form.fromAddressDelivery,\n01045|         isDelivery: form.toAddressDelivery,\n01046|         needReturnDocuments: false,\n01047|         needArrangeTransportationDocuments: false,\n01048|         senderDistanceType: 0,\n01049|         receiverDistanceType: 0,\n01050|         cargos\n\n(File has more lines. Use 'offset' parameter to read beyond line 1050)\n</file>",
    "metadata": {
      "preview": "      if (coords && coords.length === 2) {\n        return {\n          longitude: coords[0],\n          latitude: coords[1]\n        };\n      }\n      \n      return null;\n    } catch (error) {\n      console.error('Ошибка получения координат Яндекс:', error);\n      return null;\n    }\n  };\n\n  // Расчет для ПЭК через официальный API v1/calculateprice/\n  const calculatePEK = async (): Promise<CalculationResult> => {\n    const apiUrl = 'https://kabinet.pecom.ru/api/v1/calculateprice/';\n    \n    try {\n      // Получаем информацию о зонах и складах по адресам"
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1758903672446,
      "end": 1758903672448
    }
  }
}