{
  "id": "prt_986d4316d001UbRqzADPSyACUZ",
  "messageID": "msg_986d3bc96001LRXK8i33WwTAqy",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "multiedit",
  "callID": "toolu_017S4f58PAZAS8Et8oaGyjiy",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx",
      "edits": [
        {
          "oldString": "  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–Ω–æ–π –∑–æ–Ω—ã –∏ —Å–∫–ª–∞–¥–∞ –ü–≠–ö –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ API\n  const getPekZoneByAddress = async (address: string) => {\n    try {\n      console.log(`üîç –ü–≠–ö: –ø–æ–∏—Å–∫ –∑–æ–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É \"${address}\"`);\n      \n      const response = await fetch('https://api.pecom.ru/v1/branches/findzonebyaddress/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n        },\n        body: JSON.stringify({\n          address: address\n        })\n      });\n\n      if (!response.ok) {\n        console.error(`‚ùå –ü–≠–ö API –æ—à–∏–±–∫–∞: ${response.status} ${response.statusText}`);\n        return null;\n      }\n\n      const data = await response.json();\n      console.log(`‚úÖ –ü–≠–ö –∑–æ–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞:`, data);\n      \n      if (data.zoneId && data.mainWarehouseId) {\n        return {\n          zoneId: data.zoneId,\n          zoneName: data.zoneName,\n          branchUID: data.branchUID,\n          branchCode: data.branchCode,\n          branchTitle: data.branchTitle,\n          mainWarehouseId: data.mainWarehouseId,\n          warehousePoint: data.warehousePoint,\n          geoData: data.GeoData,\n          precision: data.GeoData?.precision\n        };\n      }\n      \n      console.warn(`‚ùå –ü–≠–ö: –∑–æ–Ω–∞ –Ω–µ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –∞–¥—Ä–µ—Å–∞ \"${address}\"`);\n      return null;\n    } catch (error) {\n      console.error('‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∑–æ–Ω—ã:', error);\n      return null;\n    }\n  };",
          "newString": "  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–Ω–æ–π –∑–æ–Ω—ã –∏ —Å–∫–ª–∞–¥–∞ –ü–≠–ö –ø–æ –∞–¥—Ä–µ—Å—É —á–µ—Ä–µ–∑ API\n  const getPekZoneByAddress = async (address: string) => {\n    try {\n      console.log(`üîç –ü–≠–ö: –ø–æ–∏—Å–∫ –∑–æ–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É \"${address}\"`);\n      \n      // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã API –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n      const apiVariants = [\n        {\n          url: 'https://api.pecom.ru/v1/branches/findzonebyaddress/',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n          }\n        },\n        {\n          url: 'https://api.pecom.ru/v1/branches/findzonebyaddress',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n          }\n        },\n        {\n          url: 'https://api.pecom.ru/v1/branches/findzonebyaddress/',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': 'Basic ' + btoa('624FC93CA677B23673BB476D4982294DC27E246F:')\n          }\n        }\n      ];\n      \n      for (let i = 0; i < apiVariants.length; i++) {\n        const variant = apiVariants[i];\n        \n        try {\n          console.log(`üîÑ –ü–≠–ö: –ø–æ–ø—ã—Ç–∫–∞ ${i + 1}/${apiVariants.length} - ${variant.url}`);\n          \n          const response = await fetch(variant.url, {\n            method: 'POST',\n            headers: variant.headers,\n            body: JSON.stringify({\n              address: address\n            })\n          });\n\n          console.log(`üì° –ü–≠–ö API —Å—Ç–∞—Ç—É—Å: ${response.status} ${response.statusText}`);\n          console.log(`üì° –ü–≠–ö API URL: ${response.url}`);\n          \n          if (!response.ok) {\n            const errorText = await response.text();\n            console.error(`‚ùå –ü–≠–ö API –æ—à–∏–±–∫–∞ ${i + 1}: ${response.status} ${response.statusText}`);\n            console.error(`‚ùå –û—Ç–≤–µ—Ç API:`, errorText.substring(0, 500));\n            continue;\n          }\n\n          const data = await response.json();\n          console.log(`‚úÖ –ü–≠–ö –∑–æ–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞ (–ø–æ–ø—ã—Ç–∫–∞ ${i + 1}):`, data);\n          \n          if (data.zoneId && data.mainWarehouseId) {\n            return {\n              zoneId: data.zoneId,\n              zoneName: data.zoneName,\n              branchUID: data.branchUID,\n              branchCode: data.branchCode,\n              branchTitle: data.branchTitle,\n              mainWarehouseId: data.mainWarehouseId,\n              warehousePoint: data.warehousePoint,\n              geoData: data.GeoData,\n              precision: data.GeoData?.precision\n            };\n          }\n          \n          console.warn(`‚ö†Ô∏è –ü–≠–ö: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç (–ø–æ–ø—ã—Ç–∫–∞ ${i + 1}):`, data);\n        } catch (apiError) {\n          console.error(`‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ ${i + 1}:`, apiError);\n          continue;\n        }\n      }\n      \n      // –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ API –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ–ª–ª–±—ç–∫\n      console.log(`üîÑ –ü–≠–ö: –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ñ–æ–ª–ª–±—ç–∫ –º–µ—Ç–æ–¥—É –¥–ª—è \"${address}\"`);\n      return getPekZoneFallback(address);\n      \n    } catch (error) {\n      console.error('‚ùå –ü–≠–ö: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∑–æ–Ω—ã:', error);\n      return getPekZoneFallback(address);\n    }\n  };\n\n  // –§–æ–ª–ª–±—ç–∫ –º–µ—Ç–æ–¥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω—ã –ü–≠–ö\n  const getPekZoneFallback = (address: string) => {\n    console.log(`üîÑ –ü–≠–ö —Ñ–æ–ª–ª–±—ç–∫: –∞–Ω–∞–ª–∏–∑ –∞–¥—Ä–µ—Å–∞ \"${address}\"`);\n    \n    const addressLower = address.toLowerCase();\n    \n    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏ –∏—Ö –¥–∞–Ω–Ω—ã–µ\n    const cityMappings: { [key: string]: any } = {\n      '–º–æ—Å–∫–≤–∞': {\n        zoneId: 'moscow-zone-001',\n        zoneName: '–ú–æ—Å–∫–≤–∞',\n        branchUID: 'moscow-branch-001',\n        branchCode: '–ú–°–ö',\n        branchTitle: '–ú–æ—Å–∫–≤–∞',\n        mainWarehouseId: 'dc6c746d-812d-11e4-bbfc-001999d8b3c5',\n        warehousePoint: {\n          latitude: 55.755826,\n          longitude: 37.6173\n        }\n      },\n      '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': {\n        zoneId: 'spb-zone-001',\n        zoneName: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n        branchUID: 'spb-branch-001',\n        branchCode: '–°–ü–ë',\n        branchTitle: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n        mainWarehouseId: 'b436c978-086d-11e6-b6ca-00155d668909',\n        warehousePoint: {\n          latitude: 59.9311,\n          longitude: 30.3609\n        }\n      },\n      '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': {\n        zoneId: 'ekb-zone-001',\n        zoneName: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',\n        branchUID: 'ekb-branch-001',\n        branchCode: '–ï–ö–ë',\n        branchTitle: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',\n        mainWarehouseId: 'f8d9c8e3-8e2d-11e4-bbfc-001999d8b3c5',\n        warehousePoint: {\n          latitude: 56.8431,\n          longitude: 60.6454\n        }\n      }\n    };\n    \n    for (const [city, data] of Object.entries(cityMappings)) {\n      if (addressLower.includes(city) || addressLower.includes(city.replace('-', ' '))) {\n        console.log(`‚úÖ –ü–≠–ö —Ñ–æ–ª–ª–±—ç–∫: –Ω–∞–π–¥–µ–Ω –≥–æ—Ä–æ–¥ ${city}`);\n        return {\n          ...data,\n          geoData: {\n            precision: 'fallback',\n            kind: 'locality'\n          },\n          precision: 'fallback'\n        };\n      }\n    }\n    \n    console.warn(`‚ùå –ü–≠–ö —Ñ–æ–ª–ª–±—ç–∫: –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ \"${address}\"`);\n    return null;\n  };"
        },
        {
          "oldString": "  // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–ª–∏–∂–∞–π—à–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π –ü–≠–ö\n  const getPekNearestDepartments = async (address: string, coordinates?: { latitude: string, longitude: string }) => {\n    try {\n      console.log(`üè¢ –ü–≠–ö: –ø–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π –¥–ª—è \"${address}\"`);\n      \n      const requestBody: any = {\n        departmentOperation: 3, // –≤—ã–¥–∞—á–∞ –≥—Ä—É–∑–æ–≤\n        type: 3, // –∞–≤—Ç–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç\n        searchRadius: 50, // –∫–º\n        limit: 5\n      };\n      \n      if (coordinates) {\n        requestBody.coordinates = coordinates;\n      } else {\n        requestBody.address = address;\n      }\n      \n      const response = await fetch('https://api.pecom.ru/v1/branches/nearestdepartments/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n        },\n        body: JSON.stringify(requestBody)\n      });\n\n      if (!response.ok) {\n        console.error(`‚ùå –ü–≠–ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è API –æ—à–∏–±–∫–∞: ${response.status} ${response.statusText}`);\n        return null;\n      }\n\n      const data = await response.json();\n      console.log(`‚úÖ –ü–≠–ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω—ã:`, data);\n      \n      // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤–æ–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º\n      if (data.freeDepartments && data.freeDepartments.length > 0) {\n        const bestDepartment = data.freeDepartments.sort((a: any, b: any) => b.priority - a.priority)[0];\n        return {\n          warehouseId: bestDepartment.warehouseId,\n          branchId: bestDepartment.branchId,\n          branchName: bestDepartment.branchName,\n          divisionName: bestDepartment.divisionName,\n          address: bestDepartment.address,\n          coordinates: bestDepartment.coordinates,\n          phone: bestDepartment.phone,\n          email: bestDepartment.email\n        };\n      }\n      \n      console.warn(`‚ùå –ü–≠–ö: –æ—Ç–¥–µ–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è \"${address}\"`);\n      return null;\n    } catch (error) {\n      console.error('‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –æ—Ç–¥–µ–ª–µ–Ω–∏–π:', error);\n      return null;\n    }\n  };",
          "newString": "  // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–ª–∏–∂–∞–π—à–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π –ü–≠–ö\n  const getPekNearestDepartments = async (address: string, coordinates?: { latitude: string, longitude: string }) => {\n    try {\n      console.log(`üè¢ –ü–≠–ö: –ø–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π –¥–ª—è \"${address}\"`);\n      \n      const requestBody: any = {\n        departmentOperation: 3, // –≤—ã–¥–∞—á–∞ –≥—Ä—É–∑–æ–≤\n        type: 3, // –∞–≤—Ç–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç\n        searchRadius: 50, // –∫–º\n        limit: 5\n      };\n      \n      if (coordinates) {\n        requestBody.coordinates = coordinates;\n        console.log(`üìç –ü–≠–ö: –ø–æ–∏—Å–∫ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º`, coordinates);\n      } else {\n        requestBody.address = address;\n        console.log(`üìç –ü–≠–ö: –ø–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É \"${address}\"`);\n      }\n      \n      const response = await fetch('https://api.pecom.ru/v1/branches/nearestdepartments/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n        },\n        body: JSON.stringify(requestBody)\n      });\n\n      console.log(`üì° –ü–≠–ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è API —Å—Ç–∞—Ç—É—Å: ${response.status}`);\n      \n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error(`‚ùå –ü–≠–ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è API –æ—à–∏–±–∫–∞: ${response.status} ${response.statusText}`);\n        console.error(`‚ùå –û—Ç–≤–µ—Ç:`, errorText.substring(0, 500));\n        return null;\n      }\n\n      const data = await response.json();\n      console.log(`‚úÖ –ü–≠–ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω—ã:`, data);\n      \n      // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤–æ–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º\n      if (data.freeDepartments && data.freeDepartments.length > 0) {\n        const bestDepartment = data.freeDepartments.sort((a: any, b: any) => b.priority - a.priority)[0];\n        console.log(`‚úÖ –ü–≠–ö: –≤—ã–±—Ä–∞–Ω–æ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ`, bestDepartment.divisionName);\n        return {\n          warehouseId: bestDepartment.warehouseId,\n          branchId: bestDepartment.branchId,\n          branchName: bestDepartment.branchName,\n          divisionName: bestDepartment.divisionName,\n          address: bestDepartment.address,\n          coordinates: bestDepartment.coordinates,\n          phone: bestDepartment.phone,\n          email: bestDepartment.email\n        };\n      }\n      \n      console.warn(`‚ùå –ü–≠–ö: –æ—Ç–¥–µ–ª–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è \"${address}\"`);\n      return null;\n    } catch (error) {\n      console.error('‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –æ—Ç–¥–µ–ª–µ–Ω–∏–π:', error);\n      return null;\n    }\n  };"
        },
        {
          "oldString": "      // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–æ–Ω–∞—Ö –∏ —Å–∫–ª–∞–¥–∞—Ö –ø–æ –∞–¥—Ä–µ—Å–∞–º\n      const senderZone = await getPekZoneByAddress(form.fromAddress || `–†–æ—Å—Å–∏—è, ${form.fromCity}`);\n      const receiverZone = await getPekZoneByAddress(form.toAddress || `–†–æ—Å—Å–∏—è, ${form.toCity}`);\n      \n      if (!senderZone || !receiverZone) {\n        return {\n          company: '–ü–≠–ö',\n          price: 0,\n          days: 0,\n          error: `–ó–æ–Ω–∞ –ü–≠–ö –Ω–µ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å–∞: ${!senderZone ? (form.fromAddress || form.fromCity) : ''} ${!receiverZone ? (form.toAddress || form.toCity) : ''}`.trim(),\n          apiUrl,\n          requestData: { fromAddress: form.fromAddress || form.fromCity, toAddress: form.toAddress || form.toCity },\n          responseData: null\n        };\n      }",
          "newString": "      // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–æ–Ω–∞—Ö –∏ —Å–∫–ª–∞–¥–∞—Ö –ø–æ –∞–¥—Ä–µ—Å–∞–º\n      console.log(`üöÄ –ü–≠–ö: –Ω–∞—á–∏–Ω–∞–µ–º —Ä–∞—Å—á–µ—Ç`);\n      console.log(`üìç –û—Ç: ${form.fromAddress || form.fromCity}`);\n      console.log(`üìç –î–æ: ${form.toAddress || form.toCity}`);\n      \n      const senderZone = await getPekZoneByAddress(form.fromAddress || `–≥ ${form.fromCity}`);\n      const receiverZone = await getPekZoneByAddress(form.toAddress || `–≥ ${form.toCity}`);\n      \n      console.log(`üîç –ü–≠–ö –∑–æ–Ω—ã:`);\n      console.log(`üìç –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å:`, senderZone ? `${senderZone.branchTitle} (${senderZone.mainWarehouseId})` : '–ù–ï –ù–ê–ô–î–ï–ù–ê');\n      console.log(`üìç –ü–æ–ª—É—á–∞—Ç–µ–ª—å:`, receiverZone ? `${receiverZone.branchTitle} (${receiverZone.mainWarehouseId})` : '–ù–ï –ù–ê–ô–î–ï–ù–ê');\n      \n      if (!senderZone || !receiverZone) {\n        // –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\n        const debugInfo = {\n          senderAddress: form.fromAddress || form.fromCity,\n          receiverAddress: form.toAddress || form.toCity,\n          senderZoneFound: !!senderZone,\n          receiverZoneFound: !!receiverZone,\n          apiTested: true\n        };\n        \n        console.error(`‚ùå –ü–≠–ö: –∑–æ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã`, debugInfo);\n        \n        return {\n          company: '–ü–≠–ö',\n          price: 0,\n          days: 0,\n          error: `–ó–æ–Ω–∞ –ü–≠–ö –Ω–µ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å–∞: ${!senderZone ? (form.fromAddress || form.fromCity) : ''} ${!receiverZone ? (form.toAddress || form.toCity) : ''}`.trim(),\n          apiUrl,\n          requestData: debugInfo,\n          responseData: { senderZone, receiverZone }\n        };\n      }"
        },
        {
          "oldString": "      console.log('üöÄ –ü–≠–ö API –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json;charset=utf-8',\n          'Accept': 'application/json',\n          'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n        },\n        body: JSON.stringify(requestData)\n      });\n\n      const data = await response.json();\n      console.log('üöÄ –ü–≠–ö API –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));",
          "newString": "      console.log('üöÄ –ü–≠–ö API –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n      console.log('üåê –ü–≠–ö API URL:', apiUrl);\n\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json;charset=utf-8',\n          'Accept': 'application/json',\n          'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n        },\n        body: JSON.stringify(requestData)\n      });\n\n      console.log(`üì° –ü–≠–ö API —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç—É—Å: ${response.status} ${response.statusText}`);\n      console.log(`üì° –ü–≠–ö API URL: ${response.url}`);\n      \n      const responseText = await response.text();\n      console.log(`üì° –ü–≠–ö API —Å—ã—Ä–æ–π –æ—Ç–≤–µ—Ç:`, responseText.substring(0, 1000));\n      \n      let data;\n      try {\n        data = JSON.parse(responseText);\n        console.log('üöÄ –ü–≠–ö API –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n      } catch (parseError) {\n        console.error('‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', parseError);\n        throw new Error(`–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç API: ${responseText.substring(0, 200)}`);\n      }"
        },
        {
          "oldString": "      // –§–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ\n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      let basePrice = totalWeight * 18; // 18 —Ä—É–± –∑–∞ –∫–≥ –¥–ª—è –ü–≠–ö\n      \n      if (form.fromAddressDelivery) basePrice += 600;\n      if (form.toAddressDelivery) basePrice += 600;\n      if (form.needInsurance && form.declaredValue > 0) basePrice += form.declaredValue * 0.012;\n      if (form.needPackaging) basePrice += totalWeight * 25;\n      if (form.needCarry) basePrice += 500;\n      \n      return {\n        company: '–ü–≠–ö',\n        price: Math.round(basePrice),\n        days: 3,\n        details: {\n          note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ü–≠–ö (–æ—à–∏–±–∫–∞ API)',\n          services: [\n            {\n              name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n              description: `${form.fromCity} - ${form.toCity}`,\n              price: Math.round(basePrice)\n            }\n          ]\n        },\n        requestData: null,\n        responseData: null,\n        apiUrl,\n        error: `–û—à–∏–±–∫–∞ API –ü–≠–ö: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç.`\n      };",
          "newString": "      // –§–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ\n      console.error('üö® –ü–≠–ö: –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ñ–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç—É –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏:', error.message);\n      \n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n      \n      // –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —Ñ–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Å–∞ –∏ –æ–±—ä–µ–º–∞\n      let basePrice = Math.max(\n        totalWeight * 18, // 18 —Ä—É–± –∑–∞ –∫–≥\n        totalVolume * 4500 // 4500 —Ä—É–± –∑–∞ –º3\n      );\n      \n      // –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏\n      const services = [];\n      \n      services.push({\n        name: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞',\n        description: `${form.fromCity} - ${form.toCity} (${totalWeight} –∫–≥, ${totalVolume.toFixed(3)} –º¬≥)`,\n        price: Math.round(basePrice)\n      });\n      \n      if (form.fromAddressDelivery) {\n        const pickupCost = 600;\n        basePrice += pickupCost;\n        services.push({\n          name: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n          description: '–û—Ç –∞–¥—Ä–µ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è',\n          price: pickupCost\n        });\n      }\n      \n      if (form.toAddressDelivery) {\n        const deliveryCost = 600;\n        basePrice += deliveryCost;\n        services.push({\n          name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n          description: '–î–æ –∞–¥—Ä–µ—Å–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è',\n          price: deliveryCost\n        });\n      }\n      \n      if (form.needInsurance && form.declaredValue > 0) {\n        const insuranceCost = form.declaredValue * 0.012;\n        basePrice += insuranceCost;\n        services.push({\n          name: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n          description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n          price: Math.round(insuranceCost)\n        });\n      }\n      \n      if (form.needPackaging) {\n        const packagingCost = totalWeight * 25;\n        basePrice += packagingCost;\n        services.push({\n          name: '–ó–∞—â–∏—Ç–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞',\n          description: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n          price: Math.round(packagingCost)\n        });\n      }\n      \n      if (form.needCarry) {\n        const carryCost = 500;\n        basePrice += carryCost;\n        services.push({\n          name: '–ü–æ–¥—ä–µ–º –Ω–∞ —ç—Ç–∞–∂',\n          description: `–ù–∞ ${form.floor} —ç—Ç–∞–∂ ${form.hasFreightLift ? '(—Å –ª–∏—Ñ—Ç–æ–º)' : '(–±–µ–∑ –ª–∏—Ñ—Ç–∞)'}`,\n          price: carryCost\n        });\n      }\n      \n      return {\n        company: '–ü–≠–ö',\n        price: Math.round(basePrice),\n        days: 3,\n        details: {\n          note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ü–≠–ö (API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)',\n          services,\n          totalWeight,\n          totalVolume,\n          errorInfo: error.message\n        },\n        requestData: null,\n        responseData: null,\n        apiUrl,\n        error: `API –ü–≠–ö –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º.`\n      };"
        }
      ]
    },
    "output": "",
    "metadata": {
      "results": [
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -837,47 +837,153 @@\n const getPekZoneByAddress = async (address: string) => {\n   try {\n     console.log(`üîç –ü–≠–ö: –ø–æ–∏—Å–∫ –∑–æ–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É \"${address}\"`);\n     \n-    const response = await fetch('https://api.pecom.ru/v1/branches/findzonebyaddress/', {\n-      method: 'POST',\n-      headers: {\n-        'Content-Type': 'application/json',\n-        'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n+    // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã API –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏\n+    const apiVariants = [\n+      {\n+        url: 'https://api.pecom.ru/v1/branches/findzonebyaddress/',\n+        headers: {\n+          'Content-Type': 'application/json',\n+          'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n+        }\n       },\n-      body: JSON.stringify({\n-        address: address\n-      })\n-    });\n+      {\n+        url: 'https://api.pecom.ru/v1/branches/findzonebyaddress',\n+        headers: {\n+          'Content-Type': 'application/json',\n+          'Authorization': `Bearer 624FC93CA677B23673BB476D4982294DC27E246F`\n+        }\n+      },\n+      {\n+        url: 'https://api.pecom.ru/v1/branches/findzonebyaddress/',\n+        headers: {\n+          'Content-Type': 'application/json',\n+          'Authorization': 'Basic ' + btoa('624FC93CA677B23673BB476D4982294DC27E246F:')\n+        }\n+      }\n+    ];\n+    \n+    for (let i = 0; i < apiVariants.length; i++) {\n+      const variant = apiVariants[i];\n+      \n+      try {\n+        console.log(`üîÑ –ü–≠–ö: –ø–æ–ø—ã—Ç–∫–∞ ${i + 1}/${apiVariants.length} - ${variant.url}`);\n+        \n+        const response = await fetch(variant.url, {\n+          method: 'POST',\n+          headers: variant.headers,\n+          body: JSON.stringify({\n+            address: address\n+          })\n+        });\n \n-    if (!response.ok) {\n-      console.error(`‚ùå –ü–≠–ö API –æ—à–∏–±–∫–∞: ${response.status} ${response.statusText}`);\n-      return null;\n-    }\n+        console.log(`üì° –ü–≠–ö API —Å—Ç–∞—Ç—É—Å: ${response.status} ${response.statusText}`);\n+        console.log(`üì° –ü–≠–ö API URL: ${response.url}`);\n+        \n+        if (!response.ok) {\n+          const errorText = await response.text();\n+          console.error(`‚ùå –ü–≠–ö API –æ—à–∏–±–∫–∞ ${i + 1}: ${response.status} ${response.statusText}`);\n+          console.error(`‚ùå –û—Ç–≤–µ—Ç API:`, errorText.substring(0, 500));\n+          continue;\n+        }\n \n-    const data = await response.json();\n-    console.log(`‚úÖ –ü–≠–ö –∑–æ–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞:`, data);\n+        const data = await response.json();\n+        console.log(`‚úÖ –ü–≠–ö –∑–æ–Ω–∞ –Ω–∞–π–¥–µ–Ω–∞ (–ø–æ–ø—ã—Ç–∫–∞ ${i + 1}):`, data);\n+        \n+        if (data.zoneId && data.mainWarehouseId) {\n+          return {\n+            zoneId: data.zoneId,\n+            zoneName: data.zoneName,\n+            branchUID: data.branchUID,\n+            branchCode: data.branchCode,\n+            branchTitle: data.branchTitle,\n+            mainWarehouseId: data.mainWarehouseId,\n+            warehousePoint: data.warehousePoint,\n+            geoData: data.GeoData,\n+            precision: data.GeoData?.precision\n+          };\n+        }\n+        \n+        console.warn(`‚ö†Ô∏è –ü–≠–ö: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç (–ø–æ–ø—ã—Ç–∫–∞ ${i + 1}):`, data);\n+      } catch (apiError) {\n+        console.error(`‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ ${i + 1}:`, apiError);\n+        continue;\n+      }\n+    }\n     \n-    if (data.zoneId && data.mainWarehouseId) {\n+    // –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ API –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ–ª–ª–±—ç–∫\n+    console.log(`üîÑ –ü–≠–ö: –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Ñ–æ–ª–ª–±—ç–∫ –º–µ—Ç–æ–¥—É –¥–ª—è \"${address}\"`);\n+    return getPekZoneFallback(address);\n+    \n+  } catch (error) {\n+    console.error('‚ùå –ü–≠–ö: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∑–æ–Ω—ã:', error);\n+    return getPekZoneFallback(address);\n+  }\n+};\n+\n+// –§–æ–ª–ª–±—ç–∫ –º–µ—Ç–æ–¥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω—ã –ü–≠–ö\n+const getPekZoneFallback = (address: string) => {\n+  console.log(`üîÑ –ü–≠–ö —Ñ–æ–ª–ª–±—ç–∫: –∞–Ω–∞–ª–∏–∑ –∞–¥—Ä–µ—Å–∞ \"${address}\"`);\n+  \n+  const addressLower = address.toLowerCase();\n+  \n+  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏ –∏—Ö –¥–∞–Ω–Ω—ã–µ\n+  const cityMappings: { [key: string]: any } = {\n+    '–º–æ—Å–∫–≤–∞': {\n+      zoneId: 'moscow-zone-001',\n+      zoneName: '–ú–æ—Å–∫–≤–∞',\n+      branchUID: 'moscow-branch-001',\n+      branchCode: '–ú–°–ö',\n+      branchTitle: '–ú–æ—Å–∫–≤–∞',\n+      mainWarehouseId: 'dc6c746d-812d-11e4-bbfc-001999d8b3c5',\n+      warehousePoint: {\n+        latitude: 55.755826,\n+        longitude: 37.6173\n+      }\n+    },\n+    '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': {\n+      zoneId: 'spb-zone-001',\n+      zoneName: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n+      branchUID: 'spb-branch-001',\n+      branchCode: '–°–ü–ë',\n+      branchTitle: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',\n+      mainWarehouseId: 'b436c978-086d-11e6-b6ca-00155d668909',\n+      warehousePoint: {\n+        latitude: 59.9311,\n+        longitude: 30.3609\n+      }\n+    },\n+    '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': {\n+      zoneId: 'ekb-zone-001',\n+      zoneName: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',\n+      branchUID: 'ekb-branch-001',\n+      branchCode: '–ï–ö–ë',\n+      branchTitle: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',\n+      mainWarehouseId: 'f8d9c8e3-8e2d-11e4-bbfc-001999d8b3c5',\n+      warehousePoint: {\n+        latitude: 56.8431,\n+        longitude: 60.6454\n+      }\n+    }\n+  };\n+  \n+  for (const [city, data] of Object.entries(cityMappings)) {\n+    if (addressLower.includes(city) || addressLower.includes(city.replace('-', ' '))) {\n+      console.log(`‚úÖ –ü–≠–ö —Ñ–æ–ª–ª–±—ç–∫: –Ω–∞–π–¥–µ–Ω –≥–æ—Ä–æ–¥ ${city}`);\n       return {\n-        zoneId: data.zoneId,\n-        zoneName: data.zoneName,\n-        branchUID: data.branchUID,\n-        branchCode: data.branchCode,\n-        branchTitle: data.branchTitle,\n-        mainWarehouseId: data.mainWarehouseId,\n-        warehousePoint: data.warehousePoint,\n-        geoData: data.GeoData,\n-        precision: data.GeoData?.precision\n+        ...data,\n+        geoData: {\n+          precision: 'fallback',\n+          kind: 'locality'\n+        },\n+        precision: 'fallback'\n       };\n     }\n-    \n-    console.warn(`‚ùå –ü–≠–ö: –∑–æ–Ω–∞ –Ω–µ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –∞–¥—Ä–µ—Å–∞ \"${address}\"`);\n-    return null;\n-  } catch (error) {\n-    console.error('‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∑–æ–Ω—ã:', error);\n-    return null;\n   }\n+  \n+  console.warn(`‚ùå –ü–≠–ö —Ñ–æ–ª–ª–±—ç–∫: –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ \"${address}\"`);\n+  return null;\n };\n \n // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–ª–∏–∂–∞–π—à–∏—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π –ü–≠–ö\n const getPekNearestDepartments = async (address: string, coordinates?: { latitude: string, longitude: string }) => {\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -998,10 +998,12 @@\n };\n \n if (coordinates) {\n   requestBody.coordinates = coordinates;\n+  console.log(`üìç –ü–≠–ö: –ø–æ–∏—Å–∫ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º`, coordinates);\n } else {\n   requestBody.address = address;\n+  console.log(`üìç –ü–≠–ö: –ø–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É \"${address}\"`);\n }\n \n const response = await fetch('https://api.pecom.ru/v1/branches/nearestdepartments/', {\n   method: 'POST',\n@@ -1011,10 +1013,14 @@\n   },\n   body: JSON.stringify(requestBody)\n });\n \n+console.log(`üì° –ü–≠–ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è API —Å—Ç–∞—Ç—É—Å: ${response.status}`);\n+\n if (!response.ok) {\n+  const errorText = await response.text();\n   console.error(`‚ùå –ü–≠–ö –æ—Ç–¥–µ–ª–µ–Ω–∏—è API –æ—à–∏–±–∫–∞: ${response.status} ${response.statusText}`);\n+  console.error(`‚ùå –û—Ç–≤–µ—Ç:`, errorText.substring(0, 500));\n   return null;\n }\n \n const data = await response.json();\n@@ -1022,8 +1028,9 @@\n \n // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤–æ–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º\n if (data.freeDepartments && data.freeDepartments.length > 0) {\n   const bestDepartment = data.freeDepartments.sort((a: any, b: any) => b.priority - a.priority)[0];\n+  console.log(`‚úÖ –ü–≠–ö: –≤—ã–±—Ä–∞–Ω–æ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ`, bestDepartment.divisionName);\n   return {\n     warehouseId: bestDepartment.warehouseId,\n     branchId: bestDepartment.branchId,\n     branchName: bestDepartment.branchName,\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -1080,20 +1080,39 @@\n const apiUrl = 'https://kabinet.pecom.ru/api/v1/calculateprice/';\n \n try {\n   // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–æ–Ω–∞—Ö –∏ —Å–∫–ª–∞–¥–∞—Ö –ø–æ –∞–¥—Ä–µ—Å–∞–º\n-  const senderZone = await getPekZoneByAddress(form.fromAddress || `–†–æ—Å—Å–∏—è, ${form.fromCity}`);\n-  const receiverZone = await getPekZoneByAddress(form.toAddress || `–†–æ—Å—Å–∏—è, ${form.toCity}`);\n+  console.log(`üöÄ –ü–≠–ö: –Ω–∞—á–∏–Ω–∞–µ–º —Ä–∞—Å—á–µ—Ç`);\n+  console.log(`üìç –û—Ç: ${form.fromAddress || form.fromCity}`);\n+  console.log(`üìç –î–æ: ${form.toAddress || form.toCity}`);\n   \n+  const senderZone = await getPekZoneByAddress(form.fromAddress || `–≥ ${form.fromCity}`);\n+  const receiverZone = await getPekZoneByAddress(form.toAddress || `–≥ ${form.toCity}`);\n+  \n+  console.log(`üîç –ü–≠–ö –∑–æ–Ω—ã:`);\n+  console.log(`üìç –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å:`, senderZone ? `${senderZone.branchTitle} (${senderZone.mainWarehouseId})` : '–ù–ï –ù–ê–ô–î–ï–ù–ê');\n+  console.log(`üìç –ü–æ–ª—É—á–∞—Ç–µ–ª—å:`, receiverZone ? `${receiverZone.branchTitle} (${receiverZone.mainWarehouseId})` : '–ù–ï –ù–ê–ô–î–ï–ù–ê');\n+  \n   if (!senderZone || !receiverZone) {\n+    // –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\n+    const debugInfo = {\n+      senderAddress: form.fromAddress || form.fromCity,\n+      receiverAddress: form.toAddress || form.toCity,\n+      senderZoneFound: !!senderZone,\n+      receiverZoneFound: !!receiverZone,\n+      apiTested: true\n+    };\n+    \n+    console.error(`‚ùå –ü–≠–ö: –∑–æ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã`, debugInfo);\n+    \n     return {\n       company: '–ü–≠–ö',\n       price: 0,\n       days: 0,\n       error: `–ó–æ–Ω–∞ –ü–≠–ö –Ω–µ –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å–∞: ${!senderZone ? (form.fromAddress || form.fromCity) : ''} ${!receiverZone ? (form.toAddress || form.toCity) : ''}`.trim(),\n       apiUrl,\n-      requestData: { fromAddress: form.fromAddress || form.fromCity, toAddress: form.toAddress || form.toCity },\n-      responseData: null\n+      requestData: debugInfo,\n+      responseData: { senderZone, receiverZone }\n     };\n   }\n \n   // –ü–æ–ª—É—á–∞–µ–º –±–ª–∏–∂–∞–π—à–∏–µ –æ—Ç–¥–µ–ª–µ–Ω–∏—è –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∞–¥—Ä–µ—Å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞\n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -1213,8 +1213,9 @@\n   };\n }\n \n console.log('üöÄ –ü–≠–ö API –∑–∞–ø—Ä–æ—Å:', JSON.stringify(requestData, null, 2));\n+console.log('üåê –ü–≠–ö API URL:', apiUrl);\n \n const response = await fetch(apiUrl, {\n   method: 'POST',\n   headers: {\n@@ -1224,10 +1225,22 @@\n   },\n   body: JSON.stringify(requestData)\n });\n \n-const data = await response.json();\n-console.log('üöÄ –ü–≠–ö API –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n+console.log(`üì° –ü–≠–ö API —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç—É—Å: ${response.status} ${response.statusText}`);\n+console.log(`üì° –ü–≠–ö API URL: ${response.url}`);\n+\n+const responseText = await response.text();\n+console.log(`üì° –ü–≠–ö API —Å—ã—Ä–æ–π –æ—Ç–≤–µ—Ç:`, responseText.substring(0, 1000));\n+\n+let data;\n+try {\n+  data = JSON.parse(responseText);\n+  console.log('üöÄ –ü–≠–ö API –æ—Ç–≤–µ—Ç:', JSON.stringify(data, null, 2));\n+} catch (parseError) {\n+  console.error('‚ùå –ü–≠–ö: –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', parseError);\n+  throw new Error(`–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç API: ${responseText.substring(0, 200)}`);\n+}\n \n if (response.ok && !data.hasError && data.transfers && data.transfers.length > 0) {\n   const transfer = data.transfers[0]; // –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —Ç–∞—Ä–∏—Ñ (–∞–≤—Ç–æ)\n   \n"
        },
        {
          "diagnostics": {},
          "diff": "Index: /home/user/project/app/page.tsx\n===================================================================\n--- /home/user/project/app/page.tsx\n+++ /home/user/project/app/page.tsx\n@@ -1315,35 +1315,95 @@\n   } catch (error: any) {\n     console.error('üö® –û—à–∏–±–∫–∞ –ü–≠–ö API:', error);\n     \n     // –§–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ\n+    console.error('üö® –ü–≠–ö: –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ñ–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç—É –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏:', error.message);\n+    \n     const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n-    let basePrice = totalWeight * 18; // 18 —Ä—É–± –∑–∞ –∫–≥ –¥–ª—è –ü–≠–ö\n+    const totalVolume = form.cargos.reduce((sum, cargo) => \n+      sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n+    );\n     \n-    if (form.fromAddressDelivery) basePrice += 600;\n-    if (form.toAddressDelivery) basePrice += 600;\n-    if (form.needInsurance && form.declaredValue > 0) basePrice += form.declaredValue * 0.012;\n-    if (form.needPackaging) basePrice += totalWeight * 25;\n-    if (form.needCarry) basePrice += 500;\n+    // –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —Ñ–æ–ª–ª–±—ç–∫ —Ä–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Å–∞ –∏ –æ–±—ä–µ–º–∞\n+    let basePrice = Math.max(\n+      totalWeight * 18, // 18 —Ä—É–± –∑–∞ –∫–≥\n+      totalVolume * 4500 // 4500 —Ä—É–± –∑–∞ –º3\n+    );\n     \n+    // –î–æ–±–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏\n+    const services = [];\n+    \n+    services.push({\n+      name: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞',\n+      description: `${form.fromCity} - ${form.toCity} (${totalWeight} –∫–≥, ${totalVolume.toFixed(3)} –º¬≥)`,\n+      price: Math.round(basePrice)\n+    });\n+    \n+    if (form.fromAddressDelivery) {\n+      const pickupCost = 600;\n+      basePrice += pickupCost;\n+      services.push({\n+        name: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n+        description: '–û—Ç –∞–¥—Ä–µ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è',\n+        price: pickupCost\n+      });\n+    }\n+    \n+    if (form.toAddressDelivery) {\n+      const deliveryCost = 600;\n+      basePrice += deliveryCost;\n+      services.push({\n+        name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n+        description: '–î–æ –∞–¥—Ä–µ—Å–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è',\n+        price: deliveryCost\n+      });\n+    }\n+    \n+    if (form.needInsurance && form.declaredValue > 0) {\n+      const insuranceCost = form.declaredValue * 0.012;\n+      basePrice += insuranceCost;\n+      services.push({\n+        name: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n+        description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n+        price: Math.round(insuranceCost)\n+      });\n+    }\n+    \n+    if (form.needPackaging) {\n+      const packagingCost = totalWeight * 25;\n+      basePrice += packagingCost;\n+      services.push({\n+        name: '–ó–∞—â–∏—Ç–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞',\n+        description: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n+        price: Math.round(packagingCost)\n+      });\n+    }\n+    \n+    if (form.needCarry) {\n+      const carryCost = 500;\n+      basePrice += carryCost;\n+      services.push({\n+        name: '–ü–æ–¥—ä–µ–º –Ω–∞ —ç—Ç–∞–∂',\n+        description: `–ù–∞ ${form.floor} —ç—Ç–∞–∂ ${form.hasFreightLift ? '(—Å –ª–∏—Ñ—Ç–æ–º)' : '(–±–µ–∑ –ª–∏—Ñ—Ç–∞)'}`,\n+        price: carryCost\n+      });\n+    }\n+    \n     return {\n       company: '–ü–≠–ö',\n       price: Math.round(basePrice),\n       days: 3,\n       details: {\n-        note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ü–≠–ö (–æ—à–∏–±–∫–∞ API)',\n-        services: [\n-          {\n-            name: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n-            description: `${form.fromCity} - ${form.toCity}`,\n-            price: Math.round(basePrice)\n-          }\n-        ]\n+        note: '–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º –ü–≠–ö (API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)',\n+        services,\n+        totalWeight,\n+        totalVolume,\n+        errorInfo: error.message\n       },\n       requestData: null,\n       responseData: null,\n       apiUrl,\n-      error: `–û—à–∏–±–∫–∞ API –ü–≠–ö: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç.`\n+      error: `API –ü–≠–ö –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${error.message}. –ü–æ–∫–∞–∑–∞–Ω –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ –±–∞–∑–æ–≤—ã–º —Ç–∞—Ä–∏—Ñ–∞–º.`\n     };\n   }\n };\n \n"
        }
      ]
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1758903757923,
      "end": 1758903757994
    }
  }
}