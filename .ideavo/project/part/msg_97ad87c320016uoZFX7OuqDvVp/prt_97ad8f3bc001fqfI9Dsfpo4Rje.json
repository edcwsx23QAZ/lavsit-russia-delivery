{
  "id": "prt_97ad8f3bc001fqfI9Dsfpo4Rje",
  "messageID": "msg_97ad87c320016uoZFX7OuqDvVp",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "type": "tool",
  "tool": "read",
  "callID": "toolu_016DLEedN8RYM1yeYfQ6VBWA",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx"
    },
    "output": "<file>\n00001| 'use client';\n00002| \n00003| import React, { useState, useEffect, useCallback } from 'react';\n00004| import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n00005| import { Button } from '@/components/ui/button';\n00006| import { Input } from '@/components/ui/input';\n00007| import { Label } from '@/components/ui/label';\n00008| import { Checkbox } from '@/components/ui/checkbox';\n00009| import { Plus, Truck, Building2, Map } from 'lucide-react';\n00010| import { Alert, AlertDescription } from '@/components/ui/alert';\n00011| import { Badge } from '@/components/ui/badge';\n00012| import { Separator } from '@/components/ui/separator';\n00013| import { Collapsible, CollapsibleContent } from '@/components/ui/collapsible';\n00014| \n00015| interface Cargo {\n00016|   id: string;\n00017|   length: number;\n00018|   width: number;\n00019|   height: number;\n00020|   weight: number;\n00021| }\n00022| \n00023| interface DeliveryForm {\n00024|   cargos: Cargo[];\n00025|   fromCity: string;\n00026|   toCity: string;\n00027|   fromAddress: string;\n00028|   toAddress: string;\n00029|   declaredValue: number;\n00030|   needPackaging: boolean;\n00031|   needLoading: boolean;\n00032|   needCarry: boolean;\n00033|   floor: number;\n00034|   hasFreightLift: boolean;\n00035|   needInsurance: boolean;\n00036|   fromTerminal: boolean;\n00037|   toTerminal: boolean;\n00038|   fromAddressDelivery: boolean;\n00039|   toAddressDelivery: boolean;\n00040| }\n00041| \n00042| interface CalculationResult {\n00043|   company: string;\n00044|   price: number;\n00045|   days: number;\n00046|   details?: any;\n00047|   error?: string;\n00048|   requestData?: any;\n00049|   responseData?: any;\n00050|   apiUrl?: string;\n00051|   sessionId?: string;\n00052| }\n00053| \n00054| interface AddressSuggestion {\n00055|   value: string;\n00056|   unrestricted_value: string;\n00057|   data: {\n00058|     city?: string;\n00059|     street?: string;\n00060|     house?: string;\n00061|   };\n00062| }\n00063| \n00064| const COMPANIES = [\n00065|   { name: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏', logo: 'üì¶', connected: true },\n00066|   { name: '–ü–≠–ö', logo: 'üöõ', connected: true },\n00067|   { name: 'Nord Wheel', logo: 'üåê', connected: true },\n00068|   { name: 'Rail Continent', logo: 'üöÇ', connected: true }\n00069| ];\n00070| \n00071| export default function Home() {\n00072|   const [form, setForm] = useState<DeliveryForm>({\n00073|     cargos: [{ id: '1', length: 0, width: 0, height: 0, weight: 0 }],\n00074|     fromCity: '',\n00075|     toCity: '',\n00076|     fromAddress: '',\n00077|     toAddress: '',\n00078|     declaredValue: 0,\n00079|     needPackaging: false,\n00080|     needLoading: false,\n00081|     needCarry: false,\n00082|     floor: 1,\n00083|     hasFreightLift: false,\n00084|     needInsurance: false,\n00085|     fromTerminal: true,\n00086|     toTerminal: true,\n00087|     fromAddressDelivery: false,\n00088|     toAddressDelivery: false\n00089|   });\n00090| \n00091|   const [suggestions, setSuggestions] = useState<AddressSuggestion[]>([]);\n00092|   const [showSuggestions, setShowSuggestions] = useState(false);\n00093|   const [activeField, setActiveField] = useState('');\n00094|   const [calculations, setCalculations] = useState<CalculationResult[]>([]);\n00095|   const [calculating, setCalculating] = useState(false);\n00096|   const [expandedDetails, setExpandedDetails] = useState<{ [key: string]: boolean }>({});\n00097|   const [expandedDebugInfo, setExpandedDebugInfo] = useState<{ [key: string]: boolean }>({});\n00098|   const [suggestionPosition, setSuggestionPosition] = useState({ top: 0, left: 0 });\n00099| \n00100|   // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n00101|   useEffect(() => {\n00102|     const saved = localStorage.getItem('deliveryForm');\n00103|     if (saved) {\n00104|       setForm(JSON.parse(saved));\n00105|     }\n00106|   }, []);\n00107| \n00108|   // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏\n00109|   useEffect(() => {\n00110|     localStorage.setItem('deliveryForm', JSON.stringify(form));\n00111|   }, [form]);\n00112| \n00113|   // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –ø—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n00114|   useEffect(() => {\n00115|     if (form.declaredValue > 0) {\n00116|       setForm(prev => ({ ...prev, needInsurance: true }));\n00117|     }\n00118|   }, [form.declaredValue]);\n00119| \n00120|   const searchAddresses = useCallback(async (query: string, field: string, element?: HTMLInputElement) => {\n00121|     if (query.length < 3) {\n00122|       setSuggestions([]);\n00123|       setShowSuggestions(false);\n00124|       return;\n00125|     }\n00126| \n00127|     setActiveField(field);\n00128|     \n00129|     // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–æ–∫\n00130|     if (element) {\n00131|       const rect = element.getBoundingClientRect();\n00132|       setSuggestionPosition({\n00133|         top: rect.bottom + window.scrollY,\n00134|         left: rect.left + window.scrollX\n00135|       });\n00136|     }\n00137|     \n00138|     try {\n00139|       const response = await fetch('https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address', {\n00140|         method: 'POST',\n00141|         headers: {\n00142|           'Content-Type': 'application/json',\n00143|           'Accept': 'application/json',\n00144|           'Authorization': 'Token eb87bbb3789bb43ed465f796892ea951f9e91008'\n00145|         },\n00146|         body: JSON.stringify({\n00147|           query: query,\n00148|           count: 10\n00149|         })\n00150|       });\n00151| \n00152|       if (response.ok) {\n00153|         const data = await response.json();\n00154|         setSuggestions(data.suggestions || []);\n00155|         setShowSuggestions(true);\n00156|       }\n00157|     } catch (error) {\n00158|       console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Å–∫–∞–∑–æ–∫:', error);\n00159|     }\n00160|   }, []);\n00161| \n00162|   const debounceTimer = React.useRef<NodeJS.Timeout>();\n00163|   const handleAddressChange = (field: string, value: string, element?: HTMLInputElement) => {\n00164|     setForm(prev => ({ ...prev, [field]: value }));\n00165|     \n00166|     clearTimeout(debounceTimer.current);\n00167|     debounceTimer.current = setTimeout(() => {\n00168|       searchAddresses(value, field, element);\n00169|     }, 50);\n00170|   };\n00171| \n00172|   const selectSuggestion = (suggestion: AddressSuggestion) => {\n00173|     setForm(prev => ({ ...prev, [activeField]: suggestion.value }));\n00174|     setShowSuggestions(false);\n00175|     setSuggestions([]);\n00176|   };\n00177| \n00178|   const addCargo = () => {\n00179|     const newId = (form.cargos.length + 1).toString();\n00180|     setForm(prev => ({\n00181|       ...prev,\n00182|       cargos: [...prev.cargos, { id: newId, length: 0, width: 0, height: 0, weight: 0 }]\n00183|     }));\n00184|   };\n00185| \n00186|   const updateCargo = (id: string, field: string, value: number) => {\n00187|     setForm(prev => ({\n00188|       ...prev,\n00189|       cargos: prev.cargos.map(cargo => \n00190|         cargo.id === id ? { ...cargo, [field]: value } : cargo\n00191|       )\n00192|     }));\n00193|   };\n00194| \n00195|   const removeCargo = (id: string) => {\n00196|     if (form.cargos.length > 1) {\n00197|       setForm(prev => ({\n00198|         ...prev,\n00199|         cargos: prev.cargos.filter(cargo => cargo.id !== id)\n00200|       }));\n00201|     }\n00202|   };\n00203| \n00204|   // –ü–æ–ª—É—á–µ–Ω–∏–µ sessionID –¥–ª—è –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π\n00205|   const getDellinSessionId = async (): Promise<string | null> => {\n00206|     try {\n00207|       const authResponse = await fetch('https://api.dellin.ru/v3/auth/login.json', {\n00208|         method: 'POST',\n00209|         headers: {\n00210|           'Content-Type': 'application/json'\n00211|         },\n00212|         body: JSON.stringify({\n00213|           appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n00214|           login: 'service@lavsit.ru',\n00215|           password: 'edcwsx123QAZ'\n00216|         })\n00217|       });\n00218| \n00219|       if (authResponse.ok) {\n00220|         const authData = await authResponse.json();\n00221|         return authData.data?.sessionID || null;\n00222|       }\n00223|     } catch (error) {\n00224|       console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏:', error);\n00225|     }\n00226|     return null;\n00227|   };\n00228| \n00229|   // –†–∞—Å—á–µ—Ç –¥–ª—è –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π\n00230|   const calculateDellin = async (): Promise<CalculationResult> => {\n00231|     const apiUrl = 'https://api.dellin.ru/v2/calculator.json';\n00232|     \n00233|     try {\n00234|       const sessionID = await getDellinSessionId();\n00235|       \n00236|       if (!sessionID) {\n00237|         return {\n00238|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00239|           price: 0,\n00240|           days: 0,\n00241|           error: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å sessionID',\n00242|           apiUrl\n00243|         };\n00244|       }\n00245| \n00246|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00247|       const maxLength = Math.max(...form.cargos.map(c => c.length)) / 100;\n00248|       const maxWidth = Math.max(...form.cargos.map(c => c.width)) / 100;\n00249|       const maxHeight = Math.max(...form.cargos.map(c => c.height)) / 100;\n00250|       const totalVolume = maxLength * maxWidth * maxHeight;\n00251| \n00252|       const requestData = {\n00253|         appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n00254|         sessionID: sessionID,\n00255|         delivery: {\n00256|           deliveryType: {\n00257|             type: 'auto'\n00258|           },\n00259|           derival: {\n00260|             variant: form.fromTerminal ? 'terminal' : 'address',\n00261|             address: {\n00262|               search: form.fromAddress || form.fromCity\n00263|             },\n00264|             handling: form.needCarry ? {\n00265|               freightLift: form.hasFreightLift,\n00266|               toFloor: form.floor,\n00267|               carry: 50\n00268|             } : undefined\n00269|           },\n00270|           arrival: {\n00271|             variant: form.toTerminal ? 'terminal' : 'address',\n00272|             address: {\n00273|               search: form.toAddress || form.toCity\n00274|             },\n00275|             handling: form.needCarry ? {\n00276|               freightLift: form.hasFreightLift,\n00277|               toFloor: form.floor,\n00278|               carry: 50\n00279|             } : undefined\n00280|           },\n00281|           packages: [{\n00282|             uid: 'package_0',\n00283|             count: form.cargos.length\n00284|           }]\n00285|         },\n00286|         cargo: {\n00287|           quantity: form.cargos.length,\n00288|           length: maxLength,\n00289|           width: maxWidth,\n00290|           height: maxHeight,\n00291|           weight: totalWeight,\n00292|           totalVolume: totalVolume,\n00293|           totalWeight: totalWeight,\n00294|           oversizedWeight: 0,\n00295|           oversizedVolume: 0,\n00296|           insurance: form.needInsurance && form.declaredValue > 0 ? {\n00297|             statedValue: form.declaredValue,\n00298|             term: false\n00299|           } : undefined\n00300|         },\n00301|         payment: {\n00302|           type: 'cash',\n00303|           paymentCity: '7700000000000000000000000'\n00304|         }\n00305|       };\n00306| \n00307|       const response = await fetch(apiUrl, {\n00308|         method: 'POST',\n00309|         headers: {\n00310|           'Content-Type': 'application/json'\n00311|         },\n00312|         body: JSON.stringify(requestData)\n00313|       });\n00314| \n00315|       const data = await response.json();\n00316| \n00317|       if (response.ok && data.data) {\n00318|         let totalPrice = 0;\n00319|         \n00320|         // –ü–æ–ª—É—á–∞–µ–º —Ü–µ–Ω—É –∑–∞ –¥–æ—Å—Ç–∞–≤–∫—É\n00321|         if (data.data.availableDeliveryTypes?.auto) {\n00322|           totalPrice = data.data.availableDeliveryTypes.auto;\n00323|         } else if (data.data.price) {\n00324|           totalPrice = data.data.price;\n00325|         }\n00326|         \n00327|         // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏\n00328|         if (form.needInsurance && data.data.insurance) {\n00329|           totalPrice += data.data.insurance;\n00330|         }\n00331|         \n00332|         // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–ø–∞–∫–æ–≤–∫–∏ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞)\n00333|         if (form.needPackaging) {\n00334|           totalPrice += Math.round(totalWeight * 50);\n00335|         }\n00336| \n00337|         return {\n00338|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00339|           price: totalPrice,\n00340|           days: data.data.deliveryTerm || 0,\n00341|           details: data.data,\n00342|           requestData,\n00343|           responseData: data,\n00344|           apiUrl,\n00345|           sessionId: sessionID\n00346|         };\n00347|       } else {\n00348|         return {\n00349|           company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00350|           price: 0,\n00351|           days: 0,\n00352|           error: data.metadata?.detail || data.metadata?.message || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞',\n00353|           requestData,\n00354|           responseData: data,\n00355|           apiUrl,\n00356|           sessionId: sessionID\n00357|         };\n00358|       }\n00359|     } catch (error: any) {\n00360|       return {\n00361|         company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n00362|         price: 0,\n00363|         days: 0,\n00364|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n00365|         requestData: null,\n00366|         responseData: null,\n00367|         apiUrl\n00368|       };\n00369|     }\n00370|   };\n00371| \n00372|   // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n00373|   const calculateNordWheel = async (): Promise<CalculationResult> => {\n00374|     const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n00375|     \n00376|     try {\n00377|       const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00378|       const totalVolume = form.cargos.reduce((sum, cargo) => \n00379|         sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n00380|       );\n00381| \n00382|       const params = new URLSearchParams({\n00383|         from: '91', // –ú–æ—Å–∫–≤–∞ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n00384|         to: '92', // –°–ü–± (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n00385|         pickup: form.fromAddressDelivery ? '1' : '0',\n00386|         deliver: form.toAddressDelivery ? '1' : '0',\n00387|         weight: totalWeight.toString(),\n00388|         volume: totalVolume.toString(),\n00389|         oversized: '0',\n00390|         package: form.needPackaging ? '1' : '0',\n00391|         packageCount: form.cargos.length.toString(),\n00392|         insurance: form.needInsurance ? '1' : '0',\n00393|         sum: form.declaredValue.toString(),\n00394|         documentsReturn: '0',\n00395|         fragile: '0'\n00396|       });\n00397| \n00398|       const requestData = Object.fromEntries(params);\n00399|       const fullUrl = `${apiUrl}?${params.toString()}`;\n00400| \n00401|       const response = await fetch(fullUrl);\n00402|       const data = await response.json();\n00403| \n00404|       if (response.ok && data.status === 'success' && data.data) {\n00405|         return {\n00406|           company: 'Nord Wheel',\n00407|           price: data.data.total || 0,\n00408|           days: data.data.days || 0,\n00409|           details: data.data,\n00410|           requestData,\n00411|           responseData: data,\n00412|           apiUrl: fullUrl\n00413|         };\n00414|       } else {\n00415|         return {\n00416|           company: 'Nord Wheel',\n00417|           price: 0,\n00418|           days: 0,\n00419|           error: '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ Nord Wheel',\n00420|           requestData,\n00421|           responseData: data,\n00422|           apiUrl: fullUrl\n00423|         };\n00424|       }\n00425|     } catch (error: any) {\n00426|       return {\n00427|         company: 'Nord Wheel',\n00428|         price: 0,\n00429|         days: 0,\n00430|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n00431|         apiUrl\n00432|       };\n00433|     }\n00434|   };\n00435| \n00436|   // –ü–æ–ª—É—á–µ–Ω–∏–µ ID –≥–æ—Ä–æ–¥–æ–≤ –ü–≠–ö –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é\n00437|   const getPEKCityId = async (cityName: string): Promise<number | null> => {\n00438|     try {\n00439|       // –•–∞—Ä–¥–∫–æ–¥ –æ—Å–Ω–æ–≤–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏\n00440|       const cityMappings: { [key: string]: number } = {\n00441|         '–º–æ—Å–∫–≤–∞': -457,\n00442|         '—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥': 64883,\n00443|         '—Å–ø–±': 64883,\n00444|         '–µ–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥': 65102,\n00445|         '–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫': 65398,\n00446|         '–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä': 65294,\n00447|         '—Ä–æ—Å—Ç–æ–≤-–Ω–∞-–¥–æ–Ω—É': 65456,\n00448|         '–∫–∞–∑–∞–Ω—å': 65265,\n00449|         '–Ω–∏–∂–Ω–∏–π –Ω–æ–≤–≥–æ—Ä–æ–¥': 65392,\n00450|         '—Å–∞–º–∞—Ä–∞': 65469,\n00451|         '—É—Ñ–∞': 65533,\n00452|         '–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫': 65300,\n00453|         '–ø–µ—Ä–º—å': 65419,\n00454|         '–≤–æ—Ä–æ–Ω–µ–∂': 65122,\n00455|         '–≤–æ–ª–≥–æ–≥—Ä–∞–¥': 65118\n00456|       };\n00457|       \n00458|       const normalizedCity = cityName.toLowerCase().trim();\n00459|       return cityMappings[normalizedCity] || null;\n00460|     } catch (error) {\n00461|       console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è ID –≥–æ—Ä–æ–¥–∞ –ü–≠–ö:', error);\n00462|       return null;\n00463|     }\n00464|   };\n00465| \n00466|   // –†–∞—Å—á–µ—Ç –¥–ª—è –ü–≠–ö\n00467|   const calculatePEK = async (): Promise<CalculationResult> => {\n00468|     const apiUrl = 'http://calc.pecom.ru/bitrix/components/pecom/calc/ajax.php';\n00469|     \n00470|     try {\n00471|       // –ü–æ–ª—É—á–∞–µ–º ID –≥–æ—Ä–æ–¥–æ–≤\n00472|       const fromCityId = await getPEKCityId(form.fromCity);\n00473|       const toCityId = await getPEKCityId(form.toCity);\n00474|       \n00475|       if (!fromCityId || !toCityId) {\n00476|         return {\n00477|           company: '–ü–≠–ö',\n00478|           price: 0,\n00479|           days: 0,\n00480|           error: '–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –ü–≠–ö',\n00481|           apiUrl\n00482|         };\n00483|       }\n00484| \n00485|       // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞\n00486|       const params = new URLSearchParams();\n00487|       \n00488|       // –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä—É–∑—ã\n00489|       form.cargos.forEach((cargo, index) => {\n00490|         const width = cargo.width / 100; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ –º–µ—Ç—Ä—ã\n00491|         const length = cargo.length / 100;\n00492|         const height = cargo.height / 100;\n00493|         const volume = width * length * height;\n00494|         const weight = cargo.weight;\n00495|         const isOversized = (width > 2.4 || length > 12 || height > 2.7 || weight > 1500) ? 1 : 0;\n00496|         const needZTU = form.needPackaging ? 1 : 0;\n00497|         \n00498|         params.append(`places[${index}][]`, width.toString());\n00499|         params.append(`places[${index}][]`, length.toString());\n00500|         params.append(`places[${index}][]`, height.toString());\n00501|         params.append(`places[${index}][]`, volume.toString());\n00502|         params.append(`places[${index}][]`, weight.toString());\n00503|         params.append(`places[${index}][]`, isOversized.toString());\n00504|         params.append(`places[${index}][]`, needZTU.toString());\n00505|       });\n00506|       \n00507|       // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–±–æ—Ä–∞\n00508|       params.append('take[town]', fromCityId.toString());\n00509|       params.append('take[tent]', '0'); // —Ä–∞—Å—Ç–µ–Ω—Ç—Ä–æ–≤–∫–∞\n00510|       params.append('take[gidro]', form.needLoading ? '1' : '0'); // –≥–∏–¥—Ä–æ–ª–∏—Ñ—Ç\n00511|       params.append('take[manip]', '0'); // –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä\n00512|       params.append('take[speed]', '0'); // —Å—Ä–æ—á–Ω—ã–π –∑–∞–±–æ—Ä\n00513|       params.append('take[moscow]', '0'); // –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –ú–æ—Å–∫–≤–µ\n00514|       \n00515|       // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ—Å—Ç–∞–≤–∫–∏\n00516|       params.append('deliver[town]', toCityId.toString());\n00517|       params.append('deliver[tent]', '0');\n00518|       params.append('deliver[gidro]', form.needLoading ? '1' : '0');\n00519|       params.append('deliver[manip]', '0');\n00520|       params.append('deliver[speed]', '0');\n00521|       params.append('deliver[moscow]', '0');\n00522|       \n00523|       // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n00524|       params.append('plombir', '0'); // –ø–ª–æ–º–±—ã\n00525|       params.append('strah', form.needInsurance ? form.declaredValue.toString() : '0'); // —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞\n00526|       params.append('ashan', '0'); // –¥–æ—Å—Ç–∞–≤–∫–∞ –≤ –ê—à–∞–Ω\n00527|       params.append('night', '0'); // –Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è\n00528|       params.append('pal', '0'); // –∑–∞–ø–∞–ª–ª–µ—á–∏–≤–∞–Ω–∏–µ\n00529|       params.append('pallets', '0'); // –ø–∞–ª–ª–µ—Ç–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞\n00530| \n00531|       const fullUrl = `${apiUrl}?${params.toString()}`;\n00532|       const requestData = Object.fromEntries(params);\n00533| \n00534|       const response = await fetch(fullUrl, {\n00535|         method: 'GET',\n00536|         headers: {\n00537|           'Accept': 'application/json'\n00538|         }\n00539|       });\n00540| \n00541|       const data = await response.json();\n00542| \n00543|       if (response.ok && !data.error?.length) {\n00544|         let totalPrice = 0;\n00545|         let services: { name: string; description: string; price: number }[] = [];\n00546|         \n00547|         // –°–æ–±–∏—Ä–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥\n00548|         if (data.take?.[2]) {\n00549|           totalPrice += parseFloat(data.take[2]);\n00550|           services.push({ name: data.take[0], description: data.take[1], price: parseFloat(data.take[2]) });\n00551|         }\n00552|         \n00553|         if (data.auto?.[2]) {\n00554|           totalPrice += parseFloat(data.auto[2]);\n00555|           services.push({ name: data.auto[0], description: data.auto[1], price: parseFloat(data.auto[2]) });\n00556|         } else if (data.autonegabarit?.[2]) {\n00557|           totalPrice += parseFloat(data.autonegabarit[2]);\n00558|           services.push({ name: data.autonegabarit[0], description: data.autonegabarit[1], price: parseFloat(data.autonegabarit[2]) });\n00559|         }\n00560|         \n00561|         if (data.deliver?.[2]) {\n00562|           totalPrice += parseFloat(data.deliver[2]);\n00563|           services.push({ name: data.deliver[0], description: data.deliver[1], price: parseFloat(data.deliver[2]) });\n00564|         }\n00565|         \n00566|         // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n00567|         ['ADD', 'ADD_1', 'ADD_2', 'ADD_3', 'ADD_4'].forEach(key => {\n00568|           if (data[key]?.[2] && parseFloat(data[key][2]) > 0) {\n00569|             totalPrice += parseFloat(data[key][2]);\n00570|             services.push({ name: data[key][0], description: data[key][1], price: parseFloat(data[key][2]) });\n00571|           }\n00572|         });\n00573|         \n00574|         // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏\n00575|         let deliveryDays = 3; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n00576|         if (data.periods) {\n00577|           const daysMatch = data.periods.match(/(\\d+)\\s*–¥–Ω/);\n00578|           if (daysMatch) {\n00579|             deliveryDays = parseInt(daysMatch[1]);\n00580|           }\n00581|         }\n00582| \n00583|         return {\n00584|           company: '–ü–≠–ö',\n00585|           price: Math.round(totalPrice),\n00586|           days: deliveryDays,\n00587|           details: {\n00588|             services,\n00589|             periods: data.periods,\n00590|             aperiods: data.aperiods,\n00591|             rawData: data\n00592|           },\n00593|           requestData,\n00594|           responseData: data,\n00595|           apiUrl: fullUrl\n00596|         };\n00597|       } else {\n00598|         const errorMessages = data.error?.join(', ') || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';\n00599|         return {\n00600|           company: '–ü–≠–ö',\n00601|           price: 0,\n00602|           days: 0,\n00603|           error: errorMessages,\n00604|           requestData,\n00605|           responseData: data,\n00606|           apiUrl: fullUrl\n00607|         };\n00608|       }\n00609|     } catch (error: any) {\n00610|       return {\n00611|         company: '–ü–≠–ö',\n00612|         price: 0,\n00613|         days: 0,\n00614|         error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n00615|         apiUrl\n00616|       };\n00617|     }\n00618|   };\n00619| \n00620|   const calculateRailContinent = async (): Promise<CalculationResult> => {\n00621|     await new Promise(resolve => setTimeout(resolve, 1200));\n00622|     const basePrice = form.cargos.reduce((sum, cargo) => sum + cargo.weight * 12, 0);\n00623|     let totalPrice = basePrice;\n00624|     \n00625|     if (form.needInsurance) totalPrice += form.declaredValue * 0.025;\n00626|     if (form.needPackaging) totalPrice += basePrice * 0.08;\n00627|     \n00628|     return {\n00629|       company: 'Rail Continent',\n00630|       price: totalPrice,\n00631|       days: 5,\n00632|       apiUrl: 'https://www.railcontinent.ru/services/prochie-gruzoperevozki/forshop/api-manual/',\n00633|       details: { note: '–ó–∞–≥–ª—É—à–∫–∞ - API –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω' }\n00634|     };\n00635|   };\n00636| \n00637|   const handleCalculate = async () => {\n00638|     setCalculating(true);\n00639|     setCalculations([]);\n00640|     \n00641|     // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞\n00642|     localStorage.setItem('deliveryForm', JSON.stringify(form));\n00643|     \n00644|     try {\n00645|       const results = await Promise.all([\n00646|         calculateDellin(),\n00647|         calculatePEK(),\n00648|         calculateNordWheel(),\n00649|         calculateRailContinent()\n00650|       ]);\n00651|       \n00652|       // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–µ–Ω–µ\n00653|       const sortedResults = results\n00654|         .filter(result => !result.error)\n00655|         .sort((a, b) => a.price - b.price)\n00656|         .concat(results.filter(result => result.error));\n00657|       \n00658|       setCalculations(sortedResults);\n00659|     } catch (error) {\n00660|       console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ:', error);\n00661|     } finally {\n00662|       setCalculating(false);\n00663|     }\n00664|   };\n00665| \n00666|   const exportToPDF = () => {\n00667|     if (typeof window !== 'undefined') {\n00668|       window.print();\n00669|     }\n00670|   };\n00671| \n00672|   const toggleDetails = (company: string) => {\n00673|     setExpandedDetails(prev => ({\n00674|       ...prev,\n00675|       [company]: !prev[company]\n00676|     }));\n00677|   };\n00678| \n00679|   const toggleDebugInfo = (company: string) => {\n00680|     setExpandedDebugInfo(prev => ({\n00681|       ...prev,\n00682|       [company]: !prev[company]\n00683|     }));\n00684|   };\n00685| \n00686|   // –ü–∞—Ä—Å–µ—Ä –¥–µ—Ç–∞–ª–µ–π —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è —á–∏—Ç–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞\n00687|   const parseCalculationDetails = (calc: CalculationResult) => {\n00688|     const details: { service: string; description: string; price: number }[] = [];\n00689|     \n00690|     if (calc.company === '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏' && calc.details) {\n00691|       // –û—Å–Ω–æ–≤–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞\n00692|       if (calc.details.availableDeliveryTypes?.auto) {\n00693|         details.push({\n00694|           service: '–ú–µ–∂—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≤–æ–∑–∫–∞',\n00695|           description: `${form.fromCity} - ${form.toCity}`,\n00696|           price: calc.details.availableDeliveryTypes.auto\n00697|         });\n00698|       }\n00699|       \n00700|       // –ó–∞–±–æ—Ä –≥—Ä—É–∑–∞\n00701|       if (!form.fromTerminal && calc.details.derival?.price) {\n00702|         details.push({\n00703|           service: '–ó–∞–±–æ—Ä –≥—Ä—É–∑–∞',\n00704|           description: '–û—Ç –∞–¥—Ä–µ—Å–∞',\n00705|           price: calc.details.derival.price\n00706|         });\n00707|       }\n00708|       \n00709|       // –î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞\n00710|       if (!form.toTerminal && calc.details.arrival?.price) {\n00711|         details.push({\n00712|           service: '–û—Ç–≤–æ–∑ –≥—Ä—É–∑–∞',\n00713|           description: '–î–æ –∞–¥—Ä–µ—Å–∞',\n00714|           price: calc.details.arrival.price\n00715|         });\n00716|       }\n00717|       \n00718|       // –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ\n00719|       if (form.needInsurance && calc.details.insurance) {\n00720|         details.push({\n00721|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞ –∏ —Å—Ä–æ–∫–∞',\n00722|           description: '',\n00723|           price: calc.details.insurance\n00724|         });\n00725|         \n00726|         if (form.declaredValue > 0) {\n00727|           details.push({\n00728|             service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≥—Ä—É–∑–∞',\n00729|             description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n00730|             price: Math.round(form.declaredValue * 0.01)\n00731|           });\n00732|         }\n00733|       }\n00734|       \n00735|       // –£–ø–∞–∫–æ–≤–∫–∞\n00736|       if (form.needPackaging) {\n00737|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00738|         details.push({\n00739|           service: '–£—Å–ª—É–≥–∏ –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ',\n00740|           description: '–£–ø–∞–∫–æ–≤–∫–∞ –≥—Ä—É–∑–∞',\n00741|           price: Math.round(totalWeight * 50)\n00742|         });\n00743|       }\n00744|       \n00745|       // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏\n00746|       details.push({\n00747|         service: '–î–æ–ø.—É—Å–ª—É–≥–∏',\n00748|         description: '–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ —Å—Ç–∞—Ç—É—Å–µ –≥—Ä—É–∑–∞',\n00749|         price: 15\n00750|       });\n00751|     } else if (calc.company === '–ü–≠–ö' && calc.details?.services) {\n00752|       // –î–ª—è –ü–≠–ö –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ API\n00753|       calc.details.services.forEach((service: any) => {\n00754|         if (service.price > 0) {\n00755|           details.push({\n00756|             service: service.name || '–£—Å–ª—É–≥–∞ –ü–≠–ö',\n00757|             description: service.description || '',\n00758|             price: service.price\n00759|           });\n00760|         }\n00761|       });\n00762|     } else {\n00763|       // –î–ª—è –¥—Ä—É–≥–∏—Ö –¢–ö - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\n00764|       details.push({\n00765|         service: '–î–æ—Å—Ç–∞–≤–∫–∞ –≥—Ä—É–∑–∞',\n00766|         description: `${form.fromCity} - ${form.toCity}`,\n00767|         price: calc.price\n00768|       });\n00769|       \n00770|       if (form.needInsurance && form.declaredValue > 0) {\n00771|         details.push({\n00772|           service: '–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ',\n00773|           description: `–ù–∞ —Å—É–º–º—É ${form.declaredValue.toLocaleString()} ‚ÇΩ`,\n00774|           price: Math.round(form.declaredValue * 0.02)\n00775|         });\n00776|       }\n00777|       \n00778|       if (form.needPackaging) {\n00779|         const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n00780|         details.push({\n00781|           service: '–£–ø–∞–∫–æ–≤–∫–∞',\n00782|           description: '',\n00783|           price: Math.round(totalWeight * 30)\n00784|         });\n00785|       }\n00786|     }\n00787|     \n00788|     return details;\n00789|   };\n00790| \n00791|   return (\n00792|     <div className=\"min-h-screen bg-gray-900 text-white p-4 relative\">\n00793|       <div className=\"max-w-7xl mx-auto\">\n00794|         <h1 className=\"text-2xl font-bold text-center mb-6 text-blue-400\">\n00795|           –ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞ –õ–∞–≤—Å–∏—Ç\n00796|         </h1>\n00797|         \n00798|         <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 h-[90vh]\">\n00799|           {/* –õ–µ–≤–∞—è —á–∞—Å—Ç—å - —Ñ–æ—Ä–º–∞ */}\n00800|           <div className=\"space-y-3 overflow-y-auto pr-2\">\n00801|             {/* –ì—Ä—É–∑—ã */}\n00802|             <Card className=\"bg-gray-800 border-gray-700\">\n00803|               <CardHeader className=\"pb-3\">\n00804|                 <CardTitle className=\"text-white flex items-center gap-2 text-lg\">\n00805|                   <Truck className=\"h-4 w-4\" />\n00806|                   –ì—Ä—É–∑—ã\n00807|                 </CardTitle>\n00808|               </CardHeader>\n00809|               <CardContent className=\"space-y-3\">\n00810|                 {form.cargos.map((cargo, index) => (\n00811|                   <div key={cargo.id} className=\"border border-gray-600 rounded p-3\">\n00812|                     <div className=\"flex justify-between items-center mb-2\">\n00813|                       <h4 className=\"text-sm font-medium text-white\">–ì—Ä—É–∑ ‚Ññ{index + 1}</h4>\n00814|                       {form.cargos.length > 1 && (\n00815|                         <Button\n00816|                           variant=\"destructive\"\n00817|                           size=\"sm\"\n00818|                           onClick={() => removeCargo(cargo.id)}\n00819|                           className=\"h-6 text-xs\"\n00820|                         >\n00821|                           –£–¥–∞–ª–∏—Ç—å\n00822|                         </Button>\n00823|                       )}\n00824|                     </div>\n00825|                     <div className=\"grid grid-cols-2 gap-2\">\n00826|                       <div>\n00827|                         <Label className=\"text-white text-xs\">–î–ª–∏–Ω–∞ (—Å–º)</Label>\n00828|                         <Input\n00829|                           type=\"number\"\n00830|                           value={cargo.length || ''}\n00831|                           onChange={(e) => updateCargo(cargo.id, 'length', Number(e.target.value))}\n00832|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00833|                         />\n00834|                       </div>\n00835|                       <div>\n00836|                         <Label className=\"text-white text-xs\">–®–∏—Ä–∏–Ω–∞ (—Å–º)</Label>\n00837|                         <Input\n00838|                           type=\"number\"\n00839|                           value={cargo.width || ''}\n00840|                           onChange={(e) => updateCargo(cargo.id, 'width', Number(e.target.value))}\n00841|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00842|                         />\n00843|                       </div>\n00844|                       <div>\n00845|                         <Label className=\"text-white text-xs\">–í—ã—Å–æ—Ç–∞ (—Å–º)</Label>\n00846|                         <Input\n00847|                           type=\"number\"\n00848|                           value={cargo.height || ''}\n00849|                           onChange={(e) => updateCargo(cargo.id, 'height', Number(e.target.value))}\n00850|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00851|                         />\n00852|                       </div>\n00853|                       <div>\n00854|                         <Label className=\"text-white text-xs\">–í–µ—Å (–∫–≥)</Label>\n00855|                         <Input\n00856|                           type=\"number\"\n00857|                           value={cargo.weight || ''}\n00858|                           onChange={(e) => updateCargo(cargo.id, 'weight', Number(e.target.value))}\n00859|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00860|                         />\n00861|                       </div>\n00862|                     </div>\n00863|                   </div>\n00864|                 ))}\n00865|                 <Button onClick={addCargo} className=\"w-full h-8\" variant=\"outline\">\n00866|                   <Plus className=\"h-3 w-3 mr-1\" />\n00867|                   –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑\n00868|                 </Button>\n00869|               </CardContent>\n00870|             </Card>\n00871| \n00872|             {/* –ú–∞—Ä—à—Ä—É—Ç */}\n00873|             <Card className=\"bg-gray-800 border-gray-700\">\n00874|               <CardHeader className=\"pb-3\">\n00875|                 <CardTitle className=\"text-white flex items-center gap-2 text-lg\">\n00876|                   <Map className=\"h-4 w-4\" />\n00877|                   –ú–∞—Ä—à—Ä—É—Ç\n00878|                 </CardTitle>\n00879|               </CardHeader>\n00880|               <CardContent className=\"space-y-3\">\n00881|                 {/* –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */}\n00882|                 <div className=\"space-y-2\">\n00883|                   <Label className=\"text-sm font-medium text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</Label>\n00884|                   <div className=\"flex gap-3\">\n00885|                     <label className=\"flex items-center space-x-1\">\n00886|                       <input\n00887|                         type=\"radio\"\n00888|                         name=\"fromDelivery\"\n00889|                         checked={form.fromTerminal}\n00890|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: true, fromAddressDelivery: false }))}\n00891|                       />\n00892|                       <span className=\"text-white text-xs\">–û—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n00893|                     </label>\n00894|                     <label className=\"flex items-center space-x-1\">\n00895|                       <input\n00896|                         type=\"radio\"\n00897|                         name=\"fromDelivery\"\n00898|                         checked={form.fromAddressDelivery}\n00899|                         onChange={() => setForm(prev => ({ ...prev, fromTerminal: false, fromAddressDelivery: true }))}\n00900|                       />\n00901|                       <span className=\"text-white text-xs\">–û—Ç –∞–¥—Ä–µ—Å–∞</span>\n00902|                     </label>\n00903|                   </div>\n00904|                   \n00905|                   <div>\n00906|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n00907|                     <Input\n00908|                       value={form.fromCity}\n00909|                       onChange={(e) => handleAddressChange('fromCity', e.target.value, e.target)}\n00910|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n00911|                       className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00912|                     />\n00913|                   </div>\n00914|                   \n00915|                   {form.fromAddressDelivery && (\n00916|                     <div>\n00917|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n00918|                       <Input\n00919|                         value={form.fromAddress}\n00920|                         onChange={(e) => handleAddressChange('fromAddress', e.target.value, e.target)}\n00921|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n00922|                         className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00923|                       />\n00924|                     </div>\n00925|                   )}\n00926|                 </div>\n00927| \n00928|                 <Separator className=\"bg-gray-600\" />\n00929| \n00930|                 {/* –î–æ—Å—Ç–∞–≤–∫–∞ */}\n00931|                 <div className=\"space-y-2\">\n00932|                   <Label className=\"text-sm font-medium text-white\">–î–æ—Å—Ç–∞–≤–∫–∞</Label>\n00933|                   <div className=\"flex gap-3\">\n00934|                     <label className=\"flex items-center space-x-1\">\n00935|                       <input\n00936|                         type=\"radio\"\n00937|                         name=\"toDelivery\"\n00938|                         checked={form.toTerminal}\n00939|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: true, toAddressDelivery: false }))}\n00940|                       />\n00941|                       <span className=\"text-white text-xs\">–î–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n00942|                     </label>\n00943|                     <label className=\"flex items-center space-x-1\">\n00944|                       <input\n00945|                         type=\"radio\"\n00946|                         name=\"toDelivery\"\n00947|                         checked={form.toAddressDelivery}\n00948|                         onChange={() => setForm(prev => ({ ...prev, toTerminal: false, toAddressDelivery: true }))}\n00949|                       />\n00950|                       <span className=\"text-white text-xs\">–î–æ –∞–¥—Ä–µ—Å–∞</span>\n00951|                     </label>\n00952|                   </div>\n00953|                   \n00954|                   <div>\n00955|                     <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏</Label>\n00956|                     <Input\n00957|                       value={form.toCity}\n00958|                       onChange={(e) => handleAddressChange('toCity', e.target.value, e.target)}\n00959|                       placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n00960|                       className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00961|                     />\n00962|                   </div>\n00963|                   \n00964|                   {form.toAddressDelivery && (\n00965|                     <div>\n00966|                       <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</Label>\n00967|                       <Input\n00968|                         value={form.toAddress}\n00969|                         onChange={(e) => handleAddressChange('toAddress', e.target.value, e.target)}\n00970|                         placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n00971|                         className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00972|                       />\n00973|                     </div>\n00974|                   )}\n00975|                 </div>\n00976|               </CardContent>\n00977|             </Card>\n00978| \n00979|             {/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã */}\n00980|             <Card className=\"bg-gray-800 border-gray-700\">\n00981|               <CardHeader className=\"pb-3\">\n00982|                 <CardTitle className=\"text-white text-lg\">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</CardTitle>\n00983|               </CardHeader>\n00984|               <CardContent className=\"space-y-3\">\n00985|                 <div>\n00986|                   <Label className=\"text-white text-xs\">–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)</Label>\n00987|                   <Input\n00988|                     type=\"number\"\n00989|                     value={form.declaredValue || ''}\n00990|                     onChange={(e) => setForm(prev => ({ ...prev, declaredValue: Number(e.target.value) }))}\n00991|                     className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n00992|                   />\n00993|                 </div>\n00994|                 \n00995|                 <div className=\"space-y-2\">\n00996|                   <div className=\"flex items-center space-x-2\">\n00997|                     <Checkbox\n00998|                       id=\"packaging\"\n00999|                       checked={form.needPackaging}\n01000|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needPackaging: checked as boolean }))}\n01001|                     />\n01002|                     <Label htmlFor=\"packaging\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø–∞–∫–æ–≤–∫–∞</Label>\n01003|                   </div>\n01004|                   \n01005|                   <div className=\"flex items-center space-x-2\">\n01006|                     <Checkbox\n01007|                       id=\"insurance\"\n01008|                       checked={form.needInsurance}\n01009|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needInsurance: checked as boolean }))}\n01010|                     />\n01011|                     <Label htmlFor=\"insurance\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</Label>\n01012|                   </div>\n01013|                   \n01014|                   <div className=\"flex items-center space-x-2\">\n01015|                     <Checkbox\n01016|                       id=\"loading\"\n01017|                       checked={form.needLoading}\n01018|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needLoading: checked as boolean }))}\n01019|                     />\n01020|                     <Label htmlFor=\"loading\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≥—Ä—É–∑–∫–∞/—Ä–∞–∑–≥—Ä—É–∑–∫–∞</Label>\n01021|                   </div>\n01022|                   \n01023|                   <div className=\"flex items-center space-x-2\">\n01024|                     <Checkbox\n01025|                       id=\"carry\"\n01026|                       checked={form.needCarry}\n01027|                       onCheckedChange={(checked) => setForm(prev => ({ ...prev, needCarry: checked as boolean }))}\n01028|                     />\n01029|                     <Label htmlFor=\"carry\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—ä–µ–º</Label>\n01030|                   </div>\n01031|                   \n01032|                   {form.needCarry && (\n01033|                     <div className=\"ml-6 space-y-2 border-l-2 border-gray-600 pl-3\">\n01034|                       <div>\n01035|                         <Label className=\"text-white text-xs\">–≠—Ç–∞–∂</Label>\n01036|                         <Input\n01037|                           type=\"number\"\n01038|                           value={form.floor}\n01039|                           onChange={(e) => setForm(prev => ({ ...prev, floor: Number(e.target.value) }))}\n01040|                           className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n01041|                         />\n01042|                       </div>\n01043|                       <div className=\"flex items-center space-x-2\">\n01044|                         <Checkbox\n01045|                           id=\"freightLift\"\n01046|                           checked={form.hasFreightLift}\n01047|                           onCheckedChange={(checked) => setForm(prev => ({ ...prev, hasFreightLift: checked as boolean }))}\n01048|                         />\n01049|                         <Label htmlFor=\"freightLift\" className=\"text-white text-xs\">–ù–∞–ª–∏—á–∏–µ –≥—Ä—É–∑–æ–≤–æ–≥–æ –ª–∏—Ñ—Ç–∞</Label>\n01050|                       </div>\n01051|                     </div>\n01052|                   )}\n01053|                 </div>\n01054|                 \n01055|                 <Button \n01056|                   onClick={handleCalculate} \n01057|                   className=\"w-full bg-blue-600 hover:bg-blue-700 h-8\" \n01058|                   disabled={calculating}\n01059|                 >\n01060|                   {calculating ? '–†–∞—Å—á–µ—Ç...' : '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å'}\n01061|                 </Button>\n01062|               </CardContent>\n01063|             </Card>\n01064|           </div>\n01065| \n01066|           {/* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã */}\n01067|           <div className=\"space-y-3 overflow-y-auto\">\n01068|             {calculations.length > 0 && (\n01069|               <div className=\"space-y-3\">\n01070|                 <div className=\"flex justify-between items-center\">\n01071|                   <h2 className=\"text-xl font-bold text-blue-400\">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>\n01072|                   <Button onClick={exportToPDF} variant=\"outline\" size=\"sm\" className=\"h-7 text-xs\">\n01073|                     –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF\n01074|                   </Button>\n01075|                 </div>\n01076|                 \n01077|                 {calculations.map((calc, index) => (\n01078|                   <Card key={index} className=\"bg-gray-800 border-gray-700\">\n01079|                     <CardHeader className=\"pb-2\">\n01080|                       <div className=\"flex justify-between items-center\">\n01081|                         <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n01082|                           <Building2 className=\"h-4 w-4\" />\n01083|                           {calc.company}\n01084|                         </CardTitle>\n01085|                         {calc.error ? (\n01086|                           <Badge variant=\"destructive\" className=\"text-xs\">–û—à–∏–±–∫–∞</Badge>\n01087|                         ) : (\n01088|                           <Badge variant=\"default\" className=\"bg-green-600 text-xs\">\n01089|                             {calc.price.toLocaleString()} ‚ÇΩ\n01090|                           </Badge>\n01091|                         )}\n01092|                       </div>\n01093|                     </CardHeader>\n01094|                     <CardContent className=\"pt-0\">\n01095|                       {calc.error ? (\n01096|                         <Alert className=\"border-red-600\">\n01097|                           <AlertDescription className=\"text-white text-xs\">{calc.error}</AlertDescription>\n01098|                         </Alert>\n01099|                       ) : (\n01100|                         <div className=\"space-y-2\">\n01101|                           <p className=\"text-white text-xs\"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n01102|                           <p className=\"text-white text-xs\"><strong>–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {calc.days} –¥–Ω–µ–π</p>\n01103|                           \n01104|                           <div className=\"flex gap-2 mt-2\">\n01105|                             <Button\n01106|                               variant=\"outline\"\n01107|                               size=\"sm\"\n01108|                               onClick={() => toggleDetails(calc.company)}\n01109|                               className=\"h-6 text-xs\"\n01110|                             >\n01111|                               {expandedDetails[calc.company] ? '–°–∫—Ä—ã—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ' : '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ'}\n01112|                             </Button>\n01113|                             <Button\n01114|                               variant=\"outline\"\n01115|                               size=\"sm\"\n01116|                               onClick={() => toggleDebugInfo(calc.company)}\n01117|                               className=\"h-6 text-xs\"\n01118|                             >\n01119|                               {expandedDebugInfo[calc.company] ? '–°–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–∫—É' : '–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'}\n01120|                             </Button>\n01121|                           </div>\n01122|                           \n01123|                           {/* –î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ */}\n01124|                           <Collapsible open={expandedDetails[calc.company]}>\n01125|                             <CollapsibleContent className=\"mt-2\">\n01126|                               <div className=\"bg-gray-900 p-3 rounded text-xs\">\n01127|                                 <h4 className=\"font-bold mb-2 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞:</h4>\n01128|                                 {(() => {\n01129|                                   const details = parseCalculationDetails(calc);\n01130|                                   const totalPrice = details.reduce((sum, detail) => sum + detail.price, 0);\n01131|                                   \n01132|                                   return (\n01133|                                     <div className=\"space-y-1\">\n01134|                                       {details.map((detail, idx) => (\n01135|                                         <div key={idx} className=\"flex justify-between text-white\">\n01136|                                           <div>\n01137|                                             <div className=\"font-medium\">{detail.service}</div>\n01138|                                             {detail.description && (\n01139|                                               <div className=\"text-gray-400 text-xs\">{detail.description}</div>\n01140|                                             )}\n01141|                                           </div>\n01142|                                           <div className=\"font-medium\">{detail.price.toLocaleString()} ‚ÇΩ</div>\n01143|                                         </div>\n01144|                                       ))}\n01145|                                       <hr className=\"border-gray-600 my-2\" />\n01146|                                       <div className=\"flex justify-between font-bold text-white\">\n01147|                                         <div>–ö –æ–ø–ª–∞—Ç–µ –ø–æ –∑–∞–∫–∞–∑—É:</div>\n01148|                                         <div>{totalPrice.toLocaleString()} ‚ÇΩ</div>\n01149|                                       </div>\n01150|                                     </div>\n01151|                                   );\n01152|                                 })()}\n01153|                               </div>\n01154|                             </CollapsibleContent>\n01155|                           </Collapsible>\n01156|                           \n01157|                           {/* –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */}\n01158|                           <Collapsible open={expandedDebugInfo[calc.company]}>\n01159|                             <CollapsibleContent className=\"mt-2\">\n01160|                               <div className=\"bg-gray-900 p-3 rounded text-xs\">\n01161|                                 <h4 className=\"font-bold mb-2 text-white\">–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>\n01162|                                 \n01163|                                 {calc.apiUrl && (\n01164|                                   <div className=\"mb-3\">\n01165|                                     <h5 className=\"font-bold mb-1 text-white\">–ó–∞–ø—Ä–æ—Å –∫ API:</h5>\n01166|                                     <p className=\"text-gray-300 break-all\">URL: {calc.apiUrl}</p>\n01167|                                   </div>\n01168|                                 )}\n01169|                                 \n01170|                                 {calc.sessionId && (\n01171|                                   <div className=\"mb-3\">\n01172|                                     <h5 className=\"font-bold mb-1 text-white\">Session ID:</h5>\n01173|                                     <p className=\"text-gray-300\">{calc.sessionId}</p>\n01174|                                   </div>\n01175|                                 )}\n01176|                                 \n01177|                                 {calc.requestData && (\n01178|                                   <div className=\"mb-3\">\n01179|                                     <h5 className=\"font-bold mb-1 text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:</h5>\n01180|                                     <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n01181|                                       {JSON.stringify(calc.requestData, null, 2)}\n01182|                                     </pre>\n01183|                                   </div>\n01184|                                 )}\n01185|                                 \n01186|                                 {calc.responseData && (\n01187|                                   <div className=\"mb-3\">\n01188|                                     <h5 className=\"font-bold mb-1 text-white\">–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:</h5>\n01189|                                     <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n01190|                                       {JSON.stringify(calc.responseData, null, 2)}\n01191|                                     </pre>\n01192|                                   </div>\n01193|                                 )}\n01194|                                 \n01195|                                 {calc.details && (\n01196|                                   <div className=\"mb-3\">\n01197|                                     <h5 className=\"font-bold mb-1 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞ (JSON):</h5>\n01198|                                     <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n01199|                                       {JSON.stringify(calc.details, null, 2)}\n01200|                                     </pre>\n01201|                                   </div>\n01202|                                 )}\n01203|                               </div>\n01204|                             </CollapsibleContent>\n01205|                           </Collapsible>\n01206|                         </div>\n01207|                       )}\n01208|                     </CardContent>\n01209|                   </Card>\n01210|                 ))}\n01211|               </div>\n01212|             )}\n01213|             \n01214|             {/* –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –¢–ö */}\n01215|             <Card className=\"bg-gray-800 border-gray-700\">\n01216|               <CardHeader className=\"pb-2\">\n01217|                 <CardTitle className=\"text-white text-sm\">–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏</CardTitle>\n01218|               </CardHeader>\n01219|               <CardContent>\n01220|                 <div className=\"grid grid-cols-2 gap-2\">\n01221|                   {COMPANIES.map((company, index) => (\n01222|                     <div key={index} className=\"flex items-center gap-2 p-2 bg-gray-700 rounded\">\n01223|                       <span className=\"text-lg\">{company.logo}</span>\n01224|                       <div>\n01225|                         <p className=\"font-medium text-white text-xs\">{company.name}</p>\n01226|                         <Badge variant={company.connected ? \"default\" : \"destructive\"} className=\"text-xs\">\n01227|                           {company.connected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∞' : '–û—Ç–∫–ª—é—á–µ–Ω–∞'}\n01228|                         </Badge>\n01229|                       </div>\n01230|                     </div>\n01231|                   ))}\n01232|                 </div>\n01233|               </CardContent>\n01234|             </Card>\n01235|           </div>\n01236|         </div>\n01237|       </div>\n01238| \n01239|       {/* –ê–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∏ */}\n01240|       {showSuggestions && suggestions.length > 0 && (\n01241|         <div \n01242|           className=\"fixed z-50 bg-gray-800 border border-gray-700 rounded-md shadow-lg max-w-sm w-full max-h-60 overflow-y-auto\"\n01243|           style={{\n01244|             top: suggestionPosition.top,\n01245|             left: suggestionPosition.left\n01246|           }}\n01247|         >\n01248|           <div className=\"p-1\">\n01249|             {suggestions.map((suggestion, index) => (\n01250|               <div\n01251|                 key={index}\n01252|                 className=\"p-2 hover:bg-gray-700 cursor-pointer text-xs text-white rounded transition-colors\"\n01253|                 onClick={() => selectSuggestion(suggestion)}\n01254|               >\n01255|                 {suggestion.value}\n01256|               </div>\n01257|             ))}\n01258|           </div>\n01259|         </div>\n01260|       )}\n01261|     </div>\n01262|   );\n01263| }\n</file>",
    "metadata": {
      "preview": "'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Plus, Truck, Building2, Map } from 'lucide-react';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { Collapsible, CollapsibleContent } from '@/components/ui/collapsible';\n\ninterface Cargo {\n  id: string;\n  length: number;\n  width: number;\n  height: number;\n  weight: number;"
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1758702663271,
      "end": 1758702663280
    }
  }
}