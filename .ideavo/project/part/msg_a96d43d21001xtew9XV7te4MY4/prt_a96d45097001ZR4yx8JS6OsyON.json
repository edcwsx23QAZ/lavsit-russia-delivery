{
  "id": "prt_a96d45097001ZR4yx8JS6OsyON",
  "sessionID": "ses_6852784ecffeuHwynj83p2lr14",
  "messageID": "msg_a96d43d21001xtew9XV7te4MY4",
  "type": "tool",
  "callID": "call_21839854",
  "tool": "edit",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "test-nordwheel-api.js",
      "newString": "// Тестовый скрипт для проверки NordWheel API\nconst testNordWheelAPI = async () => {\n  const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n\n  const params = new URLSearchParams({\n    'dispatch[city]': 'Москва',\n    'dispatch[terminal]': 'Москва',\n    'destination[city]': 'Санкт-Петербург',\n    'destination[terminal]': 'Санкт-Петербург',\n    'cargo[weight]': '10',\n    'cargo[volume]': '1.0',\n    'cargo[quantity]': '1',\n    'insurance': '1000',\n    'services[package]': 'false',\n    'services[documents_return]': 'false',\n    'services[fragile]': 'false',\n  });\n\n  const fullUrl = `${apiUrl}?${params.toString()}`;\n\n  try {\n    console.log('Отправка запроса к NordWheel API...');\n    console.log('URL:', fullUrl);\n    const response = await fetch(fullUrl, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    console.log('Статус ответа:', response.status);\n\n    if (!response.ok) {\n      console.error('Ошибка API:', response.status, response.statusText);\n      const errorText = await response.text();\n      console.error('Тело ошибки:', errorText);\n      return;\n    }\n\n    const data = await response.json();\n    console.log('Ответ от API:', JSON.stringify(data, null, 2));\n\n    if (data.success) {\n      console.log('Цена:', data.price);\n      console.log('Дни:', data.days);\n    } else {\n      console.log('API вернул success: false');\n    }\n\n  } catch (error) {\n    console.error('Ошибка соединения:', error);\n  }\n};\n\ntestNordWheelAPI();",
      "oldString": "// Тестовый скрипт для проверки NordWheel API\nconst testNordWheelAPI = async () => {\n  const apiUrl = 'https://api.nordw.orog.ru/api/v1/calculate';\n\n  const requestData = {\n    dispatch: {\n      location: {\n        type: 'terminal',\n        city_fias: '0c5b2444-70a0-4932-980c-b4dc0d3f02b5' // Москва\n      }\n    },\n    destination: {\n      location: {\n        type: 'terminal',\n        city_fias: 'c2deb16a-0330-4f05-821f-1d09c93331e6' // СПб\n      }\n    },\n    cargo: {\n      total_weight: 10,\n      total_volume: 1.0,\n      total_quantity: 1\n    },\n    insurance: 1000,\n    insurance_refuse: false,\n    services: {\n      is_package: false,\n      is_documents_return: false,\n      is_fragile: false\n    },\n    promocode: null\n  };\n\n  try {\n    console.log('Отправка запроса к NordWheel API...');\n    const response = await fetch(apiUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(requestData)\n    });\n\n    console.log('Статус ответа:', response.status);\n\n    if (!response.ok) {\n      console.error('Ошибка API:', response.status, response.statusText);\n      const errorText = await response.text();\n      console.error('Тело ошибки:', errorText);\n      return;\n    }\n\n    const data = await response.json();\n    console.log('Ответ от API:', JSON.stringify(data, null, 2));\n\n  } catch (error) {\n    console.error('Ошибка соединения:', error);\n  }\n};\n\ntestNordWheelAPI();"
    },
    "output": "",
    "title": "test-nordwheel-api.js",
    "metadata": {
      "diagnostics": {},
      "diff": "Index: /home/user/project/test-nordwheel-api.js\n===================================================================\n--- /home/user/project/test-nordwheel-api.js\n+++ /home/user/project/test-nordwheel-api.js\n@@ -1,44 +1,32 @@\n // Тестовый скрипт для проверки NordWheel API\n const testNordWheelAPI = async () => {\n-  const apiUrl = 'https://api.nordw.orog.ru/api/v1/calculate';\n+  const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n \n-  const requestData = {\n-    dispatch: {\n-      location: {\n-        type: 'terminal',\n-        city_fias: '0c5b2444-70a0-4932-980c-b4dc0d3f02b5' // Москва\n-      }\n-    },\n-    destination: {\n-      location: {\n-        type: 'terminal',\n-        city_fias: 'c2deb16a-0330-4f05-821f-1d09c93331e6' // СПб\n-      }\n-    },\n-    cargo: {\n-      total_weight: 10,\n-      total_volume: 1.0,\n-      total_quantity: 1\n-    },\n-    insurance: 1000,\n-    insurance_refuse: false,\n-    services: {\n-      is_package: false,\n-      is_documents_return: false,\n-      is_fragile: false\n-    },\n-    promocode: null\n-  };\n+  const params = new URLSearchParams({\n+    'dispatch[city]': 'Москва',\n+    'dispatch[terminal]': 'Москва',\n+    'destination[city]': 'Санкт-Петербург',\n+    'destination[terminal]': 'Санкт-Петербург',\n+    'cargo[weight]': '10',\n+    'cargo[volume]': '1.0',\n+    'cargo[quantity]': '1',\n+    'insurance': '1000',\n+    'services[package]': 'false',\n+    'services[documents_return]': 'false',\n+    'services[fragile]': 'false',\n+  });\n \n+  const fullUrl = `${apiUrl}?${params.toString()}`;\n+\n   try {\n     console.log('Отправка запроса к NordWheel API...');\n-    const response = await fetch(apiUrl, {\n-      method: 'POST',\n+    console.log('URL:', fullUrl);\n+    const response = await fetch(fullUrl, {\n+      method: 'GET',\n       headers: {\n         'Content-Type': 'application/json',\n       },\n-      body: JSON.stringify(requestData)\n     });\n \n     console.log('Статус ответа:', response.status);\n \n@@ -51,8 +39,15 @@\n \n     const data = await response.json();\n     console.log('Ответ от API:', JSON.stringify(data, null, 2));\n \n+    if (data.success) {\n+      console.log('Цена:', data.price);\n+      console.log('Дни:', data.days);\n+    } else {\n+      console.log('API вернул success: false');\n+    }\n+\n   } catch (error) {\n     console.error('Ошибка соединения:', error);\n   }\n };\n"
    },
    "time": {
      "start": 1763467088024,
      "end": 1763467088029
    }
  }
}