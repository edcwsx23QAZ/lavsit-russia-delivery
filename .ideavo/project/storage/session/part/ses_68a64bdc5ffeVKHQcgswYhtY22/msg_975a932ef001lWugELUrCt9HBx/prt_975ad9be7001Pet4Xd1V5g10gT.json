{
  "id": "prt_975ad9be7001Pet4Xd1V5g10gT",
  "messageID": "msg_975a932ef001lWugELUrCt9HBx",
  "sessionID": "ses_68a64bdc5ffeVKHQcgswYhtY22",
  "type": "tool",
  "tool": "write",
  "callID": "toolu_011AUQXCxS2oYG6ZTf6YFJ1E",
  "state": {
    "status": "completed",
    "input": {
      "filePath": "/home/user/project/app/page.tsx",
      "content": "'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Plus, Truck, Building2, Map } from 'lucide-react';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { Collapsible, CollapsibleContent } from '@/components/ui/collapsible';\n\ninterface Cargo {\n  id: string;\n  length: number;\n  width: number;\n  height: number;\n  weight: number;\n}\n\ninterface DeliveryForm {\n  cargos: Cargo[];\n  fromCity: string;\n  toCity: string;\n  fromAddress: string;\n  toAddress: string;\n  declaredValue: number;\n  needPackaging: boolean;\n  needLoading: boolean;\n  needCarry: boolean;\n  floor: number;\n  hasFreightLift: boolean;\n  needInsurance: boolean;\n  fromTerminal: boolean;\n  toTerminal: boolean;\n  fromAddressDelivery: boolean;\n  toAddressDelivery: boolean;\n}\n\ninterface CalculationResult {\n  company: string;\n  price: number;\n  days: number;\n  details?: any;\n  error?: string;\n  requestData?: any;\n  responseData?: any;\n  apiUrl?: string;\n  sessionId?: string;\n}\n\ninterface AddressSuggestion {\n  value: string;\n  unrestricted_value: string;\n  data: {\n    city?: string;\n    street?: string;\n    house?: string;\n  };\n}\n\nconst COMPANIES = [\n  { name: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏', logo: 'üì¶', connected: true },\n  { name: '–ü–≠–ö', logo: 'üöõ', connected: true },\n  { name: 'Nord Wheel', logo: 'üåê', connected: true },\n  { name: 'Rail Continent', logo: 'üöÇ', connected: true }\n];\n\nexport default function Home() {\n  const [form, setForm] = useState<DeliveryForm>({\n    cargos: [{ id: '1', length: 0, width: 0, height: 0, weight: 0 }],\n    fromCity: '',\n    toCity: '',\n    fromAddress: '',\n    toAddress: '',\n    declaredValue: 0,\n    needPackaging: false,\n    needLoading: false,\n    needCarry: false,\n    floor: 1,\n    hasFreightLift: false,\n    needInsurance: false,\n    fromTerminal: true,\n    toTerminal: true,\n    fromAddressDelivery: false,\n    toAddressDelivery: false\n  });\n\n  const [suggestions, setSuggestions] = useState<AddressSuggestion[]>([]);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [activeField, setActiveField] = useState('');\n  const [calculations, setCalculations] = useState<CalculationResult[]>([]);\n  const [calculating, setCalculating] = useState(false);\n  const [expandedDetails, setExpandedDetails] = useState<{ [key: string]: boolean }>({});\n  const [suggestionPosition, setSuggestionPosition] = useState({ top: 0, left: 0 });\n\n  // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n  useEffect(() => {\n    const saved = localStorage.getItem('deliveryForm');\n    if (saved) {\n      setForm(JSON.parse(saved));\n    }\n  }, []);\n\n  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏\n  useEffect(() => {\n    localStorage.setItem('deliveryForm', JSON.stringify(form));\n  }, [form]);\n\n  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –ø—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n  useEffect(() => {\n    if (form.declaredValue > 0) {\n      setForm(prev => ({ ...prev, needInsurance: true }));\n    }\n  }, [form.declaredValue]);\n\n  const searchAddresses = useCallback(async (query: string, field: string, element?: HTMLInputElement) => {\n    if (query.length < 3) {\n      setSuggestions([]);\n      setShowSuggestions(false);\n      return;\n    }\n\n    setActiveField(field);\n    \n    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –∞–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–æ–∫\n    if (element) {\n      const rect = element.getBoundingClientRect();\n      setSuggestionPosition({\n        top: rect.bottom + window.scrollY,\n        left: rect.left + window.scrollX\n      });\n    }\n    \n    try {\n      const response = await fetch('https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json',\n          'Authorization': 'Token eb87bbb3789bb43ed465f796892ea951f9e91008'\n        },\n        body: JSON.stringify({\n          query: query,\n          count: 10\n        })\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setSuggestions(data.suggestions || []);\n        setShowSuggestions(true);\n      }\n    } catch (error) {\n      console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Å–∫–∞–∑–æ–∫:', error);\n    }\n  }, []);\n\n  const debounceTimer = React.useRef<NodeJS.Timeout>();\n  const handleAddressChange = (field: string, value: string, element?: HTMLInputElement) => {\n    setForm(prev => ({ ...prev, [field]: value }));\n    \n    clearTimeout(debounceTimer.current);\n    debounceTimer.current = setTimeout(() => {\n      searchAddresses(value, field, element);\n    }, 50);\n  };\n\n  const selectSuggestion = (suggestion: AddressSuggestion) => {\n    setForm(prev => ({ ...prev, [activeField]: suggestion.value }));\n    setShowSuggestions(false);\n    setSuggestions([]);\n  };\n\n  const addCargo = () => {\n    const newId = (form.cargos.length + 1).toString();\n    setForm(prev => ({\n      ...prev,\n      cargos: [...prev.cargos, { id: newId, length: 0, width: 0, height: 0, weight: 0 }]\n    }));\n  };\n\n  const updateCargo = (id: string, field: string, value: number) => {\n    setForm(prev => ({\n      ...prev,\n      cargos: prev.cargos.map(cargo => \n        cargo.id === id ? { ...cargo, [field]: value } : cargo\n      )\n    }));\n  };\n\n  const removeCargo = (id: string) => {\n    if (form.cargos.length > 1) {\n      setForm(prev => ({\n        ...prev,\n        cargos: prev.cargos.filter(cargo => cargo.id !== id)\n      }));\n    }\n  };\n\n  // –ü–æ–ª—É—á–µ–Ω–∏–µ sessionID –¥–ª—è –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π\n  const getDellinSessionId = async (): Promise<string | null> => {\n    try {\n      const authResponse = await fetch('https://api.dellin.ru/v3/auth/login.json', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n          login: 'service@lavsit.ru',\n          password: 'edcwsx123QAZ'\n        })\n      });\n\n      if (authResponse.ok) {\n        const authData = await authResponse.json();\n        return authData.data?.sessionID || null;\n      }\n    } catch (error) {\n      console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏:', error);\n    }\n    return null;\n  };\n\n  // –†–∞—Å—á–µ—Ç –¥–ª—è –î–µ–ª–æ–≤—ã—Ö –õ–∏–Ω–∏–π\n  const calculateDellin = async (): Promise<CalculationResult> => {\n    const apiUrl = 'https://api.dellin.ru/v2/calculator.json';\n    \n    try {\n      const sessionID = await getDellinSessionId();\n      \n      if (!sessionID) {\n        return {\n          company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n          price: 0,\n          days: 0,\n          error: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å sessionID',\n          apiUrl\n        };\n      }\n\n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const maxLength = Math.max(...form.cargos.map(c => c.length)) / 100;\n      const maxWidth = Math.max(...form.cargos.map(c => c.width)) / 100;\n      const maxHeight = Math.max(...form.cargos.map(c => c.height)) / 100;\n      const totalVolume = maxLength * maxWidth * maxHeight;\n\n      const requestData = {\n        appkey: 'E6C50E91-8E93-440F-9CC6-DEF9F0D68F1B',\n        sessionID: sessionID,\n        delivery: {\n          deliveryType: {\n            type: 'auto'\n          },\n          derival: {\n            variant: form.fromTerminal ? 'terminal' : 'address',\n            address: {\n              search: form.fromAddress || form.fromCity\n            },\n            handling: form.needCarry ? {\n              freightLift: form.hasFreightLift,\n              toFloor: form.floor,\n              carry: 50\n            } : undefined\n          },\n          arrival: {\n            variant: form.toTerminal ? 'terminal' : 'address',\n            address: {\n              search: form.toAddress || form.toCity\n            },\n            handling: form.needCarry ? {\n              freightLift: form.hasFreightLift,\n              toFloor: form.floor,\n              carry: 50\n            } : undefined\n          },\n          packages: [{\n            uid: 'package_0',\n            count: form.cargos.length\n          }]\n        },\n        cargo: {\n          quantity: form.cargos.length,\n          length: maxLength,\n          width: maxWidth,\n          height: maxHeight,\n          weight: totalWeight,\n          totalVolume: totalVolume,\n          totalWeight: totalWeight,\n          oversizedWeight: 0,\n          oversizedVolume: 0,\n          insurance: form.needInsurance && form.declaredValue > 0 ? {\n            statedValue: form.declaredValue,\n            term: false\n          } : undefined\n        },\n        payment: {\n          type: 'cash',\n          paymentCity: '7700000000000000000000000'\n        }\n      };\n\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(requestData)\n      });\n\n      const data = await response.json();\n\n      if (response.ok && data.data) {\n        let totalPrice = 0;\n        \n        // –ü–æ–ª—É—á–∞–µ–º —Ü–µ–Ω—É –∑–∞ –¥–æ—Å—Ç–∞–≤–∫—É\n        if (data.data.availableDeliveryTypes?.auto) {\n          totalPrice = data.data.availableDeliveryTypes.auto;\n        } else if (data.data.price) {\n          totalPrice = data.data.price;\n        }\n        \n        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏\n        if (form.needInsurance && data.data.insurance) {\n          totalPrice += data.data.insurance;\n        }\n        \n        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–ø–∞–∫–æ–≤–∫–∏ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞)\n        if (form.needPackaging) {\n          totalPrice += Math.round(totalWeight * 50);\n        }\n\n        return {\n          company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n          price: totalPrice,\n          days: data.data.deliveryTerm || 0,\n          details: data.data,\n          requestData,\n          responseData: data,\n          apiUrl,\n          sessionId: sessionID\n        };\n      } else {\n        return {\n          company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n          price: 0,\n          days: 0,\n          error: data.metadata?.detail || data.metadata?.message || '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞',\n          requestData,\n          responseData: data,\n          apiUrl,\n          sessionId: sessionID\n        };\n      }\n    } catch (error: any) {\n      return {\n        company: '–î–µ–ª–æ–≤—ã–µ –õ–∏–Ω–∏–∏',\n        price: 0,\n        days: 0,\n        error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n        requestData: null,\n        responseData: null,\n        apiUrl\n      };\n    }\n  };\n\n  // –†–∞—Å—á–µ—Ç –¥–ª—è Nord Wheel\n  const calculateNordWheel = async (): Promise<CalculationResult> => {\n    const apiUrl = 'https://nordw.ru/tools/api/calc/calculate/';\n    \n    try {\n      const totalWeight = form.cargos.reduce((sum, cargo) => sum + cargo.weight, 0);\n      const totalVolume = form.cargos.reduce((sum, cargo) => \n        sum + (cargo.length * cargo.width * cargo.height) / 1000000, 0\n      );\n\n      const params = new URLSearchParams({\n        from: '91', // –ú–æ—Å–∫–≤–∞ (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n        to: '92', // –°–ü–± (–Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å ID –≥–æ—Ä–æ–¥–∞)\n        pickup: form.fromAddressDelivery ? '1' : '0',\n        deliver: form.toAddressDelivery ? '1' : '0',\n        weight: totalWeight.toString(),\n        volume: totalVolume.toString(),\n        oversized: '0',\n        package: form.needPackaging ? '1' : '0',\n        packageCount: form.cargos.length.toString(),\n        insurance: form.needInsurance ? '1' : '0',\n        sum: form.declaredValue.toString(),\n        documentsReturn: '0',\n        fragile: '0'\n      });\n\n      const requestData = Object.fromEntries(params);\n      const fullUrl = `${apiUrl}?${params.toString()}`;\n\n      const response = await fetch(fullUrl);\n      const data = await response.json();\n\n      if (response.ok && data.status === 'success' && data.data) {\n        return {\n          company: 'Nord Wheel',\n          price: data.data.total || 0,\n          days: data.data.days || 0,\n          details: data.data,\n          requestData,\n          responseData: data,\n          apiUrl: fullUrl\n        };\n      } else {\n        return {\n          company: 'Nord Wheel',\n          price: 0,\n          days: 0,\n          error: '–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ Nord Wheel',\n          requestData,\n          responseData: data,\n          apiUrl: fullUrl\n        };\n      }\n    } catch (error: any) {\n      return {\n        company: 'Nord Wheel',\n        price: 0,\n        days: 0,\n        error: `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`,\n        apiUrl\n      };\n    }\n  };\n\n  // –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –¢–ö\n  const calculatePEK = async (): Promise<CalculationResult> => {\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    const basePrice = form.cargos.reduce((sum, cargo) => sum + cargo.weight * 15, 0);\n    let totalPrice = basePrice;\n    \n    if (form.needInsurance) totalPrice += form.declaredValue * 0.02;\n    if (form.needPackaging) totalPrice += basePrice * 0.1;\n    \n    return {\n      company: '–ü–≠–ö',\n      price: totalPrice,\n      days: 3,\n      apiUrl: 'https://pecom.ru/business/developers/api_public/',\n      details: { note: '–ó–∞–≥–ª—É—à–∫–∞ - API –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω' }\n    };\n  };\n\n  const calculateRailContinent = async (): Promise<CalculationResult> => {\n    await new Promise(resolve => setTimeout(resolve, 1200));\n    const basePrice = form.cargos.reduce((sum, cargo) => sum + cargo.weight * 12, 0);\n    let totalPrice = basePrice;\n    \n    if (form.needInsurance) totalPrice += form.declaredValue * 0.025;\n    if (form.needPackaging) totalPrice += basePrice * 0.08;\n    \n    return {\n      company: 'Rail Continent',\n      price: totalPrice,\n      days: 5,\n      apiUrl: 'https://www.railcontinent.ru/services/prochie-gruzoperevozki/forshop/api-manual/',\n      details: { note: '–ó–∞–≥–ª—É—à–∫–∞ - API –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω' }\n    };\n  };\n\n  const handleCalculate = async () => {\n    setCalculating(true);\n    setCalculations([]);\n    \n    try {\n      const results = await Promise.all([\n        calculateDellin(),\n        calculatePEK(),\n        calculateNordWheel(),\n        calculateRailContinent()\n      ]);\n      \n      // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–µ–Ω–µ\n      const sortedResults = results\n        .filter(result => !result.error)\n        .sort((a, b) => a.price - b.price)\n        .concat(results.filter(result => result.error));\n      \n      setCalculations(sortedResults);\n    } catch (error) {\n      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ:', error);\n    } finally {\n      setCalculating(false);\n    }\n  };\n\n  const exportToPDF = () => {\n    if (typeof window !== 'undefined') {\n      window.print();\n    }\n  };\n\n  const toggleDetails = (company: string) => {\n    setExpandedDetails(prev => ({\n      ...prev,\n      [company]: !prev[company]\n    }));\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white p-4 relative\">\n      <div className=\"max-w-7xl mx-auto\">\n        <h1 className=\"text-2xl font-bold text-center mb-6 text-blue-400\">\n          –ú–µ–∂–¥—É–≥–æ—Ä–æ–¥–Ω—è—è –¥–æ—Å—Ç–∞–≤–∫–∞ –õ–∞–≤—Å–∏—Ç\n        </h1>\n        \n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 h-[90vh]\">\n          {/* –õ–µ–≤–∞—è —á–∞—Å—Ç—å - —Ñ–æ—Ä–º–∞ */}\n          <div className=\"space-y-3 overflow-y-auto pr-2\">\n            {/* –ì—Ä—É–∑—ã */}\n            <Card className=\"bg-gray-800 border-gray-700\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-white flex items-center gap-2 text-lg\">\n                  <Truck className=\"h-4 w-4\" />\n                  –ì—Ä—É–∑—ã\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {form.cargos.map((cargo, index) => (\n                  <div key={cargo.id} className=\"border border-gray-600 rounded p-3\">\n                    <div className=\"flex justify-between items-center mb-2\">\n                      <h4 className=\"text-sm font-medium text-white\">–ì—Ä—É–∑ ‚Ññ{index + 1}</h4>\n                      {form.cargos.length > 1 && (\n                        <Button\n                          variant=\"destructive\"\n                          size=\"sm\"\n                          onClick={() => removeCargo(cargo.id)}\n                          className=\"h-6 text-xs\"\n                        >\n                          –£–¥–∞–ª–∏—Ç—å\n                        </Button>\n                      )}\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <div>\n                        <Label className=\"text-white text-xs\">–î–ª–∏–Ω–∞ (—Å–º)</Label>\n                        <Input\n                          type=\"number\"\n                          value={cargo.length || ''}\n                          onChange={(e) => updateCargo(cargo.id, 'length', Number(e.target.value))}\n                          className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-white text-xs\">–®–∏—Ä–∏–Ω–∞ (—Å–º)</Label>\n                        <Input\n                          type=\"number\"\n                          value={cargo.width || ''}\n                          onChange={(e) => updateCargo(cargo.id, 'width', Number(e.target.value))}\n                          className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-white text-xs\">–í—ã—Å–æ—Ç–∞ (—Å–º)</Label>\n                        <Input\n                          type=\"number\"\n                          value={cargo.height || ''}\n                          onChange={(e) => updateCargo(cargo.id, 'height', Number(e.target.value))}\n                          className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-white text-xs\">–í–µ—Å (–∫–≥)</Label>\n                        <Input\n                          type=\"number\"\n                          value={cargo.weight || ''}\n                          onChange={(e) => updateCargo(cargo.id, 'weight', Number(e.target.value))}\n                          className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n                ))}\n                <Button onClick={addCargo} className=\"w-full h-8\" variant=\"outline\">\n                  <Plus className=\"h-3 w-3 mr-1\" />\n                  –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–∑\n                </Button>\n              </CardContent>\n            </Card>\n\n            {/* –ú–∞—Ä—à—Ä—É—Ç */}\n            <Card className=\"bg-gray-800 border-gray-700\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-white flex items-center gap-2 text-lg\">\n                  <Map className=\"h-4 w-4\" />\n                  –ú–∞—Ä—à—Ä—É—Ç\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {/* –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */}\n                <div className=\"space-y-2\">\n                  <Label className=\"text-sm font-medium text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</Label>\n                  <div className=\"flex gap-3\">\n                    <label className=\"flex items-center space-x-1\">\n                      <input\n                        type=\"radio\"\n                        name=\"fromDelivery\"\n                        checked={form.fromTerminal}\n                        onChange={() => setForm(prev => ({ ...prev, fromTerminal: true, fromAddressDelivery: false }))}\n                      />\n                      <span className=\"text-white text-xs\">–û—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n                    </label>\n                    <label className=\"flex items-center space-x-1\">\n                      <input\n                        type=\"radio\"\n                        name=\"fromDelivery\"\n                        checked={form.fromAddressDelivery}\n                        onChange={() => setForm(prev => ({ ...prev, fromTerminal: false, fromAddressDelivery: true }))}\n                      />\n                      <span className=\"text-white text-xs\">–û—Ç –∞–¥—Ä–µ—Å–∞</span>\n                    </label>\n                  </div>\n                  \n                  <div>\n                    <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n                    <Input\n                      value={form.fromCity}\n                      onChange={(e) => handleAddressChange('fromCity', e.target.value, e.target)}\n                      placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n                      className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                    />\n                  </div>\n                  \n                  {form.fromAddressDelivery && (\n                    <div>\n                      <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</Label>\n                      <Input\n                        value={form.fromAddress}\n                        onChange={(e) => handleAddressChange('fromAddress', e.target.value, e.target)}\n                        placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n                        className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                      />\n                    </div>\n                  )}\n                </div>\n\n                <Separator className=\"bg-gray-600\" />\n\n                {/* –î–æ—Å—Ç–∞–≤–∫–∞ */}\n                <div className=\"space-y-2\">\n                  <Label className=\"text-sm font-medium text-white\">–î–æ—Å—Ç–∞–≤–∫–∞</Label>\n                  <div className=\"flex gap-3\">\n                    <label className=\"flex items-center space-x-1\">\n                      <input\n                        type=\"radio\"\n                        name=\"toDelivery\"\n                        checked={form.toTerminal}\n                        onChange={() => setForm(prev => ({ ...prev, toTerminal: true, toAddressDelivery: false }))}\n                      />\n                      <span className=\"text-white text-xs\">–î–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞</span>\n                    </label>\n                    <label className=\"flex items-center space-x-1\">\n                      <input\n                        type=\"radio\"\n                        name=\"toDelivery\"\n                        checked={form.toAddressDelivery}\n                        onChange={() => setForm(prev => ({ ...prev, toTerminal: false, toAddressDelivery: true }))}\n                      />\n                      <span className=\"text-white text-xs\">–î–æ –∞–¥—Ä–µ—Å–∞</span>\n                    </label>\n                  </div>\n                  \n                  <div>\n                    <Label className=\"text-white text-xs\">–ì–æ—Ä–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏</Label>\n                    <Input\n                      value={form.toCity}\n                      onChange={(e) => handleAddressChange('toCity', e.target.value, e.target)}\n                      placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –≥–æ—Ä–æ–¥\"\n                      className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                    />\n                  </div>\n                  \n                  {form.toAddressDelivery && (\n                    <div>\n                      <Label className=\"text-white text-xs\">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</Label>\n                      <Input\n                        value={form.toAddress}\n                        onChange={(e) => handleAddressChange('toAddress', e.target.value, e.target)}\n                        placeholder=\"–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∞–¥—Ä–µ—Å\"\n                        className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                      />\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã */}\n            <Card className=\"bg-gray-800 border-gray-700\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-white text-lg\">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div>\n                  <Label className=\"text-white text-xs\">–û–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)</Label>\n                  <Input\n                    type=\"number\"\n                    value={form.declaredValue || ''}\n                    onChange={(e) => setForm(prev => ({ ...prev, declaredValue: Number(e.target.value) }))}\n                    className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                  />\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id=\"packaging\"\n                      checked={form.needPackaging}\n                      onCheckedChange={(checked) => setForm(prev => ({ ...prev, needPackaging: checked as boolean }))}\n                    />\n                    <Label htmlFor=\"packaging\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —É–ø–∞–∫–æ–≤–∫–∞</Label>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id=\"insurance\"\n                      checked={form.needInsurance}\n                      onCheckedChange={(checked) => setForm(prev => ({ ...prev, needInsurance: checked as boolean }))}\n                    />\n                    <Label htmlFor=\"insurance\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</Label>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id=\"loading\"\n                      checked={form.needLoading}\n                      onCheckedChange={(checked) => setForm(prev => ({ ...prev, needLoading: checked as boolean }))}\n                    />\n                    <Label htmlFor=\"loading\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≥—Ä—É–∑–∫–∞/—Ä–∞–∑–≥—Ä—É–∑–∫–∞</Label>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id=\"carry\"\n                      checked={form.needCarry}\n                      onCheckedChange={(checked) => setForm(prev => ({ ...prev, needCarry: checked as boolean }))}\n                    />\n                    <Label htmlFor=\"carry\" className=\"text-white text-xs\">–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—ä–µ–º</Label>\n                  </div>\n                  \n                  {form.needCarry && (\n                    <div className=\"ml-6 space-y-2 border-l-2 border-gray-600 pl-3\">\n                      <div>\n                        <Label className=\"text-white text-xs\">–≠—Ç–∞–∂</Label>\n                        <Input\n                          type=\"number\"\n                          value={form.floor}\n                          onChange={(e) => setForm(prev => ({ ...prev, floor: Number(e.target.value) }))}\n                          className=\"bg-gray-700 border-gray-600 h-8 text-white\"\n                        />\n                      </div>\n                      <div className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id=\"freightLift\"\n                          checked={form.hasFreightLift}\n                          onCheckedChange={(checked) => setForm(prev => ({ ...prev, hasFreightLift: checked as boolean }))}\n                        />\n                        <Label htmlFor=\"freightLift\" className=\"text-white text-xs\">–ù–∞–ª–∏—á–∏–µ –≥—Ä—É–∑–æ–≤–æ–≥–æ –ª–∏—Ñ—Ç–∞</Label>\n                      </div>\n                    </div>\n                  )}\n                </div>\n                \n                <Button \n                  onClick={handleCalculate} \n                  className=\"w-full bg-blue-600 hover:bg-blue-700 h-8\" \n                  disabled={calculating}\n                >\n                  {calculating ? '–†–∞—Å—á–µ—Ç...' : '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å'}\n                </Button>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã */}\n          <div className=\"space-y-3 overflow-y-auto\">\n            {calculations.length > 0 && (\n              <div className=\"space-y-3\">\n                <div className=\"flex justify-between items-center\">\n                  <h2 className=\"text-xl font-bold text-blue-400\">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h2>\n                  <Button onClick={exportToPDF} variant=\"outline\" size=\"sm\" className=\"h-7 text-xs\">\n                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF\n                  </Button>\n                </div>\n                \n                {calculations.map((calc, index) => (\n                  <Card key={index} className=\"bg-gray-800 border-gray-700\">\n                    <CardHeader className=\"pb-2\">\n                      <div className=\"flex justify-between items-center\">\n                        <CardTitle className=\"text-white flex items-center gap-2 text-sm\">\n                          <Building2 className=\"h-4 w-4\" />\n                          {calc.company}\n                        </CardTitle>\n                        {calc.error ? (\n                          <Badge variant=\"destructive\" className=\"text-xs\">–û—à–∏–±–∫–∞</Badge>\n                        ) : (\n                          <Badge variant=\"default\" className=\"bg-green-600 text-xs\">\n                            {calc.price.toLocaleString()} ‚ÇΩ\n                          </Badge>\n                        )}\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"pt-0\">\n                      {calc.error ? (\n                        <Alert className=\"border-red-600\">\n                          <AlertDescription className=\"text-white text-xs\">{calc.error}</AlertDescription>\n                        </Alert>\n                      ) : (\n                        <div className=\"space-y-2\">\n                          <p className=\"text-white text-xs\"><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {calc.price.toLocaleString()} ‚ÇΩ</p>\n                          <p className=\"text-white text-xs\"><strong>–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> {calc.days} –¥–Ω–µ–π</p>\n                          \n                          <div className=\"flex gap-2 mt-2\">\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => toggleDetails(calc.company)}\n                              className=\"h-6 text-xs\"\n                            >\n                              {expandedDetails[calc.company] ? '–°–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏' : '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ'}\n                            </Button>\n                          </div>\n                          \n                          <Collapsible open={expandedDetails[calc.company]}>\n                            <CollapsibleContent className=\"mt-2\">\n                              <div className=\"bg-gray-900 p-3 rounded text-xs\">\n                                <h4 className=\"font-bold mb-2 text-white\">–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>\n                                \n                                {calc.apiUrl && (\n                                  <div className=\"mb-3\">\n                                    <h5 className=\"font-bold mb-1 text-white\">–ó–∞–ø—Ä–æ—Å –∫ API:</h5>\n                                    <p className=\"text-gray-300 break-all\">URL: {calc.apiUrl}</p>\n                                  </div>\n                                )}\n                                \n                                {calc.sessionId && (\n                                  <div className=\"mb-3\">\n                                    <h5 className=\"font-bold mb-1 text-white\">Session ID:</h5>\n                                    <p className=\"text-gray-300\">{calc.sessionId}</p>\n                                  </div>\n                                )}\n                                \n                                {calc.requestData && (\n                                  <div className=\"mb-3\">\n                                    <h5 className=\"font-bold mb-1 text-white\">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:</h5>\n                                    <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n                                      {JSON.stringify(calc.requestData, null, 2)}\n                                    </pre>\n                                  </div>\n                                )}\n                                \n                                {calc.responseData && (\n                                  <div className=\"mb-3\">\n                                    <h5 className=\"font-bold mb-1 text-white\">–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:</h5>\n                                    <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n                                      {JSON.stringify(calc.responseData, null, 2)}\n                                    </pre>\n                                  </div>\n                                )}\n                                \n                                {calc.details && (\n                                  <div className=\"mb-3\">\n                                    <h5 className=\"font-bold mb-1 text-white\">–î–µ—Ç–∞–ª–∏ —Ä–∞—Å—á–µ—Ç–∞:</h5>\n                                    <pre className=\"whitespace-pre-wrap overflow-auto max-h-32 text-gray-300 bg-gray-950 p-2 rounded text-xs\">\n                                      {JSON.stringify(calc.details, null, 2)}\n                                    </pre>\n                                  </div>\n                                )}\n                              </div>\n                            </CollapsibleContent>\n                          </Collapsible>\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n            \n            {/* –°–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –¢–ö */}\n            <Card className=\"bg-gray-800 border-gray-700\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-white text-sm\">–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  {COMPANIES.map((company, index) => (\n                    <div key={index} className=\"flex items-center gap-2 p-2 bg-gray-700 rounded\">\n                      <span className=\"text-lg\">{company.logo}</span>\n                      <div>\n                        <p className=\"font-medium text-white text-xs\">{company.name}</p>\n                        <Badge variant={company.connected ? \"default\" : \"destructive\"} className=\"text-xs\">\n                          {company.connected ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∞' : '–û—Ç–∫–ª—é—á–µ–Ω–∞'}\n                        </Badge>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* –ê–≤—Ç–æ–ø–æ–¥—Å–∫–∞–∑–∫–∏ */}\n      {showSuggestions && suggestions.length > 0 && (\n        <div \n          className=\"fixed z-50 bg-gray-800 border border-gray-700 rounded-md shadow-lg max-w-sm w-full max-h-60 overflow-y-auto\"\n          style={{\n            top: suggestionPosition.top,\n            left: suggestionPosition.left\n          }}\n        >\n          <div className=\"p-1\">\n            {suggestions.map((suggestion, index) => (\n              <div\n                key={index}\n                className=\"p-2 hover:bg-gray-700 cursor-pointer text-xs text-white rounded transition-colors\"\n                onClick={() => selectSuggestion(suggestion)}\n              >\n                {suggestion.value}\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}"
    },
    "output": "",
    "metadata": {
      "diagnostics": {},
      "filepath": "/home/user/project/app/page.tsx",
      "exists": true
    },
    "title": "app/page.tsx",
    "time": {
      "start": 1758616047000,
      "end": 1758616047020
    }
  }
}